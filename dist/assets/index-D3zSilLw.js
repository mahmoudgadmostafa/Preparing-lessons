var tS=n=>{throw TypeError(n)};var By=(n,e,t)=>e.has(n)||tS("Cannot "+t);var W=(n,e,t)=>(By(n,e,"read from private field"),t?t.call(n):e.get(n)),Fe=(n,e,t)=>e.has(n)?tS("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),_e=(n,e,t,r)=>(By(n,e,"write to private field"),r?r.call(n,t):e.set(n,t),t),en=(n,e,t)=>(By(n,e,"access private method"),t);var Qd=(n,e,t,r)=>({set _(s){_e(n,e,s,t)},get _(){return W(n,e,r)}});function pA(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in n)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(n,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();function gA(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function bL(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var s=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:function(){return n[r]}})}),t}var mA={exports:{}},am={},yA={exports:{}},Ce={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ad=Symbol.for("react.element"),SL=Symbol.for("react.portal"),EL=Symbol.for("react.fragment"),TL=Symbol.for("react.strict_mode"),CL=Symbol.for("react.profiler"),kL=Symbol.for("react.provider"),AL=Symbol.for("react.context"),PL=Symbol.for("react.forward_ref"),IL=Symbol.for("react.suspense"),RL=Symbol.for("react.memo"),OL=Symbol.for("react.lazy"),nS=Symbol.iterator;function NL(n){return n===null||typeof n!="object"?null:(n=nS&&n[nS]||n["@@iterator"],typeof n=="function"?n:null)}var vA={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},wA=Object.assign,_A={};function jc(n,e,t){this.props=n,this.context=e,this.refs=_A,this.updater=t||vA}jc.prototype.isReactComponent={};jc.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};jc.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function xA(){}xA.prototype=jc.prototype;function N_(n,e,t){this.props=n,this.context=e,this.refs=_A,this.updater=t||vA}var j_=N_.prototype=new xA;j_.constructor=N_;wA(j_,jc.prototype);j_.isPureReactComponent=!0;var rS=Array.isArray,bA=Object.prototype.hasOwnProperty,D_={current:null},SA={key:!0,ref:!0,__self:!0,__source:!0};function EA(n,e,t){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)bA.call(e,r)&&!SA.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=t;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];s.children=l}if(n&&n.defaultProps)for(r in a=n.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:ad,type:n,key:i,ref:o,props:s,_owner:D_.current}}function jL(n,e){return{$$typeof:ad,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function M_(n){return typeof n=="object"&&n!==null&&n.$$typeof===ad}function DL(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var sS=/\/+/g;function zy(n,e){return typeof n=="object"&&n!==null&&n.key!=null?DL(""+n.key):e.toString(36)}function fp(n,e,t,r,s){var i=typeof n;(i==="undefined"||i==="boolean")&&(n=null);var o=!1;if(n===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(n.$$typeof){case ad:case SL:o=!0}}if(o)return o=n,s=s(o),n=r===""?"."+zy(o,0):r,rS(s)?(t="",n!=null&&(t=n.replace(sS,"$&/")+"/"),fp(s,e,t,"",function(c){return c})):s!=null&&(M_(s)&&(s=jL(s,t+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(sS,"$&/")+"/")+n)),e.push(s)),1;if(o=0,r=r===""?".":r+":",rS(n))for(var a=0;a<n.length;a++){i=n[a];var l=r+zy(i,a);o+=fp(i,e,t,l,s)}else if(l=NL(n),typeof l=="function")for(n=l.call(n),a=0;!(i=n.next()).done;)i=i.value,l=r+zy(i,a++),o+=fp(i,e,t,l,s);else if(i==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Jd(n,e,t){if(n==null)return n;var r=[],s=0;return fp(n,r,"","",function(i){return e.call(t,i,s++)}),r}function ML(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var Sn={current:null},pp={transition:null},LL={ReactCurrentDispatcher:Sn,ReactCurrentBatchConfig:pp,ReactCurrentOwner:D_};function TA(){throw Error("act(...) is not supported in production builds of React.")}Ce.Children={map:Jd,forEach:function(n,e,t){Jd(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return Jd(n,function(){e++}),e},toArray:function(n){return Jd(n,function(e){return e})||[]},only:function(n){if(!M_(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};Ce.Component=jc;Ce.Fragment=EL;Ce.Profiler=CL;Ce.PureComponent=N_;Ce.StrictMode=TL;Ce.Suspense=IL;Ce.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=LL;Ce.act=TA;Ce.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var r=wA({},n.props),s=n.key,i=n.ref,o=n._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=D_.current),e.key!==void 0&&(s=""+e.key),n.type&&n.type.defaultProps)var a=n.type.defaultProps;for(l in e)bA.call(e,l)&&!SA.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=t;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:ad,type:n.type,key:s,ref:i,props:r,_owner:o}};Ce.createContext=function(n){return n={$$typeof:AL,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:kL,_context:n},n.Consumer=n};Ce.createElement=EA;Ce.createFactory=function(n){var e=EA.bind(null,n);return e.type=n,e};Ce.createRef=function(){return{current:null}};Ce.forwardRef=function(n){return{$$typeof:PL,render:n}};Ce.isValidElement=M_;Ce.lazy=function(n){return{$$typeof:OL,_payload:{_status:-1,_result:n},_init:ML}};Ce.memo=function(n,e){return{$$typeof:RL,type:n,compare:e===void 0?null:e}};Ce.startTransition=function(n){var e=pp.transition;pp.transition={};try{n()}finally{pp.transition=e}};Ce.unstable_act=TA;Ce.useCallback=function(n,e){return Sn.current.useCallback(n,e)};Ce.useContext=function(n){return Sn.current.useContext(n)};Ce.useDebugValue=function(){};Ce.useDeferredValue=function(n){return Sn.current.useDeferredValue(n)};Ce.useEffect=function(n,e){return Sn.current.useEffect(n,e)};Ce.useId=function(){return Sn.current.useId()};Ce.useImperativeHandle=function(n,e,t){return Sn.current.useImperativeHandle(n,e,t)};Ce.useInsertionEffect=function(n,e){return Sn.current.useInsertionEffect(n,e)};Ce.useLayoutEffect=function(n,e){return Sn.current.useLayoutEffect(n,e)};Ce.useMemo=function(n,e){return Sn.current.useMemo(n,e)};Ce.useReducer=function(n,e,t){return Sn.current.useReducer(n,e,t)};Ce.useRef=function(n){return Sn.current.useRef(n)};Ce.useState=function(n){return Sn.current.useState(n)};Ce.useSyncExternalStore=function(n,e,t){return Sn.current.useSyncExternalStore(n,e,t)};Ce.useTransition=function(){return Sn.current.useTransition()};Ce.version="18.3.1";yA.exports=Ce;var C=yA.exports;const J=gA(C),L_=pA({__proto__:null,default:J},[C]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var FL=C,VL=Symbol.for("react.element"),UL=Symbol.for("react.fragment"),$L=Object.prototype.hasOwnProperty,BL=FL.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,zL={key:!0,ref:!0,__self:!0,__source:!0};function CA(n,e,t){var r,s={},i=null,o=null;t!==void 0&&(i=""+t),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)$L.call(e,r)&&!zL.hasOwnProperty(r)&&(s[r]=e[r]);if(n&&n.defaultProps)for(r in e=n.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:VL,type:n,key:i,ref:o,props:s,_owner:BL.current}}am.Fragment=UL;am.jsx=CA;am.jsxs=CA;mA.exports=am;var g=mA.exports,kA={exports:{}},tr={},AA={exports:{}},PA={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(V,z){var Q=V.length;V.push(z);e:for(;0<Q;){var ue=Q-1>>>1,oe=V[ue];if(0<s(oe,z))V[ue]=z,V[Q]=oe,Q=ue;else break e}}function t(V){return V.length===0?null:V[0]}function r(V){if(V.length===0)return null;var z=V[0],Q=V.pop();if(Q!==z){V[0]=Q;e:for(var ue=0,oe=V.length,fe=oe>>>1;ue<fe;){var ce=2*(ue+1)-1,Ne=V[ce],je=ce+1,Z=V[je];if(0>s(Ne,Q))je<oe&&0>s(Z,Ne)?(V[ue]=Z,V[je]=Q,ue=je):(V[ue]=Ne,V[ce]=Q,ue=ce);else if(je<oe&&0>s(Z,Q))V[ue]=Z,V[je]=Q,ue=je;else break e}}return z}function s(V,z){var Q=V.sortIndex-z.sortIndex;return Q!==0?Q:V.id-z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;n.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,h=null,f=3,p=!1,y=!1,m=!1,v=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(V){for(var z=t(c);z!==null;){if(z.callback===null)r(c);else if(z.startTime<=V)r(c),z.sortIndex=z.expirationTime,e(l,z);else break;z=t(c)}}function A(V){if(m=!1,x(V),!y)if(t(l)!==null)y=!0,G(j);else{var z=t(c);z!==null&&Y(A,z.startTime-V)}}function j(V,z){y=!1,m&&(m=!1,w(T),T=-1),p=!0;var Q=f;try{for(x(z),h=t(l);h!==null&&(!(h.expirationTime>z)||V&&!D());){var ue=h.callback;if(typeof ue=="function"){h.callback=null,f=h.priorityLevel;var oe=ue(h.expirationTime<=z);z=n.unstable_now(),typeof oe=="function"?h.callback=oe:h===t(l)&&r(l),x(z)}else r(l);h=t(l)}if(h!==null)var fe=!0;else{var ce=t(c);ce!==null&&Y(A,ce.startTime-z),fe=!1}return fe}finally{h=null,f=Q,p=!1}}var N=!1,S=null,T=-1,P=5,R=-1;function D(){return!(n.unstable_now()-R<P)}function I(){if(S!==null){var V=n.unstable_now();R=V;var z=!0;try{z=S(!0,V)}finally{z?k():(N=!1,S=null)}}else N=!1}var k;if(typeof _=="function")k=function(){_(I)};else if(typeof MessageChannel<"u"){var F=new MessageChannel,K=F.port2;F.port1.onmessage=I,k=function(){K.postMessage(null)}}else k=function(){v(I,0)};function G(V){S=V,N||(N=!0,k())}function Y(V,z){T=v(function(){V(n.unstable_now())},z)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(V){V.callback=null},n.unstable_continueExecution=function(){y||p||(y=!0,G(j))},n.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<V?Math.floor(1e3/V):5},n.unstable_getCurrentPriorityLevel=function(){return f},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(V){switch(f){case 1:case 2:case 3:var z=3;break;default:z=f}var Q=f;f=z;try{return V()}finally{f=Q}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(V,z){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var Q=f;f=V;try{return z()}finally{f=Q}},n.unstable_scheduleCallback=function(V,z,Q){var ue=n.unstable_now();switch(typeof Q=="object"&&Q!==null?(Q=Q.delay,Q=typeof Q=="number"&&0<Q?ue+Q:ue):Q=ue,V){case 1:var oe=-1;break;case 2:oe=250;break;case 5:oe=1073741823;break;case 4:oe=1e4;break;default:oe=5e3}return oe=Q+oe,V={id:u++,callback:z,priorityLevel:V,startTime:Q,expirationTime:oe,sortIndex:-1},Q>ue?(V.sortIndex=Q,e(c,V),t(l)===null&&V===t(c)&&(m?(w(T),T=-1):m=!0,Y(A,Q-ue))):(V.sortIndex=oe,e(l,V),y||p||(y=!0,G(j))),V},n.unstable_shouldYield=D,n.unstable_wrapCallback=function(V){var z=f;return function(){var Q=f;f=z;try{return V.apply(this,arguments)}finally{f=Q}}}})(PA);AA.exports=PA;var WL=AA.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var HL=C,er=WL;function X(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var IA=new Set,ph={};function Wa(n,e){dc(n,e),dc(n+"Capture",e)}function dc(n,e){for(ph[n]=e,n=0;n<e.length;n++)IA.add(e[n])}var ni=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),f0=Object.prototype.hasOwnProperty,qL=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,iS={},oS={};function GL(n){return f0.call(oS,n)?!0:f0.call(iS,n)?!1:qL.test(n)?oS[n]=!0:(iS[n]=!0,!1)}function KL(n,e,t,r){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function YL(n,e,t,r){if(e===null||typeof e>"u"||KL(n,e,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function En(n,e,t,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Qt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){Qt[n]=new En(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];Qt[e]=new En(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){Qt[n]=new En(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){Qt[n]=new En(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){Qt[n]=new En(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){Qt[n]=new En(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){Qt[n]=new En(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){Qt[n]=new En(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){Qt[n]=new En(n,5,!1,n.toLowerCase(),null,!1,!1)});var F_=/[\-:]([a-z])/g;function V_(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(F_,V_);Qt[e]=new En(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(F_,V_);Qt[e]=new En(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(F_,V_);Qt[e]=new En(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){Qt[n]=new En(n,1,!1,n.toLowerCase(),null,!1,!1)});Qt.xlinkHref=new En("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){Qt[n]=new En(n,1,!1,n.toLowerCase(),null,!0,!0)});function U_(n,e,t,r){var s=Qt.hasOwnProperty(e)?Qt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(YL(e,t,s,r)&&(t=null),r||s===null?GL(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):s.mustUseProperty?n[s.propertyName]=t===null?s.type===3?!1:"":t:(e=s.attributeName,r=s.attributeNamespace,t===null?n.removeAttribute(e):(s=s.type,t=s===3||s===4&&t===!0?"":""+t,r?n.setAttributeNS(r,e,t):n.setAttribute(e,t))))}var mi=HL.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Zd=Symbol.for("react.element"),Sl=Symbol.for("react.portal"),El=Symbol.for("react.fragment"),$_=Symbol.for("react.strict_mode"),p0=Symbol.for("react.profiler"),RA=Symbol.for("react.provider"),OA=Symbol.for("react.context"),B_=Symbol.for("react.forward_ref"),g0=Symbol.for("react.suspense"),m0=Symbol.for("react.suspense_list"),z_=Symbol.for("react.memo"),Fi=Symbol.for("react.lazy"),NA=Symbol.for("react.offscreen"),aS=Symbol.iterator;function xu(n){return n===null||typeof n!="object"?null:(n=aS&&n[aS]||n["@@iterator"],typeof n=="function"?n:null)}var dt=Object.assign,Wy;function Nu(n){if(Wy===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);Wy=e&&e[1]||""}return`
`+Wy+n}var Hy=!1;function qy(n,e){if(!n||Hy)return"";Hy=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(n,[],e)}else{try{e.call()}catch(c){r=c}n.call(e.prototype)}else{try{throw Error()}catch(c){r=c}n()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var l=`
`+s[o].replace(" at new "," at ");return n.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",n.displayName)),l}while(1<=o&&0<=a);break}}}finally{Hy=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?Nu(n):""}function XL(n){switch(n.tag){case 5:return Nu(n.type);case 16:return Nu("Lazy");case 13:return Nu("Suspense");case 19:return Nu("SuspenseList");case 0:case 2:case 15:return n=qy(n.type,!1),n;case 11:return n=qy(n.type.render,!1),n;case 1:return n=qy(n.type,!0),n;default:return""}}function y0(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case El:return"Fragment";case Sl:return"Portal";case p0:return"Profiler";case $_:return"StrictMode";case g0:return"Suspense";case m0:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case OA:return(n.displayName||"Context")+".Consumer";case RA:return(n._context.displayName||"Context")+".Provider";case B_:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case z_:return e=n.displayName||null,e!==null?e:y0(n.type)||"Memo";case Fi:e=n._payload,n=n._init;try{return y0(n(e))}catch{}}return null}function QL(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return y0(e);case 8:return e===$_?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function wo(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function jA(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function JL(n){var e=jA(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),r=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var s=t.get,i=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function ef(n){n._valueTracker||(n._valueTracker=JL(n))}function DA(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),r="";return n&&(r=jA(n)?n.checked?"true":"false":n.value),n=r,n!==t?(e.setValue(n),!0):!1}function Hp(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function v0(n,e){var t=e.checked;return dt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function lS(n,e){var t=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;t=wo(e.value!=null?e.value:t),n._wrapperState={initialChecked:r,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function MA(n,e){e=e.checked,e!=null&&U_(n,"checked",e,!1)}function w0(n,e){MA(n,e);var t=wo(e.value),r=e.type;if(t!=null)r==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(r==="submit"||r==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?_0(n,e.type,t):e.hasOwnProperty("defaultValue")&&_0(n,e.type,wo(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function cS(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function _0(n,e,t){(e!=="number"||Hp(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var ju=Array.isArray;function Ul(n,e,t,r){if(n=n.options,e){e={};for(var s=0;s<t.length;s++)e["$"+t[s]]=!0;for(t=0;t<n.length;t++)s=e.hasOwnProperty("$"+n[t].value),n[t].selected!==s&&(n[t].selected=s),s&&r&&(n[t].defaultSelected=!0)}else{for(t=""+wo(t),e=null,s=0;s<n.length;s++){if(n[s].value===t){n[s].selected=!0,r&&(n[s].defaultSelected=!0);return}e!==null||n[s].disabled||(e=n[s])}e!==null&&(e.selected=!0)}}function x0(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(X(91));return dt({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function uS(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(X(92));if(ju(t)){if(1<t.length)throw Error(X(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:wo(t)}}function LA(n,e){var t=wo(e.value),r=wo(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),r!=null&&(n.defaultValue=""+r)}function hS(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function FA(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function b0(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?FA(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var tf,VA=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,r,s){MSApp.execUnsafeLocalFunction(function(){return n(e,t,r,s)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(tf=tf||document.createElement("div"),tf.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=tf.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function gh(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var qu={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ZL=["Webkit","ms","Moz","O"];Object.keys(qu).forEach(function(n){ZL.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),qu[e]=qu[n]})});function UA(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||qu.hasOwnProperty(n)&&qu[n]?(""+e).trim():e+"px"}function $A(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var r=t.indexOf("--")===0,s=UA(t,e[t],r);t==="float"&&(t="cssFloat"),r?n.setProperty(t,s):n[t]=s}}var e4=dt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function S0(n,e){if(e){if(e4[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(X(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(X(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(X(61))}if(e.style!=null&&typeof e.style!="object")throw Error(X(62))}}function E0(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var T0=null;function W_(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var C0=null,$l=null,Bl=null;function dS(n){if(n=ud(n)){if(typeof C0!="function")throw Error(X(280));var e=n.stateNode;e&&(e=dm(e),C0(n.stateNode,n.type,e))}}function BA(n){$l?Bl?Bl.push(n):Bl=[n]:$l=n}function zA(){if($l){var n=$l,e=Bl;if(Bl=$l=null,dS(n),e)for(n=0;n<e.length;n++)dS(e[n])}}function WA(n,e){return n(e)}function HA(){}var Gy=!1;function qA(n,e,t){if(Gy)return n(e,t);Gy=!0;try{return WA(n,e,t)}finally{Gy=!1,($l!==null||Bl!==null)&&(HA(),zA())}}function mh(n,e){var t=n.stateNode;if(t===null)return null;var r=dm(t);if(r===null)return null;t=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(n=n.type,r=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!r;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(X(231,e,typeof t));return t}var k0=!1;if(ni)try{var bu={};Object.defineProperty(bu,"passive",{get:function(){k0=!0}}),window.addEventListener("test",bu,bu),window.removeEventListener("test",bu,bu)}catch{k0=!1}function t4(n,e,t,r,s,i,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(t,c)}catch(u){this.onError(u)}}var Gu=!1,qp=null,Gp=!1,A0=null,n4={onError:function(n){Gu=!0,qp=n}};function r4(n,e,t,r,s,i,o,a,l){Gu=!1,qp=null,t4.apply(n4,arguments)}function s4(n,e,t,r,s,i,o,a,l){if(r4.apply(this,arguments),Gu){if(Gu){var c=qp;Gu=!1,qp=null}else throw Error(X(198));Gp||(Gp=!0,A0=c)}}function Ha(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function GA(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function fS(n){if(Ha(n)!==n)throw Error(X(188))}function i4(n){var e=n.alternate;if(!e){if(e=Ha(n),e===null)throw Error(X(188));return e!==n?null:n}for(var t=n,r=e;;){var s=t.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){t=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===t)return fS(s),n;if(i===r)return fS(s),e;i=i.sibling}throw Error(X(188))}if(t.return!==r.return)t=s,r=i;else{for(var o=!1,a=s.child;a;){if(a===t){o=!0,t=s,r=i;break}if(a===r){o=!0,r=s,t=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===t){o=!0,t=i,r=s;break}if(a===r){o=!0,r=i,t=s;break}a=a.sibling}if(!o)throw Error(X(189))}}if(t.alternate!==r)throw Error(X(190))}if(t.tag!==3)throw Error(X(188));return t.stateNode.current===t?n:e}function KA(n){return n=i4(n),n!==null?YA(n):null}function YA(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=YA(n);if(e!==null)return e;n=n.sibling}return null}var XA=er.unstable_scheduleCallback,pS=er.unstable_cancelCallback,o4=er.unstable_shouldYield,a4=er.unstable_requestPaint,wt=er.unstable_now,l4=er.unstable_getCurrentPriorityLevel,H_=er.unstable_ImmediatePriority,QA=er.unstable_UserBlockingPriority,Kp=er.unstable_NormalPriority,c4=er.unstable_LowPriority,JA=er.unstable_IdlePriority,lm=null,ys=null;function u4(n){if(ys&&typeof ys.onCommitFiberRoot=="function")try{ys.onCommitFiberRoot(lm,n,void 0,(n.current.flags&128)===128)}catch{}}var Wr=Math.clz32?Math.clz32:f4,h4=Math.log,d4=Math.LN2;function f4(n){return n>>>=0,n===0?32:31-(h4(n)/d4|0)|0}var nf=64,rf=4194304;function Du(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function Yp(n,e){var t=n.pendingLanes;if(t===0)return 0;var r=0,s=n.suspendedLanes,i=n.pingedLanes,o=t&268435455;if(o!==0){var a=o&~s;a!==0?r=Du(a):(i&=o,i!==0&&(r=Du(i)))}else o=t&~s,o!==0?r=Du(o):i!==0&&(r=Du(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=r;0<e;)t=31-Wr(e),s=1<<t,r|=n[t],e&=~s;return r}function p4(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function g4(n,e){for(var t=n.suspendedLanes,r=n.pingedLanes,s=n.expirationTimes,i=n.pendingLanes;0<i;){var o=31-Wr(i),a=1<<o,l=s[o];l===-1?(!(a&t)||a&r)&&(s[o]=p4(a,e)):l<=e&&(n.expiredLanes|=a),i&=~a}}function P0(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function ZA(){var n=nf;return nf<<=1,!(nf&4194240)&&(nf=64),n}function Ky(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function ld(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-Wr(e),n[e]=t}function m4(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var r=n.eventTimes;for(n=n.expirationTimes;0<t;){var s=31-Wr(t),i=1<<s;e[s]=0,r[s]=-1,n[s]=-1,t&=~i}}function q_(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var r=31-Wr(t),s=1<<r;s&e|n[r]&e&&(n[r]|=e),t&=~s}}var He=0;function eP(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var tP,G_,nP,rP,sP,I0=!1,sf=[],io=null,oo=null,ao=null,yh=new Map,vh=new Map,$i=[],y4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function gS(n,e){switch(n){case"focusin":case"focusout":io=null;break;case"dragenter":case"dragleave":oo=null;break;case"mouseover":case"mouseout":ao=null;break;case"pointerover":case"pointerout":yh.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":vh.delete(e.pointerId)}}function Su(n,e,t,r,s,i){return n===null||n.nativeEvent!==i?(n={blockedOn:e,domEventName:t,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=ud(e),e!==null&&G_(e)),n):(n.eventSystemFlags|=r,e=n.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),n)}function v4(n,e,t,r,s){switch(e){case"focusin":return io=Su(io,n,e,t,r,s),!0;case"dragenter":return oo=Su(oo,n,e,t,r,s),!0;case"mouseover":return ao=Su(ao,n,e,t,r,s),!0;case"pointerover":var i=s.pointerId;return yh.set(i,Su(yh.get(i)||null,n,e,t,r,s)),!0;case"gotpointercapture":return i=s.pointerId,vh.set(i,Su(vh.get(i)||null,n,e,t,r,s)),!0}return!1}function iP(n){var e=la(n.target);if(e!==null){var t=Ha(e);if(t!==null){if(e=t.tag,e===13){if(e=GA(t),e!==null){n.blockedOn=e,sP(n.priority,function(){nP(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function gp(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=R0(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var r=new t.constructor(t.type,t);T0=r,t.target.dispatchEvent(r),T0=null}else return e=ud(t),e!==null&&G_(e),n.blockedOn=t,!1;e.shift()}return!0}function mS(n,e,t){gp(n)&&t.delete(e)}function w4(){I0=!1,io!==null&&gp(io)&&(io=null),oo!==null&&gp(oo)&&(oo=null),ao!==null&&gp(ao)&&(ao=null),yh.forEach(mS),vh.forEach(mS)}function Eu(n,e){n.blockedOn===e&&(n.blockedOn=null,I0||(I0=!0,er.unstable_scheduleCallback(er.unstable_NormalPriority,w4)))}function wh(n){function e(s){return Eu(s,n)}if(0<sf.length){Eu(sf[0],n);for(var t=1;t<sf.length;t++){var r=sf[t];r.blockedOn===n&&(r.blockedOn=null)}}for(io!==null&&Eu(io,n),oo!==null&&Eu(oo,n),ao!==null&&Eu(ao,n),yh.forEach(e),vh.forEach(e),t=0;t<$i.length;t++)r=$i[t],r.blockedOn===n&&(r.blockedOn=null);for(;0<$i.length&&(t=$i[0],t.blockedOn===null);)iP(t),t.blockedOn===null&&$i.shift()}var zl=mi.ReactCurrentBatchConfig,Xp=!0;function _4(n,e,t,r){var s=He,i=zl.transition;zl.transition=null;try{He=1,K_(n,e,t,r)}finally{He=s,zl.transition=i}}function x4(n,e,t,r){var s=He,i=zl.transition;zl.transition=null;try{He=4,K_(n,e,t,r)}finally{He=s,zl.transition=i}}function K_(n,e,t,r){if(Xp){var s=R0(n,e,t,r);if(s===null)sv(n,e,r,Qp,t),gS(n,r);else if(v4(s,n,e,t,r))r.stopPropagation();else if(gS(n,r),e&4&&-1<y4.indexOf(n)){for(;s!==null;){var i=ud(s);if(i!==null&&tP(i),i=R0(n,e,t,r),i===null&&sv(n,e,r,Qp,t),i===s)break;s=i}s!==null&&r.stopPropagation()}else sv(n,e,r,null,t)}}var Qp=null;function R0(n,e,t,r){if(Qp=null,n=W_(r),n=la(n),n!==null)if(e=Ha(n),e===null)n=null;else if(t=e.tag,t===13){if(n=GA(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return Qp=n,null}function oP(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(l4()){case H_:return 1;case QA:return 4;case Kp:case c4:return 16;case JA:return 536870912;default:return 16}default:return 16}}var eo=null,Y_=null,mp=null;function aP(){if(mp)return mp;var n,e=Y_,t=e.length,r,s="value"in eo?eo.value:eo.textContent,i=s.length;for(n=0;n<t&&e[n]===s[n];n++);var o=t-n;for(r=1;r<=o&&e[t-r]===s[i-r];r++);return mp=s.slice(n,1<r?1-r:void 0)}function yp(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function of(){return!0}function yS(){return!1}function nr(n){function e(t,r,s,i,o){this._reactName=t,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in n)n.hasOwnProperty(a)&&(t=n[a],this[a]=t?t(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?of:yS,this.isPropagationStopped=yS,this}return dt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=of)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=of)},persist:function(){},isPersistent:of}),e}var Dc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},X_=nr(Dc),cd=dt({},Dc,{view:0,detail:0}),b4=nr(cd),Yy,Xy,Tu,cm=dt({},cd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Q_,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Tu&&(Tu&&n.type==="mousemove"?(Yy=n.screenX-Tu.screenX,Xy=n.screenY-Tu.screenY):Xy=Yy=0,Tu=n),Yy)},movementY:function(n){return"movementY"in n?n.movementY:Xy}}),vS=nr(cm),S4=dt({},cm,{dataTransfer:0}),E4=nr(S4),T4=dt({},cd,{relatedTarget:0}),Qy=nr(T4),C4=dt({},Dc,{animationName:0,elapsedTime:0,pseudoElement:0}),k4=nr(C4),A4=dt({},Dc,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),P4=nr(A4),I4=dt({},Dc,{data:0}),wS=nr(I4),R4={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},O4={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},N4={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function j4(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=N4[n])?!!e[n]:!1}function Q_(){return j4}var D4=dt({},cd,{key:function(n){if(n.key){var e=R4[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=yp(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?O4[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Q_,charCode:function(n){return n.type==="keypress"?yp(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?yp(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),M4=nr(D4),L4=dt({},cm,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),_S=nr(L4),F4=dt({},cd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Q_}),V4=nr(F4),U4=dt({},Dc,{propertyName:0,elapsedTime:0,pseudoElement:0}),$4=nr(U4),B4=dt({},cm,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),z4=nr(B4),W4=[9,13,27,32],J_=ni&&"CompositionEvent"in window,Ku=null;ni&&"documentMode"in document&&(Ku=document.documentMode);var H4=ni&&"TextEvent"in window&&!Ku,lP=ni&&(!J_||Ku&&8<Ku&&11>=Ku),xS=" ",bS=!1;function cP(n,e){switch(n){case"keyup":return W4.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function uP(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Tl=!1;function q4(n,e){switch(n){case"compositionend":return uP(e);case"keypress":return e.which!==32?null:(bS=!0,xS);case"textInput":return n=e.data,n===xS&&bS?null:n;default:return null}}function G4(n,e){if(Tl)return n==="compositionend"||!J_&&cP(n,e)?(n=aP(),mp=Y_=eo=null,Tl=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return lP&&e.locale!=="ko"?null:e.data;default:return null}}var K4={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function SS(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!K4[n.type]:e==="textarea"}function hP(n,e,t,r){BA(r),e=Jp(e,"onChange"),0<e.length&&(t=new X_("onChange","change",null,t,r),n.push({event:t,listeners:e}))}var Yu=null,_h=null;function Y4(n){bP(n,0)}function um(n){var e=Al(n);if(DA(e))return n}function X4(n,e){if(n==="change")return e}var dP=!1;if(ni){var Jy;if(ni){var Zy="oninput"in document;if(!Zy){var ES=document.createElement("div");ES.setAttribute("oninput","return;"),Zy=typeof ES.oninput=="function"}Jy=Zy}else Jy=!1;dP=Jy&&(!document.documentMode||9<document.documentMode)}function TS(){Yu&&(Yu.detachEvent("onpropertychange",fP),_h=Yu=null)}function fP(n){if(n.propertyName==="value"&&um(_h)){var e=[];hP(e,_h,n,W_(n)),qA(Y4,e)}}function Q4(n,e,t){n==="focusin"?(TS(),Yu=e,_h=t,Yu.attachEvent("onpropertychange",fP)):n==="focusout"&&TS()}function J4(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return um(_h)}function Z4(n,e){if(n==="click")return um(e)}function eF(n,e){if(n==="input"||n==="change")return um(e)}function tF(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var Gr=typeof Object.is=="function"?Object.is:tF;function xh(n,e){if(Gr(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var s=t[r];if(!f0.call(e,s)||!Gr(n[s],e[s]))return!1}return!0}function CS(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function kS(n,e){var t=CS(n);n=0;for(var r;t;){if(t.nodeType===3){if(r=n+t.textContent.length,n<=e&&r>=e)return{node:t,offset:e-n};n=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=CS(t)}}function pP(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?pP(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function gP(){for(var n=window,e=Hp();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=Hp(n.document)}return e}function Z_(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function nF(n){var e=gP(),t=n.focusedElem,r=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&pP(t.ownerDocument.documentElement,t)){if(r!==null&&Z_(t)){if(e=r.start,n=r.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var s=t.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!n.extend&&i>r&&(s=r,r=i,i=s),s=kS(t,i);var o=kS(t,r);s&&o&&(n.rangeCount!==1||n.anchorNode!==s.node||n.anchorOffset!==s.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),n.removeAllRanges(),i>r?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var rF=ni&&"documentMode"in document&&11>=document.documentMode,Cl=null,O0=null,Xu=null,N0=!1;function AS(n,e,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;N0||Cl==null||Cl!==Hp(r)||(r=Cl,"selectionStart"in r&&Z_(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Xu&&xh(Xu,r)||(Xu=r,r=Jp(O0,"onSelect"),0<r.length&&(e=new X_("onSelect","select",null,e,t),n.push({event:e,listeners:r}),e.target=Cl)))}function af(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var kl={animationend:af("Animation","AnimationEnd"),animationiteration:af("Animation","AnimationIteration"),animationstart:af("Animation","AnimationStart"),transitionend:af("Transition","TransitionEnd")},ev={},mP={};ni&&(mP=document.createElement("div").style,"AnimationEvent"in window||(delete kl.animationend.animation,delete kl.animationiteration.animation,delete kl.animationstart.animation),"TransitionEvent"in window||delete kl.transitionend.transition);function hm(n){if(ev[n])return ev[n];if(!kl[n])return n;var e=kl[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in mP)return ev[n]=e[t];return n}var yP=hm("animationend"),vP=hm("animationiteration"),wP=hm("animationstart"),_P=hm("transitionend"),xP=new Map,PS="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ro(n,e){xP.set(n,e),Wa(e,[n])}for(var tv=0;tv<PS.length;tv++){var nv=PS[tv],sF=nv.toLowerCase(),iF=nv[0].toUpperCase()+nv.slice(1);Ro(sF,"on"+iF)}Ro(yP,"onAnimationEnd");Ro(vP,"onAnimationIteration");Ro(wP,"onAnimationStart");Ro("dblclick","onDoubleClick");Ro("focusin","onFocus");Ro("focusout","onBlur");Ro(_P,"onTransitionEnd");dc("onMouseEnter",["mouseout","mouseover"]);dc("onMouseLeave",["mouseout","mouseover"]);dc("onPointerEnter",["pointerout","pointerover"]);dc("onPointerLeave",["pointerout","pointerover"]);Wa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Wa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Wa("onBeforeInput",["compositionend","keypress","textInput","paste"]);Wa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Wa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Wa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Mu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),oF=new Set("cancel close invalid load scroll toggle".split(" ").concat(Mu));function IS(n,e,t){var r=n.type||"unknown-event";n.currentTarget=t,s4(r,e,void 0,n),n.currentTarget=null}function bP(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var r=n[t],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==i&&s.isPropagationStopped())break e;IS(s,a,c),i=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==i&&s.isPropagationStopped())break e;IS(s,a,c),i=l}}}if(Gp)throw n=A0,Gp=!1,A0=null,n}function tt(n,e){var t=e[F0];t===void 0&&(t=e[F0]=new Set);var r=n+"__bubble";t.has(r)||(SP(e,n,2,!1),t.add(r))}function rv(n,e,t){var r=0;e&&(r|=4),SP(t,n,r,e)}var lf="_reactListening"+Math.random().toString(36).slice(2);function bh(n){if(!n[lf]){n[lf]=!0,IA.forEach(function(t){t!=="selectionchange"&&(oF.has(t)||rv(t,!1,n),rv(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[lf]||(e[lf]=!0,rv("selectionchange",!1,e))}}function SP(n,e,t,r){switch(oP(e)){case 1:var s=_4;break;case 4:s=x4;break;default:s=K_}t=s.bind(null,e,t,n),s=void 0,!k0||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?n.addEventListener(e,t,{capture:!0,passive:s}):n.addEventListener(e,t,!0):s!==void 0?n.addEventListener(e,t,{passive:s}):n.addEventListener(e,t,!1)}function sv(n,e,t,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;o=o.return}for(;a!==null;){if(o=la(a),o===null)return;if(l=o.tag,l===5||l===6){r=i=o;continue e}a=a.parentNode}}r=r.return}qA(function(){var c=i,u=W_(t),h=[];e:{var f=xP.get(n);if(f!==void 0){var p=X_,y=n;switch(n){case"keypress":if(yp(t)===0)break e;case"keydown":case"keyup":p=M4;break;case"focusin":y="focus",p=Qy;break;case"focusout":y="blur",p=Qy;break;case"beforeblur":case"afterblur":p=Qy;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=vS;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=E4;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=V4;break;case yP:case vP:case wP:p=k4;break;case _P:p=$4;break;case"scroll":p=b4;break;case"wheel":p=z4;break;case"copy":case"cut":case"paste":p=P4;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=_S}var m=(e&4)!==0,v=!m&&n==="scroll",w=m?f!==null?f+"Capture":null:f;m=[];for(var _=c,x;_!==null;){x=_;var A=x.stateNode;if(x.tag===5&&A!==null&&(x=A,w!==null&&(A=mh(_,w),A!=null&&m.push(Sh(_,A,x)))),v)break;_=_.return}0<m.length&&(f=new p(f,y,null,t,u),h.push({event:f,listeners:m}))}}if(!(e&7)){e:{if(f=n==="mouseover"||n==="pointerover",p=n==="mouseout"||n==="pointerout",f&&t!==T0&&(y=t.relatedTarget||t.fromElement)&&(la(y)||y[ri]))break e;if((p||f)&&(f=u.window===u?u:(f=u.ownerDocument)?f.defaultView||f.parentWindow:window,p?(y=t.relatedTarget||t.toElement,p=c,y=y?la(y):null,y!==null&&(v=Ha(y),y!==v||y.tag!==5&&y.tag!==6)&&(y=null)):(p=null,y=c),p!==y)){if(m=vS,A="onMouseLeave",w="onMouseEnter",_="mouse",(n==="pointerout"||n==="pointerover")&&(m=_S,A="onPointerLeave",w="onPointerEnter",_="pointer"),v=p==null?f:Al(p),x=y==null?f:Al(y),f=new m(A,_+"leave",p,t,u),f.target=v,f.relatedTarget=x,A=null,la(u)===c&&(m=new m(w,_+"enter",y,t,u),m.target=x,m.relatedTarget=v,A=m),v=A,p&&y)t:{for(m=p,w=y,_=0,x=m;x;x=sl(x))_++;for(x=0,A=w;A;A=sl(A))x++;for(;0<_-x;)m=sl(m),_--;for(;0<x-_;)w=sl(w),x--;for(;_--;){if(m===w||w!==null&&m===w.alternate)break t;m=sl(m),w=sl(w)}m=null}else m=null;p!==null&&RS(h,f,p,m,!1),y!==null&&v!==null&&RS(h,v,y,m,!0)}}e:{if(f=c?Al(c):window,p=f.nodeName&&f.nodeName.toLowerCase(),p==="select"||p==="input"&&f.type==="file")var j=X4;else if(SS(f))if(dP)j=eF;else{j=J4;var N=Q4}else(p=f.nodeName)&&p.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(j=Z4);if(j&&(j=j(n,c))){hP(h,j,t,u);break e}N&&N(n,f,c),n==="focusout"&&(N=f._wrapperState)&&N.controlled&&f.type==="number"&&_0(f,"number",f.value)}switch(N=c?Al(c):window,n){case"focusin":(SS(N)||N.contentEditable==="true")&&(Cl=N,O0=c,Xu=null);break;case"focusout":Xu=O0=Cl=null;break;case"mousedown":N0=!0;break;case"contextmenu":case"mouseup":case"dragend":N0=!1,AS(h,t,u);break;case"selectionchange":if(rF)break;case"keydown":case"keyup":AS(h,t,u)}var S;if(J_)e:{switch(n){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else Tl?cP(n,t)&&(T="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(T="onCompositionStart");T&&(lP&&t.locale!=="ko"&&(Tl||T!=="onCompositionStart"?T==="onCompositionEnd"&&Tl&&(S=aP()):(eo=u,Y_="value"in eo?eo.value:eo.textContent,Tl=!0)),N=Jp(c,T),0<N.length&&(T=new wS(T,n,null,t,u),h.push({event:T,listeners:N}),S?T.data=S:(S=uP(t),S!==null&&(T.data=S)))),(S=H4?q4(n,t):G4(n,t))&&(c=Jp(c,"onBeforeInput"),0<c.length&&(u=new wS("onBeforeInput","beforeinput",null,t,u),h.push({event:u,listeners:c}),u.data=S))}bP(h,e)})}function Sh(n,e,t){return{instance:n,listener:e,currentTarget:t}}function Jp(n,e){for(var t=e+"Capture",r=[];n!==null;){var s=n,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=mh(n,t),i!=null&&r.unshift(Sh(n,i,s)),i=mh(n,e),i!=null&&r.push(Sh(n,i,s))),n=n.return}return r}function sl(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function RS(n,e,t,r,s){for(var i=e._reactName,o=[];t!==null&&t!==r;){var a=t,l=a.alternate,c=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&c!==null&&(a=c,s?(l=mh(t,i),l!=null&&o.unshift(Sh(t,l,a))):s||(l=mh(t,i),l!=null&&o.push(Sh(t,l,a)))),t=t.return}o.length!==0&&n.push({event:e,listeners:o})}var aF=/\r\n?/g,lF=/\u0000|\uFFFD/g;function OS(n){return(typeof n=="string"?n:""+n).replace(aF,`
`).replace(lF,"")}function cf(n,e,t){if(e=OS(e),OS(n)!==e&&t)throw Error(X(425))}function Zp(){}var j0=null,D0=null;function M0(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var L0=typeof setTimeout=="function"?setTimeout:void 0,cF=typeof clearTimeout=="function"?clearTimeout:void 0,NS=typeof Promise=="function"?Promise:void 0,uF=typeof queueMicrotask=="function"?queueMicrotask:typeof NS<"u"?function(n){return NS.resolve(null).then(n).catch(hF)}:L0;function hF(n){setTimeout(function(){throw n})}function iv(n,e){var t=e,r=0;do{var s=t.nextSibling;if(n.removeChild(t),s&&s.nodeType===8)if(t=s.data,t==="/$"){if(r===0){n.removeChild(s),wh(e);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=s}while(t);wh(e)}function lo(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function jS(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var Mc=Math.random().toString(36).slice(2),fs="__reactFiber$"+Mc,Eh="__reactProps$"+Mc,ri="__reactContainer$"+Mc,F0="__reactEvents$"+Mc,dF="__reactListeners$"+Mc,fF="__reactHandles$"+Mc;function la(n){var e=n[fs];if(e)return e;for(var t=n.parentNode;t;){if(e=t[ri]||t[fs]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=jS(n);n!==null;){if(t=n[fs])return t;n=jS(n)}return e}n=t,t=n.parentNode}return null}function ud(n){return n=n[fs]||n[ri],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function Al(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(X(33))}function dm(n){return n[Eh]||null}var V0=[],Pl=-1;function Oo(n){return{current:n}}function rt(n){0>Pl||(n.current=V0[Pl],V0[Pl]=null,Pl--)}function Je(n,e){Pl++,V0[Pl]=n.current,n.current=e}var _o={},un=Oo(_o),Nn=Oo(!1),Aa=_o;function fc(n,e){var t=n.type.contextTypes;if(!t)return _o;var r=n.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in t)s[i]=e[i];return r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=s),s}function jn(n){return n=n.childContextTypes,n!=null}function eg(){rt(Nn),rt(un)}function DS(n,e,t){if(un.current!==_o)throw Error(X(168));Je(un,e),Je(Nn,t)}function EP(n,e,t){var r=n.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(X(108,QL(n)||"Unknown",s));return dt({},t,r)}function tg(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||_o,Aa=un.current,Je(un,n),Je(Nn,Nn.current),!0}function MS(n,e,t){var r=n.stateNode;if(!r)throw Error(X(169));t?(n=EP(n,e,Aa),r.__reactInternalMemoizedMergedChildContext=n,rt(Nn),rt(un),Je(un,n)):rt(Nn),Je(Nn,t)}var Us=null,fm=!1,ov=!1;function TP(n){Us===null?Us=[n]:Us.push(n)}function pF(n){fm=!0,TP(n)}function No(){if(!ov&&Us!==null){ov=!0;var n=0,e=He;try{var t=Us;for(He=1;n<t.length;n++){var r=t[n];do r=r(!0);while(r!==null)}Us=null,fm=!1}catch(s){throw Us!==null&&(Us=Us.slice(n+1)),XA(H_,No),s}finally{He=e,ov=!1}}return null}var Il=[],Rl=0,ng=null,rg=0,ar=[],lr=0,Pa=null,Hs=1,qs="";function Zo(n,e){Il[Rl++]=rg,Il[Rl++]=ng,ng=n,rg=e}function CP(n,e,t){ar[lr++]=Hs,ar[lr++]=qs,ar[lr++]=Pa,Pa=n;var r=Hs;n=qs;var s=32-Wr(r)-1;r&=~(1<<s),t+=1;var i=32-Wr(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,Hs=1<<32-Wr(e)+s|t<<s|r,qs=i+n}else Hs=1<<i|t<<s|r,qs=n}function ex(n){n.return!==null&&(Zo(n,1),CP(n,1,0))}function tx(n){for(;n===ng;)ng=Il[--Rl],Il[Rl]=null,rg=Il[--Rl],Il[Rl]=null;for(;n===Pa;)Pa=ar[--lr],ar[lr]=null,qs=ar[--lr],ar[lr]=null,Hs=ar[--lr],ar[lr]=null}var Jn=null,Yn=null,it=!1,Fr=null;function kP(n,e){var t=fr(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function LS(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,Jn=n,Yn=lo(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,Jn=n,Yn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=Pa!==null?{id:Hs,overflow:qs}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=fr(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,Jn=n,Yn=null,!0):!1;default:return!1}}function U0(n){return(n.mode&1)!==0&&(n.flags&128)===0}function $0(n){if(it){var e=Yn;if(e){var t=e;if(!LS(n,e)){if(U0(n))throw Error(X(418));e=lo(t.nextSibling);var r=Jn;e&&LS(n,e)?kP(r,t):(n.flags=n.flags&-4097|2,it=!1,Jn=n)}}else{if(U0(n))throw Error(X(418));n.flags=n.flags&-4097|2,it=!1,Jn=n}}}function FS(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Jn=n}function uf(n){if(n!==Jn)return!1;if(!it)return FS(n),it=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!M0(n.type,n.memoizedProps)),e&&(e=Yn)){if(U0(n))throw AP(),Error(X(418));for(;e;)kP(n,e),e=lo(e.nextSibling)}if(FS(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(X(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){Yn=lo(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}Yn=null}}else Yn=Jn?lo(n.stateNode.nextSibling):null;return!0}function AP(){for(var n=Yn;n;)n=lo(n.nextSibling)}function pc(){Yn=Jn=null,it=!1}function nx(n){Fr===null?Fr=[n]:Fr.push(n)}var gF=mi.ReactCurrentBatchConfig;function Cu(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(X(309));var r=t.stateNode}if(!r)throw Error(X(147,n));var s=r,i=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof n!="string")throw Error(X(284));if(!t._owner)throw Error(X(290,n))}return n}function hf(n,e){throw n=Object.prototype.toString.call(e),Error(X(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function VS(n){var e=n._init;return e(n._payload)}function PP(n){function e(w,_){if(n){var x=w.deletions;x===null?(w.deletions=[_],w.flags|=16):x.push(_)}}function t(w,_){if(!n)return null;for(;_!==null;)e(w,_),_=_.sibling;return null}function r(w,_){for(w=new Map;_!==null;)_.key!==null?w.set(_.key,_):w.set(_.index,_),_=_.sibling;return w}function s(w,_){return w=fo(w,_),w.index=0,w.sibling=null,w}function i(w,_,x){return w.index=x,n?(x=w.alternate,x!==null?(x=x.index,x<_?(w.flags|=2,_):x):(w.flags|=2,_)):(w.flags|=1048576,_)}function o(w){return n&&w.alternate===null&&(w.flags|=2),w}function a(w,_,x,A){return _===null||_.tag!==6?(_=fv(x,w.mode,A),_.return=w,_):(_=s(_,x),_.return=w,_)}function l(w,_,x,A){var j=x.type;return j===El?u(w,_,x.props.children,A,x.key):_!==null&&(_.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===Fi&&VS(j)===_.type)?(A=s(_,x.props),A.ref=Cu(w,_,x),A.return=w,A):(A=Ep(x.type,x.key,x.props,null,w.mode,A),A.ref=Cu(w,_,x),A.return=w,A)}function c(w,_,x,A){return _===null||_.tag!==4||_.stateNode.containerInfo!==x.containerInfo||_.stateNode.implementation!==x.implementation?(_=pv(x,w.mode,A),_.return=w,_):(_=s(_,x.children||[]),_.return=w,_)}function u(w,_,x,A,j){return _===null||_.tag!==7?(_=ba(x,w.mode,A,j),_.return=w,_):(_=s(_,x),_.return=w,_)}function h(w,_,x){if(typeof _=="string"&&_!==""||typeof _=="number")return _=fv(""+_,w.mode,x),_.return=w,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Zd:return x=Ep(_.type,_.key,_.props,null,w.mode,x),x.ref=Cu(w,null,_),x.return=w,x;case Sl:return _=pv(_,w.mode,x),_.return=w,_;case Fi:var A=_._init;return h(w,A(_._payload),x)}if(ju(_)||xu(_))return _=ba(_,w.mode,x,null),_.return=w,_;hf(w,_)}return null}function f(w,_,x,A){var j=_!==null?_.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return j!==null?null:a(w,_,""+x,A);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Zd:return x.key===j?l(w,_,x,A):null;case Sl:return x.key===j?c(w,_,x,A):null;case Fi:return j=x._init,f(w,_,j(x._payload),A)}if(ju(x)||xu(x))return j!==null?null:u(w,_,x,A,null);hf(w,x)}return null}function p(w,_,x,A,j){if(typeof A=="string"&&A!==""||typeof A=="number")return w=w.get(x)||null,a(_,w,""+A,j);if(typeof A=="object"&&A!==null){switch(A.$$typeof){case Zd:return w=w.get(A.key===null?x:A.key)||null,l(_,w,A,j);case Sl:return w=w.get(A.key===null?x:A.key)||null,c(_,w,A,j);case Fi:var N=A._init;return p(w,_,x,N(A._payload),j)}if(ju(A)||xu(A))return w=w.get(x)||null,u(_,w,A,j,null);hf(_,A)}return null}function y(w,_,x,A){for(var j=null,N=null,S=_,T=_=0,P=null;S!==null&&T<x.length;T++){S.index>T?(P=S,S=null):P=S.sibling;var R=f(w,S,x[T],A);if(R===null){S===null&&(S=P);break}n&&S&&R.alternate===null&&e(w,S),_=i(R,_,T),N===null?j=R:N.sibling=R,N=R,S=P}if(T===x.length)return t(w,S),it&&Zo(w,T),j;if(S===null){for(;T<x.length;T++)S=h(w,x[T],A),S!==null&&(_=i(S,_,T),N===null?j=S:N.sibling=S,N=S);return it&&Zo(w,T),j}for(S=r(w,S);T<x.length;T++)P=p(S,w,T,x[T],A),P!==null&&(n&&P.alternate!==null&&S.delete(P.key===null?T:P.key),_=i(P,_,T),N===null?j=P:N.sibling=P,N=P);return n&&S.forEach(function(D){return e(w,D)}),it&&Zo(w,T),j}function m(w,_,x,A){var j=xu(x);if(typeof j!="function")throw Error(X(150));if(x=j.call(x),x==null)throw Error(X(151));for(var N=j=null,S=_,T=_=0,P=null,R=x.next();S!==null&&!R.done;T++,R=x.next()){S.index>T?(P=S,S=null):P=S.sibling;var D=f(w,S,R.value,A);if(D===null){S===null&&(S=P);break}n&&S&&D.alternate===null&&e(w,S),_=i(D,_,T),N===null?j=D:N.sibling=D,N=D,S=P}if(R.done)return t(w,S),it&&Zo(w,T),j;if(S===null){for(;!R.done;T++,R=x.next())R=h(w,R.value,A),R!==null&&(_=i(R,_,T),N===null?j=R:N.sibling=R,N=R);return it&&Zo(w,T),j}for(S=r(w,S);!R.done;T++,R=x.next())R=p(S,w,T,R.value,A),R!==null&&(n&&R.alternate!==null&&S.delete(R.key===null?T:R.key),_=i(R,_,T),N===null?j=R:N.sibling=R,N=R);return n&&S.forEach(function(I){return e(w,I)}),it&&Zo(w,T),j}function v(w,_,x,A){if(typeof x=="object"&&x!==null&&x.type===El&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case Zd:e:{for(var j=x.key,N=_;N!==null;){if(N.key===j){if(j=x.type,j===El){if(N.tag===7){t(w,N.sibling),_=s(N,x.props.children),_.return=w,w=_;break e}}else if(N.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===Fi&&VS(j)===N.type){t(w,N.sibling),_=s(N,x.props),_.ref=Cu(w,N,x),_.return=w,w=_;break e}t(w,N);break}else e(w,N);N=N.sibling}x.type===El?(_=ba(x.props.children,w.mode,A,x.key),_.return=w,w=_):(A=Ep(x.type,x.key,x.props,null,w.mode,A),A.ref=Cu(w,_,x),A.return=w,w=A)}return o(w);case Sl:e:{for(N=x.key;_!==null;){if(_.key===N)if(_.tag===4&&_.stateNode.containerInfo===x.containerInfo&&_.stateNode.implementation===x.implementation){t(w,_.sibling),_=s(_,x.children||[]),_.return=w,w=_;break e}else{t(w,_);break}else e(w,_);_=_.sibling}_=pv(x,w.mode,A),_.return=w,w=_}return o(w);case Fi:return N=x._init,v(w,_,N(x._payload),A)}if(ju(x))return y(w,_,x,A);if(xu(x))return m(w,_,x,A);hf(w,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,_!==null&&_.tag===6?(t(w,_.sibling),_=s(_,x),_.return=w,w=_):(t(w,_),_=fv(x,w.mode,A),_.return=w,w=_),o(w)):t(w,_)}return v}var gc=PP(!0),IP=PP(!1),sg=Oo(null),ig=null,Ol=null,rx=null;function sx(){rx=Ol=ig=null}function ix(n){var e=sg.current;rt(sg),n._currentValue=e}function B0(n,e,t){for(;n!==null;){var r=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),n===t)break;n=n.return}}function Wl(n,e){ig=n,rx=Ol=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(On=!0),n.firstContext=null)}function mr(n){var e=n._currentValue;if(rx!==n)if(n={context:n,memoizedValue:e,next:null},Ol===null){if(ig===null)throw Error(X(308));Ol=n,ig.dependencies={lanes:0,firstContext:n}}else Ol=Ol.next=n;return e}var ca=null;function ox(n){ca===null?ca=[n]:ca.push(n)}function RP(n,e,t,r){var s=e.interleaved;return s===null?(t.next=t,ox(e)):(t.next=s.next,s.next=t),e.interleaved=t,si(n,r)}function si(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var Vi=!1;function ax(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function OP(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Qs(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function co(n,e,t){var r=n.updateQueue;if(r===null)return null;if(r=r.shared,Me&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,si(n,t)}return s=r.interleaved,s===null?(e.next=e,ox(r)):(e.next=s.next,s.next=e),r.interleaved=e,si(n,t)}function vp(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,q_(n,t)}}function US(n,e){var t=n.updateQueue,r=n.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var s=null,i=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};i===null?s=i=o:i=i.next=o,t=t.next}while(t!==null);i===null?s=i=e:i=i.next=e}else s=i=e;t={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function og(n,e,t,r){var s=n.updateQueue;Vi=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?i=c:o.next=c,o=l;var u=n.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(i!==null){var h=s.baseState;o=0,u=c=l=null,a=i;do{var f=a.lane,p=a.eventTime;if((r&f)===f){u!==null&&(u=u.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var y=n,m=a;switch(f=e,p=t,m.tag){case 1:if(y=m.payload,typeof y=="function"){h=y.call(p,h,f);break e}h=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=m.payload,f=typeof y=="function"?y.call(p,h,f):y,f==null)break e;h=dt({},h,f);break e;case 2:Vi=!0}}a.callback!==null&&a.lane!==0&&(n.flags|=64,f=s.effects,f===null?s.effects=[a]:f.push(a))}else p={eventTime:p,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=p,l=h):u=u.next=p,o|=f;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;f=a,a=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(!0);if(u===null&&(l=h),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=u,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Ra|=o,n.lanes=o,n.memoizedState=h}}function $S(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var r=n[e],s=r.callback;if(s!==null){if(r.callback=null,r=t,typeof s!="function")throw Error(X(191,s));s.call(r)}}}var hd={},vs=Oo(hd),Th=Oo(hd),Ch=Oo(hd);function ua(n){if(n===hd)throw Error(X(174));return n}function lx(n,e){switch(Je(Ch,e),Je(Th,n),Je(vs,hd),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:b0(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=b0(e,n)}rt(vs),Je(vs,e)}function mc(){rt(vs),rt(Th),rt(Ch)}function NP(n){ua(Ch.current);var e=ua(vs.current),t=b0(e,n.type);e!==t&&(Je(Th,n),Je(vs,t))}function cx(n){Th.current===n&&(rt(vs),rt(Th))}var ut=Oo(0);function ag(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var av=[];function ux(){for(var n=0;n<av.length;n++)av[n]._workInProgressVersionPrimary=null;av.length=0}var wp=mi.ReactCurrentDispatcher,lv=mi.ReactCurrentBatchConfig,Ia=0,ht=null,Nt=null,Bt=null,lg=!1,Qu=!1,kh=0,mF=0;function tn(){throw Error(X(321))}function hx(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!Gr(n[t],e[t]))return!1;return!0}function dx(n,e,t,r,s,i){if(Ia=i,ht=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,wp.current=n===null||n.memoizedState===null?_F:xF,n=t(r,s),Qu){i=0;do{if(Qu=!1,kh=0,25<=i)throw Error(X(301));i+=1,Bt=Nt=null,e.updateQueue=null,wp.current=bF,n=t(r,s)}while(Qu)}if(wp.current=cg,e=Nt!==null&&Nt.next!==null,Ia=0,Bt=Nt=ht=null,lg=!1,e)throw Error(X(300));return n}function fx(){var n=kh!==0;return kh=0,n}function as(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Bt===null?ht.memoizedState=Bt=n:Bt=Bt.next=n,Bt}function yr(){if(Nt===null){var n=ht.alternate;n=n!==null?n.memoizedState:null}else n=Nt.next;var e=Bt===null?ht.memoizedState:Bt.next;if(e!==null)Bt=e,Nt=n;else{if(n===null)throw Error(X(310));Nt=n,n={memoizedState:Nt.memoizedState,baseState:Nt.baseState,baseQueue:Nt.baseQueue,queue:Nt.queue,next:null},Bt===null?ht.memoizedState=Bt=n:Bt=Bt.next=n}return Bt}function Ah(n,e){return typeof e=="function"?e(n):e}function cv(n){var e=yr(),t=e.queue;if(t===null)throw Error(X(311));t.lastRenderedReducer=n;var r=Nt,s=r.baseQueue,i=t.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,t.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=o=null,l=null,c=i;do{var u=c.lane;if((Ia&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:n(r,c.action);else{var h={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=h,o=r):l=l.next=h,ht.lanes|=u,Ra|=u}c=c.next}while(c!==null&&c!==i);l===null?o=r:l.next=a,Gr(r,e.memoizedState)||(On=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,t.lastRenderedState=r}if(n=t.interleaved,n!==null){s=n;do i=s.lane,ht.lanes|=i,Ra|=i,s=s.next;while(s!==n)}else s===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function uv(n){var e=yr(),t=e.queue;if(t===null)throw Error(X(311));t.lastRenderedReducer=n;var r=t.dispatch,s=t.pending,i=e.memoizedState;if(s!==null){t.pending=null;var o=s=s.next;do i=n(i,o.action),o=o.next;while(o!==s);Gr(i,e.memoizedState)||(On=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),t.lastRenderedState=i}return[i,r]}function jP(){}function DP(n,e){var t=ht,r=yr(),s=e(),i=!Gr(r.memoizedState,s);if(i&&(r.memoizedState=s,On=!0),r=r.queue,px(FP.bind(null,t,r,n),[n]),r.getSnapshot!==e||i||Bt!==null&&Bt.memoizedState.tag&1){if(t.flags|=2048,Ph(9,LP.bind(null,t,r,s,e),void 0,null),zt===null)throw Error(X(349));Ia&30||MP(t,e,s)}return s}function MP(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=ht.updateQueue,e===null?(e={lastEffect:null,stores:null},ht.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function LP(n,e,t,r){e.value=t,e.getSnapshot=r,VP(e)&&UP(n)}function FP(n,e,t){return t(function(){VP(e)&&UP(n)})}function VP(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!Gr(n,t)}catch{return!0}}function UP(n){var e=si(n,1);e!==null&&Hr(e,n,1,-1)}function BS(n){var e=as();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ah,lastRenderedState:n},e.queue=n,n=n.dispatch=wF.bind(null,ht,n),[e.memoizedState,n]}function Ph(n,e,t,r){return n={tag:n,create:e,destroy:t,deps:r,next:null},e=ht.updateQueue,e===null?(e={lastEffect:null,stores:null},ht.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(r=t.next,t.next=n,n.next=r,e.lastEffect=n)),n}function $P(){return yr().memoizedState}function _p(n,e,t,r){var s=as();ht.flags|=n,s.memoizedState=Ph(1|e,t,void 0,r===void 0?null:r)}function pm(n,e,t,r){var s=yr();r=r===void 0?null:r;var i=void 0;if(Nt!==null){var o=Nt.memoizedState;if(i=o.destroy,r!==null&&hx(r,o.deps)){s.memoizedState=Ph(e,t,i,r);return}}ht.flags|=n,s.memoizedState=Ph(1|e,t,i,r)}function zS(n,e){return _p(8390656,8,n,e)}function px(n,e){return pm(2048,8,n,e)}function BP(n,e){return pm(4,2,n,e)}function zP(n,e){return pm(4,4,n,e)}function WP(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function HP(n,e,t){return t=t!=null?t.concat([n]):null,pm(4,4,WP.bind(null,e,n),t)}function gx(){}function qP(n,e){var t=yr();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&hx(e,r[1])?r[0]:(t.memoizedState=[n,e],n)}function GP(n,e){var t=yr();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&hx(e,r[1])?r[0]:(n=n(),t.memoizedState=[n,e],n)}function KP(n,e,t){return Ia&21?(Gr(t,e)||(t=ZA(),ht.lanes|=t,Ra|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,On=!0),n.memoizedState=t)}function yF(n,e){var t=He;He=t!==0&&4>t?t:4,n(!0);var r=lv.transition;lv.transition={};try{n(!1),e()}finally{He=t,lv.transition=r}}function YP(){return yr().memoizedState}function vF(n,e,t){var r=ho(n);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},XP(n))QP(e,t);else if(t=RP(n,e,t,r),t!==null){var s=xn();Hr(t,n,r,s),JP(t,e,r)}}function wF(n,e,t){var r=ho(n),s={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(XP(n))QP(e,s);else{var i=n.alternate;if(n.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,t);if(s.hasEagerState=!0,s.eagerState=a,Gr(a,o)){var l=e.interleaved;l===null?(s.next=s,ox(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}t=RP(n,e,s,r),t!==null&&(s=xn(),Hr(t,n,r,s),JP(t,e,r))}}function XP(n){var e=n.alternate;return n===ht||e!==null&&e===ht}function QP(n,e){Qu=lg=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function JP(n,e,t){if(t&4194240){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,q_(n,t)}}var cg={readContext:mr,useCallback:tn,useContext:tn,useEffect:tn,useImperativeHandle:tn,useInsertionEffect:tn,useLayoutEffect:tn,useMemo:tn,useReducer:tn,useRef:tn,useState:tn,useDebugValue:tn,useDeferredValue:tn,useTransition:tn,useMutableSource:tn,useSyncExternalStore:tn,useId:tn,unstable_isNewReconciler:!1},_F={readContext:mr,useCallback:function(n,e){return as().memoizedState=[n,e===void 0?null:e],n},useContext:mr,useEffect:zS,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,_p(4194308,4,WP.bind(null,e,n),t)},useLayoutEffect:function(n,e){return _p(4194308,4,n,e)},useInsertionEffect:function(n,e){return _p(4,2,n,e)},useMemo:function(n,e){var t=as();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var r=as();return e=t!==void 0?t(e):e,r.memoizedState=r.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},r.queue=n,n=n.dispatch=vF.bind(null,ht,n),[r.memoizedState,n]},useRef:function(n){var e=as();return n={current:n},e.memoizedState=n},useState:BS,useDebugValue:gx,useDeferredValue:function(n){return as().memoizedState=n},useTransition:function(){var n=BS(!1),e=n[0];return n=yF.bind(null,n[1]),as().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var r=ht,s=as();if(it){if(t===void 0)throw Error(X(407));t=t()}else{if(t=e(),zt===null)throw Error(X(349));Ia&30||MP(r,e,t)}s.memoizedState=t;var i={value:t,getSnapshot:e};return s.queue=i,zS(FP.bind(null,r,i,n),[n]),r.flags|=2048,Ph(9,LP.bind(null,r,i,t,e),void 0,null),t},useId:function(){var n=as(),e=zt.identifierPrefix;if(it){var t=qs,r=Hs;t=(r&~(1<<32-Wr(r)-1)).toString(32)+t,e=":"+e+"R"+t,t=kh++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=mF++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},xF={readContext:mr,useCallback:qP,useContext:mr,useEffect:px,useImperativeHandle:HP,useInsertionEffect:BP,useLayoutEffect:zP,useMemo:GP,useReducer:cv,useRef:$P,useState:function(){return cv(Ah)},useDebugValue:gx,useDeferredValue:function(n){var e=yr();return KP(e,Nt.memoizedState,n)},useTransition:function(){var n=cv(Ah)[0],e=yr().memoizedState;return[n,e]},useMutableSource:jP,useSyncExternalStore:DP,useId:YP,unstable_isNewReconciler:!1},bF={readContext:mr,useCallback:qP,useContext:mr,useEffect:px,useImperativeHandle:HP,useInsertionEffect:BP,useLayoutEffect:zP,useMemo:GP,useReducer:uv,useRef:$P,useState:function(){return uv(Ah)},useDebugValue:gx,useDeferredValue:function(n){var e=yr();return Nt===null?e.memoizedState=n:KP(e,Nt.memoizedState,n)},useTransition:function(){var n=uv(Ah)[0],e=yr().memoizedState;return[n,e]},useMutableSource:jP,useSyncExternalStore:DP,useId:YP,unstable_isNewReconciler:!1};function Ir(n,e){if(n&&n.defaultProps){e=dt({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function z0(n,e,t,r){e=n.memoizedState,t=t(r,e),t=t==null?e:dt({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var gm={isMounted:function(n){return(n=n._reactInternals)?Ha(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var r=xn(),s=ho(n),i=Qs(r,s);i.payload=e,t!=null&&(i.callback=t),e=co(n,i,s),e!==null&&(Hr(e,n,s,r),vp(e,n,s))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var r=xn(),s=ho(n),i=Qs(r,s);i.tag=1,i.payload=e,t!=null&&(i.callback=t),e=co(n,i,s),e!==null&&(Hr(e,n,s,r),vp(e,n,s))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=xn(),r=ho(n),s=Qs(t,r);s.tag=2,e!=null&&(s.callback=e),e=co(n,s,r),e!==null&&(Hr(e,n,r,t),vp(e,n,r))}};function WS(n,e,t,r,s,i,o){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!xh(t,r)||!xh(s,i):!0}function ZP(n,e,t){var r=!1,s=_o,i=e.contextType;return typeof i=="object"&&i!==null?i=mr(i):(s=jn(e)?Aa:un.current,r=e.contextTypes,i=(r=r!=null)?fc(n,s):_o),e=new e(t,i),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=gm,n.stateNode=e,e._reactInternals=n,r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=s,n.__reactInternalMemoizedMaskedChildContext=i),e}function HS(n,e,t,r){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,r),e.state!==n&&gm.enqueueReplaceState(e,e.state,null)}function W0(n,e,t,r){var s=n.stateNode;s.props=t,s.state=n.memoizedState,s.refs={},ax(n);var i=e.contextType;typeof i=="object"&&i!==null?s.context=mr(i):(i=jn(e)?Aa:un.current,s.context=fc(n,i)),s.state=n.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(z0(n,e,i,t),s.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&gm.enqueueReplaceState(s,s.state,null),og(n,t,s,r),s.state=n.memoizedState),typeof s.componentDidMount=="function"&&(n.flags|=4194308)}function yc(n,e){try{var t="",r=e;do t+=XL(r),r=r.return;while(r);var s=t}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:n,source:e,stack:s,digest:null}}function hv(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function H0(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var SF=typeof WeakMap=="function"?WeakMap:Map;function eI(n,e,t){t=Qs(-1,t),t.tag=3,t.payload={element:null};var r=e.value;return t.callback=function(){hg||(hg=!0,tw=r),H0(n,e)},t}function tI(n,e,t){t=Qs(-1,t),t.tag=3;var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;t.payload=function(){return r(s)},t.callback=function(){H0(n,e)}}var i=n.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(t.callback=function(){H0(n,e),typeof r!="function"&&(uo===null?uo=new Set([this]):uo.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function qS(n,e,t){var r=n.pingCache;if(r===null){r=n.pingCache=new SF;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(t)||(s.add(t),n=LF.bind(null,n,e,t),e.then(n,n))}function GS(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function KS(n,e,t,r,s){return n.mode&1?(n.flags|=65536,n.lanes=s,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Qs(-1,1),e.tag=2,co(t,e,1))),t.lanes|=1),n)}var EF=mi.ReactCurrentOwner,On=!1;function gn(n,e,t,r){e.child=n===null?IP(e,null,t,r):gc(e,n.child,t,r)}function YS(n,e,t,r,s){t=t.render;var i=e.ref;return Wl(e,s),r=dx(n,e,t,r,i,s),t=fx(),n!==null&&!On?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~s,ii(n,e,s)):(it&&t&&ex(e),e.flags|=1,gn(n,e,r,s),e.child)}function XS(n,e,t,r,s){if(n===null){var i=t.type;return typeof i=="function"&&!Sx(i)&&i.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=i,nI(n,e,i,r,s)):(n=Ep(t.type,null,r,e,e.mode,s),n.ref=e.ref,n.return=e,e.child=n)}if(i=n.child,!(n.lanes&s)){var o=i.memoizedProps;if(t=t.compare,t=t!==null?t:xh,t(o,r)&&n.ref===e.ref)return ii(n,e,s)}return e.flags|=1,n=fo(i,r),n.ref=e.ref,n.return=e,e.child=n}function nI(n,e,t,r,s){if(n!==null){var i=n.memoizedProps;if(xh(i,r)&&n.ref===e.ref)if(On=!1,e.pendingProps=r=i,(n.lanes&s)!==0)n.flags&131072&&(On=!0);else return e.lanes=n.lanes,ii(n,e,s)}return q0(n,e,t,r,s)}function rI(n,e,t){var r=e.pendingProps,s=r.children,i=n!==null?n.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Je(jl,Wn),Wn|=t;else{if(!(t&1073741824))return n=i!==null?i.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,Je(jl,Wn),Wn|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:t,Je(jl,Wn),Wn|=r}else i!==null?(r=i.baseLanes|t,e.memoizedState=null):r=t,Je(jl,Wn),Wn|=r;return gn(n,e,s,t),e.child}function sI(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function q0(n,e,t,r,s){var i=jn(t)?Aa:un.current;return i=fc(e,i),Wl(e,s),t=dx(n,e,t,r,i,s),r=fx(),n!==null&&!On?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~s,ii(n,e,s)):(it&&r&&ex(e),e.flags|=1,gn(n,e,t,s),e.child)}function QS(n,e,t,r,s){if(jn(t)){var i=!0;tg(e)}else i=!1;if(Wl(e,s),e.stateNode===null)xp(n,e),ZP(e,t,r),W0(e,t,r,s),r=!0;else if(n===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=t.contextType;typeof c=="object"&&c!==null?c=mr(c):(c=jn(t)?Aa:un.current,c=fc(e,c));var u=t.getDerivedStateFromProps,h=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==c)&&HS(e,o,r,c),Vi=!1;var f=e.memoizedState;o.state=f,og(e,r,o,s),l=e.memoizedState,a!==r||f!==l||Nn.current||Vi?(typeof u=="function"&&(z0(e,t,u,r),l=e.memoizedState),(a=Vi||WS(e,t,a,r,f,l,c))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=c,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,OP(n,e),a=e.memoizedProps,c=e.type===e.elementType?a:Ir(e.type,a),o.props=c,h=e.pendingProps,f=o.context,l=t.contextType,typeof l=="object"&&l!==null?l=mr(l):(l=jn(t)?Aa:un.current,l=fc(e,l));var p=t.getDerivedStateFromProps;(u=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||f!==l)&&HS(e,o,r,l),Vi=!1,f=e.memoizedState,o.state=f,og(e,r,o,s);var y=e.memoizedState;a!==h||f!==y||Nn.current||Vi?(typeof p=="function"&&(z0(e,t,p,r),y=e.memoizedState),(c=Vi||WS(e,t,c,r,f,y,l)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,y,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,y,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&f===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&f===n.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=y),o.props=r,o.state=y,o.context=l,r=c):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&f===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&f===n.memoizedState||(e.flags|=1024),r=!1)}return G0(n,e,t,r,i,s)}function G0(n,e,t,r,s,i){sI(n,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&MS(e,t,!1),ii(n,e,i);r=e.stateNode,EF.current=e;var a=o&&typeof t.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,n!==null&&o?(e.child=gc(e,n.child,null,i),e.child=gc(e,null,a,i)):gn(n,e,a,i),e.memoizedState=r.state,s&&MS(e,t,!0),e.child}function iI(n){var e=n.stateNode;e.pendingContext?DS(n,e.pendingContext,e.pendingContext!==e.context):e.context&&DS(n,e.context,!1),lx(n,e.containerInfo)}function JS(n,e,t,r,s){return pc(),nx(s),e.flags|=256,gn(n,e,t,r),e.child}var K0={dehydrated:null,treeContext:null,retryLane:0};function Y0(n){return{baseLanes:n,cachePool:null,transitions:null}}function oI(n,e,t){var r=e.pendingProps,s=ut.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=n!==null&&n.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(s|=1),Je(ut,s&1),n===null)return $0(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,n=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=vm(o,r,0,null),n=ba(n,r,t,null),i.return=e,n.return=e,i.sibling=n,e.child=i,e.child.memoizedState=Y0(t),e.memoizedState=K0,n):mx(e,o));if(s=n.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return TF(n,e,o,r,a,s,t);if(i){i=r.fallback,o=e.mode,s=n.child,a=s.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=fo(s,l),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=fo(a,i):(i=ba(i,o,t,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=n.child.memoizedState,o=o===null?Y0(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=n.childLanes&~t,e.memoizedState=K0,r}return i=n.child,n=i.sibling,r=fo(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=t),r.return=e,r.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=r,e.memoizedState=null,r}function mx(n,e){return e=vm({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function df(n,e,t,r){return r!==null&&nx(r),gc(e,n.child,null,t),n=mx(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function TF(n,e,t,r,s,i,o){if(t)return e.flags&256?(e.flags&=-257,r=hv(Error(X(422))),df(n,e,o,r)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=vm({mode:"visible",children:r.children},s,0,null),i=ba(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&gc(e,n.child,null,o),e.child.memoizedState=Y0(o),e.memoizedState=K0,i);if(!(e.mode&1))return df(n,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error(X(419)),r=hv(i,r,void 0),df(n,e,o,r)}if(a=(o&n.childLanes)!==0,On||a){if(r=zt,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,si(n,s),Hr(r,n,s,-1))}return bx(),r=hv(Error(X(421))),df(n,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=n.child,e=FF.bind(null,n),s._reactRetry=e,null):(n=i.treeContext,Yn=lo(s.nextSibling),Jn=e,it=!0,Fr=null,n!==null&&(ar[lr++]=Hs,ar[lr++]=qs,ar[lr++]=Pa,Hs=n.id,qs=n.overflow,Pa=e),e=mx(e,r.children),e.flags|=4096,e)}function ZS(n,e,t){n.lanes|=e;var r=n.alternate;r!==null&&(r.lanes|=e),B0(n.return,e,t)}function dv(n,e,t,r,s){var i=n.memoizedState;i===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=t,i.tailMode=s)}function aI(n,e,t){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(gn(n,e,r.children,t),r=ut.current,r&2)r=r&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&ZS(n,t,e);else if(n.tag===19)ZS(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}r&=1}if(Je(ut,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(t=e.child,s=null;t!==null;)n=t.alternate,n!==null&&ag(n)===null&&(s=t),t=t.sibling;t=s,t===null?(s=e.child,e.child=null):(s=t.sibling,t.sibling=null),dv(e,!1,s,t,i);break;case"backwards":for(t=null,s=e.child,e.child=null;s!==null;){if(n=s.alternate,n!==null&&ag(n)===null){e.child=s;break}n=s.sibling,s.sibling=t,t=s,s=n}dv(e,!0,t,null,i);break;case"together":dv(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function xp(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function ii(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),Ra|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(X(153));if(e.child!==null){for(n=e.child,t=fo(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=fo(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function CF(n,e,t){switch(e.tag){case 3:iI(e),pc();break;case 5:NP(e);break;case 1:jn(e.type)&&tg(e);break;case 4:lx(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Je(sg,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Je(ut,ut.current&1),e.flags|=128,null):t&e.child.childLanes?oI(n,e,t):(Je(ut,ut.current&1),n=ii(n,e,t),n!==null?n.sibling:null);Je(ut,ut.current&1);break;case 19:if(r=(t&e.childLanes)!==0,n.flags&128){if(r)return aI(n,e,t);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Je(ut,ut.current),r)break;return null;case 22:case 23:return e.lanes=0,rI(n,e,t)}return ii(n,e,t)}var lI,X0,cI,uI;lI=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};X0=function(){};cI=function(n,e,t,r){var s=n.memoizedProps;if(s!==r){n=e.stateNode,ua(vs.current);var i=null;switch(t){case"input":s=v0(n,s),r=v0(n,r),i=[];break;case"select":s=dt({},s,{value:void 0}),r=dt({},r,{value:void 0}),i=[];break;case"textarea":s=x0(n,s),r=x0(n,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(n.onclick=Zp)}S0(t,r);var o;t=null;for(c in s)if(!r.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var a=s[c];for(o in a)a.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(ph.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in r){var l=r[c];if(a=s!=null?s[c]:void 0,r.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(t||(t={}),t[o]=l[o])}else t||(i||(i=[]),i.push(c,t)),t=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(ph.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&tt("scroll",n),i||a===l||(i=[])):(i=i||[]).push(c,l))}t&&(i=i||[]).push("style",t);var c=i;(e.updateQueue=c)&&(e.flags|=4)}};uI=function(n,e,t,r){t!==r&&(e.flags|=4)};function ku(n,e){if(!it)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:r.sibling=null}}function nn(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,r=0;if(e)for(var s=n.child;s!==null;)t|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=n,s=s.sibling;else for(s=n.child;s!==null;)t|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=n,s=s.sibling;return n.subtreeFlags|=r,n.childLanes=t,e}function kF(n,e,t){var r=e.pendingProps;switch(tx(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return nn(e),null;case 1:return jn(e.type)&&eg(),nn(e),null;case 3:return r=e.stateNode,mc(),rt(Nn),rt(un),ux(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(n===null||n.child===null)&&(uf(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Fr!==null&&(sw(Fr),Fr=null))),X0(n,e),nn(e),null;case 5:cx(e);var s=ua(Ch.current);if(t=e.type,n!==null&&e.stateNode!=null)cI(n,e,t,r,s),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(X(166));return nn(e),null}if(n=ua(vs.current),uf(e)){r=e.stateNode,t=e.type;var i=e.memoizedProps;switch(r[fs]=e,r[Eh]=i,n=(e.mode&1)!==0,t){case"dialog":tt("cancel",r),tt("close",r);break;case"iframe":case"object":case"embed":tt("load",r);break;case"video":case"audio":for(s=0;s<Mu.length;s++)tt(Mu[s],r);break;case"source":tt("error",r);break;case"img":case"image":case"link":tt("error",r),tt("load",r);break;case"details":tt("toggle",r);break;case"input":lS(r,i),tt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},tt("invalid",r);break;case"textarea":uS(r,i),tt("invalid",r)}S0(t,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&cf(r.textContent,a,n),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&cf(r.textContent,a,n),s=["children",""+a]):ph.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&tt("scroll",r)}switch(t){case"input":ef(r),cS(r,i,!0);break;case"textarea":ef(r),hS(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Zp)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=FA(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=o.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof r.is=="string"?n=o.createElement(t,{is:r.is}):(n=o.createElement(t),t==="select"&&(o=n,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):n=o.createElementNS(n,t),n[fs]=e,n[Eh]=r,lI(n,e,!1,!1),e.stateNode=n;e:{switch(o=E0(t,r),t){case"dialog":tt("cancel",n),tt("close",n),s=r;break;case"iframe":case"object":case"embed":tt("load",n),s=r;break;case"video":case"audio":for(s=0;s<Mu.length;s++)tt(Mu[s],n);s=r;break;case"source":tt("error",n),s=r;break;case"img":case"image":case"link":tt("error",n),tt("load",n),s=r;break;case"details":tt("toggle",n),s=r;break;case"input":lS(n,r),s=v0(n,r),tt("invalid",n);break;case"option":s=r;break;case"select":n._wrapperState={wasMultiple:!!r.multiple},s=dt({},r,{value:void 0}),tt("invalid",n);break;case"textarea":uS(n,r),s=x0(n,r),tt("invalid",n);break;default:s=r}S0(t,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?$A(n,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&VA(n,l)):i==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&gh(n,l):typeof l=="number"&&gh(n,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(ph.hasOwnProperty(i)?l!=null&&i==="onScroll"&&tt("scroll",n):l!=null&&U_(n,i,l,o))}switch(t){case"input":ef(n),cS(n,r,!1);break;case"textarea":ef(n),hS(n);break;case"option":r.value!=null&&n.setAttribute("value",""+wo(r.value));break;case"select":n.multiple=!!r.multiple,i=r.value,i!=null?Ul(n,!!r.multiple,i,!1):r.defaultValue!=null&&Ul(n,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(n.onclick=Zp)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return nn(e),null;case 6:if(n&&e.stateNode!=null)uI(n,e,n.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(X(166));if(t=ua(Ch.current),ua(vs.current),uf(e)){if(r=e.stateNode,t=e.memoizedProps,r[fs]=e,(i=r.nodeValue!==t)&&(n=Jn,n!==null))switch(n.tag){case 3:cf(r.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&cf(r.nodeValue,t,(n.mode&1)!==0)}i&&(e.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[fs]=e,e.stateNode=r}return nn(e),null;case 13:if(rt(ut),r=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(it&&Yn!==null&&e.mode&1&&!(e.flags&128))AP(),pc(),e.flags|=98560,i=!1;else if(i=uf(e),r!==null&&r.dehydrated!==null){if(n===null){if(!i)throw Error(X(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(X(317));i[fs]=e}else pc(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;nn(e),i=!1}else Fr!==null&&(sw(Fr),Fr=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(r=r!==null,r!==(n!==null&&n.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(n===null||ut.current&1?jt===0&&(jt=3):bx())),e.updateQueue!==null&&(e.flags|=4),nn(e),null);case 4:return mc(),X0(n,e),n===null&&bh(e.stateNode.containerInfo),nn(e),null;case 10:return ix(e.type._context),nn(e),null;case 17:return jn(e.type)&&eg(),nn(e),null;case 19:if(rt(ut),i=e.memoizedState,i===null)return nn(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)ku(i,!1);else{if(jt!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(o=ag(n),o!==null){for(e.flags|=128,ku(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=t,t=e.child;t!==null;)i=t,n=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=n,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,n=o.dependencies,i.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return Je(ut,ut.current&1|2),e.child}n=n.sibling}i.tail!==null&&wt()>vc&&(e.flags|=128,r=!0,ku(i,!1),e.lanes=4194304)}else{if(!r)if(n=ag(o),n!==null){if(e.flags|=128,r=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),ku(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!it)return nn(e),null}else 2*wt()-i.renderingStartTime>vc&&t!==1073741824&&(e.flags|=128,r=!0,ku(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(t=i.last,t!==null?t.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=wt(),e.sibling=null,t=ut.current,Je(ut,r?t&1|2:t&1),e):(nn(e),null);case 22:case 23:return xx(),r=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Wn&1073741824&&(nn(e),e.subtreeFlags&6&&(e.flags|=8192)):nn(e),null;case 24:return null;case 25:return null}throw Error(X(156,e.tag))}function AF(n,e){switch(tx(e),e.tag){case 1:return jn(e.type)&&eg(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return mc(),rt(Nn),rt(un),ux(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return cx(e),null;case 13:if(rt(ut),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(X(340));pc()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return rt(ut),null;case 4:return mc(),null;case 10:return ix(e.type._context),null;case 22:case 23:return xx(),null;case 24:return null;default:return null}}var ff=!1,an=!1,PF=typeof WeakSet=="function"?WeakSet:Set,se=null;function Nl(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){mt(n,e,r)}else t.current=null}function Q0(n,e,t){try{t()}catch(r){mt(n,e,r)}}var eE=!1;function IF(n,e){if(j0=Xp,n=gP(),Z_(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{t.nodeType,i.nodeType}catch{t=null;break e}var o=0,a=-1,l=-1,c=0,u=0,h=n,f=null;t:for(;;){for(var p;h!==t||s!==0&&h.nodeType!==3||(a=o+s),h!==i||r!==0&&h.nodeType!==3||(l=o+r),h.nodeType===3&&(o+=h.nodeValue.length),(p=h.firstChild)!==null;)f=h,h=p;for(;;){if(h===n)break t;if(f===t&&++c===s&&(a=o),f===i&&++u===r&&(l=o),(p=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=p}t=a===-1||l===-1?null:{start:a,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(D0={focusedElem:n,selectionRange:t},Xp=!1,se=e;se!==null;)if(e=se,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,se=n;else for(;se!==null;){e=se;try{var y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var m=y.memoizedProps,v=y.memoizedState,w=e.stateNode,_=w.getSnapshotBeforeUpdate(e.elementType===e.type?m:Ir(e.type,m),v);w.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var x=e.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(X(163))}}catch(A){mt(e,e.return,A)}if(n=e.sibling,n!==null){n.return=e.return,se=n;break}se=e.return}return y=eE,eE=!1,y}function Ju(n,e,t){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&n)===n){var i=s.destroy;s.destroy=void 0,i!==void 0&&Q0(e,t,i)}s=s.next}while(s!==r)}}function mm(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}}function J0(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function hI(n){var e=n.alternate;e!==null&&(n.alternate=null,hI(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[fs],delete e[Eh],delete e[F0],delete e[dF],delete e[fF])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function dI(n){return n.tag===5||n.tag===3||n.tag===4}function tE(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||dI(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Z0(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=Zp));else if(r!==4&&(n=n.child,n!==null))for(Z0(n,e,t),n=n.sibling;n!==null;)Z0(n,e,t),n=n.sibling}function ew(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(r!==4&&(n=n.child,n!==null))for(ew(n,e,t),n=n.sibling;n!==null;)ew(n,e,t),n=n.sibling}var qt=null,Dr=!1;function Pi(n,e,t){for(t=t.child;t!==null;)fI(n,e,t),t=t.sibling}function fI(n,e,t){if(ys&&typeof ys.onCommitFiberUnmount=="function")try{ys.onCommitFiberUnmount(lm,t)}catch{}switch(t.tag){case 5:an||Nl(t,e);case 6:var r=qt,s=Dr;qt=null,Pi(n,e,t),qt=r,Dr=s,qt!==null&&(Dr?(n=qt,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):qt.removeChild(t.stateNode));break;case 18:qt!==null&&(Dr?(n=qt,t=t.stateNode,n.nodeType===8?iv(n.parentNode,t):n.nodeType===1&&iv(n,t),wh(n)):iv(qt,t.stateNode));break;case 4:r=qt,s=Dr,qt=t.stateNode.containerInfo,Dr=!0,Pi(n,e,t),qt=r,Dr=s;break;case 0:case 11:case 14:case 15:if(!an&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Q0(t,e,o),s=s.next}while(s!==r)}Pi(n,e,t);break;case 1:if(!an&&(Nl(t,e),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(a){mt(t,e,a)}Pi(n,e,t);break;case 21:Pi(n,e,t);break;case 22:t.mode&1?(an=(r=an)||t.memoizedState!==null,Pi(n,e,t),an=r):Pi(n,e,t);break;default:Pi(n,e,t)}}function nE(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new PF),e.forEach(function(r){var s=VF.bind(null,n,r);t.has(r)||(t.add(r),r.then(s,s))})}}function Sr(n,e){var t=e.deletions;if(t!==null)for(var r=0;r<t.length;r++){var s=t[r];try{var i=n,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:qt=a.stateNode,Dr=!1;break e;case 3:qt=a.stateNode.containerInfo,Dr=!0;break e;case 4:qt=a.stateNode.containerInfo,Dr=!0;break e}a=a.return}if(qt===null)throw Error(X(160));fI(i,o,s),qt=null,Dr=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(c){mt(s,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)pI(e,n),e=e.sibling}function pI(n,e){var t=n.alternate,r=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Sr(e,n),os(n),r&4){try{Ju(3,n,n.return),mm(3,n)}catch(m){mt(n,n.return,m)}try{Ju(5,n,n.return)}catch(m){mt(n,n.return,m)}}break;case 1:Sr(e,n),os(n),r&512&&t!==null&&Nl(t,t.return);break;case 5:if(Sr(e,n),os(n),r&512&&t!==null&&Nl(t,t.return),n.flags&32){var s=n.stateNode;try{gh(s,"")}catch(m){mt(n,n.return,m)}}if(r&4&&(s=n.stateNode,s!=null)){var i=n.memoizedProps,o=t!==null?t.memoizedProps:i,a=n.type,l=n.updateQueue;if(n.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&MA(s,i),E0(a,o);var c=E0(a,i);for(o=0;o<l.length;o+=2){var u=l[o],h=l[o+1];u==="style"?$A(s,h):u==="dangerouslySetInnerHTML"?VA(s,h):u==="children"?gh(s,h):U_(s,u,h,c)}switch(a){case"input":w0(s,i);break;case"textarea":LA(s,i);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var p=i.value;p!=null?Ul(s,!!i.multiple,p,!1):f!==!!i.multiple&&(i.defaultValue!=null?Ul(s,!!i.multiple,i.defaultValue,!0):Ul(s,!!i.multiple,i.multiple?[]:"",!1))}s[Eh]=i}catch(m){mt(n,n.return,m)}}break;case 6:if(Sr(e,n),os(n),r&4){if(n.stateNode===null)throw Error(X(162));s=n.stateNode,i=n.memoizedProps;try{s.nodeValue=i}catch(m){mt(n,n.return,m)}}break;case 3:if(Sr(e,n),os(n),r&4&&t!==null&&t.memoizedState.isDehydrated)try{wh(e.containerInfo)}catch(m){mt(n,n.return,m)}break;case 4:Sr(e,n),os(n);break;case 13:Sr(e,n),os(n),s=n.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(wx=wt())),r&4&&nE(n);break;case 22:if(u=t!==null&&t.memoizedState!==null,n.mode&1?(an=(c=an)||u,Sr(e,n),an=c):Sr(e,n),os(n),r&8192){if(c=n.memoizedState!==null,(n.stateNode.isHidden=c)&&!u&&n.mode&1)for(se=n,u=n.child;u!==null;){for(h=se=u;se!==null;){switch(f=se,p=f.child,f.tag){case 0:case 11:case 14:case 15:Ju(4,f,f.return);break;case 1:Nl(f,f.return);var y=f.stateNode;if(typeof y.componentWillUnmount=="function"){r=f,t=f.return;try{e=r,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch(m){mt(r,t,m)}}break;case 5:Nl(f,f.return);break;case 22:if(f.memoizedState!==null){sE(h);continue}}p!==null?(p.return=f,se=p):sE(h)}u=u.sibling}e:for(u=null,h=n;;){if(h.tag===5){if(u===null){u=h;try{s=h.stateNode,c?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=h.stateNode,l=h.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=UA("display",o))}catch(m){mt(n,n.return,m)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(m){mt(n,n.return,m)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===n)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===n)break e;for(;h.sibling===null;){if(h.return===null||h.return===n)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Sr(e,n),os(n),r&4&&nE(n);break;case 21:break;default:Sr(e,n),os(n)}}function os(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(dI(t)){var r=t;break e}t=t.return}throw Error(X(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(gh(s,""),r.flags&=-33);var i=tE(n);ew(n,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,a=tE(n);Z0(n,a,o);break;default:throw Error(X(161))}}catch(l){mt(n,n.return,l)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function RF(n,e,t){se=n,gI(n)}function gI(n,e,t){for(var r=(n.mode&1)!==0;se!==null;){var s=se,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||ff;if(!o){var a=s.alternate,l=a!==null&&a.memoizedState!==null||an;a=ff;var c=an;if(ff=o,(an=l)&&!c)for(se=s;se!==null;)o=se,l=o.child,o.tag===22&&o.memoizedState!==null?iE(s):l!==null?(l.return=o,se=l):iE(s);for(;i!==null;)se=i,gI(i),i=i.sibling;se=s,ff=a,an=c}rE(n)}else s.subtreeFlags&8772&&i!==null?(i.return=s,se=i):rE(n)}}function rE(n){for(;se!==null;){var e=se;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:an||mm(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!an)if(t===null)r.componentDidMount();else{var s=e.elementType===e.type?t.memoizedProps:Ir(e.type,t.memoizedProps);r.componentDidUpdate(s,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&$S(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}$S(e,o,t)}break;case 5:var a=e.stateNode;if(t===null&&e.flags&4){t=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&wh(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(X(163))}an||e.flags&512&&J0(e)}catch(f){mt(e,e.return,f)}}if(e===n){se=null;break}if(t=e.sibling,t!==null){t.return=e.return,se=t;break}se=e.return}}function sE(n){for(;se!==null;){var e=se;if(e===n){se=null;break}var t=e.sibling;if(t!==null){t.return=e.return,se=t;break}se=e.return}}function iE(n){for(;se!==null;){var e=se;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{mm(4,e)}catch(l){mt(e,t,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(l){mt(e,s,l)}}var i=e.return;try{J0(e)}catch(l){mt(e,i,l)}break;case 5:var o=e.return;try{J0(e)}catch(l){mt(e,o,l)}}}catch(l){mt(e,e.return,l)}if(e===n){se=null;break}var a=e.sibling;if(a!==null){a.return=e.return,se=a;break}se=e.return}}var OF=Math.ceil,ug=mi.ReactCurrentDispatcher,yx=mi.ReactCurrentOwner,pr=mi.ReactCurrentBatchConfig,Me=0,zt=null,Ct=null,Xt=0,Wn=0,jl=Oo(0),jt=0,Ih=null,Ra=0,ym=0,vx=0,Zu=null,In=null,wx=0,vc=1/0,Fs=null,hg=!1,tw=null,uo=null,pf=!1,to=null,dg=0,eh=0,nw=null,bp=-1,Sp=0;function xn(){return Me&6?wt():bp!==-1?bp:bp=wt()}function ho(n){return n.mode&1?Me&2&&Xt!==0?Xt&-Xt:gF.transition!==null?(Sp===0&&(Sp=ZA()),Sp):(n=He,n!==0||(n=window.event,n=n===void 0?16:oP(n.type)),n):1}function Hr(n,e,t,r){if(50<eh)throw eh=0,nw=null,Error(X(185));ld(n,t,r),(!(Me&2)||n!==zt)&&(n===zt&&(!(Me&2)&&(ym|=t),jt===4&&Bi(n,Xt)),Dn(n,r),t===1&&Me===0&&!(e.mode&1)&&(vc=wt()+500,fm&&No()))}function Dn(n,e){var t=n.callbackNode;g4(n,e);var r=Yp(n,n===zt?Xt:0);if(r===0)t!==null&&pS(t),n.callbackNode=null,n.callbackPriority=0;else if(e=r&-r,n.callbackPriority!==e){if(t!=null&&pS(t),e===1)n.tag===0?pF(oE.bind(null,n)):TP(oE.bind(null,n)),uF(function(){!(Me&6)&&No()}),t=null;else{switch(eP(r)){case 1:t=H_;break;case 4:t=QA;break;case 16:t=Kp;break;case 536870912:t=JA;break;default:t=Kp}t=SI(t,mI.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function mI(n,e){if(bp=-1,Sp=0,Me&6)throw Error(X(327));var t=n.callbackNode;if(Hl()&&n.callbackNode!==t)return null;var r=Yp(n,n===zt?Xt:0);if(r===0)return null;if(r&30||r&n.expiredLanes||e)e=fg(n,r);else{e=r;var s=Me;Me|=2;var i=vI();(zt!==n||Xt!==e)&&(Fs=null,vc=wt()+500,xa(n,e));do try{DF();break}catch(a){yI(n,a)}while(!0);sx(),ug.current=i,Me=s,Ct!==null?e=0:(zt=null,Xt=0,e=jt)}if(e!==0){if(e===2&&(s=P0(n),s!==0&&(r=s,e=rw(n,s))),e===1)throw t=Ih,xa(n,0),Bi(n,r),Dn(n,wt()),t;if(e===6)Bi(n,r);else{if(s=n.current.alternate,!(r&30)&&!NF(s)&&(e=fg(n,r),e===2&&(i=P0(n),i!==0&&(r=i,e=rw(n,i))),e===1))throw t=Ih,xa(n,0),Bi(n,r),Dn(n,wt()),t;switch(n.finishedWork=s,n.finishedLanes=r,e){case 0:case 1:throw Error(X(345));case 2:ea(n,In,Fs);break;case 3:if(Bi(n,r),(r&130023424)===r&&(e=wx+500-wt(),10<e)){if(Yp(n,0)!==0)break;if(s=n.suspendedLanes,(s&r)!==r){xn(),n.pingedLanes|=n.suspendedLanes&s;break}n.timeoutHandle=L0(ea.bind(null,n,In,Fs),e);break}ea(n,In,Fs);break;case 4:if(Bi(n,r),(r&4194240)===r)break;for(e=n.eventTimes,s=-1;0<r;){var o=31-Wr(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=wt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*OF(r/1960))-r,10<r){n.timeoutHandle=L0(ea.bind(null,n,In,Fs),r);break}ea(n,In,Fs);break;case 5:ea(n,In,Fs);break;default:throw Error(X(329))}}}return Dn(n,wt()),n.callbackNode===t?mI.bind(null,n):null}function rw(n,e){var t=Zu;return n.current.memoizedState.isDehydrated&&(xa(n,e).flags|=256),n=fg(n,e),n!==2&&(e=In,In=t,e!==null&&sw(e)),n}function sw(n){In===null?In=n:In.push.apply(In,n)}function NF(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var s=t[r],i=s.getSnapshot;s=s.value;try{if(!Gr(i(),s))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Bi(n,e){for(e&=~vx,e&=~ym,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-Wr(e),r=1<<t;n[t]=-1,e&=~r}}function oE(n){if(Me&6)throw Error(X(327));Hl();var e=Yp(n,0);if(!(e&1))return Dn(n,wt()),null;var t=fg(n,e);if(n.tag!==0&&t===2){var r=P0(n);r!==0&&(e=r,t=rw(n,r))}if(t===1)throw t=Ih,xa(n,0),Bi(n,e),Dn(n,wt()),t;if(t===6)throw Error(X(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,ea(n,In,Fs),Dn(n,wt()),null}function _x(n,e){var t=Me;Me|=1;try{return n(e)}finally{Me=t,Me===0&&(vc=wt()+500,fm&&No())}}function Oa(n){to!==null&&to.tag===0&&!(Me&6)&&Hl();var e=Me;Me|=1;var t=pr.transition,r=He;try{if(pr.transition=null,He=1,n)return n()}finally{He=r,pr.transition=t,Me=e,!(Me&6)&&No()}}function xx(){Wn=jl.current,rt(jl)}function xa(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,cF(t)),Ct!==null)for(t=Ct.return;t!==null;){var r=t;switch(tx(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&eg();break;case 3:mc(),rt(Nn),rt(un),ux();break;case 5:cx(r);break;case 4:mc();break;case 13:rt(ut);break;case 19:rt(ut);break;case 10:ix(r.type._context);break;case 22:case 23:xx()}t=t.return}if(zt=n,Ct=n=fo(n.current,null),Xt=Wn=e,jt=0,Ih=null,vx=ym=Ra=0,In=Zu=null,ca!==null){for(e=0;e<ca.length;e++)if(t=ca[e],r=t.interleaved,r!==null){t.interleaved=null;var s=r.next,i=t.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}t.pending=r}ca=null}return n}function yI(n,e){do{var t=Ct;try{if(sx(),wp.current=cg,lg){for(var r=ht.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}lg=!1}if(Ia=0,Bt=Nt=ht=null,Qu=!1,kh=0,yx.current=null,t===null||t.return===null){jt=1,Ih=e,Ct=null;break}e:{var i=n,o=t.return,a=t,l=e;if(e=Xt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var f=u.alternate;f?(u.updateQueue=f.updateQueue,u.memoizedState=f.memoizedState,u.lanes=f.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=GS(o);if(p!==null){p.flags&=-257,KS(p,o,a,i,e),p.mode&1&&qS(i,c,e),e=p,l=c;var y=e.updateQueue;if(y===null){var m=new Set;m.add(l),e.updateQueue=m}else y.add(l);break e}else{if(!(e&1)){qS(i,c,e),bx();break e}l=Error(X(426))}}else if(it&&a.mode&1){var v=GS(o);if(v!==null){!(v.flags&65536)&&(v.flags|=256),KS(v,o,a,i,e),nx(yc(l,a));break e}}i=l=yc(l,a),jt!==4&&(jt=2),Zu===null?Zu=[i]:Zu.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var w=eI(i,l,e);US(i,w);break e;case 1:a=l;var _=i.type,x=i.stateNode;if(!(i.flags&128)&&(typeof _.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(uo===null||!uo.has(x)))){i.flags|=65536,e&=-e,i.lanes|=e;var A=tI(i,a,e);US(i,A);break e}}i=i.return}while(i!==null)}_I(t)}catch(j){e=j,Ct===t&&t!==null&&(Ct=t=t.return);continue}break}while(!0)}function vI(){var n=ug.current;return ug.current=cg,n===null?cg:n}function bx(){(jt===0||jt===3||jt===2)&&(jt=4),zt===null||!(Ra&268435455)&&!(ym&268435455)||Bi(zt,Xt)}function fg(n,e){var t=Me;Me|=2;var r=vI();(zt!==n||Xt!==e)&&(Fs=null,xa(n,e));do try{jF();break}catch(s){yI(n,s)}while(!0);if(sx(),Me=t,ug.current=r,Ct!==null)throw Error(X(261));return zt=null,Xt=0,jt}function jF(){for(;Ct!==null;)wI(Ct)}function DF(){for(;Ct!==null&&!o4();)wI(Ct)}function wI(n){var e=bI(n.alternate,n,Wn);n.memoizedProps=n.pendingProps,e===null?_I(n):Ct=e,yx.current=null}function _I(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=AF(t,e),t!==null){t.flags&=32767,Ct=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{jt=6,Ct=null;return}}else if(t=kF(t,e,Wn),t!==null){Ct=t;return}if(e=e.sibling,e!==null){Ct=e;return}Ct=e=n}while(e!==null);jt===0&&(jt=5)}function ea(n,e,t){var r=He,s=pr.transition;try{pr.transition=null,He=1,MF(n,e,t,r)}finally{pr.transition=s,He=r}return null}function MF(n,e,t,r){do Hl();while(to!==null);if(Me&6)throw Error(X(327));t=n.finishedWork;var s=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(X(177));n.callbackNode=null,n.callbackPriority=0;var i=t.lanes|t.childLanes;if(m4(n,i),n===zt&&(Ct=zt=null,Xt=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||pf||(pf=!0,SI(Kp,function(){return Hl(),null})),i=(t.flags&15990)!==0,t.subtreeFlags&15990||i){i=pr.transition,pr.transition=null;var o=He;He=1;var a=Me;Me|=4,yx.current=null,IF(n,t),pI(t,n),nF(D0),Xp=!!j0,D0=j0=null,n.current=t,RF(t),a4(),Me=a,He=o,pr.transition=i}else n.current=t;if(pf&&(pf=!1,to=n,dg=s),i=n.pendingLanes,i===0&&(uo=null),u4(t.stateNode),Dn(n,wt()),e!==null)for(r=n.onRecoverableError,t=0;t<e.length;t++)s=e[t],r(s.value,{componentStack:s.stack,digest:s.digest});if(hg)throw hg=!1,n=tw,tw=null,n;return dg&1&&n.tag!==0&&Hl(),i=n.pendingLanes,i&1?n===nw?eh++:(eh=0,nw=n):eh=0,No(),null}function Hl(){if(to!==null){var n=eP(dg),e=pr.transition,t=He;try{if(pr.transition=null,He=16>n?16:n,to===null)var r=!1;else{if(n=to,to=null,dg=0,Me&6)throw Error(X(331));var s=Me;for(Me|=4,se=n.current;se!==null;){var i=se,o=i.child;if(se.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(se=c;se!==null;){var u=se;switch(u.tag){case 0:case 11:case 15:Ju(8,u,i)}var h=u.child;if(h!==null)h.return=u,se=h;else for(;se!==null;){u=se;var f=u.sibling,p=u.return;if(hI(u),u===c){se=null;break}if(f!==null){f.return=p,se=f;break}se=p}}}var y=i.alternate;if(y!==null){var m=y.child;if(m!==null){y.child=null;do{var v=m.sibling;m.sibling=null,m=v}while(m!==null)}}se=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,se=o;else e:for(;se!==null;){if(i=se,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Ju(9,i,i.return)}var w=i.sibling;if(w!==null){w.return=i.return,se=w;break e}se=i.return}}var _=n.current;for(se=_;se!==null;){o=se;var x=o.child;if(o.subtreeFlags&2064&&x!==null)x.return=o,se=x;else e:for(o=_;se!==null;){if(a=se,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:mm(9,a)}}catch(j){mt(a,a.return,j)}if(a===o){se=null;break e}var A=a.sibling;if(A!==null){A.return=a.return,se=A;break e}se=a.return}}if(Me=s,No(),ys&&typeof ys.onPostCommitFiberRoot=="function")try{ys.onPostCommitFiberRoot(lm,n)}catch{}r=!0}return r}finally{He=t,pr.transition=e}}return!1}function aE(n,e,t){e=yc(t,e),e=eI(n,e,1),n=co(n,e,1),e=xn(),n!==null&&(ld(n,1,e),Dn(n,e))}function mt(n,e,t){if(n.tag===3)aE(n,n,t);else for(;e!==null;){if(e.tag===3){aE(e,n,t);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(uo===null||!uo.has(r))){n=yc(t,n),n=tI(e,n,1),e=co(e,n,1),n=xn(),e!==null&&(ld(e,1,n),Dn(e,n));break}}e=e.return}}function LF(n,e,t){var r=n.pingCache;r!==null&&r.delete(e),e=xn(),n.pingedLanes|=n.suspendedLanes&t,zt===n&&(Xt&t)===t&&(jt===4||jt===3&&(Xt&130023424)===Xt&&500>wt()-wx?xa(n,0):vx|=t),Dn(n,e)}function xI(n,e){e===0&&(n.mode&1?(e=rf,rf<<=1,!(rf&130023424)&&(rf=4194304)):e=1);var t=xn();n=si(n,e),n!==null&&(ld(n,e,t),Dn(n,t))}function FF(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),xI(n,t)}function VF(n,e){var t=0;switch(n.tag){case 13:var r=n.stateNode,s=n.memoizedState;s!==null&&(t=s.retryLane);break;case 19:r=n.stateNode;break;default:throw Error(X(314))}r!==null&&r.delete(e),xI(n,t)}var bI;bI=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||Nn.current)On=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return On=!1,CF(n,e,t);On=!!(n.flags&131072)}else On=!1,it&&e.flags&1048576&&CP(e,rg,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;xp(n,e),n=e.pendingProps;var s=fc(e,un.current);Wl(e,t),s=dx(null,e,r,n,s,t);var i=fx();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,jn(r)?(i=!0,tg(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,ax(e),s.updater=gm,e.stateNode=s,s._reactInternals=e,W0(e,r,n,t),e=G0(null,e,r,!0,i,t)):(e.tag=0,it&&i&&ex(e),gn(null,e,s,t),e=e.child),e;case 16:r=e.elementType;e:{switch(xp(n,e),n=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=$F(r),n=Ir(r,n),s){case 0:e=q0(null,e,r,n,t);break e;case 1:e=QS(null,e,r,n,t);break e;case 11:e=YS(null,e,r,n,t);break e;case 14:e=XS(null,e,r,Ir(r.type,n),t);break e}throw Error(X(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Ir(r,s),q0(n,e,r,s,t);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Ir(r,s),QS(n,e,r,s,t);case 3:e:{if(iI(e),n===null)throw Error(X(387));r=e.pendingProps,i=e.memoizedState,s=i.element,OP(n,e),og(e,r,null,t);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=yc(Error(X(423)),e),e=JS(n,e,r,t,s);break e}else if(r!==s){s=yc(Error(X(424)),e),e=JS(n,e,r,t,s);break e}else for(Yn=lo(e.stateNode.containerInfo.firstChild),Jn=e,it=!0,Fr=null,t=IP(e,null,r,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(pc(),r===s){e=ii(n,e,t);break e}gn(n,e,r,t)}e=e.child}return e;case 5:return NP(e),n===null&&$0(e),r=e.type,s=e.pendingProps,i=n!==null?n.memoizedProps:null,o=s.children,M0(r,s)?o=null:i!==null&&M0(r,i)&&(e.flags|=32),sI(n,e),gn(n,e,o,t),e.child;case 6:return n===null&&$0(e),null;case 13:return oI(n,e,t);case 4:return lx(e,e.stateNode.containerInfo),r=e.pendingProps,n===null?e.child=gc(e,null,r,t):gn(n,e,r,t),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Ir(r,s),YS(n,e,r,s,t);case 7:return gn(n,e,e.pendingProps,t),e.child;case 8:return gn(n,e,e.pendingProps.children,t),e.child;case 12:return gn(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Je(sg,r._currentValue),r._currentValue=o,i!==null)if(Gr(i.value,o)){if(i.children===s.children&&!Nn.current){e=ii(n,e,t);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(i.tag===1){l=Qs(-1,t&-t),l.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}i.lanes|=t,l=i.alternate,l!==null&&(l.lanes|=t),B0(i.return,t,e),a.lanes|=t;break}l=l.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(X(341));o.lanes|=t,a=o.alternate,a!==null&&(a.lanes|=t),B0(o,t,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}gn(n,e,s.children,t),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Wl(e,t),s=mr(s),r=r(s),e.flags|=1,gn(n,e,r,t),e.child;case 14:return r=e.type,s=Ir(r,e.pendingProps),s=Ir(r.type,s),XS(n,e,r,s,t);case 15:return nI(n,e,e.type,e.pendingProps,t);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Ir(r,s),xp(n,e),e.tag=1,jn(r)?(n=!0,tg(e)):n=!1,Wl(e,t),ZP(e,r,s),W0(e,r,s,t),G0(null,e,r,!0,n,t);case 19:return aI(n,e,t);case 22:return rI(n,e,t)}throw Error(X(156,e.tag))};function SI(n,e){return XA(n,e)}function UF(n,e,t,r){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function fr(n,e,t,r){return new UF(n,e,t,r)}function Sx(n){return n=n.prototype,!(!n||!n.isReactComponent)}function $F(n){if(typeof n=="function")return Sx(n)?1:0;if(n!=null){if(n=n.$$typeof,n===B_)return 11;if(n===z_)return 14}return 2}function fo(n,e){var t=n.alternate;return t===null?(t=fr(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function Ep(n,e,t,r,s,i){var o=2;if(r=n,typeof n=="function")Sx(n)&&(o=1);else if(typeof n=="string")o=5;else e:switch(n){case El:return ba(t.children,s,i,e);case $_:o=8,s|=8;break;case p0:return n=fr(12,t,e,s|2),n.elementType=p0,n.lanes=i,n;case g0:return n=fr(13,t,e,s),n.elementType=g0,n.lanes=i,n;case m0:return n=fr(19,t,e,s),n.elementType=m0,n.lanes=i,n;case NA:return vm(t,s,i,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case RA:o=10;break e;case OA:o=9;break e;case B_:o=11;break e;case z_:o=14;break e;case Fi:o=16,r=null;break e}throw Error(X(130,n==null?n:typeof n,""))}return e=fr(o,t,e,s),e.elementType=n,e.type=r,e.lanes=i,e}function ba(n,e,t,r){return n=fr(7,n,r,e),n.lanes=t,n}function vm(n,e,t,r){return n=fr(22,n,r,e),n.elementType=NA,n.lanes=t,n.stateNode={isHidden:!1},n}function fv(n,e,t){return n=fr(6,n,null,e),n.lanes=t,n}function pv(n,e,t){return e=fr(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function BF(n,e,t,r,s){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ky(0),this.expirationTimes=Ky(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ky(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Ex(n,e,t,r,s,i,o,a,l){return n=new BF(n,e,t,a,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=fr(3,null,null,e),n.current=i,i.stateNode=n,i.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},ax(i),n}function zF(n,e,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Sl,key:r==null?null:""+r,children:n,containerInfo:e,implementation:t}}function EI(n){if(!n)return _o;n=n._reactInternals;e:{if(Ha(n)!==n||n.tag!==1)throw Error(X(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(jn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(X(171))}if(n.tag===1){var t=n.type;if(jn(t))return EP(n,t,e)}return e}function TI(n,e,t,r,s,i,o,a,l){return n=Ex(t,r,!0,n,s,i,o,a,l),n.context=EI(null),t=n.current,r=xn(),s=ho(t),i=Qs(r,s),i.callback=e??null,co(t,i,s),n.current.lanes=s,ld(n,s,r),Dn(n,r),n}function wm(n,e,t,r){var s=e.current,i=xn(),o=ho(s);return t=EI(t),e.context===null?e.context=t:e.pendingContext=t,e=Qs(i,o),e.payload={element:n},r=r===void 0?null:r,r!==null&&(e.callback=r),n=co(s,e,o),n!==null&&(Hr(n,s,o,i),vp(n,s,o)),o}function pg(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function lE(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function Tx(n,e){lE(n,e),(n=n.alternate)&&lE(n,e)}function WF(){return null}var CI=typeof reportError=="function"?reportError:function(n){console.error(n)};function Cx(n){this._internalRoot=n}_m.prototype.render=Cx.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(X(409));wm(n,e,null,null)};_m.prototype.unmount=Cx.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;Oa(function(){wm(null,n,null,null)}),e[ri]=null}};function _m(n){this._internalRoot=n}_m.prototype.unstable_scheduleHydration=function(n){if(n){var e=rP();n={blockedOn:null,target:n,priority:e};for(var t=0;t<$i.length&&e!==0&&e<$i[t].priority;t++);$i.splice(t,0,n),t===0&&iP(n)}};function kx(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function xm(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function cE(){}function HF(n,e,t,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var c=pg(o);i.call(c)}}var o=TI(e,r,n,0,null,!1,!1,"",cE);return n._reactRootContainer=o,n[ri]=o.current,bh(n.nodeType===8?n.parentNode:n),Oa(),o}for(;s=n.lastChild;)n.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var c=pg(l);a.call(c)}}var l=Ex(n,0,!1,null,null,!1,!1,"",cE);return n._reactRootContainer=l,n[ri]=l.current,bh(n.nodeType===8?n.parentNode:n),Oa(function(){wm(e,l,t,r)}),l}function bm(n,e,t,r,s){var i=t._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var l=pg(o);a.call(l)}}wm(e,o,n,s)}else o=HF(t,e,n,s,r);return pg(o)}tP=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=Du(e.pendingLanes);t!==0&&(q_(e,t|1),Dn(e,wt()),!(Me&6)&&(vc=wt()+500,No()))}break;case 13:Oa(function(){var r=si(n,1);if(r!==null){var s=xn();Hr(r,n,1,s)}}),Tx(n,1)}};G_=function(n){if(n.tag===13){var e=si(n,134217728);if(e!==null){var t=xn();Hr(e,n,134217728,t)}Tx(n,134217728)}};nP=function(n){if(n.tag===13){var e=ho(n),t=si(n,e);if(t!==null){var r=xn();Hr(t,n,e,r)}Tx(n,e)}};rP=function(){return He};sP=function(n,e){var t=He;try{return He=n,e()}finally{He=t}};C0=function(n,e,t){switch(e){case"input":if(w0(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var r=t[e];if(r!==n&&r.form===n.form){var s=dm(r);if(!s)throw Error(X(90));DA(r),w0(r,s)}}}break;case"textarea":LA(n,t);break;case"select":e=t.value,e!=null&&Ul(n,!!t.multiple,e,!1)}};WA=_x;HA=Oa;var qF={usingClientEntryPoint:!1,Events:[ud,Al,dm,BA,zA,_x]},Au={findFiberByHostInstance:la,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},GF={bundleType:Au.bundleType,version:Au.version,rendererPackageName:Au.rendererPackageName,rendererConfig:Au.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:mi.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=KA(n),n===null?null:n.stateNode},findFiberByHostInstance:Au.findFiberByHostInstance||WF,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var gf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!gf.isDisabled&&gf.supportsFiber)try{lm=gf.inject(GF),ys=gf}catch{}}tr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=qF;tr.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!kx(e))throw Error(X(200));return zF(n,e,null,t)};tr.createRoot=function(n,e){if(!kx(n))throw Error(X(299));var t=!1,r="",s=CI;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Ex(n,1,!1,null,null,t,!1,r,s),n[ri]=e.current,bh(n.nodeType===8?n.parentNode:n),new Cx(e)};tr.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(X(188)):(n=Object.keys(n).join(","),Error(X(268,n)));return n=KA(e),n=n===null?null:n.stateNode,n};tr.flushSync=function(n){return Oa(n)};tr.hydrate=function(n,e,t){if(!xm(e))throw Error(X(200));return bm(null,n,e,!0,t)};tr.hydrateRoot=function(n,e,t){if(!kx(n))throw Error(X(405));var r=t!=null&&t.hydratedSources||null,s=!1,i="",o=CI;if(t!=null&&(t.unstable_strictMode===!0&&(s=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=TI(e,null,n,1,t??null,s,!1,i,o),n[ri]=e.current,bh(n),r)for(n=0;n<r.length;n++)t=r[n],s=t._getVersion,s=s(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,s]:e.mutableSourceEagerHydrationData.push(t,s);return new _m(e)};tr.render=function(n,e,t){if(!xm(e))throw Error(X(200));return bm(null,n,e,!1,t)};tr.unmountComponentAtNode=function(n){if(!xm(n))throw Error(X(40));return n._reactRootContainer?(Oa(function(){bm(null,null,n,!1,function(){n._reactRootContainer=null,n[ri]=null})}),!0):!1};tr.unstable_batchedUpdates=_x;tr.unstable_renderSubtreeIntoContainer=function(n,e,t,r){if(!xm(t))throw Error(X(200));if(n==null||n._reactInternals===void 0)throw Error(X(38));return bm(n,e,t,!1,r)};tr.version="18.3.1-next-f1338f8080-20240426";function kI(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(kI)}catch(n){console.error(n)}}kI(),kA.exports=tr;var qa=kA.exports;const AI=gA(qa);var PI,uE=qa;PI=uE.createRoot,uE.hydrateRoot;const KF=1,YF=1e6;let gv=0;function XF(){return gv=(gv+1)%Number.MAX_SAFE_INTEGER,gv.toString()}const mv=new Map,hE=n=>{if(mv.has(n))return;const e=setTimeout(()=>{mv.delete(n),th({type:"REMOVE_TOAST",toastId:n})},YF);mv.set(n,e)},QF=(n,e)=>{switch(e.type){case"ADD_TOAST":return{...n,toasts:[e.toast,...n.toasts].slice(0,KF)};case"UPDATE_TOAST":return{...n,toasts:n.toasts.map(t=>t.id===e.toast.id?{...t,...e.toast}:t)};case"DISMISS_TOAST":{const{toastId:t}=e;return t?hE(t):n.toasts.forEach(r=>{hE(r.id)}),{...n,toasts:n.toasts.map(r=>r.id===t||t===void 0?{...r,open:!1}:r)}}case"REMOVE_TOAST":return e.toastId===void 0?{...n,toasts:[]}:{...n,toasts:n.toasts.filter(t=>t.id!==e.toastId)}}},Tp=[];let Cp={toasts:[]};function th(n){Cp=QF(Cp,n),Tp.forEach(e=>{e(Cp)})}function JF({...n}){const e=XF(),t=s=>th({type:"UPDATE_TOAST",toast:{...s,id:e}}),r=()=>th({type:"DISMISS_TOAST",toastId:e});return th({type:"ADD_TOAST",toast:{...n,id:e,open:!0,onOpenChange:s=>{s||r()}}}),{id:e,dismiss:r,update:t}}function jo(){const[n,e]=C.useState(Cp);return C.useEffect(()=>(Tp.push(e),()=>{const t=Tp.indexOf(e);t>-1&&Tp.splice(t,1)}),[n]),{...n,toast:JF,dismiss:t=>th({type:"DISMISS_TOAST",toastId:t})}}function Se(n,e,{checkForDefaultPrevented:t=!0}={}){return function(s){if(n==null||n(s),t===!1||!s.defaultPrevented)return e==null?void 0:e(s)}}function dE(n,e){if(typeof n=="function")return n(e);n!=null&&(n.current=e)}function II(...n){return e=>{let t=!1;const r=n.map(s=>{const i=dE(s,e);return!t&&typeof i=="function"&&(t=!0),i});if(t)return()=>{for(let s=0;s<r.length;s++){const i=r[s];typeof i=="function"?i():dE(n[s],null)}}}}function ot(...n){return C.useCallback(II(...n),n)}function Lc(n,e=[]){let t=[];function r(i,o){const a=C.createContext(o),l=t.length;t=[...t,o];const c=h=>{var w;const{scope:f,children:p,...y}=h,m=((w=f==null?void 0:f[n])==null?void 0:w[l])||a,v=C.useMemo(()=>y,Object.values(y));return g.jsx(m.Provider,{value:v,children:p})};c.displayName=i+"Provider";function u(h,f){var m;const p=((m=f==null?void 0:f[n])==null?void 0:m[l])||a,y=C.useContext(p);if(y)return y;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return[c,u]}const s=()=>{const i=t.map(o=>C.createContext(o));return function(a){const l=(a==null?void 0:a[n])||i;return C.useMemo(()=>({[`__scope${n}`]:{...a,[n]:l}}),[a,l])}};return s.scopeName=n,[r,ZF(s,...e)]}function ZF(...n){const e=n[0];if(n.length===1)return e;const t=()=>{const r=n.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const o=r.reduce((a,{useScope:l,scopeName:c})=>{const h=l(i)[`__scope${c}`];return{...a,...h}},{});return C.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return t.scopeName=e.scopeName,t}function wc(n){const e=tV(n),t=C.forwardRef((r,s)=>{const{children:i,...o}=r,a=C.Children.toArray(i),l=a.find(rV);if(l){const c=l.props.children,u=a.map(h=>h===l?C.Children.count(c)>1?C.Children.only(null):C.isValidElement(c)?c.props.children:null:h);return g.jsx(e,{...o,ref:s,children:C.isValidElement(c)?C.cloneElement(c,void 0,u):null})}return g.jsx(e,{...o,ref:s,children:i})});return t.displayName=`${n}.Slot`,t}var eV=wc("Slot");function tV(n){const e=C.forwardRef((t,r)=>{const{children:s,...i}=t;if(C.isValidElement(s)){const o=iV(s),a=sV(i,s.props);return s.type!==C.Fragment&&(a.ref=r?II(r,o):o),C.cloneElement(s,a)}return C.Children.count(s)>1?C.Children.only(null):null});return e.displayName=`${n}.SlotClone`,e}var RI=Symbol("radix.slottable");function nV(n){const e=({children:t})=>g.jsx(g.Fragment,{children:t});return e.displayName=`${n}.Slottable`,e.__radixId=RI,e}function rV(n){return C.isValidElement(n)&&typeof n.type=="function"&&"__radixId"in n.type&&n.type.__radixId===RI}function sV(n,e){const t={...e};for(const r in e){const s=n[r],i=e[r];/^on[A-Z]/.test(r)?s&&i?t[r]=(...a)=>{const l=i(...a);return s(...a),l}:s&&(t[r]=s):r==="style"?t[r]={...s,...i}:r==="className"&&(t[r]=[s,i].filter(Boolean).join(" "))}return{...n,...t}}function iV(n){var r,s;let e=(r=Object.getOwnPropertyDescriptor(n.props,"ref"))==null?void 0:r.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?n.ref:(e=(s=Object.getOwnPropertyDescriptor(n,"ref"))==null?void 0:s.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?n.props.ref:n.props.ref||n.ref)}function OI(n){const e=n+"CollectionProvider",[t,r]=Lc(e),[s,i]=t(e,{collectionRef:{current:null},itemMap:new Map}),o=m=>{const{scope:v,children:w}=m,_=J.useRef(null),x=J.useRef(new Map).current;return g.jsx(s,{scope:v,itemMap:x,collectionRef:_,children:w})};o.displayName=e;const a=n+"CollectionSlot",l=wc(a),c=J.forwardRef((m,v)=>{const{scope:w,children:_}=m,x=i(a,w),A=ot(v,x.collectionRef);return g.jsx(l,{ref:A,children:_})});c.displayName=a;const u=n+"CollectionItemSlot",h="data-radix-collection-item",f=wc(u),p=J.forwardRef((m,v)=>{const{scope:w,children:_,...x}=m,A=J.useRef(null),j=ot(v,A),N=i(u,w);return J.useEffect(()=>(N.itemMap.set(A,{ref:A,...x}),()=>void N.itemMap.delete(A))),g.jsx(f,{[h]:"",ref:j,children:_})});p.displayName=u;function y(m){const v=i(n+"CollectionConsumer",m);return J.useCallback(()=>{const _=v.collectionRef.current;if(!_)return[];const x=Array.from(_.querySelectorAll(`[${h}]`));return Array.from(v.itemMap.values()).sort((N,S)=>x.indexOf(N.ref.current)-x.indexOf(S.ref.current))},[v.collectionRef,v.itemMap])}return[{Provider:o,Slot:c,ItemSlot:p},y,r]}var oV=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Ve=oV.reduce((n,e)=>{const t=wc(`Primitive.${e}`),r=C.forwardRef((s,i)=>{const{asChild:o,...a}=s,l=o?t:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),g.jsx(l,{...a,ref:i})});return r.displayName=`Primitive.${e}`,{...n,[e]:r}},{});function NI(n,e){n&&qa.flushSync(()=>n.dispatchEvent(e))}function Kr(n){const e=C.useRef(n);return C.useEffect(()=>{e.current=n}),C.useMemo(()=>(...t)=>{var r;return(r=e.current)==null?void 0:r.call(e,...t)},[])}function aV(n,e=globalThis==null?void 0:globalThis.document){const t=Kr(n);C.useEffect(()=>{const r=s=>{s.key==="Escape"&&t(s)};return e.addEventListener("keydown",r,{capture:!0}),()=>e.removeEventListener("keydown",r,{capture:!0})},[t,e])}var lV="DismissableLayer",iw="dismissableLayer.update",cV="dismissableLayer.pointerDownOutside",uV="dismissableLayer.focusOutside",fE,jI=C.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),dd=C.forwardRef((n,e)=>{const{disableOutsidePointerEvents:t=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:o,onDismiss:a,...l}=n,c=C.useContext(jI),[u,h]=C.useState(null),f=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,p]=C.useState({}),y=ot(e,S=>h(S)),m=Array.from(c.layers),[v]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),w=m.indexOf(v),_=u?m.indexOf(u):-1,x=c.layersWithOutsidePointerEventsDisabled.size>0,A=_>=w,j=dV(S=>{const T=S.target,P=[...c.branches].some(R=>R.contains(T));!A||P||(s==null||s(S),o==null||o(S),S.defaultPrevented||a==null||a())},f),N=fV(S=>{const T=S.target;[...c.branches].some(R=>R.contains(T))||(i==null||i(S),o==null||o(S),S.defaultPrevented||a==null||a())},f);return aV(S=>{_===c.layers.size-1&&(r==null||r(S),!S.defaultPrevented&&a&&(S.preventDefault(),a()))},f),C.useEffect(()=>{if(u)return t&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(fE=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),pE(),()=>{t&&c.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=fE)}},[u,f,t,c]),C.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),pE())},[u,c]),C.useEffect(()=>{const S=()=>p({});return document.addEventListener(iw,S),()=>document.removeEventListener(iw,S)},[]),g.jsx(Ve.div,{...l,ref:y,style:{pointerEvents:x?A?"auto":"none":void 0,...n.style},onFocusCapture:Se(n.onFocusCapture,N.onFocusCapture),onBlurCapture:Se(n.onBlurCapture,N.onBlurCapture),onPointerDownCapture:Se(n.onPointerDownCapture,j.onPointerDownCapture)})});dd.displayName=lV;var hV="DismissableLayerBranch",DI=C.forwardRef((n,e)=>{const t=C.useContext(jI),r=C.useRef(null),s=ot(e,r);return C.useEffect(()=>{const i=r.current;if(i)return t.branches.add(i),()=>{t.branches.delete(i)}},[t.branches]),g.jsx(Ve.div,{...n,ref:s})});DI.displayName=hV;function dV(n,e=globalThis==null?void 0:globalThis.document){const t=Kr(n),r=C.useRef(!1),s=C.useRef(()=>{});return C.useEffect(()=>{const i=a=>{if(a.target&&!r.current){let l=function(){MI(cV,t,c,{discrete:!0})};const c={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",s.current),s.current=l,e.addEventListener("click",s.current,{once:!0})):l()}else e.removeEventListener("click",s.current);r.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",i),e.removeEventListener("click",s.current)}},[e,t]),{onPointerDownCapture:()=>r.current=!0}}function fV(n,e=globalThis==null?void 0:globalThis.document){const t=Kr(n),r=C.useRef(!1);return C.useEffect(()=>{const s=i=>{i.target&&!r.current&&MI(uV,t,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",s),()=>e.removeEventListener("focusin",s)},[e,t]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function pE(){const n=new CustomEvent(iw);document.dispatchEvent(n)}function MI(n,e,t,{discrete:r}){const s=t.originalEvent.target,i=new CustomEvent(n,{bubbles:!1,cancelable:!0,detail:t});e&&s.addEventListener(n,e,{once:!0}),r?NI(s,i):s.dispatchEvent(i)}var pV=dd,gV=DI,Jt=globalThis!=null&&globalThis.document?C.useLayoutEffect:()=>{},mV="Portal",Sm=C.forwardRef((n,e)=>{var a;const{container:t,...r}=n,[s,i]=C.useState(!1);Jt(()=>i(!0),[]);const o=t||s&&((a=globalThis==null?void 0:globalThis.document)==null?void 0:a.body);return o?AI.createPortal(g.jsx(Ve.div,{...r,ref:e}),o):null});Sm.displayName=mV;function yV(n,e){return C.useReducer((t,r)=>e[t][r]??t,n)}var fd=n=>{const{present:e,children:t}=n,r=vV(e),s=typeof t=="function"?t({present:r.isPresent}):C.Children.only(t),i=ot(r.ref,wV(s));return typeof t=="function"||r.isPresent?C.cloneElement(s,{ref:i}):null};fd.displayName="Presence";function vV(n){const[e,t]=C.useState(),r=C.useRef(null),s=C.useRef(n),i=C.useRef("none"),o=n?"mounted":"unmounted",[a,l]=yV(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return C.useEffect(()=>{const c=mf(r.current);i.current=a==="mounted"?c:"none"},[a]),Jt(()=>{const c=r.current,u=s.current;if(u!==n){const f=i.current,p=mf(c);n?l("MOUNT"):p==="none"||(c==null?void 0:c.display)==="none"?l("UNMOUNT"):l(u&&f!==p?"ANIMATION_OUT":"UNMOUNT"),s.current=n}},[n,l]),Jt(()=>{if(e){let c;const u=e.ownerDocument.defaultView??window,h=p=>{const m=mf(r.current).includes(p.animationName);if(p.target===e&&m&&(l("ANIMATION_END"),!s.current)){const v=e.style.animationFillMode;e.style.animationFillMode="forwards",c=u.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=v)})}},f=p=>{p.target===e&&(i.current=mf(r.current))};return e.addEventListener("animationstart",f),e.addEventListener("animationcancel",h),e.addEventListener("animationend",h),()=>{u.clearTimeout(c),e.removeEventListener("animationstart",f),e.removeEventListener("animationcancel",h),e.removeEventListener("animationend",h)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:C.useCallback(c=>{r.current=c?getComputedStyle(c):null,t(c)},[])}}function mf(n){return(n==null?void 0:n.animationName)||"none"}function wV(n){var r,s;let e=(r=Object.getOwnPropertyDescriptor(n.props,"ref"))==null?void 0:r.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?n.ref:(e=(s=Object.getOwnPropertyDescriptor(n,"ref"))==null?void 0:s.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?n.props.ref:n.props.ref||n.ref)}var _V=L_[" useInsertionEffect ".trim().toString()]||Jt;function gg({prop:n,defaultProp:e,onChange:t=()=>{},caller:r}){const[s,i,o]=xV({defaultProp:e,onChange:t}),a=n!==void 0,l=a?n:s;{const u=C.useRef(n!==void 0);C.useEffect(()=>{const h=u.current;h!==a&&console.warn(`${r} is changing from ${h?"controlled":"uncontrolled"} to ${a?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),u.current=a},[a,r])}const c=C.useCallback(u=>{var h;if(a){const f=bV(u)?u(n):u;f!==n&&((h=o.current)==null||h.call(o,f))}else i(u)},[a,n,i,o]);return[l,c]}function xV({defaultProp:n,onChange:e}){const[t,r]=C.useState(n),s=C.useRef(t),i=C.useRef(e);return _V(()=>{i.current=e},[e]),C.useEffect(()=>{var o;s.current!==t&&((o=i.current)==null||o.call(i,t),s.current=t)},[t,s]),[t,r,i]}function bV(n){return typeof n=="function"}var LI=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),SV="VisuallyHidden",Em=C.forwardRef((n,e)=>g.jsx(Ve.span,{...n,ref:e,style:{...LI,...n.style}}));Em.displayName=SV;var EV=Em,Ax="ToastProvider",[Px,TV,CV]=OI("Toast"),[FI,wZ]=Lc("Toast",[CV]),[kV,Tm]=FI(Ax),VI=n=>{const{__scopeToast:e,label:t="Notification",duration:r=5e3,swipeDirection:s="right",swipeThreshold:i=50,children:o}=n,[a,l]=C.useState(null),[c,u]=C.useState(0),h=C.useRef(!1),f=C.useRef(!1);return t.trim()||console.error(`Invalid prop \`label\` supplied to \`${Ax}\`. Expected non-empty \`string\`.`),g.jsx(Px.Provider,{scope:e,children:g.jsx(kV,{scope:e,label:t,duration:r,swipeDirection:s,swipeThreshold:i,toastCount:c,viewport:a,onViewportChange:l,onToastAdd:C.useCallback(()=>u(p=>p+1),[]),onToastRemove:C.useCallback(()=>u(p=>p-1),[]),isFocusedToastEscapeKeyDownRef:h,isClosePausedRef:f,children:o})})};VI.displayName=Ax;var UI="ToastViewport",AV=["F8"],ow="toast.viewportPause",aw="toast.viewportResume",$I=C.forwardRef((n,e)=>{const{__scopeToast:t,hotkey:r=AV,label:s="Notifications ({hotkey})",...i}=n,o=Tm(UI,t),a=TV(t),l=C.useRef(null),c=C.useRef(null),u=C.useRef(null),h=C.useRef(null),f=ot(e,h,o.onViewportChange),p=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),y=o.toastCount>0;C.useEffect(()=>{const v=w=>{var x;r.length!==0&&r.every(A=>w[A]||w.code===A)&&((x=h.current)==null||x.focus())};return document.addEventListener("keydown",v),()=>document.removeEventListener("keydown",v)},[r]),C.useEffect(()=>{const v=l.current,w=h.current;if(y&&v&&w){const _=()=>{if(!o.isClosePausedRef.current){const N=new CustomEvent(ow);w.dispatchEvent(N),o.isClosePausedRef.current=!0}},x=()=>{if(o.isClosePausedRef.current){const N=new CustomEvent(aw);w.dispatchEvent(N),o.isClosePausedRef.current=!1}},A=N=>{!v.contains(N.relatedTarget)&&x()},j=()=>{v.contains(document.activeElement)||x()};return v.addEventListener("focusin",_),v.addEventListener("focusout",A),v.addEventListener("pointermove",_),v.addEventListener("pointerleave",j),window.addEventListener("blur",_),window.addEventListener("focus",x),()=>{v.removeEventListener("focusin",_),v.removeEventListener("focusout",A),v.removeEventListener("pointermove",_),v.removeEventListener("pointerleave",j),window.removeEventListener("blur",_),window.removeEventListener("focus",x)}}},[y,o.isClosePausedRef]);const m=C.useCallback(({tabbingDirection:v})=>{const _=a().map(x=>{const A=x.ref.current,j=[A,...$V(A)];return v==="forwards"?j:j.reverse()});return(v==="forwards"?_.reverse():_).flat()},[a]);return C.useEffect(()=>{const v=h.current;if(v){const w=_=>{var j,N,S;const x=_.altKey||_.ctrlKey||_.metaKey;if(_.key==="Tab"&&!x){const T=document.activeElement,P=_.shiftKey;if(_.target===v&&P){(j=c.current)==null||j.focus();return}const I=m({tabbingDirection:P?"backwards":"forwards"}),k=I.findIndex(F=>F===T);yv(I.slice(k+1))?_.preventDefault():P?(N=c.current)==null||N.focus():(S=u.current)==null||S.focus()}};return v.addEventListener("keydown",w),()=>v.removeEventListener("keydown",w)}},[a,m]),g.jsxs(gV,{ref:l,role:"region","aria-label":s.replace("{hotkey}",p),tabIndex:-1,style:{pointerEvents:y?void 0:"none"},children:[y&&g.jsx(lw,{ref:c,onFocusFromOutsideViewport:()=>{const v=m({tabbingDirection:"forwards"});yv(v)}}),g.jsx(Px.Slot,{scope:t,children:g.jsx(Ve.ol,{tabIndex:-1,...i,ref:f})}),y&&g.jsx(lw,{ref:u,onFocusFromOutsideViewport:()=>{const v=m({tabbingDirection:"backwards"});yv(v)}})]})});$I.displayName=UI;var BI="ToastFocusProxy",lw=C.forwardRef((n,e)=>{const{__scopeToast:t,onFocusFromOutsideViewport:r,...s}=n,i=Tm(BI,t);return g.jsx(Em,{"aria-hidden":!0,tabIndex:0,...s,ref:e,style:{position:"fixed"},onFocus:o=>{var c;const a=o.relatedTarget;!((c=i.viewport)!=null&&c.contains(a))&&r()}})});lw.displayName=BI;var pd="Toast",PV="toast.swipeStart",IV="toast.swipeMove",RV="toast.swipeCancel",OV="toast.swipeEnd",zI=C.forwardRef((n,e)=>{const{forceMount:t,open:r,defaultOpen:s,onOpenChange:i,...o}=n,[a,l]=gg({prop:r,defaultProp:s??!0,onChange:i,caller:pd});return g.jsx(fd,{present:t||a,children:g.jsx(DV,{open:a,...o,ref:e,onClose:()=>l(!1),onPause:Kr(n.onPause),onResume:Kr(n.onResume),onSwipeStart:Se(n.onSwipeStart,c=>{c.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:Se(n.onSwipeMove,c=>{const{x:u,y:h}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","move"),c.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${u}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${h}px`)}),onSwipeCancel:Se(n.onSwipeCancel,c=>{c.currentTarget.setAttribute("data-swipe","cancel"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:Se(n.onSwipeEnd,c=>{const{x:u,y:h}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","end"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${u}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${h}px`),l(!1)})})})});zI.displayName=pd;var[NV,jV]=FI(pd,{onClose(){}}),DV=C.forwardRef((n,e)=>{const{__scopeToast:t,type:r="foreground",duration:s,open:i,onClose:o,onEscapeKeyDown:a,onPause:l,onResume:c,onSwipeStart:u,onSwipeMove:h,onSwipeCancel:f,onSwipeEnd:p,...y}=n,m=Tm(pd,t),[v,w]=C.useState(null),_=ot(e,F=>w(F)),x=C.useRef(null),A=C.useRef(null),j=s||m.duration,N=C.useRef(0),S=C.useRef(j),T=C.useRef(0),{onToastAdd:P,onToastRemove:R}=m,D=Kr(()=>{var K;(v==null?void 0:v.contains(document.activeElement))&&((K=m.viewport)==null||K.focus()),o()}),I=C.useCallback(F=>{!F||F===1/0||(window.clearTimeout(T.current),N.current=new Date().getTime(),T.current=window.setTimeout(D,F))},[D]);C.useEffect(()=>{const F=m.viewport;if(F){const K=()=>{I(S.current),c==null||c()},G=()=>{const Y=new Date().getTime()-N.current;S.current=S.current-Y,window.clearTimeout(T.current),l==null||l()};return F.addEventListener(ow,G),F.addEventListener(aw,K),()=>{F.removeEventListener(ow,G),F.removeEventListener(aw,K)}}},[m.viewport,j,l,c,I]),C.useEffect(()=>{i&&!m.isClosePausedRef.current&&I(j)},[i,j,m.isClosePausedRef,I]),C.useEffect(()=>(P(),()=>R()),[P,R]);const k=C.useMemo(()=>v?XI(v):null,[v]);return m.viewport?g.jsxs(g.Fragment,{children:[k&&g.jsx(MV,{__scopeToast:t,role:"status","aria-live":r==="foreground"?"assertive":"polite","aria-atomic":!0,children:k}),g.jsx(NV,{scope:t,onClose:D,children:qa.createPortal(g.jsx(Px.ItemSlot,{scope:t,children:g.jsx(pV,{asChild:!0,onEscapeKeyDown:Se(a,()=>{m.isFocusedToastEscapeKeyDownRef.current||D(),m.isFocusedToastEscapeKeyDownRef.current=!1}),children:g.jsx(Ve.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":m.swipeDirection,...y,ref:_,style:{userSelect:"none",touchAction:"none",...n.style},onKeyDown:Se(n.onKeyDown,F=>{F.key==="Escape"&&(a==null||a(F.nativeEvent),F.nativeEvent.defaultPrevented||(m.isFocusedToastEscapeKeyDownRef.current=!0,D()))}),onPointerDown:Se(n.onPointerDown,F=>{F.button===0&&(x.current={x:F.clientX,y:F.clientY})}),onPointerMove:Se(n.onPointerMove,F=>{if(!x.current)return;const K=F.clientX-x.current.x,G=F.clientY-x.current.y,Y=!!A.current,V=["left","right"].includes(m.swipeDirection),z=["left","up"].includes(m.swipeDirection)?Math.min:Math.max,Q=V?z(0,K):0,ue=V?0:z(0,G),oe=F.pointerType==="touch"?10:2,fe={x:Q,y:ue},ce={originalEvent:F,delta:fe};Y?(A.current=fe,yf(IV,h,ce,{discrete:!1})):gE(fe,m.swipeDirection,oe)?(A.current=fe,yf(PV,u,ce,{discrete:!1}),F.target.setPointerCapture(F.pointerId)):(Math.abs(K)>oe||Math.abs(G)>oe)&&(x.current=null)}),onPointerUp:Se(n.onPointerUp,F=>{const K=A.current,G=F.target;if(G.hasPointerCapture(F.pointerId)&&G.releasePointerCapture(F.pointerId),A.current=null,x.current=null,K){const Y=F.currentTarget,V={originalEvent:F,delta:K};gE(K,m.swipeDirection,m.swipeThreshold)?yf(OV,p,V,{discrete:!0}):yf(RV,f,V,{discrete:!0}),Y.addEventListener("click",z=>z.preventDefault(),{once:!0})}})})})}),m.viewport)})]}):null}),MV=n=>{const{__scopeToast:e,children:t,...r}=n,s=Tm(pd,e),[i,o]=C.useState(!1),[a,l]=C.useState(!1);return VV(()=>o(!0)),C.useEffect(()=>{const c=window.setTimeout(()=>l(!0),1e3);return()=>window.clearTimeout(c)},[]),a?null:g.jsx(Sm,{asChild:!0,children:g.jsx(Em,{...r,children:i&&g.jsxs(g.Fragment,{children:[s.label," ",t]})})})},LV="ToastTitle",WI=C.forwardRef((n,e)=>{const{__scopeToast:t,...r}=n;return g.jsx(Ve.div,{...r,ref:e})});WI.displayName=LV;var FV="ToastDescription",HI=C.forwardRef((n,e)=>{const{__scopeToast:t,...r}=n;return g.jsx(Ve.div,{...r,ref:e})});HI.displayName=FV;var qI="ToastAction",GI=C.forwardRef((n,e)=>{const{altText:t,...r}=n;return t.trim()?g.jsx(YI,{altText:t,asChild:!0,children:g.jsx(Ix,{...r,ref:e})}):(console.error(`Invalid prop \`altText\` supplied to \`${qI}\`. Expected non-empty \`string\`.`),null)});GI.displayName=qI;var KI="ToastClose",Ix=C.forwardRef((n,e)=>{const{__scopeToast:t,...r}=n,s=jV(KI,t);return g.jsx(YI,{asChild:!0,children:g.jsx(Ve.button,{type:"button",...r,ref:e,onClick:Se(n.onClick,s.onClose)})})});Ix.displayName=KI;var YI=C.forwardRef((n,e)=>{const{__scopeToast:t,altText:r,...s}=n;return g.jsx(Ve.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0,...s,ref:e})});function XI(n){const e=[];return Array.from(n.childNodes).forEach(r=>{if(r.nodeType===r.TEXT_NODE&&r.textContent&&e.push(r.textContent),UV(r)){const s=r.ariaHidden||r.hidden||r.style.display==="none",i=r.dataset.radixToastAnnounceExclude==="";if(!s)if(i){const o=r.dataset.radixToastAnnounceAlt;o&&e.push(o)}else e.push(...XI(r))}}),e}function yf(n,e,t,{discrete:r}){const s=t.originalEvent.currentTarget,i=new CustomEvent(n,{bubbles:!0,cancelable:!0,detail:t});e&&s.addEventListener(n,e,{once:!0}),r?NI(s,i):s.dispatchEvent(i)}var gE=(n,e,t=0)=>{const r=Math.abs(n.x),s=Math.abs(n.y),i=r>s;return e==="left"||e==="right"?i&&r>t:!i&&s>t};function VV(n=()=>{}){const e=Kr(n);Jt(()=>{let t=0,r=0;return t=window.requestAnimationFrame(()=>r=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(t),window.cancelAnimationFrame(r)}},[e])}function UV(n){return n.nodeType===n.ELEMENT_NODE}function $V(n){const e=[],t=document.createTreeWalker(n,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;t.nextNode();)e.push(t.currentNode);return e}function yv(n){const e=document.activeElement;return n.some(t=>t===e?!0:(t.focus(),document.activeElement!==e))}var BV=VI,QI=$I,JI=zI,ZI=WI,eR=HI,tR=GI,nR=Ix;function rR(n){var e,t,r="";if(typeof n=="string"||typeof n=="number")r+=n;else if(typeof n=="object")if(Array.isArray(n)){var s=n.length;for(e=0;e<s;e++)n[e]&&(t=rR(n[e]))&&(r&&(r+=" "),r+=t)}else for(t in n)n[t]&&(r&&(r+=" "),r+=t);return r}function sR(){for(var n,e,t=0,r="",s=arguments.length;t<s;t++)(n=arguments[t])&&(e=rR(n))&&(r&&(r+=" "),r+=e);return r}const mE=n=>typeof n=="boolean"?`${n}`:n===0?"0":n,yE=sR,Rx=(n,e)=>t=>{var r;if((e==null?void 0:e.variants)==null)return yE(n,t==null?void 0:t.class,t==null?void 0:t.className);const{variants:s,defaultVariants:i}=e,o=Object.keys(s).map(c=>{const u=t==null?void 0:t[c],h=i==null?void 0:i[c];if(u===null)return null;const f=mE(u)||mE(h);return s[c][f]}),a=t&&Object.entries(t).reduce((c,u)=>{let[h,f]=u;return f===void 0||(c[h]=f),c},{}),l=e==null||(r=e.compoundVariants)===null||r===void 0?void 0:r.reduce((c,u)=>{let{class:h,className:f,...p}=u;return Object.entries(p).every(y=>{let[m,v]=y;return Array.isArray(v)?v.includes({...i,...a}[m]):{...i,...a}[m]===v})?[...c,h,f]:c},[]);return yE(n,o,l,t==null?void 0:t.class,t==null?void 0:t.className)};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zV=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),iR=(...n)=>n.filter((e,t,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===t).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var WV={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HV=C.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:s="",children:i,iconNode:o,...a},l)=>C.createElement("svg",{ref:l,...WV,width:e,height:e,stroke:n,strokeWidth:r?Number(t)*24/Number(e):t,className:iR("lucide",s),...a},[...o.map(([c,u])=>C.createElement(c,u)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=(n,e)=>{const t=C.forwardRef(({className:r,...s},i)=>C.createElement(HV,{ref:i,iconNode:e,className:iR(`lucide-${zV(n)}`,r),...s}));return t.displayName=`${n}`,t};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qV=de("AlignCenter",[["path",{d:"M17 12H7",key:"16if0g"}],["path",{d:"M19 18H5",key:"18s9l3"}],["path",{d:"M21 6H3",key:"1jwq7v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GV=de("AlignLeft",[["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 18H3",key:"1amg6g"}],["path",{d:"M21 6H3",key:"1jwq7v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KV=de("AlignRight",[["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M21 18H7",key:"1ygte8"}],["path",{d:"M21 6H3",key:"1jwq7v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vE=de("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YV=de("Bold",[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mg=de("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XV=de("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QV=de("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oR=de("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JV=de("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wE=de("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZV=de("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cw=de("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e5=de("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aR=de("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t5=de("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uw=de("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hw=de("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vf=de("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yg=de("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n5=de("ImagePlus",[["path",{d:"M16 5h6",key:"1vod17"}],["path",{d:"M19 2v6",key:"4bpg5p"}],["path",{d:"M21 11.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7.5",key:"1ue2ih"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r5=de("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s5=de("Italic",[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i5=de("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dw=de("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cm=de("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vg=de("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o5=de("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a5=de("MoveDown",[["path",{d:"M8 18L12 22L16 18",key:"cskvfv"}],["path",{d:"M12 2V22",key:"r89rzk"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l5=de("MoveUp",[["path",{d:"M8 6L12 2L16 6",key:"1yvkyx"}],["path",{d:"M12 2V22",key:"r89rzk"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c5=de("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _E=de("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u5=de("Printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h5=de("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d5=de("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f5=de("RotateCw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xE=de("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p5=de("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g5=de("Shapes",[["path",{d:"M8.3 10a.7.7 0 0 1-.626-1.079L11.4 3a.7.7 0 0 1 1.198-.043L16.3 8.9a.7.7 0 0 1-.572 1.1Z",key:"1bo67w"}],["rect",{x:"3",y:"14",width:"7",height:"7",rx:"1",key:"1bkyp8"}],["circle",{cx:"17.5",cy:"17.5",r:"3.5",key:"w3z12y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Na=de("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ui=de("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m5=de("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y5=de("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v5=de("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rh=de("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w5=de("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _5=de("Triangle",[["path",{d:"M13.73 4a2 2 0 0 0-3.46 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"14u9p9"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x5=de("Underline",[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bE=de("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fw=de("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SE=de("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lR=de("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Ox="-",b5=n=>{const e=E5(n),{conflictingClassGroups:t,conflictingClassGroupModifiers:r}=n;return{getClassGroupId:o=>{const a=o.split(Ox);return a[0]===""&&a.length!==1&&a.shift(),cR(a,e)||S5(o)},getConflictingClassGroupIds:(o,a)=>{const l=t[o]||[];return a&&r[o]?[...l,...r[o]]:l}}},cR=(n,e)=>{var o;if(n.length===0)return e.classGroupId;const t=n[0],r=e.nextPart.get(t),s=r?cR(n.slice(1),r):void 0;if(s)return s;if(e.validators.length===0)return;const i=n.join(Ox);return(o=e.validators.find(({validator:a})=>a(i)))==null?void 0:o.classGroupId},EE=/^\[(.+)\]$/,S5=n=>{if(EE.test(n)){const e=EE.exec(n)[1],t=e==null?void 0:e.substring(0,e.indexOf(":"));if(t)return"arbitrary.."+t}},E5=n=>{const{theme:e,prefix:t}=n,r={nextPart:new Map,validators:[]};return C5(Object.entries(n.classGroups),t).forEach(([i,o])=>{pw(o,r,i,e)}),r},pw=(n,e,t,r)=>{n.forEach(s=>{if(typeof s=="string"){const i=s===""?e:TE(e,s);i.classGroupId=t;return}if(typeof s=="function"){if(T5(s)){pw(s(r),e,t,r);return}e.validators.push({validator:s,classGroupId:t});return}Object.entries(s).forEach(([i,o])=>{pw(o,TE(e,i),t,r)})})},TE=(n,e)=>{let t=n;return e.split(Ox).forEach(r=>{t.nextPart.has(r)||t.nextPart.set(r,{nextPart:new Map,validators:[]}),t=t.nextPart.get(r)}),t},T5=n=>n.isThemeGetter,C5=(n,e)=>e?n.map(([t,r])=>{const s=r.map(i=>typeof i=="string"?e+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([o,a])=>[e+o,a])):i);return[t,s]}):n,k5=n=>{if(n<1)return{get:()=>{},set:()=>{}};let e=0,t=new Map,r=new Map;const s=(i,o)=>{t.set(i,o),e++,e>n&&(e=0,r=t,t=new Map)};return{get(i){let o=t.get(i);if(o!==void 0)return o;if((o=r.get(i))!==void 0)return s(i,o),o},set(i,o){t.has(i)?t.set(i,o):s(i,o)}}},uR="!",A5=n=>{const{separator:e,experimentalParseClassName:t}=n,r=e.length===1,s=e[0],i=e.length,o=a=>{const l=[];let c=0,u=0,h;for(let v=0;v<a.length;v++){let w=a[v];if(c===0){if(w===s&&(r||a.slice(v,v+i)===e)){l.push(a.slice(u,v)),u=v+i;continue}if(w==="/"){h=v;continue}}w==="["?c++:w==="]"&&c--}const f=l.length===0?a:a.substring(u),p=f.startsWith(uR),y=p?f.substring(1):f,m=h&&h>u?h-u:void 0;return{modifiers:l,hasImportantModifier:p,baseClassName:y,maybePostfixModifierPosition:m}};return t?a=>t({className:a,parseClassName:o}):o},P5=n=>{if(n.length<=1)return n;const e=[];let t=[];return n.forEach(r=>{r[0]==="["?(e.push(...t.sort(),r),t=[]):t.push(r)}),e.push(...t.sort()),e},I5=n=>({cache:k5(n.cacheSize),parseClassName:A5(n),...b5(n)}),R5=/\s+/,O5=(n,e)=>{const{parseClassName:t,getClassGroupId:r,getConflictingClassGroupIds:s}=e,i=[],o=n.trim().split(R5);let a="";for(let l=o.length-1;l>=0;l-=1){const c=o[l],{modifiers:u,hasImportantModifier:h,baseClassName:f,maybePostfixModifierPosition:p}=t(c);let y=!!p,m=r(y?f.substring(0,p):f);if(!m){if(!y){a=c+(a.length>0?" "+a:a);continue}if(m=r(f),!m){a=c+(a.length>0?" "+a:a);continue}y=!1}const v=P5(u).join(":"),w=h?v+uR:v,_=w+m;if(i.includes(_))continue;i.push(_);const x=s(m,y);for(let A=0;A<x.length;++A){const j=x[A];i.push(w+j)}a=c+(a.length>0?" "+a:a)}return a};function N5(){let n=0,e,t,r="";for(;n<arguments.length;)(e=arguments[n++])&&(t=hR(e))&&(r&&(r+=" "),r+=t);return r}const hR=n=>{if(typeof n=="string")return n;let e,t="";for(let r=0;r<n.length;r++)n[r]&&(e=hR(n[r]))&&(t&&(t+=" "),t+=e);return t};function j5(n,...e){let t,r,s,i=o;function o(l){const c=e.reduce((u,h)=>h(u),n());return t=I5(c),r=t.cache.get,s=t.cache.set,i=a,a(l)}function a(l){const c=r(l);if(c)return c;const u=O5(l,t);return s(l,u),u}return function(){return i(N5.apply(null,arguments))}}const et=n=>{const e=t=>t[n]||[];return e.isThemeGetter=!0,e},dR=/^\[(?:([a-z-]+):)?(.+)\]$/i,D5=/^\d+\/\d+$/,M5=new Set(["px","full","screen"]),L5=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,F5=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,V5=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,U5=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,$5=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Ds=n=>ql(n)||M5.has(n)||D5.test(n),Ii=n=>Fc(n,"length",Y5),ql=n=>!!n&&!Number.isNaN(Number(n)),vv=n=>Fc(n,"number",ql),Pu=n=>!!n&&Number.isInteger(Number(n)),B5=n=>n.endsWith("%")&&ql(n.slice(0,-1)),be=n=>dR.test(n),Ri=n=>L5.test(n),z5=new Set(["length","size","percentage"]),W5=n=>Fc(n,z5,fR),H5=n=>Fc(n,"position",fR),q5=new Set(["image","url"]),G5=n=>Fc(n,q5,Q5),K5=n=>Fc(n,"",X5),Iu=()=>!0,Fc=(n,e,t)=>{const r=dR.exec(n);return r?r[1]?typeof e=="string"?r[1]===e:e.has(r[1]):t(r[2]):!1},Y5=n=>F5.test(n)&&!V5.test(n),fR=()=>!1,X5=n=>U5.test(n),Q5=n=>$5.test(n),J5=()=>{const n=et("colors"),e=et("spacing"),t=et("blur"),r=et("brightness"),s=et("borderColor"),i=et("borderRadius"),o=et("borderSpacing"),a=et("borderWidth"),l=et("contrast"),c=et("grayscale"),u=et("hueRotate"),h=et("invert"),f=et("gap"),p=et("gradientColorStops"),y=et("gradientColorStopPositions"),m=et("inset"),v=et("margin"),w=et("opacity"),_=et("padding"),x=et("saturate"),A=et("scale"),j=et("sepia"),N=et("skew"),S=et("space"),T=et("translate"),P=()=>["auto","contain","none"],R=()=>["auto","hidden","clip","visible","scroll"],D=()=>["auto",be,e],I=()=>[be,e],k=()=>["",Ds,Ii],F=()=>["auto",ql,be],K=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],G=()=>["solid","dashed","dotted","double","none"],Y=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],V=()=>["start","end","center","between","around","evenly","stretch"],z=()=>["","0",be],Q=()=>["auto","avoid","all","avoid-page","page","left","right","column"],ue=()=>[ql,be];return{cacheSize:500,separator:":",theme:{colors:[Iu],spacing:[Ds,Ii],blur:["none","",Ri,be],brightness:ue(),borderColor:[n],borderRadius:["none","","full",Ri,be],borderSpacing:I(),borderWidth:k(),contrast:ue(),grayscale:z(),hueRotate:ue(),invert:z(),gap:I(),gradientColorStops:[n],gradientColorStopPositions:[B5,Ii],inset:D(),margin:D(),opacity:ue(),padding:I(),saturate:ue(),scale:ue(),sepia:z(),skew:ue(),space:I(),translate:I()},classGroups:{aspect:[{aspect:["auto","square","video",be]}],container:["container"],columns:[{columns:[Ri]}],"break-after":[{"break-after":Q()}],"break-before":[{"break-before":Q()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...K(),be]}],overflow:[{overflow:R()}],"overflow-x":[{"overflow-x":R()}],"overflow-y":[{"overflow-y":R()}],overscroll:[{overscroll:P()}],"overscroll-x":[{"overscroll-x":P()}],"overscroll-y":[{"overscroll-y":P()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[m]}],"inset-x":[{"inset-x":[m]}],"inset-y":[{"inset-y":[m]}],start:[{start:[m]}],end:[{end:[m]}],top:[{top:[m]}],right:[{right:[m]}],bottom:[{bottom:[m]}],left:[{left:[m]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Pu,be]}],basis:[{basis:D()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",be]}],grow:[{grow:z()}],shrink:[{shrink:z()}],order:[{order:["first","last","none",Pu,be]}],"grid-cols":[{"grid-cols":[Iu]}],"col-start-end":[{col:["auto",{span:["full",Pu,be]},be]}],"col-start":[{"col-start":F()}],"col-end":[{"col-end":F()}],"grid-rows":[{"grid-rows":[Iu]}],"row-start-end":[{row:["auto",{span:[Pu,be]},be]}],"row-start":[{"row-start":F()}],"row-end":[{"row-end":F()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",be]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",be]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",...V()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...V(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...V(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[_]}],px:[{px:[_]}],py:[{py:[_]}],ps:[{ps:[_]}],pe:[{pe:[_]}],pt:[{pt:[_]}],pr:[{pr:[_]}],pb:[{pb:[_]}],pl:[{pl:[_]}],m:[{m:[v]}],mx:[{mx:[v]}],my:[{my:[v]}],ms:[{ms:[v]}],me:[{me:[v]}],mt:[{mt:[v]}],mr:[{mr:[v]}],mb:[{mb:[v]}],ml:[{ml:[v]}],"space-x":[{"space-x":[S]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[S]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",be,e]}],"min-w":[{"min-w":[be,e,"min","max","fit"]}],"max-w":[{"max-w":[be,e,"none","full","min","max","fit","prose",{screen:[Ri]},Ri]}],h:[{h:[be,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[be,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[be,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[be,e,"auto","min","max","fit"]}],"font-size":[{text:["base",Ri,Ii]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",vv]}],"font-family":[{font:[Iu]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",be]}],"line-clamp":[{"line-clamp":["none",ql,vv]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Ds,be]}],"list-image":[{"list-image":["none",be]}],"list-style-type":[{list:["none","disc","decimal",be]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[n]}],"placeholder-opacity":[{"placeholder-opacity":[w]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[n]}],"text-opacity":[{"text-opacity":[w]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...G(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Ds,Ii]}],"underline-offset":[{"underline-offset":["auto",Ds,be]}],"text-decoration-color":[{decoration:[n]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:I()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",be]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",be]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[w]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...K(),H5]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",W5]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},G5]}],"bg-color":[{bg:[n]}],"gradient-from-pos":[{from:[y]}],"gradient-via-pos":[{via:[y]}],"gradient-to-pos":[{to:[y]}],"gradient-from":[{from:[p]}],"gradient-via":[{via:[p]}],"gradient-to":[{to:[p]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[a]}],"border-w-x":[{"border-x":[a]}],"border-w-y":[{"border-y":[a]}],"border-w-s":[{"border-s":[a]}],"border-w-e":[{"border-e":[a]}],"border-w-t":[{"border-t":[a]}],"border-w-r":[{"border-r":[a]}],"border-w-b":[{"border-b":[a]}],"border-w-l":[{"border-l":[a]}],"border-opacity":[{"border-opacity":[w]}],"border-style":[{border:[...G(),"hidden"]}],"divide-x":[{"divide-x":[a]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[a]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[w]}],"divide-style":[{divide:G()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-s":[{"border-s":[s]}],"border-color-e":[{"border-e":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:["",...G()]}],"outline-offset":[{"outline-offset":[Ds,be]}],"outline-w":[{outline:[Ds,Ii]}],"outline-color":[{outline:[n]}],"ring-w":[{ring:k()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[n]}],"ring-opacity":[{"ring-opacity":[w]}],"ring-offset-w":[{"ring-offset":[Ds,Ii]}],"ring-offset-color":[{"ring-offset":[n]}],shadow:[{shadow:["","inner","none",Ri,K5]}],"shadow-color":[{shadow:[Iu]}],opacity:[{opacity:[w]}],"mix-blend":[{"mix-blend":[...Y(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":Y()}],filter:[{filter:["","none"]}],blur:[{blur:[t]}],brightness:[{brightness:[r]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",Ri,be]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[h]}],saturate:[{saturate:[x]}],sepia:[{sepia:[j]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[t]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[w]}],"backdrop-saturate":[{"backdrop-saturate":[x]}],"backdrop-sepia":[{"backdrop-sepia":[j]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",be]}],duration:[{duration:ue()}],ease:[{ease:["linear","in","out","in-out",be]}],delay:[{delay:ue()}],animate:[{animate:["none","spin","ping","pulse","bounce",be]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[A]}],"scale-x":[{"scale-x":[A]}],"scale-y":[{"scale-y":[A]}],rotate:[{rotate:[Pu,be]}],"translate-x":[{"translate-x":[T]}],"translate-y":[{"translate-y":[T]}],"skew-x":[{"skew-x":[N]}],"skew-y":[{"skew-y":[N]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",be]}],accent:[{accent:["auto",n]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",be]}],"caret-color":[{caret:[n]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":I()}],"scroll-mx":[{"scroll-mx":I()}],"scroll-my":[{"scroll-my":I()}],"scroll-ms":[{"scroll-ms":I()}],"scroll-me":[{"scroll-me":I()}],"scroll-mt":[{"scroll-mt":I()}],"scroll-mr":[{"scroll-mr":I()}],"scroll-mb":[{"scroll-mb":I()}],"scroll-ml":[{"scroll-ml":I()}],"scroll-p":[{"scroll-p":I()}],"scroll-px":[{"scroll-px":I()}],"scroll-py":[{"scroll-py":I()}],"scroll-ps":[{"scroll-ps":I()}],"scroll-pe":[{"scroll-pe":I()}],"scroll-pt":[{"scroll-pt":I()}],"scroll-pr":[{"scroll-pr":I()}],"scroll-pb":[{"scroll-pb":I()}],"scroll-pl":[{"scroll-pl":I()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",be]}],fill:[{fill:[n,"none"]}],"stroke-w":[{stroke:[Ds,Ii,vv]}],stroke:[{stroke:[n,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},Z5=j5(J5);function Ge(...n){return Z5(sR(n))}const e3=BV,pR=C.forwardRef(({className:n,...e},t)=>g.jsx(QI,{ref:t,className:Ge("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",n),...e}));pR.displayName=QI.displayName;const t3=Rx("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),gR=C.forwardRef(({className:n,variant:e,...t},r)=>g.jsx(JI,{ref:r,className:Ge(t3({variant:e}),n),...t}));gR.displayName=JI.displayName;const n3=C.forwardRef(({className:n,...e},t)=>g.jsx(tR,{ref:t,className:Ge("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors group-[.destructive]:border-muted/40 hover:bg-secondary group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 group-[.destructive]:focus:ring-destructive disabled:pointer-events-none disabled:opacity-50",n),...e}));n3.displayName=tR.displayName;const mR=C.forwardRef(({className:n,...e},t)=>g.jsx(nR,{ref:t,className:Ge("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity group-hover:opacity-100 group-[.destructive]:text-red-300 hover:text-foreground group-[.destructive]:hover:text-red-50 focus:opacity-100 focus:outline-none focus:ring-2 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",n),"toast-close":"",...e,children:g.jsx(lR,{className:"h-4 w-4"})}));mR.displayName=nR.displayName;const yR=C.forwardRef(({className:n,...e},t)=>g.jsx(ZI,{ref:t,className:Ge("text-sm font-semibold",n),...e}));yR.displayName=ZI.displayName;const vR=C.forwardRef(({className:n,...e},t)=>g.jsx(eR,{ref:t,className:Ge("text-sm opacity-90",n),...e}));vR.displayName=eR.displayName;function r3(){const{toasts:n}=jo();return g.jsxs(e3,{children:[n.map(function({id:e,title:t,description:r,action:s,...i}){return g.jsxs(gR,{...i,children:[g.jsxs("div",{className:"grid gap-1",children:[t&&g.jsx(yR,{children:t}),r&&g.jsx(vR,{children:r})]}),s,g.jsx(mR,{})]},e)}),g.jsx(pR,{})]})}var CE=["light","dark"],s3="(prefers-color-scheme: dark)",i3=C.createContext(void 0),o3={setTheme:n=>{},themes:[]},a3=()=>{var n;return(n=C.useContext(i3))!=null?n:o3};C.memo(({forcedTheme:n,storageKey:e,attribute:t,enableSystem:r,enableColorScheme:s,defaultTheme:i,value:o,attrs:a,nonce:l})=>{let c=i==="system",u=t==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${a.map(y=>`'${y}'`).join(",")})`};`:`var d=document.documentElement,n='${t}',s='setAttribute';`,h=s?CE.includes(i)&&i?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${i}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",f=(y,m=!1,v=!0)=>{let w=o?o[y]:y,_=m?y+"|| ''":`'${w}'`,x="";return s&&v&&!m&&CE.includes(y)&&(x+=`d.style.colorScheme = '${y}';`),t==="class"?m||w?x+=`c.add(${_})`:x+="null":w&&(x+=`d[s](n,${_})`),x},p=n?`!function(){${u}${f(n)}}()`:r?`!function(){try{${u}var e=localStorage.getItem('${e}');if('system'===e||(!e&&${c})){var t='${s3}',m=window.matchMedia(t);if(m.media!==t||m.matches){${f("dark")}}else{${f("light")}}}else if(e){${o?`var x=${JSON.stringify(o)};`:""}${f(o?"x[e]":"e",!0)}}${c?"":"else{"+f(i,!1,!1)+"}"}${h}}catch(e){}}()`:`!function(){try{${u}var e=localStorage.getItem('${e}');if(e){${o?`var x=${JSON.stringify(o)};`:""}${f(o?"x[e]":"e",!0)}}else{${f(i,!1,!1)};}${h}}catch(t){}}();`;return C.createElement("script",{nonce:l,dangerouslySetInnerHTML:{__html:p}})});var l3=n=>{switch(n){case"success":return h3;case"info":return f3;case"warning":return d3;case"error":return p3;default:return null}},c3=Array(12).fill(0),u3=({visible:n,className:e})=>J.createElement("div",{className:["sonner-loading-wrapper",e].filter(Boolean).join(" "),"data-visible":n},J.createElement("div",{className:"sonner-spinner"},c3.map((t,r)=>J.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${r}`})))),h3=J.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},J.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),d3=J.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},J.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),f3=J.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},J.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),p3=J.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},J.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),g3=J.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},J.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),J.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),m3=()=>{let[n,e]=J.useState(document.hidden);return J.useEffect(()=>{let t=()=>{e(document.hidden)};return document.addEventListener("visibilitychange",t),()=>window.removeEventListener("visibilitychange",t)},[]),n},gw=1,y3=class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let t=this.subscribers.indexOf(e);this.subscribers.splice(t,1)}),this.publish=e=>{this.subscribers.forEach(t=>t(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var t;let{message:r,...s}=e,i=typeof(e==null?void 0:e.id)=="number"||((t=e.id)==null?void 0:t.length)>0?e.id:gw++,o=this.toasts.find(l=>l.id===i),a=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(i)&&this.dismissedToasts.delete(i),o?this.toasts=this.toasts.map(l=>l.id===i?(this.publish({...l,...e,id:i,title:r}),{...l,...e,id:i,dismissible:a,title:r}):l):this.addToast({title:r,...s,dismissible:a,id:i}),i},this.dismiss=e=>(this.dismissedToasts.add(e),e||this.toasts.forEach(t=>{this.subscribers.forEach(r=>r({id:t.id,dismiss:!0}))}),this.subscribers.forEach(t=>t({id:e,dismiss:!0})),e),this.message=(e,t)=>this.create({...t,message:e}),this.error=(e,t)=>this.create({...t,message:e,type:"error"}),this.success=(e,t)=>this.create({...t,type:"success",message:e}),this.info=(e,t)=>this.create({...t,type:"info",message:e}),this.warning=(e,t)=>this.create({...t,type:"warning",message:e}),this.loading=(e,t)=>this.create({...t,type:"loading",message:e}),this.promise=(e,t)=>{if(!t)return;let r;t.loading!==void 0&&(r=this.create({...t,promise:e,type:"loading",message:t.loading,description:typeof t.description!="function"?t.description:void 0}));let s=e instanceof Promise?e:e(),i=r!==void 0,o,a=s.then(async c=>{if(o=["resolve",c],J.isValidElement(c))i=!1,this.create({id:r,type:"default",message:c});else if(w3(c)&&!c.ok){i=!1;let u=typeof t.error=="function"?await t.error(`HTTP error! status: ${c.status}`):t.error,h=typeof t.description=="function"?await t.description(`HTTP error! status: ${c.status}`):t.description;this.create({id:r,type:"error",message:u,description:h})}else if(t.success!==void 0){i=!1;let u=typeof t.success=="function"?await t.success(c):t.success,h=typeof t.description=="function"?await t.description(c):t.description;this.create({id:r,type:"success",message:u,description:h})}}).catch(async c=>{if(o=["reject",c],t.error!==void 0){i=!1;let u=typeof t.error=="function"?await t.error(c):t.error,h=typeof t.description=="function"?await t.description(c):t.description;this.create({id:r,type:"error",message:u,description:h})}}).finally(()=>{var c;i&&(this.dismiss(r),r=void 0),(c=t.finally)==null||c.call(t)}),l=()=>new Promise((c,u)=>a.then(()=>o[0]==="reject"?u(o[1]):c(o[1])).catch(u));return typeof r!="string"&&typeof r!="number"?{unwrap:l}:Object.assign(r,{unwrap:l})},this.custom=(e,t)=>{let r=(t==null?void 0:t.id)||gw++;return this.create({jsx:e(r),id:r,...t}),r},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},kn=new y3,v3=(n,e)=>{let t=(e==null?void 0:e.id)||gw++;return kn.addToast({title:n,...e,id:t}),t},w3=n=>n&&typeof n=="object"&&"ok"in n&&typeof n.ok=="boolean"&&"status"in n&&typeof n.status=="number",_3=v3,x3=()=>kn.toasts,b3=()=>kn.getActiveToasts();Object.assign(_3,{success:kn.success,info:kn.info,warning:kn.warning,error:kn.error,custom:kn.custom,message:kn.message,promise:kn.promise,dismiss:kn.dismiss,loading:kn.loading},{getHistory:x3,getToasts:b3});function S3(n,{insertAt:e}={}){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",e==="top"&&t.firstChild?t.insertBefore(r,t.firstChild):t.appendChild(r),r.styleSheet?r.styleSheet.cssText=n:r.appendChild(document.createTextNode(n))}S3(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function wf(n){return n.label!==void 0}var E3=3,T3="32px",C3="16px",kE=4e3,k3=356,A3=14,P3=20,I3=200;function Er(...n){return n.filter(Boolean).join(" ")}function R3(n){let[e,t]=n.split("-"),r=[];return e&&r.push(e),t&&r.push(t),r}var O3=n=>{var e,t,r,s,i,o,a,l,c,u,h;let{invert:f,toast:p,unstyled:y,interacting:m,setHeights:v,visibleToasts:w,heights:_,index:x,toasts:A,expanded:j,removeToast:N,defaultRichColors:S,closeButton:T,style:P,cancelButtonStyle:R,actionButtonStyle:D,className:I="",descriptionClassName:k="",duration:F,position:K,gap:G,loadingIcon:Y,expandByDefault:V,classNames:z,icons:Q,closeButtonAriaLabel:ue="Close toast",pauseWhenPageIsHidden:oe}=n,[fe,ce]=J.useState(null),[Ne,je]=J.useState(null),[Z,Re]=J.useState(!1),[ze,xe]=J.useState(!1),[ke,Oe]=J.useState(!1),[bt,dn]=J.useState(!1),[Os,rr]=J.useState(!1),[_r,xi]=J.useState(0),[at,Ft]=J.useState(0),es=J.useRef(p.duration||F||kE),Fd=J.useRef(null),ts=J.useRef(null),Cy=x===0,Ho=x+1<=w,fn=p.type,Ns=p.dismissible!==!1,au=p.className||"",ky=p.descriptionClassName||"",Za=J.useMemo(()=>_.findIndex(ge=>ge.toastId===p.id)||0,[_,p.id]),Vd=J.useMemo(()=>{var ge;return(ge=p.closeButton)!=null?ge:T},[p.closeButton,T]),lu=J.useMemo(()=>p.duration||F||kE,[p.duration,F]),js=J.useRef(0),ns=J.useRef(0),el=J.useRef(0),Tn=J.useRef(null),[Ud,tl]=K.split("-"),cu=J.useMemo(()=>_.reduce((ge,Ue,Ke)=>Ke>=Za?ge:ge+Ue.height,0),[_,Za]),bi=m3(),$d=p.invert||f,It=fn==="loading";ns.current=J.useMemo(()=>Za*G+cu,[Za,cu]),J.useEffect(()=>{es.current=lu},[lu]),J.useEffect(()=>{Re(!0)},[]),J.useEffect(()=>{let ge=ts.current;if(ge){let Ue=ge.getBoundingClientRect().height;return Ft(Ue),v(Ke=>[{toastId:p.id,height:Ue,position:p.position},...Ke]),()=>v(Ke=>Ke.filter(Vt=>Vt.toastId!==p.id))}},[v,p.id]),J.useLayoutEffect(()=>{if(!Z)return;let ge=ts.current,Ue=ge.style.height;ge.style.height="auto";let Ke=ge.getBoundingClientRect().height;ge.style.height=Ue,Ft(Ke),v(Vt=>Vt.find(Un=>Un.toastId===p.id)?Vt.map(Un=>Un.toastId===p.id?{...Un,height:Ke}:Un):[{toastId:p.id,height:Ke,position:p.position},...Vt])},[Z,p.title,p.description,v,p.id]);let xr=J.useCallback(()=>{xe(!0),xi(ns.current),v(ge=>ge.filter(Ue=>Ue.toastId!==p.id)),setTimeout(()=>{N(p)},I3)},[p,N,v,ns]);J.useEffect(()=>{if(p.promise&&fn==="loading"||p.duration===1/0||p.type==="loading")return;let ge;return j||m||oe&&bi?(()=>{if(el.current<js.current){let Ue=new Date().getTime()-js.current;es.current=es.current-Ue}el.current=new Date().getTime()})():es.current!==1/0&&(js.current=new Date().getTime(),ge=setTimeout(()=>{var Ue;(Ue=p.onAutoClose)==null||Ue.call(p,p),xr()},es.current)),()=>clearTimeout(ge)},[j,m,p,fn,oe,bi,xr]),J.useEffect(()=>{p.delete&&xr()},[xr,p.delete]);function qo(){var ge,Ue,Ke;return Q!=null&&Q.loading?J.createElement("div",{className:Er(z==null?void 0:z.loader,(ge=p==null?void 0:p.classNames)==null?void 0:ge.loader,"sonner-loader"),"data-visible":fn==="loading"},Q.loading):Y?J.createElement("div",{className:Er(z==null?void 0:z.loader,(Ue=p==null?void 0:p.classNames)==null?void 0:Ue.loader,"sonner-loader"),"data-visible":fn==="loading"},Y):J.createElement(u3,{className:Er(z==null?void 0:z.loader,(Ke=p==null?void 0:p.classNames)==null?void 0:Ke.loader),visible:fn==="loading"})}return J.createElement("li",{tabIndex:0,ref:ts,className:Er(I,au,z==null?void 0:z.toast,(e=p==null?void 0:p.classNames)==null?void 0:e.toast,z==null?void 0:z.default,z==null?void 0:z[fn],(t=p==null?void 0:p.classNames)==null?void 0:t[fn]),"data-sonner-toast":"","data-rich-colors":(r=p.richColors)!=null?r:S,"data-styled":!(p.jsx||p.unstyled||y),"data-mounted":Z,"data-promise":!!p.promise,"data-swiped":Os,"data-removed":ze,"data-visible":Ho,"data-y-position":Ud,"data-x-position":tl,"data-index":x,"data-front":Cy,"data-swiping":ke,"data-dismissible":Ns,"data-type":fn,"data-invert":$d,"data-swipe-out":bt,"data-swipe-direction":Ne,"data-expanded":!!(j||V&&Z),style:{"--index":x,"--toasts-before":x,"--z-index":A.length-x,"--offset":`${ze?_r:ns.current}px`,"--initial-height":V?"auto":`${at}px`,...P,...p.style},onDragEnd:()=>{Oe(!1),ce(null),Tn.current=null},onPointerDown:ge=>{It||!Ns||(Fd.current=new Date,xi(ns.current),ge.target.setPointerCapture(ge.pointerId),ge.target.tagName!=="BUTTON"&&(Oe(!0),Tn.current={x:ge.clientX,y:ge.clientY}))},onPointerUp:()=>{var ge,Ue,Ke,Vt;if(bt||!Ns)return;Tn.current=null;let Un=Number(((ge=ts.current)==null?void 0:ge.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),rs=Number(((Ue=ts.current)==null?void 0:Ue.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),sr=new Date().getTime()-((Ke=Fd.current)==null?void 0:Ke.getTime()),Cn=fe==="x"?Un:rs,br=Math.abs(Cn)/sr;if(Math.abs(Cn)>=P3||br>.11){xi(ns.current),(Vt=p.onDismiss)==null||Vt.call(p,p),je(fe==="x"?Un>0?"right":"left":rs>0?"down":"up"),xr(),dn(!0),rr(!1);return}Oe(!1),ce(null)},onPointerMove:ge=>{var Ue,Ke,Vt,Un;if(!Tn.current||!Ns||((Ue=window.getSelection())==null?void 0:Ue.toString().length)>0)return;let rs=ge.clientY-Tn.current.y,sr=ge.clientX-Tn.current.x,Cn=(Ke=n.swipeDirections)!=null?Ke:R3(K);!fe&&(Math.abs(sr)>1||Math.abs(rs)>1)&&ce(Math.abs(sr)>Math.abs(rs)?"x":"y");let br={x:0,y:0};fe==="y"?(Cn.includes("top")||Cn.includes("bottom"))&&(Cn.includes("top")&&rs<0||Cn.includes("bottom")&&rs>0)&&(br.y=rs):fe==="x"&&(Cn.includes("left")||Cn.includes("right"))&&(Cn.includes("left")&&sr<0||Cn.includes("right")&&sr>0)&&(br.x=sr),(Math.abs(br.x)>0||Math.abs(br.y)>0)&&rr(!0),(Vt=ts.current)==null||Vt.style.setProperty("--swipe-amount-x",`${br.x}px`),(Un=ts.current)==null||Un.style.setProperty("--swipe-amount-y",`${br.y}px`)}},Vd&&!p.jsx?J.createElement("button",{"aria-label":ue,"data-disabled":It,"data-close-button":!0,onClick:It||!Ns?()=>{}:()=>{var ge;xr(),(ge=p.onDismiss)==null||ge.call(p,p)},className:Er(z==null?void 0:z.closeButton,(s=p==null?void 0:p.classNames)==null?void 0:s.closeButton)},(i=Q==null?void 0:Q.close)!=null?i:g3):null,p.jsx||C.isValidElement(p.title)?p.jsx?p.jsx:typeof p.title=="function"?p.title():p.title:J.createElement(J.Fragment,null,fn||p.icon||p.promise?J.createElement("div",{"data-icon":"",className:Er(z==null?void 0:z.icon,(o=p==null?void 0:p.classNames)==null?void 0:o.icon)},p.promise||p.type==="loading"&&!p.icon?p.icon||qo():null,p.type!=="loading"?p.icon||(Q==null?void 0:Q[fn])||l3(fn):null):null,J.createElement("div",{"data-content":"",className:Er(z==null?void 0:z.content,(a=p==null?void 0:p.classNames)==null?void 0:a.content)},J.createElement("div",{"data-title":"",className:Er(z==null?void 0:z.title,(l=p==null?void 0:p.classNames)==null?void 0:l.title)},typeof p.title=="function"?p.title():p.title),p.description?J.createElement("div",{"data-description":"",className:Er(k,ky,z==null?void 0:z.description,(c=p==null?void 0:p.classNames)==null?void 0:c.description)},typeof p.description=="function"?p.description():p.description):null),C.isValidElement(p.cancel)?p.cancel:p.cancel&&wf(p.cancel)?J.createElement("button",{"data-button":!0,"data-cancel":!0,style:p.cancelButtonStyle||R,onClick:ge=>{var Ue,Ke;wf(p.cancel)&&Ns&&((Ke=(Ue=p.cancel).onClick)==null||Ke.call(Ue,ge),xr())},className:Er(z==null?void 0:z.cancelButton,(u=p==null?void 0:p.classNames)==null?void 0:u.cancelButton)},p.cancel.label):null,C.isValidElement(p.action)?p.action:p.action&&wf(p.action)?J.createElement("button",{"data-button":!0,"data-action":!0,style:p.actionButtonStyle||D,onClick:ge=>{var Ue,Ke;wf(p.action)&&((Ke=(Ue=p.action).onClick)==null||Ke.call(Ue,ge),!ge.defaultPrevented&&xr())},className:Er(z==null?void 0:z.actionButton,(h=p==null?void 0:p.classNames)==null?void 0:h.actionButton)},p.action.label):null))};function AE(){if(typeof window>"u"||typeof document>"u")return"ltr";let n=document.documentElement.getAttribute("dir");return n==="auto"||!n?window.getComputedStyle(document.documentElement).direction:n}function N3(n,e){let t={};return[n,e].forEach((r,s)=>{let i=s===1,o=i?"--mobile-offset":"--offset",a=i?C3:T3;function l(c){["top","right","bottom","left"].forEach(u=>{t[`${o}-${u}`]=typeof c=="number"?`${c}px`:c})}typeof r=="number"||typeof r=="string"?l(r):typeof r=="object"?["top","right","bottom","left"].forEach(c=>{r[c]===void 0?t[`${o}-${c}`]=a:t[`${o}-${c}`]=typeof r[c]=="number"?`${r[c]}px`:r[c]}):l(a)}),t}var j3=C.forwardRef(function(n,e){let{invert:t,position:r="bottom-right",hotkey:s=["altKey","KeyT"],expand:i,closeButton:o,className:a,offset:l,mobileOffset:c,theme:u="light",richColors:h,duration:f,style:p,visibleToasts:y=E3,toastOptions:m,dir:v=AE(),gap:w=A3,loadingIcon:_,icons:x,containerAriaLabel:A="Notifications",pauseWhenPageIsHidden:j}=n,[N,S]=J.useState([]),T=J.useMemo(()=>Array.from(new Set([r].concat(N.filter(oe=>oe.position).map(oe=>oe.position)))),[N,r]),[P,R]=J.useState([]),[D,I]=J.useState(!1),[k,F]=J.useState(!1),[K,G]=J.useState(u!=="system"?u:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),Y=J.useRef(null),V=s.join("+").replace(/Key/g,"").replace(/Digit/g,""),z=J.useRef(null),Q=J.useRef(!1),ue=J.useCallback(oe=>{S(fe=>{var ce;return(ce=fe.find(Ne=>Ne.id===oe.id))!=null&&ce.delete||kn.dismiss(oe.id),fe.filter(({id:Ne})=>Ne!==oe.id)})},[]);return J.useEffect(()=>kn.subscribe(oe=>{if(oe.dismiss){S(fe=>fe.map(ce=>ce.id===oe.id?{...ce,delete:!0}:ce));return}setTimeout(()=>{AI.flushSync(()=>{S(fe=>{let ce=fe.findIndex(Ne=>Ne.id===oe.id);return ce!==-1?[...fe.slice(0,ce),{...fe[ce],...oe},...fe.slice(ce+1)]:[oe,...fe]})})})}),[]),J.useEffect(()=>{if(u!=="system"){G(u);return}if(u==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?G("dark"):G("light")),typeof window>"u")return;let oe=window.matchMedia("(prefers-color-scheme: dark)");try{oe.addEventListener("change",({matches:fe})=>{G(fe?"dark":"light")})}catch{oe.addListener(({matches:ce})=>{try{G(ce?"dark":"light")}catch(Ne){console.error(Ne)}})}},[u]),J.useEffect(()=>{N.length<=1&&I(!1)},[N]),J.useEffect(()=>{let oe=fe=>{var ce,Ne;s.every(je=>fe[je]||fe.code===je)&&(I(!0),(ce=Y.current)==null||ce.focus()),fe.code==="Escape"&&(document.activeElement===Y.current||(Ne=Y.current)!=null&&Ne.contains(document.activeElement))&&I(!1)};return document.addEventListener("keydown",oe),()=>document.removeEventListener("keydown",oe)},[s]),J.useEffect(()=>{if(Y.current)return()=>{z.current&&(z.current.focus({preventScroll:!0}),z.current=null,Q.current=!1)}},[Y.current]),J.createElement("section",{ref:e,"aria-label":`${A} ${V}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},T.map((oe,fe)=>{var ce;let[Ne,je]=oe.split("-");return N.length?J.createElement("ol",{key:oe,dir:v==="auto"?AE():v,tabIndex:-1,ref:Y,className:a,"data-sonner-toaster":!0,"data-theme":K,"data-y-position":Ne,"data-lifted":D&&N.length>1&&!i,"data-x-position":je,style:{"--front-toast-height":`${((ce=P[0])==null?void 0:ce.height)||0}px`,"--width":`${k3}px`,"--gap":`${w}px`,...p,...N3(l,c)},onBlur:Z=>{Q.current&&!Z.currentTarget.contains(Z.relatedTarget)&&(Q.current=!1,z.current&&(z.current.focus({preventScroll:!0}),z.current=null))},onFocus:Z=>{Z.target instanceof HTMLElement&&Z.target.dataset.dismissible==="false"||Q.current||(Q.current=!0,z.current=Z.relatedTarget)},onMouseEnter:()=>I(!0),onMouseMove:()=>I(!0),onMouseLeave:()=>{k||I(!1)},onDragEnd:()=>I(!1),onPointerDown:Z=>{Z.target instanceof HTMLElement&&Z.target.dataset.dismissible==="false"||F(!0)},onPointerUp:()=>F(!1)},N.filter(Z=>!Z.position&&fe===0||Z.position===oe).map((Z,Re)=>{var ze,xe;return J.createElement(O3,{key:Z.id,icons:x,index:Re,toast:Z,defaultRichColors:h,duration:(ze=m==null?void 0:m.duration)!=null?ze:f,className:m==null?void 0:m.className,descriptionClassName:m==null?void 0:m.descriptionClassName,invert:t,visibleToasts:y,closeButton:(xe=m==null?void 0:m.closeButton)!=null?xe:o,interacting:k,position:oe,style:m==null?void 0:m.style,unstyled:m==null?void 0:m.unstyled,classNames:m==null?void 0:m.classNames,cancelButtonStyle:m==null?void 0:m.cancelButtonStyle,actionButtonStyle:m==null?void 0:m.actionButtonStyle,removeToast:ue,toasts:N.filter(ke=>ke.position==Z.position),heights:P.filter(ke=>ke.position==Z.position),setHeights:R,expandByDefault:i,gap:w,loadingIcon:_,expanded:D,pauseWhenPageIsHidden:j,swipeDirections:n.swipeDirections})})):null}))});const D3=({...n})=>{const{theme:e="system"}=a3();return g.jsx(j3,{theme:e,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...n})};var M3=L_[" useId ".trim().toString()]||(()=>{}),L3=0;function km(n){const[e,t]=C.useState(M3());return Jt(()=>{t(r=>r??String(L3++))},[n]),e?`radix-${e}`:""}const F3=["top","right","bottom","left"],xo=Math.min,qn=Math.max,wg=Math.round,_f=Math.floor,ws=n=>({x:n,y:n}),V3={left:"right",right:"left",bottom:"top",top:"bottom"},U3={start:"end",end:"start"};function mw(n,e,t){return qn(n,xo(e,t))}function oi(n,e){return typeof n=="function"?n(e):n}function ai(n){return n.split("-")[0]}function Vc(n){return n.split("-")[1]}function Nx(n){return n==="x"?"y":"x"}function jx(n){return n==="y"?"height":"width"}const $3=new Set(["top","bottom"]);function gs(n){return $3.has(ai(n))?"y":"x"}function Dx(n){return Nx(gs(n))}function B3(n,e,t){t===void 0&&(t=!1);const r=Vc(n),s=Dx(n),i=jx(s);let o=s==="x"?r===(t?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(o=_g(o)),[o,_g(o)]}function z3(n){const e=_g(n);return[yw(n),e,yw(e)]}function yw(n){return n.replace(/start|end/g,e=>U3[e])}const PE=["left","right"],IE=["right","left"],W3=["top","bottom"],H3=["bottom","top"];function q3(n,e,t){switch(n){case"top":case"bottom":return t?e?IE:PE:e?PE:IE;case"left":case"right":return e?W3:H3;default:return[]}}function G3(n,e,t,r){const s=Vc(n);let i=q3(ai(n),t==="start",r);return s&&(i=i.map(o=>o+"-"+s),e&&(i=i.concat(i.map(yw)))),i}function _g(n){return n.replace(/left|right|bottom|top/g,e=>V3[e])}function K3(n){return{top:0,right:0,bottom:0,left:0,...n}}function wR(n){return typeof n!="number"?K3(n):{top:n,right:n,bottom:n,left:n}}function xg(n){const{x:e,y:t,width:r,height:s}=n;return{width:r,height:s,top:t,left:e,right:e+r,bottom:t+s,x:e,y:t}}function RE(n,e,t){let{reference:r,floating:s}=n;const i=gs(e),o=Dx(e),a=jx(o),l=ai(e),c=i==="y",u=r.x+r.width/2-s.width/2,h=r.y+r.height/2-s.height/2,f=r[a]/2-s[a]/2;let p;switch(l){case"top":p={x:u,y:r.y-s.height};break;case"bottom":p={x:u,y:r.y+r.height};break;case"right":p={x:r.x+r.width,y:h};break;case"left":p={x:r.x-s.width,y:h};break;default:p={x:r.x,y:r.y}}switch(Vc(e)){case"start":p[o]-=f*(t&&c?-1:1);break;case"end":p[o]+=f*(t&&c?-1:1);break}return p}const Y3=async(n,e,t)=>{const{placement:r="bottom",strategy:s="absolute",middleware:i=[],platform:o}=t,a=i.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(e));let c=await o.getElementRects({reference:n,floating:e,strategy:s}),{x:u,y:h}=RE(c,r,l),f=r,p={},y=0;for(let m=0;m<a.length;m++){const{name:v,fn:w}=a[m],{x:_,y:x,data:A,reset:j}=await w({x:u,y:h,initialPlacement:r,placement:f,strategy:s,middlewareData:p,rects:c,platform:o,elements:{reference:n,floating:e}});u=_??u,h=x??h,p={...p,[v]:{...p[v],...A}},j&&y<=50&&(y++,typeof j=="object"&&(j.placement&&(f=j.placement),j.rects&&(c=j.rects===!0?await o.getElementRects({reference:n,floating:e,strategy:s}):j.rects),{x:u,y:h}=RE(c,f,l)),m=-1)}return{x:u,y:h,placement:f,strategy:s,middlewareData:p}};async function Oh(n,e){var t;e===void 0&&(e={});const{x:r,y:s,platform:i,rects:o,elements:a,strategy:l}=n,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:h="floating",altBoundary:f=!1,padding:p=0}=oi(e,n),y=wR(p),v=a[f?h==="floating"?"reference":"floating":h],w=xg(await i.getClippingRect({element:(t=await(i.isElement==null?void 0:i.isElement(v)))==null||t?v:v.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),_=h==="floating"?{x:r,y:s,width:o.floating.width,height:o.floating.height}:o.reference,x=await(i.getOffsetParent==null?void 0:i.getOffsetParent(a.floating)),A=await(i.isElement==null?void 0:i.isElement(x))?await(i.getScale==null?void 0:i.getScale(x))||{x:1,y:1}:{x:1,y:1},j=xg(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:_,offsetParent:x,strategy:l}):_);return{top:(w.top-j.top+y.top)/A.y,bottom:(j.bottom-w.bottom+y.bottom)/A.y,left:(w.left-j.left+y.left)/A.x,right:(j.right-w.right+y.right)/A.x}}const X3=n=>({name:"arrow",options:n,async fn(e){const{x:t,y:r,placement:s,rects:i,platform:o,elements:a,middlewareData:l}=e,{element:c,padding:u=0}=oi(n,e)||{};if(c==null)return{};const h=wR(u),f={x:t,y:r},p=Dx(s),y=jx(p),m=await o.getDimensions(c),v=p==="y",w=v?"top":"left",_=v?"bottom":"right",x=v?"clientHeight":"clientWidth",A=i.reference[y]+i.reference[p]-f[p]-i.floating[y],j=f[p]-i.reference[p],N=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c));let S=N?N[x]:0;(!S||!await(o.isElement==null?void 0:o.isElement(N)))&&(S=a.floating[x]||i.floating[y]);const T=A/2-j/2,P=S/2-m[y]/2-1,R=xo(h[w],P),D=xo(h[_],P),I=R,k=S-m[y]-D,F=S/2-m[y]/2+T,K=mw(I,F,k),G=!l.arrow&&Vc(s)!=null&&F!==K&&i.reference[y]/2-(F<I?R:D)-m[y]/2<0,Y=G?F<I?F-I:F-k:0;return{[p]:f[p]+Y,data:{[p]:K,centerOffset:F-K-Y,...G&&{alignmentOffset:Y}},reset:G}}}),Q3=function(n){return n===void 0&&(n={}),{name:"flip",options:n,async fn(e){var t,r;const{placement:s,middlewareData:i,rects:o,initialPlacement:a,platform:l,elements:c}=e,{mainAxis:u=!0,crossAxis:h=!0,fallbackPlacements:f,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:y="none",flipAlignment:m=!0,...v}=oi(n,e);if((t=i.arrow)!=null&&t.alignmentOffset)return{};const w=ai(s),_=gs(a),x=ai(a)===a,A=await(l.isRTL==null?void 0:l.isRTL(c.floating)),j=f||(x||!m?[_g(a)]:z3(a)),N=y!=="none";!f&&N&&j.push(...G3(a,m,y,A));const S=[a,...j],T=await Oh(e,v),P=[];let R=((r=i.flip)==null?void 0:r.overflows)||[];if(u&&P.push(T[w]),h){const F=B3(s,o,A);P.push(T[F[0]],T[F[1]])}if(R=[...R,{placement:s,overflows:P}],!P.every(F=>F<=0)){var D,I;const F=(((D=i.flip)==null?void 0:D.index)||0)+1,K=S[F];if(K&&(!(h==="alignment"?_!==gs(K):!1)||R.every(V=>V.overflows[0]>0&&gs(V.placement)===_)))return{data:{index:F,overflows:R},reset:{placement:K}};let G=(I=R.filter(Y=>Y.overflows[0]<=0).sort((Y,V)=>Y.overflows[1]-V.overflows[1])[0])==null?void 0:I.placement;if(!G)switch(p){case"bestFit":{var k;const Y=(k=R.filter(V=>{if(N){const z=gs(V.placement);return z===_||z==="y"}return!0}).map(V=>[V.placement,V.overflows.filter(z=>z>0).reduce((z,Q)=>z+Q,0)]).sort((V,z)=>V[1]-z[1])[0])==null?void 0:k[0];Y&&(G=Y);break}case"initialPlacement":G=a;break}if(s!==G)return{reset:{placement:G}}}return{}}}};function OE(n,e){return{top:n.top-e.height,right:n.right-e.width,bottom:n.bottom-e.height,left:n.left-e.width}}function NE(n){return F3.some(e=>n[e]>=0)}const J3=function(n){return n===void 0&&(n={}),{name:"hide",options:n,async fn(e){const{rects:t}=e,{strategy:r="referenceHidden",...s}=oi(n,e);switch(r){case"referenceHidden":{const i=await Oh(e,{...s,elementContext:"reference"}),o=OE(i,t.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:NE(o)}}}case"escaped":{const i=await Oh(e,{...s,altBoundary:!0}),o=OE(i,t.floating);return{data:{escapedOffsets:o,escaped:NE(o)}}}default:return{}}}}},_R=new Set(["left","top"]);async function Z3(n,e){const{placement:t,platform:r,elements:s}=n,i=await(r.isRTL==null?void 0:r.isRTL(s.floating)),o=ai(t),a=Vc(t),l=gs(t)==="y",c=_R.has(o)?-1:1,u=i&&l?-1:1,h=oi(e,n);let{mainAxis:f,crossAxis:p,alignmentAxis:y}=typeof h=="number"?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:h.mainAxis||0,crossAxis:h.crossAxis||0,alignmentAxis:h.alignmentAxis};return a&&typeof y=="number"&&(p=a==="end"?y*-1:y),l?{x:p*u,y:f*c}:{x:f*c,y:p*u}}const eU=function(n){return n===void 0&&(n=0),{name:"offset",options:n,async fn(e){var t,r;const{x:s,y:i,placement:o,middlewareData:a}=e,l=await Z3(e,n);return o===((t=a.offset)==null?void 0:t.placement)&&(r=a.arrow)!=null&&r.alignmentOffset?{}:{x:s+l.x,y:i+l.y,data:{...l,placement:o}}}}},tU=function(n){return n===void 0&&(n={}),{name:"shift",options:n,async fn(e){const{x:t,y:r,placement:s}=e,{mainAxis:i=!0,crossAxis:o=!1,limiter:a={fn:v=>{let{x:w,y:_}=v;return{x:w,y:_}}},...l}=oi(n,e),c={x:t,y:r},u=await Oh(e,l),h=gs(ai(s)),f=Nx(h);let p=c[f],y=c[h];if(i){const v=f==="y"?"top":"left",w=f==="y"?"bottom":"right",_=p+u[v],x=p-u[w];p=mw(_,p,x)}if(o){const v=h==="y"?"top":"left",w=h==="y"?"bottom":"right",_=y+u[v],x=y-u[w];y=mw(_,y,x)}const m=a.fn({...e,[f]:p,[h]:y});return{...m,data:{x:m.x-t,y:m.y-r,enabled:{[f]:i,[h]:o}}}}}},nU=function(n){return n===void 0&&(n={}),{options:n,fn(e){const{x:t,y:r,placement:s,rects:i,middlewareData:o}=e,{offset:a=0,mainAxis:l=!0,crossAxis:c=!0}=oi(n,e),u={x:t,y:r},h=gs(s),f=Nx(h);let p=u[f],y=u[h];const m=oi(a,e),v=typeof m=="number"?{mainAxis:m,crossAxis:0}:{mainAxis:0,crossAxis:0,...m};if(l){const x=f==="y"?"height":"width",A=i.reference[f]-i.floating[x]+v.mainAxis,j=i.reference[f]+i.reference[x]-v.mainAxis;p<A?p=A:p>j&&(p=j)}if(c){var w,_;const x=f==="y"?"width":"height",A=_R.has(ai(s)),j=i.reference[h]-i.floating[x]+(A&&((w=o.offset)==null?void 0:w[h])||0)+(A?0:v.crossAxis),N=i.reference[h]+i.reference[x]+(A?0:((_=o.offset)==null?void 0:_[h])||0)-(A?v.crossAxis:0);y<j?y=j:y>N&&(y=N)}return{[f]:p,[h]:y}}}},rU=function(n){return n===void 0&&(n={}),{name:"size",options:n,async fn(e){var t,r;const{placement:s,rects:i,platform:o,elements:a}=e,{apply:l=()=>{},...c}=oi(n,e),u=await Oh(e,c),h=ai(s),f=Vc(s),p=gs(s)==="y",{width:y,height:m}=i.floating;let v,w;h==="top"||h==="bottom"?(v=h,w=f===(await(o.isRTL==null?void 0:o.isRTL(a.floating))?"start":"end")?"left":"right"):(w=h,v=f==="end"?"top":"bottom");const _=m-u.top-u.bottom,x=y-u.left-u.right,A=xo(m-u[v],_),j=xo(y-u[w],x),N=!e.middlewareData.shift;let S=A,T=j;if((t=e.middlewareData.shift)!=null&&t.enabled.x&&(T=x),(r=e.middlewareData.shift)!=null&&r.enabled.y&&(S=_),N&&!f){const R=qn(u.left,0),D=qn(u.right,0),I=qn(u.top,0),k=qn(u.bottom,0);p?T=y-2*(R!==0||D!==0?R+D:qn(u.left,u.right)):S=m-2*(I!==0||k!==0?I+k:qn(u.top,u.bottom))}await l({...e,availableWidth:T,availableHeight:S});const P=await o.getDimensions(a.floating);return y!==P.width||m!==P.height?{reset:{rects:!0}}:{}}}};function Am(){return typeof window<"u"}function Uc(n){return xR(n)?(n.nodeName||"").toLowerCase():"#document"}function Zn(n){var e;return(n==null||(e=n.ownerDocument)==null?void 0:e.defaultView)||window}function Ps(n){var e;return(e=(xR(n)?n.ownerDocument:n.document)||window.document)==null?void 0:e.documentElement}function xR(n){return Am()?n instanceof Node||n instanceof Zn(n).Node:!1}function Yr(n){return Am()?n instanceof Element||n instanceof Zn(n).Element:!1}function Cs(n){return Am()?n instanceof HTMLElement||n instanceof Zn(n).HTMLElement:!1}function jE(n){return!Am()||typeof ShadowRoot>"u"?!1:n instanceof ShadowRoot||n instanceof Zn(n).ShadowRoot}const sU=new Set(["inline","contents"]);function gd(n){const{overflow:e,overflowX:t,overflowY:r,display:s}=Xr(n);return/auto|scroll|overlay|hidden|clip/.test(e+r+t)&&!sU.has(s)}const iU=new Set(["table","td","th"]);function oU(n){return iU.has(Uc(n))}const aU=[":popover-open",":modal"];function Pm(n){return aU.some(e=>{try{return n.matches(e)}catch{return!1}})}const lU=["transform","translate","scale","rotate","perspective"],cU=["transform","translate","scale","rotate","perspective","filter"],uU=["paint","layout","strict","content"];function Mx(n){const e=Lx(),t=Yr(n)?Xr(n):n;return lU.some(r=>t[r]?t[r]!=="none":!1)||(t.containerType?t.containerType!=="normal":!1)||!e&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!e&&(t.filter?t.filter!=="none":!1)||cU.some(r=>(t.willChange||"").includes(r))||uU.some(r=>(t.contain||"").includes(r))}function hU(n){let e=bo(n);for(;Cs(e)&&!_c(e);){if(Mx(e))return e;if(Pm(e))return null;e=bo(e)}return null}function Lx(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const dU=new Set(["html","body","#document"]);function _c(n){return dU.has(Uc(n))}function Xr(n){return Zn(n).getComputedStyle(n)}function Im(n){return Yr(n)?{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}:{scrollLeft:n.scrollX,scrollTop:n.scrollY}}function bo(n){if(Uc(n)==="html")return n;const e=n.assignedSlot||n.parentNode||jE(n)&&n.host||Ps(n);return jE(e)?e.host:e}function bR(n){const e=bo(n);return _c(e)?n.ownerDocument?n.ownerDocument.body:n.body:Cs(e)&&gd(e)?e:bR(e)}function Nh(n,e,t){var r;e===void 0&&(e=[]),t===void 0&&(t=!0);const s=bR(n),i=s===((r=n.ownerDocument)==null?void 0:r.body),o=Zn(s);if(i){const a=vw(o);return e.concat(o,o.visualViewport||[],gd(s)?s:[],a&&t?Nh(a):[])}return e.concat(s,Nh(s,[],t))}function vw(n){return n.parent&&Object.getPrototypeOf(n.parent)?n.frameElement:null}function SR(n){const e=Xr(n);let t=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const s=Cs(n),i=s?n.offsetWidth:t,o=s?n.offsetHeight:r,a=wg(t)!==i||wg(r)!==o;return a&&(t=i,r=o),{width:t,height:r,$:a}}function Fx(n){return Yr(n)?n:n.contextElement}function Gl(n){const e=Fx(n);if(!Cs(e))return ws(1);const t=e.getBoundingClientRect(),{width:r,height:s,$:i}=SR(e);let o=(i?wg(t.width):t.width)/r,a=(i?wg(t.height):t.height)/s;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const fU=ws(0);function ER(n){const e=Zn(n);return!Lx()||!e.visualViewport?fU:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function pU(n,e,t){return e===void 0&&(e=!1),!t||e&&t!==Zn(n)?!1:e}function ja(n,e,t,r){e===void 0&&(e=!1),t===void 0&&(t=!1);const s=n.getBoundingClientRect(),i=Fx(n);let o=ws(1);e&&(r?Yr(r)&&(o=Gl(r)):o=Gl(n));const a=pU(i,t,r)?ER(i):ws(0);let l=(s.left+a.x)/o.x,c=(s.top+a.y)/o.y,u=s.width/o.x,h=s.height/o.y;if(i){const f=Zn(i),p=r&&Yr(r)?Zn(r):r;let y=f,m=vw(y);for(;m&&r&&p!==y;){const v=Gl(m),w=m.getBoundingClientRect(),_=Xr(m),x=w.left+(m.clientLeft+parseFloat(_.paddingLeft))*v.x,A=w.top+(m.clientTop+parseFloat(_.paddingTop))*v.y;l*=v.x,c*=v.y,u*=v.x,h*=v.y,l+=x,c+=A,y=Zn(m),m=vw(y)}}return xg({width:u,height:h,x:l,y:c})}function Vx(n,e){const t=Im(n).scrollLeft;return e?e.left+t:ja(Ps(n)).left+t}function TR(n,e,t){t===void 0&&(t=!1);const r=n.getBoundingClientRect(),s=r.left+e.scrollLeft-(t?0:Vx(n,r)),i=r.top+e.scrollTop;return{x:s,y:i}}function gU(n){let{elements:e,rect:t,offsetParent:r,strategy:s}=n;const i=s==="fixed",o=Ps(r),a=e?Pm(e.floating):!1;if(r===o||a&&i)return t;let l={scrollLeft:0,scrollTop:0},c=ws(1);const u=ws(0),h=Cs(r);if((h||!h&&!i)&&((Uc(r)!=="body"||gd(o))&&(l=Im(r)),Cs(r))){const p=ja(r);c=Gl(r),u.x=p.x+r.clientLeft,u.y=p.y+r.clientTop}const f=o&&!h&&!i?TR(o,l,!0):ws(0);return{width:t.width*c.x,height:t.height*c.y,x:t.x*c.x-l.scrollLeft*c.x+u.x+f.x,y:t.y*c.y-l.scrollTop*c.y+u.y+f.y}}function mU(n){return Array.from(n.getClientRects())}function yU(n){const e=Ps(n),t=Im(n),r=n.ownerDocument.body,s=qn(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),i=qn(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let o=-t.scrollLeft+Vx(n);const a=-t.scrollTop;return Xr(r).direction==="rtl"&&(o+=qn(e.clientWidth,r.clientWidth)-s),{width:s,height:i,x:o,y:a}}function vU(n,e){const t=Zn(n),r=Ps(n),s=t.visualViewport;let i=r.clientWidth,o=r.clientHeight,a=0,l=0;if(s){i=s.width,o=s.height;const c=Lx();(!c||c&&e==="fixed")&&(a=s.offsetLeft,l=s.offsetTop)}return{width:i,height:o,x:a,y:l}}const wU=new Set(["absolute","fixed"]);function _U(n,e){const t=ja(n,!0,e==="fixed"),r=t.top+n.clientTop,s=t.left+n.clientLeft,i=Cs(n)?Gl(n):ws(1),o=n.clientWidth*i.x,a=n.clientHeight*i.y,l=s*i.x,c=r*i.y;return{width:o,height:a,x:l,y:c}}function DE(n,e,t){let r;if(e==="viewport")r=vU(n,t);else if(e==="document")r=yU(Ps(n));else if(Yr(e))r=_U(e,t);else{const s=ER(n);r={x:e.x-s.x,y:e.y-s.y,width:e.width,height:e.height}}return xg(r)}function CR(n,e){const t=bo(n);return t===e||!Yr(t)||_c(t)?!1:Xr(t).position==="fixed"||CR(t,e)}function xU(n,e){const t=e.get(n);if(t)return t;let r=Nh(n,[],!1).filter(a=>Yr(a)&&Uc(a)!=="body"),s=null;const i=Xr(n).position==="fixed";let o=i?bo(n):n;for(;Yr(o)&&!_c(o);){const a=Xr(o),l=Mx(o);!l&&a.position==="fixed"&&(s=null),(i?!l&&!s:!l&&a.position==="static"&&!!s&&wU.has(s.position)||gd(o)&&!l&&CR(n,o))?r=r.filter(u=>u!==o):s=a,o=bo(o)}return e.set(n,r),r}function bU(n){let{element:e,boundary:t,rootBoundary:r,strategy:s}=n;const o=[...t==="clippingAncestors"?Pm(e)?[]:xU(e,this._c):[].concat(t),r],a=o[0],l=o.reduce((c,u)=>{const h=DE(e,u,s);return c.top=qn(h.top,c.top),c.right=xo(h.right,c.right),c.bottom=xo(h.bottom,c.bottom),c.left=qn(h.left,c.left),c},DE(e,a,s));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function SU(n){const{width:e,height:t}=SR(n);return{width:e,height:t}}function EU(n,e,t){const r=Cs(e),s=Ps(e),i=t==="fixed",o=ja(n,!0,i,e);let a={scrollLeft:0,scrollTop:0};const l=ws(0);function c(){l.x=Vx(s)}if(r||!r&&!i)if((Uc(e)!=="body"||gd(s))&&(a=Im(e)),r){const p=ja(e,!0,i,e);l.x=p.x+e.clientLeft,l.y=p.y+e.clientTop}else s&&c();i&&!r&&s&&c();const u=s&&!r&&!i?TR(s,a):ws(0),h=o.left+a.scrollLeft-l.x-u.x,f=o.top+a.scrollTop-l.y-u.y;return{x:h,y:f,width:o.width,height:o.height}}function wv(n){return Xr(n).position==="static"}function ME(n,e){if(!Cs(n)||Xr(n).position==="fixed")return null;if(e)return e(n);let t=n.offsetParent;return Ps(n)===t&&(t=t.ownerDocument.body),t}function kR(n,e){const t=Zn(n);if(Pm(n))return t;if(!Cs(n)){let s=bo(n);for(;s&&!_c(s);){if(Yr(s)&&!wv(s))return s;s=bo(s)}return t}let r=ME(n,e);for(;r&&oU(r)&&wv(r);)r=ME(r,e);return r&&_c(r)&&wv(r)&&!Mx(r)?t:r||hU(n)||t}const TU=async function(n){const e=this.getOffsetParent||kR,t=this.getDimensions,r=await t(n.floating);return{reference:EU(n.reference,await e(n.floating),n.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function CU(n){return Xr(n).direction==="rtl"}const kU={convertOffsetParentRelativeRectToViewportRelativeRect:gU,getDocumentElement:Ps,getClippingRect:bU,getOffsetParent:kR,getElementRects:TU,getClientRects:mU,getDimensions:SU,getScale:Gl,isElement:Yr,isRTL:CU};function AR(n,e){return n.x===e.x&&n.y===e.y&&n.width===e.width&&n.height===e.height}function AU(n,e){let t=null,r;const s=Ps(n);function i(){var a;clearTimeout(r),(a=t)==null||a.disconnect(),t=null}function o(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),i();const c=n.getBoundingClientRect(),{left:u,top:h,width:f,height:p}=c;if(a||e(),!f||!p)return;const y=_f(h),m=_f(s.clientWidth-(u+f)),v=_f(s.clientHeight-(h+p)),w=_f(u),x={rootMargin:-y+"px "+-m+"px "+-v+"px "+-w+"px",threshold:qn(0,xo(1,l))||1};let A=!0;function j(N){const S=N[0].intersectionRatio;if(S!==l){if(!A)return o();S?o(!1,S):r=setTimeout(()=>{o(!1,1e-7)},1e3)}S===1&&!AR(c,n.getBoundingClientRect())&&o(),A=!1}try{t=new IntersectionObserver(j,{...x,root:s.ownerDocument})}catch{t=new IntersectionObserver(j,x)}t.observe(n)}return o(!0),i}function PU(n,e,t,r){r===void 0&&(r={});const{ancestorScroll:s=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=r,c=Fx(n),u=s||i?[...c?Nh(c):[],...Nh(e)]:[];u.forEach(w=>{s&&w.addEventListener("scroll",t,{passive:!0}),i&&w.addEventListener("resize",t)});const h=c&&a?AU(c,t):null;let f=-1,p=null;o&&(p=new ResizeObserver(w=>{let[_]=w;_&&_.target===c&&p&&(p.unobserve(e),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var x;(x=p)==null||x.observe(e)})),t()}),c&&!l&&p.observe(c),p.observe(e));let y,m=l?ja(n):null;l&&v();function v(){const w=ja(n);m&&!AR(m,w)&&t(),m=w,y=requestAnimationFrame(v)}return t(),()=>{var w;u.forEach(_=>{s&&_.removeEventListener("scroll",t),i&&_.removeEventListener("resize",t)}),h==null||h(),(w=p)==null||w.disconnect(),p=null,l&&cancelAnimationFrame(y)}}const IU=eU,RU=tU,OU=Q3,NU=rU,jU=J3,LE=X3,DU=nU,MU=(n,e,t)=>{const r=new Map,s={platform:kU,...t},i={...s.platform,_c:r};return Y3(n,e,{...s,platform:i})};var LU=typeof document<"u",FU=function(){},kp=LU?C.useLayoutEffect:FU;function bg(n,e){if(n===e)return!0;if(typeof n!=typeof e)return!1;if(typeof n=="function"&&n.toString()===e.toString())return!0;let t,r,s;if(n&&e&&typeof n=="object"){if(Array.isArray(n)){if(t=n.length,t!==e.length)return!1;for(r=t;r--!==0;)if(!bg(n[r],e[r]))return!1;return!0}if(s=Object.keys(n),t=s.length,t!==Object.keys(e).length)return!1;for(r=t;r--!==0;)if(!{}.hasOwnProperty.call(e,s[r]))return!1;for(r=t;r--!==0;){const i=s[r];if(!(i==="_owner"&&n.$$typeof)&&!bg(n[i],e[i]))return!1}return!0}return n!==n&&e!==e}function PR(n){return typeof window>"u"?1:(n.ownerDocument.defaultView||window).devicePixelRatio||1}function FE(n,e){const t=PR(n);return Math.round(e*t)/t}function _v(n){const e=C.useRef(n);return kp(()=>{e.current=n}),e}function VU(n){n===void 0&&(n={});const{placement:e="bottom",strategy:t="absolute",middleware:r=[],platform:s,elements:{reference:i,floating:o}={},transform:a=!0,whileElementsMounted:l,open:c}=n,[u,h]=C.useState({x:0,y:0,strategy:t,placement:e,middlewareData:{},isPositioned:!1}),[f,p]=C.useState(r);bg(f,r)||p(r);const[y,m]=C.useState(null),[v,w]=C.useState(null),_=C.useCallback(V=>{V!==N.current&&(N.current=V,m(V))},[]),x=C.useCallback(V=>{V!==S.current&&(S.current=V,w(V))},[]),A=i||y,j=o||v,N=C.useRef(null),S=C.useRef(null),T=C.useRef(u),P=l!=null,R=_v(l),D=_v(s),I=_v(c),k=C.useCallback(()=>{if(!N.current||!S.current)return;const V={placement:e,strategy:t,middleware:f};D.current&&(V.platform=D.current),MU(N.current,S.current,V).then(z=>{const Q={...z,isPositioned:I.current!==!1};F.current&&!bg(T.current,Q)&&(T.current=Q,qa.flushSync(()=>{h(Q)}))})},[f,e,t,D,I]);kp(()=>{c===!1&&T.current.isPositioned&&(T.current.isPositioned=!1,h(V=>({...V,isPositioned:!1})))},[c]);const F=C.useRef(!1);kp(()=>(F.current=!0,()=>{F.current=!1}),[]),kp(()=>{if(A&&(N.current=A),j&&(S.current=j),A&&j){if(R.current)return R.current(A,j,k);k()}},[A,j,k,R,P]);const K=C.useMemo(()=>({reference:N,floating:S,setReference:_,setFloating:x}),[_,x]),G=C.useMemo(()=>({reference:A,floating:j}),[A,j]),Y=C.useMemo(()=>{const V={position:t,left:0,top:0};if(!G.floating)return V;const z=FE(G.floating,u.x),Q=FE(G.floating,u.y);return a?{...V,transform:"translate("+z+"px, "+Q+"px)",...PR(G.floating)>=1.5&&{willChange:"transform"}}:{position:t,left:z,top:Q}},[t,a,G.floating,u.x,u.y]);return C.useMemo(()=>({...u,update:k,refs:K,elements:G,floatingStyles:Y}),[u,k,K,G,Y])}const UU=n=>{function e(t){return{}.hasOwnProperty.call(t,"current")}return{name:"arrow",options:n,fn(t){const{element:r,padding:s}=typeof n=="function"?n(t):n;return r&&e(r)?r.current!=null?LE({element:r.current,padding:s}).fn(t):{}:r?LE({element:r,padding:s}).fn(t):{}}}},$U=(n,e)=>({...IU(n),options:[n,e]}),BU=(n,e)=>({...RU(n),options:[n,e]}),zU=(n,e)=>({...DU(n),options:[n,e]}),WU=(n,e)=>({...OU(n),options:[n,e]}),HU=(n,e)=>({...NU(n),options:[n,e]}),qU=(n,e)=>({...jU(n),options:[n,e]}),GU=(n,e)=>({...UU(n),options:[n,e]});var KU="Arrow",IR=C.forwardRef((n,e)=>{const{children:t,width:r=10,height:s=5,...i}=n;return g.jsx(Ve.svg,{...i,ref:e,width:r,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:n.asChild?t:g.jsx("polygon",{points:"0,0 30,0 15,10"})})});IR.displayName=KU;var YU=IR;function XU(n){const[e,t]=C.useState(void 0);return Jt(()=>{if(n){t({width:n.offsetWidth,height:n.offsetHeight});const r=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let o,a;if("borderBoxSize"in i){const l=i.borderBoxSize,c=Array.isArray(l)?l[0]:l;o=c.inlineSize,a=c.blockSize}else o=n.offsetWidth,a=n.offsetHeight;t({width:o,height:a})});return r.observe(n,{box:"border-box"}),()=>r.unobserve(n)}else t(void 0)},[n]),e}var Ux="Popper",[RR,$c]=Lc(Ux),[QU,OR]=RR(Ux),NR=n=>{const{__scopePopper:e,children:t}=n,[r,s]=C.useState(null);return g.jsx(QU,{scope:e,anchor:r,onAnchorChange:s,children:t})};NR.displayName=Ux;var jR="PopperAnchor",DR=C.forwardRef((n,e)=>{const{__scopePopper:t,virtualRef:r,...s}=n,i=OR(jR,t),o=C.useRef(null),a=ot(e,o);return C.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||o.current)}),r?null:g.jsx(Ve.div,{...s,ref:a})});DR.displayName=jR;var $x="PopperContent",[JU,ZU]=RR($x),MR=C.forwardRef((n,e)=>{var Z,Re,ze,xe,ke,Oe;const{__scopePopper:t,side:r="bottom",sideOffset:s=0,align:i="center",alignOffset:o=0,arrowPadding:a=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:h="partial",hideWhenDetached:f=!1,updatePositionStrategy:p="optimized",onPlaced:y,...m}=n,v=OR($x,t),[w,_]=C.useState(null),x=ot(e,bt=>_(bt)),[A,j]=C.useState(null),N=XU(A),S=(N==null?void 0:N.width)??0,T=(N==null?void 0:N.height)??0,P=r+(i!=="center"?"-"+i:""),R=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},D=Array.isArray(c)?c:[c],I=D.length>0,k={padding:R,boundary:D.filter(t$),altBoundary:I},{refs:F,floatingStyles:K,placement:G,isPositioned:Y,middlewareData:V}=VU({strategy:"fixed",placement:P,whileElementsMounted:(...bt)=>PU(...bt,{animationFrame:p==="always"}),elements:{reference:v.anchor},middleware:[$U({mainAxis:s+T,alignmentAxis:o}),l&&BU({mainAxis:!0,crossAxis:!1,limiter:h==="partial"?zU():void 0,...k}),l&&WU({...k}),HU({...k,apply:({elements:bt,rects:dn,availableWidth:Os,availableHeight:rr})=>{const{width:_r,height:xi}=dn.reference,at=bt.floating.style;at.setProperty("--radix-popper-available-width",`${Os}px`),at.setProperty("--radix-popper-available-height",`${rr}px`),at.setProperty("--radix-popper-anchor-width",`${_r}px`),at.setProperty("--radix-popper-anchor-height",`${xi}px`)}}),A&&GU({element:A,padding:a}),n$({arrowWidth:S,arrowHeight:T}),f&&qU({strategy:"referenceHidden",...k})]}),[z,Q]=VR(G),ue=Kr(y);Jt(()=>{Y&&(ue==null||ue())},[Y,ue]);const oe=(Z=V.arrow)==null?void 0:Z.x,fe=(Re=V.arrow)==null?void 0:Re.y,ce=((ze=V.arrow)==null?void 0:ze.centerOffset)!==0,[Ne,je]=C.useState();return Jt(()=>{w&&je(window.getComputedStyle(w).zIndex)},[w]),g.jsx("div",{ref:F.setFloating,"data-radix-popper-content-wrapper":"",style:{...K,transform:Y?K.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:Ne,"--radix-popper-transform-origin":[(xe=V.transformOrigin)==null?void 0:xe.x,(ke=V.transformOrigin)==null?void 0:ke.y].join(" "),...((Oe=V.hide)==null?void 0:Oe.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:n.dir,children:g.jsx(JU,{scope:t,placedSide:z,onArrowChange:j,arrowX:oe,arrowY:fe,shouldHideArrow:ce,children:g.jsx(Ve.div,{"data-side":z,"data-align":Q,...m,ref:x,style:{...m.style,animation:Y?void 0:"none"}})})})});MR.displayName=$x;var LR="PopperArrow",e$={top:"bottom",right:"left",bottom:"top",left:"right"},FR=C.forwardRef(function(e,t){const{__scopePopper:r,...s}=e,i=ZU(LR,r),o=e$[i.placedSide];return g.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:g.jsx(YU,{...s,ref:t,style:{...s.style,display:"block"}})})});FR.displayName=LR;function t$(n){return n!==null}var n$=n=>({name:"transformOrigin",options:n,fn(e){var v,w,_;const{placement:t,rects:r,middlewareData:s}=e,o=((v=s.arrow)==null?void 0:v.centerOffset)!==0,a=o?0:n.arrowWidth,l=o?0:n.arrowHeight,[c,u]=VR(t),h={start:"0%",center:"50%",end:"100%"}[u],f=(((w=s.arrow)==null?void 0:w.x)??0)+a/2,p=(((_=s.arrow)==null?void 0:_.y)??0)+l/2;let y="",m="";return c==="bottom"?(y=o?h:`${f}px`,m=`${-l}px`):c==="top"?(y=o?h:`${f}px`,m=`${r.floating.height+l}px`):c==="right"?(y=`${-l}px`,m=o?h:`${p}px`):c==="left"&&(y=`${r.floating.width+l}px`,m=o?h:`${p}px`),{data:{x:y,y:m}}}});function VR(n){const[e,t="center"]=n.split("-");return[e,t]}var UR=NR,Rm=DR,Bx=MR,zx=FR,[Om,xZ]=Lc("Tooltip",[$c]),Wx=$c(),$R="TooltipProvider",r$=700,VE="tooltip.open",[s$,BR]=Om($R),zR=n=>{const{__scopeTooltip:e,delayDuration:t=r$,skipDelayDuration:r=300,disableHoverableContent:s=!1,children:i}=n,o=C.useRef(!0),a=C.useRef(!1),l=C.useRef(0);return C.useEffect(()=>{const c=l.current;return()=>window.clearTimeout(c)},[]),g.jsx(s$,{scope:e,isOpenDelayedRef:o,delayDuration:t,onOpen:C.useCallback(()=>{window.clearTimeout(l.current),o.current=!1},[]),onClose:C.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>o.current=!0,r)},[r]),isPointerInTransitRef:a,onPointerInTransitChange:C.useCallback(c=>{a.current=c},[]),disableHoverableContent:s,children:i})};zR.displayName=$R;var WR="Tooltip",[bZ,Nm]=Om(WR),ww="TooltipTrigger",i$=C.forwardRef((n,e)=>{const{__scopeTooltip:t,...r}=n,s=Nm(ww,t),i=BR(ww,t),o=Wx(t),a=C.useRef(null),l=ot(e,a,s.onTriggerChange),c=C.useRef(!1),u=C.useRef(!1),h=C.useCallback(()=>c.current=!1,[]);return C.useEffect(()=>()=>document.removeEventListener("pointerup",h),[h]),g.jsx(Rm,{asChild:!0,...o,children:g.jsx(Ve.button,{"aria-describedby":s.open?s.contentId:void 0,"data-state":s.stateAttribute,...r,ref:l,onPointerMove:Se(n.onPointerMove,f=>{f.pointerType!=="touch"&&!u.current&&!i.isPointerInTransitRef.current&&(s.onTriggerEnter(),u.current=!0)}),onPointerLeave:Se(n.onPointerLeave,()=>{s.onTriggerLeave(),u.current=!1}),onPointerDown:Se(n.onPointerDown,()=>{s.open&&s.onClose(),c.current=!0,document.addEventListener("pointerup",h,{once:!0})}),onFocus:Se(n.onFocus,()=>{c.current||s.onOpen()}),onBlur:Se(n.onBlur,s.onClose),onClick:Se(n.onClick,s.onClose)})})});i$.displayName=ww;var o$="TooltipPortal",[SZ,a$]=Om(o$,{forceMount:void 0}),xc="TooltipContent",HR=C.forwardRef((n,e)=>{const t=a$(xc,n.__scopeTooltip),{forceMount:r=t.forceMount,side:s="top",...i}=n,o=Nm(xc,n.__scopeTooltip);return g.jsx(fd,{present:r||o.open,children:o.disableHoverableContent?g.jsx(qR,{side:s,...i,ref:e}):g.jsx(l$,{side:s,...i,ref:e})})}),l$=C.forwardRef((n,e)=>{const t=Nm(xc,n.__scopeTooltip),r=BR(xc,n.__scopeTooltip),s=C.useRef(null),i=ot(e,s),[o,a]=C.useState(null),{trigger:l,onClose:c}=t,u=s.current,{onPointerInTransitChange:h}=r,f=C.useCallback(()=>{a(null),h(!1)},[h]),p=C.useCallback((y,m)=>{const v=y.currentTarget,w={x:y.clientX,y:y.clientY},_=f$(w,v.getBoundingClientRect()),x=p$(w,_),A=g$(m.getBoundingClientRect()),j=y$([...x,...A]);a(j),h(!0)},[h]);return C.useEffect(()=>()=>f(),[f]),C.useEffect(()=>{if(l&&u){const y=v=>p(v,u),m=v=>p(v,l);return l.addEventListener("pointerleave",y),u.addEventListener("pointerleave",m),()=>{l.removeEventListener("pointerleave",y),u.removeEventListener("pointerleave",m)}}},[l,u,p,f]),C.useEffect(()=>{if(o){const y=m=>{const v=m.target,w={x:m.clientX,y:m.clientY},_=(l==null?void 0:l.contains(v))||(u==null?void 0:u.contains(v)),x=!m$(w,o);_?f():x&&(f(),c())};return document.addEventListener("pointermove",y),()=>document.removeEventListener("pointermove",y)}},[l,u,o,c,f]),g.jsx(qR,{...n,ref:i})}),[c$,u$]=Om(WR,{isInside:!1}),h$=nV("TooltipContent"),qR=C.forwardRef((n,e)=>{const{__scopeTooltip:t,children:r,"aria-label":s,onEscapeKeyDown:i,onPointerDownOutside:o,...a}=n,l=Nm(xc,t),c=Wx(t),{onClose:u}=l;return C.useEffect(()=>(document.addEventListener(VE,u),()=>document.removeEventListener(VE,u)),[u]),C.useEffect(()=>{if(l.trigger){const h=f=>{const p=f.target;p!=null&&p.contains(l.trigger)&&u()};return window.addEventListener("scroll",h,{capture:!0}),()=>window.removeEventListener("scroll",h,{capture:!0})}},[l.trigger,u]),g.jsx(dd,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:h=>h.preventDefault(),onDismiss:u,children:g.jsxs(Bx,{"data-state":l.stateAttribute,...c,...a,ref:e,style:{...a.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[g.jsx(h$,{children:r}),g.jsx(c$,{scope:t,isInside:!0,children:g.jsx(EV,{id:l.contentId,role:"tooltip",children:s||r})})]})})});HR.displayName=xc;var GR="TooltipArrow",d$=C.forwardRef((n,e)=>{const{__scopeTooltip:t,...r}=n,s=Wx(t);return u$(GR,t).isInside?null:g.jsx(zx,{...s,...r,ref:e})});d$.displayName=GR;function f$(n,e){const t=Math.abs(e.top-n.y),r=Math.abs(e.bottom-n.y),s=Math.abs(e.right-n.x),i=Math.abs(e.left-n.x);switch(Math.min(t,r,s,i)){case i:return"left";case s:return"right";case t:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function p$(n,e,t=5){const r=[];switch(e){case"top":r.push({x:n.x-t,y:n.y+t},{x:n.x+t,y:n.y+t});break;case"bottom":r.push({x:n.x-t,y:n.y-t},{x:n.x+t,y:n.y-t});break;case"left":r.push({x:n.x+t,y:n.y-t},{x:n.x+t,y:n.y+t});break;case"right":r.push({x:n.x-t,y:n.y-t},{x:n.x-t,y:n.y+t});break}return r}function g$(n){const{top:e,right:t,bottom:r,left:s}=n;return[{x:s,y:e},{x:t,y:e},{x:t,y:r},{x:s,y:r}]}function m$(n,e){const{x:t,y:r}=n;let s=!1;for(let i=0,o=e.length-1;i<e.length;o=i++){const a=e[i],l=e[o],c=a.x,u=a.y,h=l.x,f=l.y;u>r!=f>r&&t<(h-c)*(r-u)/(f-u)+c&&(s=!s)}return s}function y$(n){const e=n.slice();return e.sort((t,r)=>t.x<r.x?-1:t.x>r.x?1:t.y<r.y?-1:t.y>r.y?1:0),v$(e)}function v$(n){if(n.length<=1)return n.slice();const e=[];for(let r=0;r<n.length;r++){const s=n[r];for(;e.length>=2;){const i=e[e.length-1],o=e[e.length-2];if((i.x-o.x)*(s.y-o.y)>=(i.y-o.y)*(s.x-o.x))e.pop();else break}e.push(s)}e.pop();const t=[];for(let r=n.length-1;r>=0;r--){const s=n[r];for(;t.length>=2;){const i=t[t.length-1],o=t[t.length-2];if((i.x-o.x)*(s.y-o.y)>=(i.y-o.y)*(s.x-o.x))t.pop();else break}t.push(s)}return t.pop(),e.length===1&&t.length===1&&e[0].x===t[0].x&&e[0].y===t[0].y?e:e.concat(t)}var w$=zR,KR=HR;const _$=w$,x$=C.forwardRef(({className:n,sideOffset:e=4,...t},r)=>g.jsx(KR,{ref:r,sideOffset:e,className:Ge("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n),...t}));x$.displayName=KR.displayName;var jm=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(n){return this.listeners.add(n),this.onSubscribe(),()=>{this.listeners.delete(n),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Dm=typeof window>"u"||"Deno"in globalThis;function Rr(){}function b$(n,e){return typeof n=="function"?n(e):n}function S$(n){return typeof n=="number"&&n>=0&&n!==1/0}function E$(n,e){return Math.max(n+(e||0)-Date.now(),0)}function _w(n,e){return typeof n=="function"?n(e):n}function T$(n,e){return typeof n=="function"?n(e):n}function UE(n,e){const{type:t="all",exact:r,fetchStatus:s,predicate:i,queryKey:o,stale:a}=n;if(o){if(r){if(e.queryHash!==Hx(o,e.options))return!1}else if(!Dh(e.queryKey,o))return!1}if(t!=="all"){const l=e.isActive();if(t==="active"&&!l||t==="inactive"&&l)return!1}return!(typeof a=="boolean"&&e.isStale()!==a||s&&s!==e.state.fetchStatus||i&&!i(e))}function $E(n,e){const{exact:t,status:r,predicate:s,mutationKey:i}=n;if(i){if(!e.options.mutationKey)return!1;if(t){if(jh(e.options.mutationKey)!==jh(i))return!1}else if(!Dh(e.options.mutationKey,i))return!1}return!(r&&e.state.status!==r||s&&!s(e))}function Hx(n,e){return((e==null?void 0:e.queryKeyHashFn)||jh)(n)}function jh(n){return JSON.stringify(n,(e,t)=>xw(t)?Object.keys(t).sort().reduce((r,s)=>(r[s]=t[s],r),{}):t)}function Dh(n,e){return n===e?!0:typeof n!=typeof e?!1:n&&e&&typeof n=="object"&&typeof e=="object"?Object.keys(e).every(t=>Dh(n[t],e[t])):!1}function YR(n,e){if(n===e)return n;const t=BE(n)&&BE(e);if(t||xw(n)&&xw(e)){const r=t?n:Object.keys(n),s=r.length,i=t?e:Object.keys(e),o=i.length,a=t?[]:{},l=new Set(r);let c=0;for(let u=0;u<o;u++){const h=t?u:i[u];(!t&&l.has(h)||t)&&n[h]===void 0&&e[h]===void 0?(a[h]=void 0,c++):(a[h]=YR(n[h],e[h]),a[h]===n[h]&&n[h]!==void 0&&c++)}return s===o&&c===s?n:a}return e}function BE(n){return Array.isArray(n)&&n.length===Object.keys(n).length}function xw(n){if(!zE(n))return!1;const e=n.constructor;if(e===void 0)return!0;const t=e.prototype;return!(!zE(t)||!t.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(n)!==Object.prototype)}function zE(n){return Object.prototype.toString.call(n)==="[object Object]"}function C$(n){return new Promise(e=>{setTimeout(e,n)})}function k$(n,e,t){return typeof t.structuralSharing=="function"?t.structuralSharing(n,e):t.structuralSharing!==!1?YR(n,e):e}function A$(n,e,t=0){const r=[...n,e];return t&&r.length>t?r.slice(1):r}function P$(n,e,t=0){const r=[e,...n];return t&&r.length>t?r.slice(0,-1):r}var qx=Symbol();function XR(n,e){return!n.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!n.queryFn||n.queryFn===qx?()=>Promise.reject(new Error(`Missing queryFn: '${n.queryHash}'`)):n.queryFn}var ga,Yi,sc,oA,I$=(oA=class extends jm{constructor(){super();Fe(this,ga);Fe(this,Yi);Fe(this,sc);_e(this,sc,e=>{if(!Dm&&window.addEventListener){const t=()=>e();return window.addEventListener("visibilitychange",t,!1),()=>{window.removeEventListener("visibilitychange",t)}}})}onSubscribe(){W(this,Yi)||this.setEventListener(W(this,sc))}onUnsubscribe(){var e;this.hasListeners()||((e=W(this,Yi))==null||e.call(this),_e(this,Yi,void 0))}setEventListener(e){var t;_e(this,sc,e),(t=W(this,Yi))==null||t.call(this),_e(this,Yi,e(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(e){W(this,ga)!==e&&(_e(this,ga,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(t=>{t(e)})}isFocused(){var e;return typeof W(this,ga)=="boolean"?W(this,ga):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},ga=new WeakMap,Yi=new WeakMap,sc=new WeakMap,oA),QR=new I$,ic,Xi,oc,aA,R$=(aA=class extends jm{constructor(){super();Fe(this,ic,!0);Fe(this,Xi);Fe(this,oc);_e(this,oc,e=>{if(!Dm&&window.addEventListener){const t=()=>e(!0),r=()=>e(!1);return window.addEventListener("online",t,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",r)}}})}onSubscribe(){W(this,Xi)||this.setEventListener(W(this,oc))}onUnsubscribe(){var e;this.hasListeners()||((e=W(this,Xi))==null||e.call(this),_e(this,Xi,void 0))}setEventListener(e){var t;_e(this,oc,e),(t=W(this,Xi))==null||t.call(this),_e(this,Xi,e(this.setOnline.bind(this)))}setOnline(e){W(this,ic)!==e&&(_e(this,ic,e),this.listeners.forEach(r=>{r(e)}))}isOnline(){return W(this,ic)}},ic=new WeakMap,Xi=new WeakMap,oc=new WeakMap,aA),Sg=new R$;function O$(){let n,e;const t=new Promise((s,i)=>{n=s,e=i});t.status="pending",t.catch(()=>{});function r(s){Object.assign(t,s),delete t.resolve,delete t.reject}return t.resolve=s=>{r({status:"fulfilled",value:s}),n(s)},t.reject=s=>{r({status:"rejected",reason:s}),e(s)},t}function N$(n){return Math.min(1e3*2**n,3e4)}function JR(n){return(n??"online")==="online"?Sg.isOnline():!0}var ZR=class extends Error{constructor(n){super("CancelledError"),this.revert=n==null?void 0:n.revert,this.silent=n==null?void 0:n.silent}};function xv(n){return n instanceof ZR}function e2(n){let e=!1,t=0,r=!1,s;const i=O$(),o=m=>{var v;r||(f(new ZR(m)),(v=n.abort)==null||v.call(n))},a=()=>{e=!0},l=()=>{e=!1},c=()=>QR.isFocused()&&(n.networkMode==="always"||Sg.isOnline())&&n.canRun(),u=()=>JR(n.networkMode)&&n.canRun(),h=m=>{var v;r||(r=!0,(v=n.onSuccess)==null||v.call(n,m),s==null||s(),i.resolve(m))},f=m=>{var v;r||(r=!0,(v=n.onError)==null||v.call(n,m),s==null||s(),i.reject(m))},p=()=>new Promise(m=>{var v;s=w=>{(r||c())&&m(w)},(v=n.onPause)==null||v.call(n)}).then(()=>{var m;s=void 0,r||(m=n.onContinue)==null||m.call(n)}),y=()=>{if(r)return;let m;const v=t===0?n.initialPromise:void 0;try{m=v??n.fn()}catch(w){m=Promise.reject(w)}Promise.resolve(m).then(h).catch(w=>{var N;if(r)return;const _=n.retry??(Dm?0:3),x=n.retryDelay??N$,A=typeof x=="function"?x(t,w):x,j=_===!0||typeof _=="number"&&t<_||typeof _=="function"&&_(t,w);if(e||!j){f(w);return}t++,(N=n.onFail)==null||N.call(n,t,w),C$(A).then(()=>c()?void 0:p()).then(()=>{e?f(w):y()})})};return{promise:i,cancel:o,continue:()=>(s==null||s(),i),cancelRetry:a,continueRetry:l,canStart:u,start:()=>(u()?y():p().then(y),i)}}var j$=n=>setTimeout(n,0);function D$(){let n=[],e=0,t=a=>{a()},r=a=>{a()},s=j$;const i=a=>{e?n.push(a):s(()=>{t(a)})},o=()=>{const a=n;n=[],a.length&&s(()=>{r(()=>{a.forEach(l=>{t(l)})})})};return{batch:a=>{let l;e++;try{l=a()}finally{e--,e||o()}return l},batchCalls:a=>(...l)=>{i(()=>{a(...l)})},schedule:i,setNotifyFunction:a=>{t=a},setBatchNotifyFunction:a=>{r=a},setScheduler:a=>{s=a}}}var yn=D$(),ma,lA,t2=(lA=class{constructor(){Fe(this,ma)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),S$(this.gcTime)&&_e(this,ma,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(n){this.gcTime=Math.max(this.gcTime||0,n??(Dm?1/0:5*60*1e3))}clearGcTimeout(){W(this,ma)&&(clearTimeout(W(this,ma)),_e(this,ma,void 0))}},ma=new WeakMap,lA),ac,ya,or,va,sn,id,wa,Nr,Ms,cA,M$=(cA=class extends t2{constructor(t){super();Fe(this,Nr);Fe(this,ac);Fe(this,ya);Fe(this,or);Fe(this,va);Fe(this,sn);Fe(this,id);Fe(this,wa);_e(this,wa,!1),_e(this,id,t.defaultOptions),this.setOptions(t.options),this.observers=[],_e(this,va,t.client),_e(this,or,W(this,va).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,_e(this,ac,F$(this.options)),this.state=t.state??W(this,ac),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=W(this,sn))==null?void 0:t.promise}setOptions(t){this.options={...W(this,id),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&W(this,or).remove(this)}setData(t,r){const s=k$(this.state.data,t,this.options);return en(this,Nr,Ms).call(this,{data:s,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),s}setState(t,r){en(this,Nr,Ms).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var s,i;const r=(s=W(this,sn))==null?void 0:s.promise;return(i=W(this,sn))==null||i.cancel(t),r?r.then(Rr).catch(Rr):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(W(this,ac))}isActive(){return this.observers.some(t=>T$(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===qx||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>_w(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!E$(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(s=>s.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=W(this,sn))==null||r.continue()}onOnline(){var r;const t=this.observers.find(s=>s.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=W(this,sn))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),W(this,or).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(W(this,sn)&&(W(this,wa)?W(this,sn).cancel({revert:!0}):W(this,sn).cancelRetry()),this.scheduleGc()),W(this,or).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||en(this,Nr,Ms).call(this,{type:"invalidate"})}fetch(t,r){var u,h,f;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(W(this,sn))return W(this,sn).continueRetry(),W(this,sn).promise}if(t&&this.setOptions(t),!this.options.queryFn){const p=this.observers.find(y=>y.options.queryFn);p&&this.setOptions(p.options)}const s=new AbortController,i=p=>{Object.defineProperty(p,"signal",{enumerable:!0,get:()=>(_e(this,wa,!0),s.signal)})},o=()=>{const p=XR(this.options,r),m=(()=>{const v={client:W(this,va),queryKey:this.queryKey,meta:this.meta};return i(v),v})();return _e(this,wa,!1),this.options.persister?this.options.persister(p,m,this):p(m)},l=(()=>{const p={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:W(this,va),state:this.state,fetchFn:o};return i(p),p})();(u=this.options.behavior)==null||u.onFetch(l,this),_e(this,ya,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((h=l.fetchOptions)==null?void 0:h.meta))&&en(this,Nr,Ms).call(this,{type:"fetch",meta:(f=l.fetchOptions)==null?void 0:f.meta});const c=p=>{var y,m,v,w;xv(p)&&p.silent||en(this,Nr,Ms).call(this,{type:"error",error:p}),xv(p)||((m=(y=W(this,or).config).onError)==null||m.call(y,p,this),(w=(v=W(this,or).config).onSettled)==null||w.call(v,this.state.data,p,this)),this.scheduleGc()};return _e(this,sn,e2({initialPromise:r==null?void 0:r.initialPromise,fn:l.fetchFn,abort:s.abort.bind(s),onSuccess:p=>{var y,m,v,w;if(p===void 0){c(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(p)}catch(_){c(_);return}(m=(y=W(this,or).config).onSuccess)==null||m.call(y,p,this),(w=(v=W(this,or).config).onSettled)==null||w.call(v,p,this.state.error,this),this.scheduleGc()},onError:c,onFail:(p,y)=>{en(this,Nr,Ms).call(this,{type:"failed",failureCount:p,error:y})},onPause:()=>{en(this,Nr,Ms).call(this,{type:"pause"})},onContinue:()=>{en(this,Nr,Ms).call(this,{type:"continue"})},retry:l.options.retry,retryDelay:l.options.retryDelay,networkMode:l.options.networkMode,canRun:()=>!0})),W(this,sn).start()}},ac=new WeakMap,ya=new WeakMap,or=new WeakMap,va=new WeakMap,sn=new WeakMap,id=new WeakMap,wa=new WeakMap,Nr=new WeakSet,Ms=function(t){const r=s=>{switch(t.type){case"failed":return{...s,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...s,fetchStatus:"paused"};case"continue":return{...s,fetchStatus:"fetching"};case"fetch":return{...s,...L$(s.data,this.options),fetchMeta:t.meta??null};case"success":return _e(this,ya,void 0),{...s,data:t.data,dataUpdateCount:s.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const i=t.error;return xv(i)&&i.revert&&W(this,ya)?{...W(this,ya),fetchStatus:"idle"}:{...s,error:i,errorUpdateCount:s.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:s.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error"};case"invalidate":return{...s,isInvalidated:!0};case"setState":return{...s,...t.state}}};this.state=r(this.state),yn.batch(()=>{this.observers.forEach(s=>{s.onQueryUpdate()}),W(this,or).notify({query:this,type:"updated",action:t})})},cA);function L$(n,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:JR(e.networkMode)?"fetching":"paused",...n===void 0&&{error:null,status:"pending"}}}function F$(n){const e=typeof n.initialData=="function"?n.initialData():n.initialData,t=e!==void 0,r=t?typeof n.initialDataUpdatedAt=="function"?n.initialDataUpdatedAt():n.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:t?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:t?"success":"pending",fetchStatus:"idle"}}var cs,uA,V$=(uA=class extends jm{constructor(e={}){super();Fe(this,cs);this.config=e,_e(this,cs,new Map)}build(e,t,r){const s=t.queryKey,i=t.queryHash??Hx(s,t);let o=this.get(i);return o||(o=new M$({client:e,queryKey:s,queryHash:i,options:e.defaultQueryOptions(t),state:r,defaultOptions:e.getQueryDefaults(s)}),this.add(o)),o}add(e){W(this,cs).has(e.queryHash)||(W(this,cs).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const t=W(this,cs).get(e.queryHash);t&&(e.destroy(),t===e&&W(this,cs).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){yn.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return W(this,cs).get(e)}getAll(){return[...W(this,cs).values()]}find(e){const t={exact:!0,...e};return this.getAll().find(r=>UE(t,r))}findAll(e={}){const t=this.getAll();return Object.keys(e).length>0?t.filter(r=>UE(e,r)):t}notify(e){yn.batch(()=>{this.listeners.forEach(t=>{t(e)})})}onFocus(){yn.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){yn.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},cs=new WeakMap,uA),us,pn,_a,hs,Mi,hA,U$=(hA=class extends t2{constructor(t){super();Fe(this,hs);Fe(this,us);Fe(this,pn);Fe(this,_a);this.mutationId=t.mutationId,_e(this,pn,t.mutationCache),_e(this,us,[]),this.state=t.state||$$(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){W(this,us).includes(t)||(W(this,us).push(t),this.clearGcTimeout(),W(this,pn).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){_e(this,us,W(this,us).filter(r=>r!==t)),this.scheduleGc(),W(this,pn).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){W(this,us).length||(this.state.status==="pending"?this.scheduleGc():W(this,pn).remove(this))}continue(){var t;return((t=W(this,_a))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var o,a,l,c,u,h,f,p,y,m,v,w,_,x,A,j,N,S,T,P;const r=()=>{en(this,hs,Mi).call(this,{type:"continue"})};_e(this,_a,e2({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(R,D)=>{en(this,hs,Mi).call(this,{type:"failed",failureCount:R,error:D})},onPause:()=>{en(this,hs,Mi).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>W(this,pn).canRun(this)}));const s=this.state.status==="pending",i=!W(this,_a).canStart();try{if(s)r();else{en(this,hs,Mi).call(this,{type:"pending",variables:t,isPaused:i}),await((a=(o=W(this,pn).config).onMutate)==null?void 0:a.call(o,t,this));const D=await((c=(l=this.options).onMutate)==null?void 0:c.call(l,t));D!==this.state.context&&en(this,hs,Mi).call(this,{type:"pending",context:D,variables:t,isPaused:i})}const R=await W(this,_a).start();return await((h=(u=W(this,pn).config).onSuccess)==null?void 0:h.call(u,R,t,this.state.context,this)),await((p=(f=this.options).onSuccess)==null?void 0:p.call(f,R,t,this.state.context)),await((m=(y=W(this,pn).config).onSettled)==null?void 0:m.call(y,R,null,this.state.variables,this.state.context,this)),await((w=(v=this.options).onSettled)==null?void 0:w.call(v,R,null,t,this.state.context)),en(this,hs,Mi).call(this,{type:"success",data:R}),R}catch(R){try{throw await((x=(_=W(this,pn).config).onError)==null?void 0:x.call(_,R,t,this.state.context,this)),await((j=(A=this.options).onError)==null?void 0:j.call(A,R,t,this.state.context)),await((S=(N=W(this,pn).config).onSettled)==null?void 0:S.call(N,void 0,R,this.state.variables,this.state.context,this)),await((P=(T=this.options).onSettled)==null?void 0:P.call(T,void 0,R,t,this.state.context)),R}finally{en(this,hs,Mi).call(this,{type:"error",error:R})}}finally{W(this,pn).runNext(this)}}},us=new WeakMap,pn=new WeakMap,_a=new WeakMap,hs=new WeakSet,Mi=function(t){const r=s=>{switch(t.type){case"failed":return{...s,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...s,isPaused:!0};case"continue":return{...s,isPaused:!1};case"pending":return{...s,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...s,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...s,data:void 0,error:t.error,failureCount:s.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=r(this.state),yn.batch(()=>{W(this,us).forEach(s=>{s.onMutationUpdate(t)}),W(this,pn).notify({mutation:this,type:"updated",action:t})})},hA);function $$(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Ws,jr,od,dA,B$=(dA=class extends jm{constructor(e={}){super();Fe(this,Ws);Fe(this,jr);Fe(this,od);this.config=e,_e(this,Ws,new Set),_e(this,jr,new Map),_e(this,od,0)}build(e,t,r){const s=new U$({mutationCache:this,mutationId:++Qd(this,od)._,options:e.defaultMutationOptions(t),state:r});return this.add(s),s}add(e){W(this,Ws).add(e);const t=xf(e);if(typeof t=="string"){const r=W(this,jr).get(t);r?r.push(e):W(this,jr).set(t,[e])}this.notify({type:"added",mutation:e})}remove(e){if(W(this,Ws).delete(e)){const t=xf(e);if(typeof t=="string"){const r=W(this,jr).get(t);if(r)if(r.length>1){const s=r.indexOf(e);s!==-1&&r.splice(s,1)}else r[0]===e&&W(this,jr).delete(t)}}this.notify({type:"removed",mutation:e})}canRun(e){const t=xf(e);if(typeof t=="string"){const r=W(this,jr).get(t),s=r==null?void 0:r.find(i=>i.state.status==="pending");return!s||s===e}else return!0}runNext(e){var r;const t=xf(e);if(typeof t=="string"){const s=(r=W(this,jr).get(t))==null?void 0:r.find(i=>i!==e&&i.state.isPaused);return(s==null?void 0:s.continue())??Promise.resolve()}else return Promise.resolve()}clear(){yn.batch(()=>{W(this,Ws).forEach(e=>{this.notify({type:"removed",mutation:e})}),W(this,Ws).clear(),W(this,jr).clear()})}getAll(){return Array.from(W(this,Ws))}find(e){const t={exact:!0,...e};return this.getAll().find(r=>$E(t,r))}findAll(e={}){return this.getAll().filter(t=>$E(e,t))}notify(e){yn.batch(()=>{this.listeners.forEach(t=>{t(e)})})}resumePausedMutations(){const e=this.getAll().filter(t=>t.state.isPaused);return yn.batch(()=>Promise.all(e.map(t=>t.continue().catch(Rr))))}},Ws=new WeakMap,jr=new WeakMap,od=new WeakMap,dA);function xf(n){var e;return(e=n.options.scope)==null?void 0:e.id}function WE(n){return{onFetch:(e,t)=>{var u,h,f,p,y;const r=e.options,s=(f=(h=(u=e.fetchOptions)==null?void 0:u.meta)==null?void 0:h.fetchMore)==null?void 0:f.direction,i=((p=e.state.data)==null?void 0:p.pages)||[],o=((y=e.state.data)==null?void 0:y.pageParams)||[];let a={pages:[],pageParams:[]},l=0;const c=async()=>{let m=!1;const v=x=>{Object.defineProperty(x,"signal",{enumerable:!0,get:()=>(e.signal.aborted?m=!0:e.signal.addEventListener("abort",()=>{m=!0}),e.signal)})},w=XR(e.options,e.fetchOptions),_=async(x,A,j)=>{if(m)return Promise.reject();if(A==null&&x.pages.length)return Promise.resolve(x);const S=(()=>{const D={client:e.client,queryKey:e.queryKey,pageParam:A,direction:j?"backward":"forward",meta:e.options.meta};return v(D),D})(),T=await w(S),{maxPages:P}=e.options,R=j?P$:A$;return{pages:R(x.pages,T,P),pageParams:R(x.pageParams,A,P)}};if(s&&i.length){const x=s==="backward",A=x?z$:HE,j={pages:i,pageParams:o},N=A(r,j);a=await _(j,N,x)}else{const x=n??i.length;do{const A=l===0?o[0]??r.initialPageParam:HE(r,a);if(l>0&&A==null)break;a=await _(a,A),l++}while(l<x)}return a};e.options.persister?e.fetchFn=()=>{var m,v;return(v=(m=e.options).persister)==null?void 0:v.call(m,c,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},t)}:e.fetchFn=c}}}function HE(n,{pages:e,pageParams:t}){const r=e.length-1;return e.length>0?n.getNextPageParam(e[r],e,t[r],t):void 0}function z$(n,{pages:e,pageParams:t}){var r;return e.length>0?(r=n.getPreviousPageParam)==null?void 0:r.call(n,e[0],e,t[0],t):void 0}var gt,Qi,Ji,lc,cc,Zi,uc,hc,fA,W$=(fA=class{constructor(n={}){Fe(this,gt);Fe(this,Qi);Fe(this,Ji);Fe(this,lc);Fe(this,cc);Fe(this,Zi);Fe(this,uc);Fe(this,hc);_e(this,gt,n.queryCache||new V$),_e(this,Qi,n.mutationCache||new B$),_e(this,Ji,n.defaultOptions||{}),_e(this,lc,new Map),_e(this,cc,new Map),_e(this,Zi,0)}mount(){Qd(this,Zi)._++,W(this,Zi)===1&&(_e(this,uc,QR.subscribe(async n=>{n&&(await this.resumePausedMutations(),W(this,gt).onFocus())})),_e(this,hc,Sg.subscribe(async n=>{n&&(await this.resumePausedMutations(),W(this,gt).onOnline())})))}unmount(){var n,e;Qd(this,Zi)._--,W(this,Zi)===0&&((n=W(this,uc))==null||n.call(this),_e(this,uc,void 0),(e=W(this,hc))==null||e.call(this),_e(this,hc,void 0))}isFetching(n){return W(this,gt).findAll({...n,fetchStatus:"fetching"}).length}isMutating(n){return W(this,Qi).findAll({...n,status:"pending"}).length}getQueryData(n){var t;const e=this.defaultQueryOptions({queryKey:n});return(t=W(this,gt).get(e.queryHash))==null?void 0:t.state.data}ensureQueryData(n){const e=this.defaultQueryOptions(n),t=W(this,gt).build(this,e),r=t.state.data;return r===void 0?this.fetchQuery(n):(n.revalidateIfStale&&t.isStaleByTime(_w(e.staleTime,t))&&this.prefetchQuery(e),Promise.resolve(r))}getQueriesData(n){return W(this,gt).findAll(n).map(({queryKey:e,state:t})=>{const r=t.data;return[e,r]})}setQueryData(n,e,t){const r=this.defaultQueryOptions({queryKey:n}),s=W(this,gt).get(r.queryHash),i=s==null?void 0:s.state.data,o=b$(e,i);if(o!==void 0)return W(this,gt).build(this,r).setData(o,{...t,manual:!0})}setQueriesData(n,e,t){return yn.batch(()=>W(this,gt).findAll(n).map(({queryKey:r})=>[r,this.setQueryData(r,e,t)]))}getQueryState(n){var t;const e=this.defaultQueryOptions({queryKey:n});return(t=W(this,gt).get(e.queryHash))==null?void 0:t.state}removeQueries(n){const e=W(this,gt);yn.batch(()=>{e.findAll(n).forEach(t=>{e.remove(t)})})}resetQueries(n,e){const t=W(this,gt);return yn.batch(()=>(t.findAll(n).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...n},e)))}cancelQueries(n,e={}){const t={revert:!0,...e},r=yn.batch(()=>W(this,gt).findAll(n).map(s=>s.cancel(t)));return Promise.all(r).then(Rr).catch(Rr)}invalidateQueries(n,e={}){return yn.batch(()=>(W(this,gt).findAll(n).forEach(t=>{t.invalidate()}),(n==null?void 0:n.refetchType)==="none"?Promise.resolve():this.refetchQueries({...n,type:(n==null?void 0:n.refetchType)??(n==null?void 0:n.type)??"active"},e)))}refetchQueries(n,e={}){const t={...e,cancelRefetch:e.cancelRefetch??!0},r=yn.batch(()=>W(this,gt).findAll(n).filter(s=>!s.isDisabled()&&!s.isStatic()).map(s=>{let i=s.fetch(void 0,t);return t.throwOnError||(i=i.catch(Rr)),s.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(r).then(Rr)}fetchQuery(n){const e=this.defaultQueryOptions(n);e.retry===void 0&&(e.retry=!1);const t=W(this,gt).build(this,e);return t.isStaleByTime(_w(e.staleTime,t))?t.fetch(e):Promise.resolve(t.state.data)}prefetchQuery(n){return this.fetchQuery(n).then(Rr).catch(Rr)}fetchInfiniteQuery(n){return n.behavior=WE(n.pages),this.fetchQuery(n)}prefetchInfiniteQuery(n){return this.fetchInfiniteQuery(n).then(Rr).catch(Rr)}ensureInfiniteQueryData(n){return n.behavior=WE(n.pages),this.ensureQueryData(n)}resumePausedMutations(){return Sg.isOnline()?W(this,Qi).resumePausedMutations():Promise.resolve()}getQueryCache(){return W(this,gt)}getMutationCache(){return W(this,Qi)}getDefaultOptions(){return W(this,Ji)}setDefaultOptions(n){_e(this,Ji,n)}setQueryDefaults(n,e){W(this,lc).set(jh(n),{queryKey:n,defaultOptions:e})}getQueryDefaults(n){const e=[...W(this,lc).values()],t={};return e.forEach(r=>{Dh(n,r.queryKey)&&Object.assign(t,r.defaultOptions)}),t}setMutationDefaults(n,e){W(this,cc).set(jh(n),{mutationKey:n,defaultOptions:e})}getMutationDefaults(n){const e=[...W(this,cc).values()],t={};return e.forEach(r=>{Dh(n,r.mutationKey)&&Object.assign(t,r.defaultOptions)}),t}defaultQueryOptions(n){if(n._defaulted)return n;const e={...W(this,Ji).queries,...this.getQueryDefaults(n.queryKey),...n,_defaulted:!0};return e.queryHash||(e.queryHash=Hx(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===qx&&(e.enabled=!1),e}defaultMutationOptions(n){return n!=null&&n._defaulted?n:{...W(this,Ji).mutations,...(n==null?void 0:n.mutationKey)&&this.getMutationDefaults(n.mutationKey),...n,_defaulted:!0}}clear(){W(this,gt).clear(),W(this,Qi).clear()}},gt=new WeakMap,Qi=new WeakMap,Ji=new WeakMap,lc=new WeakMap,cc=new WeakMap,Zi=new WeakMap,uc=new WeakMap,hc=new WeakMap,fA),H$=C.createContext(void 0),q$=({client:n,children:e})=>(C.useEffect(()=>(n.mount(),()=>{n.unmount()}),[n]),g.jsx(H$.Provider,{value:n,children:e}));/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Mh(){return Mh=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Mh.apply(this,arguments)}var no;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(no||(no={}));const qE="popstate";function G$(n){n===void 0&&(n={});function e(r,s){let{pathname:i,search:o,hash:a}=r.location;return bw("",{pathname:i,search:o,hash:a},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function t(r,s){return typeof s=="string"?s:r2(s)}return Y$(e,t,null,n)}function Pt(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function n2(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function K$(){return Math.random().toString(36).substr(2,8)}function GE(n,e){return{usr:n.state,key:n.key,idx:e}}function bw(n,e,t,r){return t===void 0&&(t=null),Mh({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?Bc(e):e,{state:t,key:e&&e.key||r||K$()})}function r2(n){let{pathname:e="/",search:t="",hash:r=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Bc(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substr(r),n=n.substr(0,r)),n&&(e.pathname=n)}return e}function Y$(n,e,t,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,a=no.Pop,l=null,c=u();c==null&&(c=0,o.replaceState(Mh({},o.state,{idx:c}),""));function u(){return(o.state||{idx:null}).idx}function h(){a=no.Pop;let v=u(),w=v==null?null:v-c;c=v,l&&l({action:a,location:m.location,delta:w})}function f(v,w){a=no.Push;let _=bw(m.location,v,w);c=u()+1;let x=GE(_,c),A=m.createHref(_);try{o.pushState(x,"",A)}catch(j){if(j instanceof DOMException&&j.name==="DataCloneError")throw j;s.location.assign(A)}i&&l&&l({action:a,location:m.location,delta:1})}function p(v,w){a=no.Replace;let _=bw(m.location,v,w);c=u();let x=GE(_,c),A=m.createHref(_);o.replaceState(x,"",A),i&&l&&l({action:a,location:m.location,delta:0})}function y(v){let w=s.location.origin!=="null"?s.location.origin:s.location.href,_=typeof v=="string"?v:r2(v);return _=_.replace(/ $/,"%20"),Pt(w,"No window.location.(origin|href) available to create URL for href: "+_),new URL(_,w)}let m={get action(){return a},get location(){return n(s,o)},listen(v){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(qE,h),l=v,()=>{s.removeEventListener(qE,h),l=null}},createHref(v){return e(s,v)},createURL:y,encodeLocation(v){let w=y(v);return{pathname:w.pathname,search:w.search,hash:w.hash}},push:f,replace:p,go(v){return o.go(v)}};return m}var KE;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(KE||(KE={}));function X$(n,e,t){return t===void 0&&(t="/"),Q$(n,e,t,!1)}function Q$(n,e,t,r){let s=typeof e=="string"?Bc(e):e,i=o2(s.pathname||"/",t);if(i==null)return null;let o=s2(n);J$(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let c=c6(i);a=a6(o[l],c,r)}return a}function s2(n,e,t,r){e===void 0&&(e=[]),t===void 0&&(t=[]),r===void 0&&(r="");let s=(i,o,a)=>{let l={relativePath:a===void 0?i.path||"":a,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};l.relativePath.startsWith("/")&&(Pt(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let c=Sa([r,l.relativePath]),u=t.concat(l);i.children&&i.children.length>0&&(Pt(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),s2(i.children,e,u,c)),!(i.path==null&&!i.index)&&e.push({path:c,score:i6(c,i.index),routesMeta:u})};return n.forEach((i,o)=>{var a;if(i.path===""||!((a=i.path)!=null&&a.includes("?")))s(i,o);else for(let l of i2(i.path))s(i,o,l)}),e}function i2(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,s=t.endsWith("?"),i=t.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=i2(r.join("/")),a=[];return a.push(...o.map(l=>l===""?i:[i,l].join("/"))),s&&a.push(...o),a.map(l=>n.startsWith("/")&&l===""?"/":l)}function J$(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:o6(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}const Z$=/^:[\w-]+$/,e6=3,t6=2,n6=1,r6=10,s6=-2,YE=n=>n==="*";function i6(n,e){let t=n.split("/"),r=t.length;return t.some(YE)&&(r+=s6),e&&(r+=t6),t.filter(s=>!YE(s)).reduce((s,i)=>s+(Z$.test(i)?e6:i===""?n6:r6),r)}function o6(n,e){return n.length===e.length&&n.slice(0,-1).every((r,s)=>r===e[s])?n[n.length-1]-e[e.length-1]:0}function a6(n,e,t){let{routesMeta:r}=n,s={},i="/",o=[];for(let a=0;a<r.length;++a){let l=r[a],c=a===r.length-1,u=i==="/"?e:e.slice(i.length)||"/",h=XE({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),f=l.route;if(!h&&c&&t&&!r[r.length-1].route.index&&(h=XE({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},u)),!h)return null;Object.assign(s,h.params),o.push({params:s,pathname:Sa([i,h.pathname]),pathnameBase:f6(Sa([i,h.pathnameBase])),route:f}),h.pathnameBase!=="/"&&(i=Sa([i,h.pathnameBase]))}return o}function XE(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=l6(n.path,n.caseSensitive,n.end),s=e.match(t);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),a=s.slice(1);return{params:r.reduce((c,u,h)=>{let{paramName:f,isOptional:p}=u;if(f==="*"){let m=a[h]||"";o=i.slice(0,i.length-m.length).replace(/(.)\/+$/,"$1")}const y=a[h];return p&&!y?c[f]=void 0:c[f]=(y||"").replace(/%2F/g,"/"),c},{}),pathname:i,pathnameBase:o,pattern:n}}function l6(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),n2(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let r=[],s="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(r.push({paramName:"*"}),s+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?s+="\\/*$":n!==""&&n!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function c6(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return n2(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function o2(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}function u6(n,e){e===void 0&&(e="/");let{pathname:t,search:r="",hash:s=""}=typeof n=="string"?Bc(n):n;return{pathname:t?t.startsWith("/")?t:h6(t,e):e,search:p6(r),hash:g6(s)}}function h6(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(s=>{s===".."?t.length>1&&t.pop():s!=="."&&t.push(s)}),t.length>1?t.join("/"):"/"}function bv(n,e,t,r){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function d6(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function a2(n,e){let t=d6(n);return e?t.map((r,s)=>s===t.length-1?r.pathname:r.pathnameBase):t.map(r=>r.pathnameBase)}function l2(n,e,t,r){r===void 0&&(r=!1);let s;typeof n=="string"?s=Bc(n):(s=Mh({},n),Pt(!s.pathname||!s.pathname.includes("?"),bv("?","pathname","search",s)),Pt(!s.pathname||!s.pathname.includes("#"),bv("#","pathname","hash",s)),Pt(!s.search||!s.search.includes("#"),bv("#","search","hash",s)));let i=n===""||s.pathname==="",o=i?"/":s.pathname,a;if(o==null)a=t;else{let h=e.length-1;if(!r&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),h-=1;s.pathname=f.join("/")}a=h>=0?e[h]:"/"}let l=u6(s,a),c=o&&o!=="/"&&o.endsWith("/"),u=(i||o===".")&&t.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}const Sa=n=>n.join("/").replace(/\/\/+/g,"/"),f6=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),p6=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,g6=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function m6(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const c2=["post","put","patch","delete"];new Set(c2);const y6=["get",...c2];new Set(y6);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Lh(){return Lh=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Lh.apply(this,arguments)}const Gx=C.createContext(null),v6=C.createContext(null),md=C.createContext(null),Mm=C.createContext(null),Ga=C.createContext({outlet:null,matches:[],isDataRoute:!1}),u2=C.createContext(null);function yd(){return C.useContext(Mm)!=null}function vd(){return yd()||Pt(!1),C.useContext(Mm).location}function h2(n){C.useContext(md).static||C.useLayoutEffect(n)}function yi(){let{isDataRoute:n}=C.useContext(Ga);return n?R6():w6()}function w6(){yd()||Pt(!1);let n=C.useContext(Gx),{basename:e,future:t,navigator:r}=C.useContext(md),{matches:s}=C.useContext(Ga),{pathname:i}=vd(),o=JSON.stringify(a2(s,t.v7_relativeSplatPath)),a=C.useRef(!1);return h2(()=>{a.current=!0}),C.useCallback(function(c,u){if(u===void 0&&(u={}),!a.current)return;if(typeof c=="number"){r.go(c);return}let h=l2(c,JSON.parse(o),i,u.relative==="path");n==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Sa([e,h.pathname])),(u.replace?r.replace:r.push)(h,u.state,u)},[e,r,o,i,n])}function _6(n,e){return x6(n,e)}function x6(n,e,t,r){yd()||Pt(!1);let{navigator:s}=C.useContext(md),{matches:i}=C.useContext(Ga),o=i[i.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let c=vd(),u;if(e){var h;let v=typeof e=="string"?Bc(e):e;l==="/"||(h=v.pathname)!=null&&h.startsWith(l)||Pt(!1),u=v}else u=c;let f=u.pathname||"/",p=f;if(l!=="/"){let v=l.replace(/^\//,"").split("/");p="/"+f.replace(/^\//,"").split("/").slice(v.length).join("/")}let y=X$(n,{pathname:p}),m=C6(y&&y.map(v=>Object.assign({},v,{params:Object.assign({},a,v.params),pathname:Sa([l,s.encodeLocation?s.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?l:Sa([l,s.encodeLocation?s.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),i,t,r);return e&&m?C.createElement(Mm.Provider,{value:{location:Lh({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:no.Pop}},m):m}function b6(){let n=I6(),e=m6(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return C.createElement(C.Fragment,null,C.createElement("h2",null,"Unexpected Application Error!"),C.createElement("h3",{style:{fontStyle:"italic"}},e),t?C.createElement("pre",{style:s},t):null,null)}const S6=C.createElement(b6,null);class E6 extends C.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?C.createElement(Ga.Provider,{value:this.props.routeContext},C.createElement(u2.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function T6(n){let{routeContext:e,match:t,children:r}=n,s=C.useContext(Gx);return s&&s.static&&s.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=t.route.id),C.createElement(Ga.Provider,{value:e},r)}function C6(n,e,t,r){var s;if(e===void 0&&(e=[]),t===void 0&&(t=null),r===void 0&&(r=null),n==null){var i;if(!t)return null;if(t.errors)n=t.matches;else if((i=r)!=null&&i.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let o=n,a=(s=t)==null?void 0:s.errors;if(a!=null){let u=o.findIndex(h=>h.route.id&&(a==null?void 0:a[h.route.id])!==void 0);u>=0||Pt(!1),o=o.slice(0,Math.min(o.length,u+1))}let l=!1,c=-1;if(t&&r&&r.v7_partialHydration)for(let u=0;u<o.length;u++){let h=o[u];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(c=u),h.route.id){let{loaderData:f,errors:p}=t,y=h.route.loader&&f[h.route.id]===void 0&&(!p||p[h.route.id]===void 0);if(h.route.lazy||y){l=!0,c>=0?o=o.slice(0,c+1):o=[o[0]];break}}}return o.reduceRight((u,h,f)=>{let p,y=!1,m=null,v=null;t&&(p=a&&h.route.id?a[h.route.id]:void 0,m=h.route.errorElement||S6,l&&(c<0&&f===0?(y=!0,v=null):c===f&&(y=!0,v=h.route.hydrateFallbackElement||null)));let w=e.concat(o.slice(0,f+1)),_=()=>{let x;return p?x=m:y?x=v:h.route.Component?x=C.createElement(h.route.Component,null):h.route.element?x=h.route.element:x=u,C.createElement(T6,{match:h,routeContext:{outlet:u,matches:w,isDataRoute:t!=null},children:x})};return t&&(h.route.ErrorBoundary||h.route.errorElement||f===0)?C.createElement(E6,{location:t.location,revalidation:t.revalidation,component:m,error:p,children:_(),routeContext:{outlet:null,matches:w,isDataRoute:!0}}):_()},null)}var d2=function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n}(d2||{}),Eg=function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n}(Eg||{});function k6(n){let e=C.useContext(Gx);return e||Pt(!1),e}function A6(n){let e=C.useContext(v6);return e||Pt(!1),e}function P6(n){let e=C.useContext(Ga);return e||Pt(!1),e}function f2(n){let e=P6(),t=e.matches[e.matches.length-1];return t.route.id||Pt(!1),t.route.id}function I6(){var n;let e=C.useContext(u2),t=A6(Eg.UseRouteError),r=f2(Eg.UseRouteError);return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function R6(){let{router:n}=k6(d2.UseNavigateStable),e=f2(Eg.UseNavigateStable),t=C.useRef(!1);return h2(()=>{t.current=!0}),C.useCallback(function(s,i){i===void 0&&(i={}),t.current&&(typeof s=="number"?n.navigate(s):n.navigate(s,Lh({fromRouteId:e},i)))},[n,e])}function O6(n,e){n==null||n.v7_startTransition,n==null||n.v7_relativeSplatPath}function Sv(n){let{to:e,replace:t,state:r,relative:s}=n;yd()||Pt(!1);let{future:i,static:o}=C.useContext(md),{matches:a}=C.useContext(Ga),{pathname:l}=vd(),c=yi(),u=l2(e,a2(a,i.v7_relativeSplatPath),l,s==="path"),h=JSON.stringify(u);return C.useEffect(()=>c(JSON.parse(h),{replace:t,state:r,relative:s}),[c,h,s,t,r]),null}function Cr(n){Pt(!1)}function N6(n){let{basename:e="/",children:t=null,location:r,navigationType:s=no.Pop,navigator:i,static:o=!1,future:a}=n;yd()&&Pt(!1);let l=e.replace(/^\/*/,"/"),c=C.useMemo(()=>({basename:l,navigator:i,static:o,future:Lh({v7_relativeSplatPath:!1},a)}),[l,a,i,o]);typeof r=="string"&&(r=Bc(r));let{pathname:u="/",search:h="",hash:f="",state:p=null,key:y="default"}=r,m=C.useMemo(()=>{let v=o2(u,l);return v==null?null:{location:{pathname:v,search:h,hash:f,state:p,key:y},navigationType:s}},[l,u,h,f,p,y,s]);return m==null?null:C.createElement(md.Provider,{value:c},C.createElement(Mm.Provider,{children:t,value:m}))}function j6(n){let{children:e,location:t}=n;return _6(Sw(e),t)}new Promise(()=>{});function Sw(n,e){e===void 0&&(e=[]);let t=[];return C.Children.forEach(n,(r,s)=>{if(!C.isValidElement(r))return;let i=[...e,s];if(r.type===C.Fragment){t.push.apply(t,Sw(r.props.children,i));return}r.type!==Cr&&Pt(!1),!r.props.index||!r.props.children||Pt(!1);let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=Sw(r.props.children,i)),t.push(o)}),t}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const D6="6";try{window.__reactRouterVersion=D6}catch{}const M6="startTransition",QE=L_[M6];function L6(n){let{basename:e,children:t,future:r,window:s}=n,i=C.useRef();i.current==null&&(i.current=G$({window:s,v5Compat:!0}));let o=i.current,[a,l]=C.useState({action:o.action,location:o.location}),{v7_startTransition:c}=r||{},u=C.useCallback(h=>{c&&QE?QE(()=>l(h)):l(h)},[l,c]);return C.useLayoutEffect(()=>o.listen(u),[o,u]),C.useEffect(()=>O6(r),[r]),C.createElement(N6,{basename:e,children:t,location:a.location,navigationType:a.action,navigator:o,future:r})}var JE;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(JE||(JE={}));var ZE;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(ZE||(ZE={}));const F6=()=>{};var eT={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p2=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},V6=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const s=n[t++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=n[t++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=n[t++],o=n[t++],a=n[t++],l=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const i=n[t++],o=n[t++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},g2={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const i=n[s],o=s+1<n.length,a=o?n[s+1]:0,l=s+2<n.length,c=l?n[s+2]:0,u=i>>2,h=(i&3)<<4|a>>4;let f=(a&15)<<2|c>>6,p=c&63;l||(p=64,o||(f=64)),r.push(t[u],t[h],t[f],t[p])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(p2(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):V6(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const i=t[n.charAt(s++)],a=s<n.length?t[n.charAt(s)]:0;++s;const c=s<n.length?t[n.charAt(s)]:64;++s;const h=s<n.length?t[n.charAt(s)]:64;if(++s,i==null||a==null||c==null||h==null)throw new U6;const f=i<<2|a>>4;if(r.push(f),c!==64){const p=a<<4&240|c>>2;if(r.push(p),h!==64){const y=c<<6&192|h;r.push(y)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class U6 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const $6=function(n){const e=p2(n);return g2.encodeByteArray(e,!0)},Tg=function(n){return $6(n).replace(/\./g,"")},m2=function(n){try{return g2.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B6(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z6=()=>B6().__FIREBASE_DEFAULTS__,W6=()=>{if(typeof process>"u"||typeof eT>"u")return;const n=eT.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},H6=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&m2(n[1]);return e&&JSON.parse(e)},Lm=()=>{try{return F6()||z6()||W6()||H6()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},y2=n=>{var e,t;return(t=(e=Lm())==null?void 0:e.emulatorHosts)==null?void 0:t[n]},q6=n=>{const e=y2(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},v2=()=>{var n;return(n=Lm())==null?void 0:n.config},w2=n=>{var e;return(e=Lm())==null?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let G6=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zc(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function _2(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K6(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",s=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Tg(JSON.stringify(t)),Tg(JSON.stringify(o)),""].join(".")}const nh={};function Y6(){const n={prod:[],emulator:[]};for(const e of Object.keys(nh))nh[e]?n.emulator.push(e):n.prod.push(e);return n}function X6(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let tT=!1;function x2(n,e){if(typeof window>"u"||typeof document>"u"||!zc(window.location.host)||nh[n]===e||nh[n]||tT)return;nh[n]=e;function t(f){return`__firebase__banner__${f}`}const r="__firebase__banner",i=Y6().prod.length>0;function o(){const f=document.getElementById(r);f&&f.remove()}function a(f){f.style.display="flex",f.style.background="#7faaf0",f.style.position="fixed",f.style.bottom="5px",f.style.left="5px",f.style.padding=".5em",f.style.borderRadius="5px",f.style.alignItems="center"}function l(f,p){f.setAttribute("width","24"),f.setAttribute("id",p),f.setAttribute("height","24"),f.setAttribute("viewBox","0 0 24 24"),f.setAttribute("fill","none"),f.style.marginLeft="-6px"}function c(){const f=document.createElement("span");return f.style.cursor="pointer",f.style.marginLeft="16px",f.style.fontSize="24px",f.innerHTML=" &times;",f.onclick=()=>{tT=!0,o()},f}function u(f,p){f.setAttribute("id",p),f.innerText="Learn more",f.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",f.setAttribute("target","__blank"),f.style.paddingLeft="5px",f.style.textDecoration="underline"}function h(){const f=X6(r),p=t("text"),y=document.getElementById(p)||document.createElement("span"),m=t("learnmore"),v=document.getElementById(m)||document.createElement("a"),w=t("preprendIcon"),_=document.getElementById(w)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(f.created){const x=f.element;a(x),u(v,m);const A=c();l(_,w),x.append(_,y,v,A),document.body.appendChild(x)}i?(y.innerText="Preview backend disconnected.",_.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(_.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,y.innerText="Preview backend running in this workspace."),y.setAttribute("id",p)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Q6(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(hn())}function J6(){var e;const n=(e=Lm())==null?void 0:e.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Z6(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function eB(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function tB(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function nB(){const n=hn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function rB(){return!J6()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function sB(){try{return typeof indexedDB=="object"}catch{return!1}}function iB(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var i;e(((i=s.error)==null?void 0:i.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oB="FirebaseError";class vi extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=oB,Object.setPrototypeOf(this,vi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,wd.prototype.create)}}class wd{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?aB(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new vi(s,a,r)}}function aB(n,e){return n.replace(lB,(t,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const lB=/\{\$([^}]+)}/g;function cB(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Da(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const s of t){if(!r.includes(s))return!1;const i=n[s],o=e[s];if(nT(i)&&nT(o)){if(!Da(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!t.includes(s))return!1;return!0}function nT(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _d(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Lu(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function Fu(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function uB(n,e){const t=new hB(n,e);return t.subscribe.bind(t)}class hB{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let s;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");dB(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:r},s.next===void 0&&(s.next=Ev),s.error===void 0&&(s.error=Ev),s.complete===void 0&&(s.complete=Ev);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function dB(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Ev(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wt(n){return n&&n._delegate?n._delegate:n}class Ma{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ta="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fB{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new G6;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(gB(e))try{this.getOrInitializeService({instanceIdentifier:ta})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=ta){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ta){return this.instances.has(e)}getOptions(e=ta){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const s of r)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:pB(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=ta){return this.component?this.component.multipleInstances?e:ta:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function pB(n){return n===ta?void 0:n}function gB(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mB{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new fB(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ae;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Ae||(Ae={}));const yB={debug:Ae.DEBUG,verbose:Ae.VERBOSE,info:Ae.INFO,warn:Ae.WARN,error:Ae.ERROR,silent:Ae.SILENT},vB=Ae.INFO,wB={[Ae.DEBUG]:"log",[Ae.VERBOSE]:"log",[Ae.INFO]:"info",[Ae.WARN]:"warn",[Ae.ERROR]:"error"},_B=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),s=wB[e];if(s)console[s](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Kx{constructor(e){this.name=e,this._logLevel=vB,this._logHandler=_B,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ae))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?yB[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ae.DEBUG,...e),this._logHandler(this,Ae.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ae.VERBOSE,...e),this._logHandler(this,Ae.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ae.INFO,...e),this._logHandler(this,Ae.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ae.WARN,...e),this._logHandler(this,Ae.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ae.ERROR,...e),this._logHandler(this,Ae.ERROR,...e)}}const xB=(n,e)=>e.some(t=>n instanceof t);let rT,sT;function bB(){return rT||(rT=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function SB(){return sT||(sT=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const b2=new WeakMap,Ew=new WeakMap,S2=new WeakMap,Tv=new WeakMap,Yx=new WeakMap;function EB(n){const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("success",i),n.removeEventListener("error",o)},i=()=>{t(po(n.result)),s()},o=()=>{r(n.error),s()};n.addEventListener("success",i),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&b2.set(t,n)}).catch(()=>{}),Yx.set(e,n),e}function TB(n){if(Ew.has(n))return;const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",o),n.removeEventListener("abort",o)},i=()=>{t(),s()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",i),n.addEventListener("error",o),n.addEventListener("abort",o)});Ew.set(n,e)}let Tw={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Ew.get(n);if(e==="objectStoreNames")return n.objectStoreNames||S2.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return po(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function CB(n){Tw=n(Tw)}function kB(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(Cv(this),e,...t);return S2.set(r,e.sort?e.sort():[e]),po(r)}:SB().includes(n)?function(...e){return n.apply(Cv(this),e),po(b2.get(this))}:function(...e){return po(n.apply(Cv(this),e))}}function AB(n){return typeof n=="function"?kB(n):(n instanceof IDBTransaction&&TB(n),xB(n,bB())?new Proxy(n,Tw):n)}function po(n){if(n instanceof IDBRequest)return EB(n);if(Tv.has(n))return Tv.get(n);const e=AB(n);return e!==n&&(Tv.set(n,e),Yx.set(e,n)),e}const Cv=n=>Yx.get(n);function PB(n,e,{blocked:t,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(n,e),a=po(o);return r&&o.addEventListener("upgradeneeded",l=>{r(po(o.result),l.oldVersion,l.newVersion,po(o.transaction),l)}),t&&o.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),a.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const IB=["get","getKey","getAll","getAllKeys","count"],RB=["put","add","delete","clear"],kv=new Map;function iT(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(kv.get(e))return kv.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,s=RB.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(s||IB.includes(t)))return;const i=async function(o,...a){const l=this.transaction(o,s?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[t](...a),s&&l.done]))[0]};return kv.set(e,i),i}CB(n=>({...n,get:(e,t,r)=>iT(e,t)||n.get(e,t,r),has:(e,t)=>!!iT(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OB{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(NB(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function NB(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Cw="@firebase/app",oT="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const li=new Kx("@firebase/app"),jB="@firebase/app-compat",DB="@firebase/analytics-compat",MB="@firebase/analytics",LB="@firebase/app-check-compat",FB="@firebase/app-check",VB="@firebase/auth",UB="@firebase/auth-compat",$B="@firebase/database",BB="@firebase/data-connect",zB="@firebase/database-compat",WB="@firebase/functions",HB="@firebase/functions-compat",qB="@firebase/installations",GB="@firebase/installations-compat",KB="@firebase/messaging",YB="@firebase/messaging-compat",XB="@firebase/performance",QB="@firebase/performance-compat",JB="@firebase/remote-config",ZB="@firebase/remote-config-compat",ez="@firebase/storage",tz="@firebase/storage-compat",nz="@firebase/firestore",rz="@firebase/ai",sz="@firebase/firestore-compat",iz="firebase",oz="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kw="[DEFAULT]",az={[Cw]:"fire-core",[jB]:"fire-core-compat",[MB]:"fire-analytics",[DB]:"fire-analytics-compat",[FB]:"fire-app-check",[LB]:"fire-app-check-compat",[VB]:"fire-auth",[UB]:"fire-auth-compat",[$B]:"fire-rtdb",[BB]:"fire-data-connect",[zB]:"fire-rtdb-compat",[WB]:"fire-fn",[HB]:"fire-fn-compat",[qB]:"fire-iid",[GB]:"fire-iid-compat",[KB]:"fire-fcm",[YB]:"fire-fcm-compat",[XB]:"fire-perf",[QB]:"fire-perf-compat",[JB]:"fire-rc",[ZB]:"fire-rc-compat",[ez]:"fire-gcs",[tz]:"fire-gcs-compat",[nz]:"fire-fst",[sz]:"fire-fst-compat",[rz]:"fire-vertex","fire-js":"fire-js",[iz]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cg=new Map,lz=new Map,Aw=new Map;function aT(n,e){try{n.container.addComponent(e)}catch(t){li.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function bc(n){const e=n.name;if(Aw.has(e))return li.debug(`There were multiple attempts to register component ${e}.`),!1;Aw.set(e,n);for(const t of Cg.values())aT(t,n);for(const t of lz.values())aT(t,n);return!0}function Xx(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function cr(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cz={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},go=new wd("app","Firebase",cz);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uz{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ma("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw go.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wc=oz;function E2(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:kw,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw go.create("bad-app-name",{appName:String(s)});if(t||(t=v2()),!t)throw go.create("no-options");const i=Cg.get(s);if(i){if(Da(t,i.options)&&Da(r,i.config))return i;throw go.create("duplicate-app",{appName:s})}const o=new mB(s);for(const l of Aw.values())o.addComponent(l);const a=new uz(t,r,o);return Cg.set(s,a),a}function T2(n=kw){const e=Cg.get(n);if(!e&&n===kw&&v2())return E2();if(!e)throw go.create("no-app",{appName:n});return e}function mo(n,e,t){let r=az[n]??n;t&&(r+=`-${t}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const o=[`Unable to register library "${r}" with version "${e}":`];s&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),li.warn(o.join(" "));return}bc(new Ma(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hz="firebase-heartbeat-database",dz=1,Fh="firebase-heartbeat-store";let Av=null;function C2(){return Av||(Av=PB(hz,dz,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Fh)}catch(t){console.warn(t)}}}}).catch(n=>{throw go.create("idb-open",{originalErrorMessage:n.message})})),Av}async function fz(n){try{const t=(await C2()).transaction(Fh),r=await t.objectStore(Fh).get(k2(n));return await t.done,r}catch(e){if(e instanceof vi)li.warn(e.message);else{const t=go.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});li.warn(t.message)}}}async function lT(n,e){try{const r=(await C2()).transaction(Fh,"readwrite");await r.objectStore(Fh).put(e,k2(n)),await r.done}catch(t){if(t instanceof vi)li.warn(t.message);else{const r=go.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});li.warn(r.message)}}}function k2(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pz=1024,gz=30;class mz{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new vz(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=cT();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>gz){const o=wz(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){li.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=cT(),{heartbeatsToSend:r,unsentEntries:s}=yz(this._heartbeatsCache.heartbeats),i=Tg(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return li.warn(t),""}}}function cT(){return new Date().toISOString().substring(0,10)}function yz(n,e=pz){const t=[];let r=n.slice();for(const s of n){const i=t.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),uT(t)>e){i.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),uT(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class vz{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return sB()?iB().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await fz(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return lT(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return lT(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function uT(n){return Tg(JSON.stringify({version:2,heartbeats:n})).length}function wz(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _z(n){bc(new Ma("platform-logger",e=>new OB(e),"PRIVATE")),bc(new Ma("heartbeat",e=>new mz(e),"PRIVATE")),mo(Cw,oT,n),mo(Cw,oT,"esm2020"),mo("fire-js","")}_z("");function A2(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const xz=A2,P2=new wd("auth","Firebase",A2());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kg=new Kx("@firebase/auth");function bz(n,...e){kg.logLevel<=Ae.WARN&&kg.warn(`Auth (${Wc}): ${n}`,...e)}function Ap(n,...e){kg.logLevel<=Ae.ERROR&&kg.error(`Auth (${Wc}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qr(n,...e){throw Qx(n,...e)}function _s(n,...e){return Qx(n,...e)}function I2(n,e,t){const r={...xz(),[e]:t};return new wd("auth","Firebase",r).create(e,{appName:n.name})}function Js(n){return I2(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Qx(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return P2.create(n,...e)}function me(n,e,...t){if(!n)throw Qx(e,...t)}function Gs(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Ap(e),new Error(e)}function ci(n,e){n||Gs(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pw(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.href)||""}function Sz(){return hT()==="http:"||hT()==="https:"}function hT(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ez(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Sz()||eB()||"connection"in navigator)?navigator.onLine:!0}function Tz(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xd{constructor(e,t){this.shortDelay=e,this.longDelay=t,ci(t>e,"Short delay should be less than long delay!"),this.isMobile=Q6()||tB()}get(){return Ez()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jx(n,e){ci(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R2{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Gs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Gs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Gs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cz={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kz=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Az=new xd(3e4,6e4);function Do(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Mo(n,e,t,r,s={}){return O2(n,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const a=_d({key:n.config.apiKey,...o}).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const c={method:e,headers:l,...i};return Z6()||(c.referrerPolicy="no-referrer"),n.emulatorConfig&&zc(n.emulatorConfig.host)&&(c.credentials="include"),R2.fetch()(await N2(n,n.config.apiHost,t,a),c)})}async function O2(n,e,t){n._canInitEmulator=!1;const r={...Cz,...e};try{const s=new Iz(n),i=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw bf(n,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw bf(n,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw bf(n,"email-already-in-use",o);if(l==="USER_DISABLED")throw bf(n,"user-disabled",o);const u=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw I2(n,u,c);Qr(n,u)}}catch(s){if(s instanceof vi)throw s;Qr(n,"network-request-failed",{message:String(s)})}}async function bd(n,e,t,r,s={}){const i=await Mo(n,e,t,r,s);return"mfaPendingCredential"in i&&Qr(n,"multi-factor-auth-required",{_serverResponse:i}),i}async function N2(n,e,t,r){const s=`${e}${t}?${r}`,i=n,o=i.config.emulator?Jx(n.config,s):`${n.config.apiScheme}://${s}`;return kz.includes(t)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function Pz(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Iz{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(_s(this.auth,"network-request-failed")),Az.get())})}}function bf(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const s=_s(n,e,r);return s.customData._tokenResponse=t,s}function dT(n){return n!==void 0&&n.enterprise!==void 0}class Rz{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return Pz(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function Oz(n,e){return Mo(n,"GET","/v2/recaptchaConfig",Do(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Nz(n,e){return Mo(n,"POST","/v1/accounts:delete",e)}async function Ag(n,e){return Mo(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rh(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function jz(n,e=!1){const t=Wt(n),r=await t.getIdToken(e),s=Zx(r);me(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:rh(Pv(s.auth_time)),issuedAtTime:rh(Pv(s.iat)),expirationTime:rh(Pv(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Pv(n){return Number(n)*1e3}function Zx(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Ap("JWT malformed, contained fewer than 3 sections"),null;try{const s=m2(t);return s?JSON.parse(s):(Ap("Failed to decode base64 JWT payload"),null)}catch(s){return Ap("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function fT(n){const e=Zx(n);return me(e,"internal-error"),me(typeof e.exp<"u","internal-error"),me(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vh(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof vi&&Dz(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function Dz({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mz{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iw{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=rh(this.lastLoginAt),this.creationTime=rh(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Pg(n){var h;const e=n.auth,t=await n.getIdToken(),r=await Vh(n,Ag(e,{idToken:t}));me(r==null?void 0:r.users.length,e,"internal-error");const s=r.users[0];n._notifyReloadListener(s);const i=(h=s.providerUserInfo)!=null&&h.length?j2(s.providerUserInfo):[],o=Fz(n.providerData,i),a=n.isAnonymous,l=!(n.email&&s.passwordHash)&&!(o!=null&&o.length),c=a?l:!1,u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Iw(s.createdAt,s.lastLoginAt),isAnonymous:c};Object.assign(n,u)}async function Lz(n){const e=Wt(n);await Pg(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Fz(n,e){return[...n.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function j2(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vz(n,e){const t=await O2(n,{},async()=>{const r=_d({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=n.config,o=await N2(n,s,"/v1/token",`key=${i}`),a=await n._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:a,body:r};return n.emulatorConfig&&zc(n.emulatorConfig.host)&&(l.credentials="include"),R2.fetch()(o,l)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function Uz(n,e){return Mo(n,"POST","/v2/accounts:revokeToken",Do(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){me(e.idToken,"internal-error"),me(typeof e.idToken<"u","internal-error"),me(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):fT(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){me(e.length!==0,"internal-error");const t=fT(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(me(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:s,expiresIn:i}=await Vz(e,t);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:s,expirationTime:i}=t,o=new Kl;return r&&(me(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(me(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(me(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Kl,this.toJSON())}_performRefresh(){return Gs("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oi(n,e){me(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class $r{constructor({uid:e,auth:t,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new Mz(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Iw(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await Vh(this,this.stsTokenManager.getToken(this.auth,e));return me(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return jz(this,e)}reload(){return Lz(this)}_assign(e){this!==e&&(me(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new $r({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){me(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await Pg(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(cr(this.auth.app))return Promise.reject(Js(this.auth));const e=await this.getIdToken();return await Vh(this,Nz(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,s=t.email??void 0,i=t.phoneNumber??void 0,o=t.photoURL??void 0,a=t.tenantId??void 0,l=t._redirectEventId??void 0,c=t.createdAt??void 0,u=t.lastLoginAt??void 0,{uid:h,emailVerified:f,isAnonymous:p,providerData:y,stsTokenManager:m}=t;me(h&&m,e,"internal-error");const v=Kl.fromJSON(this.name,m);me(typeof h=="string",e,"internal-error"),Oi(r,e.name),Oi(s,e.name),me(typeof f=="boolean",e,"internal-error"),me(typeof p=="boolean",e,"internal-error"),Oi(i,e.name),Oi(o,e.name),Oi(a,e.name),Oi(l,e.name),Oi(c,e.name),Oi(u,e.name);const w=new $r({uid:h,auth:e,email:s,emailVerified:f,displayName:r,isAnonymous:p,photoURL:o,phoneNumber:i,tenantId:a,stsTokenManager:v,createdAt:c,lastLoginAt:u});return y&&Array.isArray(y)&&(w.providerData=y.map(_=>({..._}))),l&&(w._redirectEventId=l),w}static async _fromIdTokenResponse(e,t,r=!1){const s=new Kl;s.updateFromServerResponse(t);const i=new $r({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Pg(i),i}static async _fromGetAccountInfoResponse(e,t,r){const s=t.users[0];me(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?j2(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),a=new Kl;a.updateFromIdToken(r);const l=new $r({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:o}),c={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Iw(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pT=new Map;function Ks(n){ci(n instanceof Function,"Expected a class definition");let e=pT.get(n);return e?(ci(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,pT.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D2{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}D2.type="NONE";const gT=D2;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pp(n,e,t){return`firebase:${n}:${e}:${t}`}class Yl{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Pp(this.userKey,s.apiKey,i),this.fullPersistenceKey=Pp("persistence",s.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Ag(this.auth,{idToken:e}).catch(()=>{});return t?$r._fromGetAccountInfoResponse(this.auth,t,e):null}return $r._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Yl(Ks(gT),e,r);const s=(await Promise.all(t.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let i=s[0]||Ks(gT);const o=Pp(r,e.config.apiKey,e.name);let a=null;for(const c of t)try{const u=await c._get(o);if(u){let h;if(typeof u=="string"){const f=await Ag(e,{idToken:u}).catch(()=>{});if(!f)break;h=await $r._fromGetAccountInfoResponse(e,f,u)}else h=$r._fromJSON(e,u);c!==i&&(a=h),i=c;break}}catch{}const l=s.filter(c=>c._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new Yl(i,e,r):(i=l[0],a&&await i._set(o,a.toJSON()),await Promise.all(t.map(async c=>{if(c!==i)try{await c._remove(o)}catch{}})),new Yl(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mT(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(V2(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(M2(e))return"Firefox";if(e.includes("silk/"))return"Silk";if($2(e))return"Blackberry";if(B2(e))return"Webos";if(L2(e))return"Safari";if((e.includes("chrome/")||F2(e))&&!e.includes("edge/"))return"Chrome";if(U2(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function M2(n=hn()){return/firefox\//i.test(n)}function L2(n=hn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function F2(n=hn()){return/crios\//i.test(n)}function V2(n=hn()){return/iemobile/i.test(n)}function U2(n=hn()){return/android/i.test(n)}function $2(n=hn()){return/blackberry/i.test(n)}function B2(n=hn()){return/webos/i.test(n)}function eb(n=hn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function $z(n=hn()){var e;return eb(n)&&!!((e=window.navigator)!=null&&e.standalone)}function Bz(){return nB()&&document.documentMode===10}function z2(n=hn()){return eb(n)||U2(n)||B2(n)||$2(n)||/windows phone/i.test(n)||V2(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W2(n,e=[]){let t;switch(n){case"Browser":t=mT(hn());break;case"Worker":t=`${mT(hn())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Wc}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zz{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=i=>new Promise((o,a)=>{try{const l=e(i);o(l)}catch(l){a(l)}});r.onAbort=t,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Wz(n,e={}){return Mo(n,"GET","/v2/passwordPolicy",Do(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hz=6;class qz{constructor(e){var r;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??Hz,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gz{constructor(e,t,r,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new yT(this),this.idTokenSubscription=new yT(this),this.beforeStateQueue=new zz(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=P2,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Ks(t)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await Yl.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Ag(this,{idToken:e}),r=await $r._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(cr(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(i=this.redirectUser)==null?void 0:i._redirectEventId,a=r==null?void 0:r._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(r=l.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return me(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Pg(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Tz()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(cr(this.app))return Promise.reject(Js(this));const t=e?Wt(e):null;return t&&me(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&me(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return cr(this.app)?Promise.reject(Js(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return cr(this.app)?Promise.reject(Js(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ks(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Wz(this),t=new qz(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new wd("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await Uz(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Ks(e)||this._popupRedirectResolver;me(t,this,"argument-error"),this.redirectPersistenceManager=await Yl.create(this,[Ks(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,s){if(this._deleted)return()=>{};const i=typeof t=="function"?t:t.next.bind(t);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(me(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,r,s);return()=>{o=!0,l()}}else{const l=e.addObserver(t);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return me(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=W2(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var t;if(cr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&bz(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Ka(n){return Wt(n)}class yT{constructor(e){this.auth=e,this.observer=null,this.addObserver=uB(t=>this.observer=t)}get next(){return me(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Fm={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Kz(n){Fm=n}function H2(n){return Fm.loadJS(n)}function Yz(){return Fm.recaptchaEnterpriseScript}function Xz(){return Fm.gapiScript}function Qz(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class Jz{constructor(){this.enterprise=new Zz}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class Zz{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const e9="recaptcha-enterprise",q2="NO_RECAPTCHA";class t9{constructor(e){this.type=e9,this.auth=Ka(e)}async verify(e="verify",t=!1){async function r(i){if(!t){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,a)=>{Oz(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const c=new Rz(l);return i.tenantId==null?i._agentRecaptchaConfig=c:i._tenantRecaptchaConfigs[i.tenantId]=c,o(c.siteKey)}}).catch(l=>{a(l)})})}function s(i,o,a){const l=window.grecaptcha;dT(l)?l.enterprise.ready(()=>{l.enterprise.execute(i,{action:e}).then(c=>{o(c)}).catch(()=>{o(q2)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new Jz().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{r(this.auth).then(a=>{if(!t&&dT(window.grecaptcha))s(a,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=Yz();l.length!==0&&(l+=a),H2(l).then(()=>{s(a,i,o)}).catch(c=>{o(c)})}}).catch(a=>{o(a)})})}}async function vT(n,e,t,r=!1,s=!1){const i=new t9(n);let o;if(s)o=q2;else try{o=await i.verify(t)}catch{o=await i.verify(t,!0)}const a={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const l=a.phoneEnrollmentInfo.phoneNumber,c=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:c,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const l=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function Rw(n,e,t,r,s){var i;if((i=n._getRecaptchaConfig())!=null&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await vT(n,e,t,t==="getOobCode");return r(n,o)}else return r(n,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await vT(n,e,t,t==="getOobCode");return r(n,a)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n9(n,e){const t=Xx(n,"auth");if(t.isInitialized()){const s=t.getImmediate(),i=t.getOptions();if(Da(i,e??{}))return s;Qr(s,"already-initialized")}return t.initialize({options:e})}function r9(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(Ks);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function s9(n,e,t){const r=Ka(n);me(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!!(t!=null&&t.disableWarnings),i=G2(e),{host:o,port:a}=i9(e),l=a===null?"":`:${a}`,c={url:`${i}//${o}${l}/`},u=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){me(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),me(Da(c,r.config.emulator)&&Da(u,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=c,r.emulatorConfig=u,r.settings.appVerificationDisabledForTesting=!0,zc(o)?(_2(`${i}//${o}${l}`),x2("Auth",!0)):o9()}function G2(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function i9(n){const e=G2(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:wT(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:wT(o)}}}function wT(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function o9(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tb{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Gs("not implemented")}_getIdTokenResponse(e){return Gs("not implemented")}_linkToIdToken(e,t){return Gs("not implemented")}_getReauthenticationResolver(e){return Gs("not implemented")}}async function a9(n,e){return Mo(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function l9(n,e){return bd(n,"POST","/v1/accounts:signInWithPassword",Do(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function c9(n,e){return bd(n,"POST","/v1/accounts:signInWithEmailLink",Do(n,e))}async function u9(n,e){return bd(n,"POST","/v1/accounts:signInWithEmailLink",Do(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uh extends tb{constructor(e,t,r,s=null){super("password",r),this._email=e,this._password=t,this._tenantId=s}static _fromEmailAndPassword(e,t){return new Uh(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new Uh(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Rw(e,t,"signInWithPassword",l9);case"emailLink":return c9(e,{email:this._email,oobCode:this._password});default:Qr(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Rw(e,r,"signUpPassword",a9);case"emailLink":return u9(e,{idToken:t,email:this._email,oobCode:this._password});default:Qr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xl(n,e){return bd(n,"POST","/v1/accounts:signInWithIdp",Do(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h9="http://localhost";class La extends tb{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new La(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Qr("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=t;if(!r||!s)return null;const o=new La(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return Xl(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Xl(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Xl(e,t)}buildRequest(){const e={requestUri:h9,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=_d(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d9(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function f9(n){const e=Lu(Fu(n)).link,t=e?Lu(Fu(e)).deep_link_id:null,r=Lu(Fu(n)).deep_link_id;return(r?Lu(Fu(r)).link:null)||r||t||e||n}class nb{constructor(e){const t=Lu(Fu(e)),r=t.apiKey??null,s=t.oobCode??null,i=d9(t.mode??null);me(r&&s&&i,"argument-error"),this.apiKey=r,this.operation=i,this.code=s,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=f9(e);try{return new nb(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hc{constructor(){this.providerId=Hc.PROVIDER_ID}static credential(e,t){return Uh._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=nb.parseLink(t);return me(r,"argument-error"),Uh._fromEmailAndCode(e,r.code,r.tenantId)}}Hc.PROVIDER_ID="password";Hc.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Hc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K2{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sd extends K2{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zi extends Sd{constructor(){super("facebook.com")}static credential(e){return La._fromParams({providerId:zi.PROVIDER_ID,signInMethod:zi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return zi.credentialFromTaggedObject(e)}static credentialFromError(e){return zi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return zi.credential(e.oauthAccessToken)}catch{return null}}}zi.FACEBOOK_SIGN_IN_METHOD="facebook.com";zi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wi extends Sd{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return La._fromParams({providerId:Wi.PROVIDER_ID,signInMethod:Wi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Wi.credentialFromTaggedObject(e)}static credentialFromError(e){return Wi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Wi.credential(t,r)}catch{return null}}}Wi.GOOGLE_SIGN_IN_METHOD="google.com";Wi.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hi extends Sd{constructor(){super("github.com")}static credential(e){return La._fromParams({providerId:Hi.PROVIDER_ID,signInMethod:Hi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Hi.credentialFromTaggedObject(e)}static credentialFromError(e){return Hi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Hi.credential(e.oauthAccessToken)}catch{return null}}}Hi.GITHUB_SIGN_IN_METHOD="github.com";Hi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qi extends Sd{constructor(){super("twitter.com")}static credential(e,t){return La._fromParams({providerId:qi.PROVIDER_ID,signInMethod:qi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return qi.credentialFromTaggedObject(e)}static credentialFromError(e){return qi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return qi.credential(t,r)}catch{return null}}}qi.TWITTER_SIGN_IN_METHOD="twitter.com";qi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function p9(n,e){return bd(n,"POST","/v1/accounts:signUp",Do(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fa{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,s=!1){const i=await $r._fromIdTokenResponse(e,r,s),o=_T(r);return new Fa({user:i,providerId:o,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const s=_T(r);return new Fa({user:e,providerId:s,_tokenResponse:r,operationType:t})}}function _T(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ig extends vi{constructor(e,t,r,s){super(t.code,t.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Ig.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,s){return new Ig(e,t,r,s)}}function Y2(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Ig._fromErrorAndOperation(n,i,e,r):i})}async function g9(n,e,t=!1){const r=await Vh(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Fa._forOperation(n,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function m9(n,e,t=!1){const{auth:r}=n;if(cr(r.app))return Promise.reject(Js(r));const s="reauthenticate";try{const i=await Vh(n,Y2(r,s,e,n),t);me(i.idToken,r,"internal-error");const o=Zx(i.idToken);me(o,r,"internal-error");const{sub:a}=o;return me(n.uid===a,r,"user-mismatch"),Fa._forOperation(n,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Qr(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function X2(n,e,t=!1){if(cr(n.app))return Promise.reject(Js(n));const r="signIn",s=await Y2(n,r,e),i=await Fa._fromIdTokenResponse(n,r,s);return t||await n._updateCurrentUser(i.user),i}async function y9(n,e){return X2(Ka(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Q2(n){const e=Ka(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function v9(n,e,t){if(cr(n.app))return Promise.reject(Js(n));const r=Ka(n),o=await Rw(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",p9).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&Q2(n),l}),a=await Fa._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(a.user),a}function w9(n,e,t){return cr(n.app)?Promise.reject(Js(n)):y9(Wt(n),Hc.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Q2(n),r})}function _9(n,e,t,r){return Wt(n).onIdTokenChanged(e,t,r)}function x9(n,e,t){return Wt(n).beforeAuthStateChanged(e,t)}function b9(n,e,t,r){return Wt(n).onAuthStateChanged(e,t,r)}function S9(n){return Wt(n).signOut()}const Rg="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J2{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Rg,"1"),this.storage.removeItem(Rg),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E9=1e3,T9=10;class Z2 extends J2{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=z2(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),s=this.localCache[t];r!==s&&e(t,s,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!t&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);Bz()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,T9):s()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},E9)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Z2.type="LOCAL";const C9=Z2;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eO extends J2{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}eO.type="SESSION";const tO=eO;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k9(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vm{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const r=new Vm(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:s,data:i}=t.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(o).map(async c=>c(t.origin,i)),l=await k9(a);t.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Vm.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rb(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A9{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,l)=>{const c=rb("",20);s.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(h){const f=h;if(f.data.eventId===c)switch(f.data.status){case"ack":clearTimeout(u),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(f.data.response);break;default:clearTimeout(u),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xs(){return window}function P9(n){xs().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nO(){return typeof xs().WorkerGlobalScope<"u"&&typeof xs().importScripts=="function"}async function I9(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function R9(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)==null?void 0:n.controller)||null}function O9(){return nO()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rO="firebaseLocalStorageDb",N9=1,Og="firebaseLocalStorage",sO="fbase_key";class Ed{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Um(n,e){return n.transaction([Og],e?"readwrite":"readonly").objectStore(Og)}function j9(){const n=indexedDB.deleteDatabase(rO);return new Ed(n).toPromise()}function Ow(){const n=indexedDB.open(rO,N9);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(Og,{keyPath:sO})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(Og)?e(r):(r.close(),await j9(),e(await Ow()))})})}async function xT(n,e,t){const r=Um(n,!0).put({[sO]:e,value:t});return new Ed(r).toPromise()}async function D9(n,e){const t=Um(n,!1).get(e),r=await new Ed(t).toPromise();return r===void 0?null:r.value}function bT(n,e){const t=Um(n,!0).delete(e);return new Ed(t).toPromise()}const M9=800,L9=3;class iO{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Ow(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>L9)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return nO()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Vm._getInstance(O9()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,r;if(this.activeServiceWorker=await I9(),!this.activeServiceWorker)return;this.sender=new A9(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||R9()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Ow();return await xT(e,Rg,"1"),await bT(e,Rg),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>xT(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>D9(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>bT(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Um(s,!1).getAll();return new Ed(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),M9)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}iO.type="LOCAL";const F9=iO;new xd(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V9(n,e){return e?Ks(e):(me(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sb extends tb{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Xl(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Xl(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Xl(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function U9(n){return X2(n.auth,new sb(n),n.bypassAuthState)}function $9(n){const{auth:e,user:t}=n;return me(t,e,"internal-error"),m9(t,new sb(n),n.bypassAuthState)}async function B9(n){const{auth:e,user:t}=n;return me(t,e,"internal-error"),g9(t,new sb(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oO{constructor(e,t,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:t,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return U9;case"linkViaPopup":case"linkViaRedirect":return B9;case"reauthViaPopup":case"reauthViaRedirect":return $9;default:Qr(this.auth,"internal-error")}}resolve(e){ci(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ci(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z9=new xd(2e3,1e4);class Dl extends oO{constructor(e,t,r,s,i){super(e,t,s,i),this.provider=r,this.authWindow=null,this.pollId=null,Dl.currentPopupAction&&Dl.currentPopupAction.cancel(),Dl.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return me(e,this.auth,"internal-error"),e}async onExecution(){ci(this.filter.length===1,"Popup operations only handle one event");const e=rb();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(_s(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(_s(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Dl.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if((r=(t=this.authWindow)==null?void 0:t.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(_s(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,z9.get())};e()}}Dl.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W9="pendingRedirect",Ip=new Map;class H9 extends oO{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Ip.get(this.auth._key());if(!e){try{const r=await q9(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Ip.set(this.auth._key(),e)}return this.bypassAuthState||Ip.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function q9(n,e){const t=Y9(e),r=K9(n);if(!await r._isAvailable())return!1;const s=await r._get(t)==="true";return await r._remove(t),s}function G9(n,e){Ip.set(n._key(),e)}function K9(n){return Ks(n._redirectPersistence)}function Y9(n){return Pp(W9,n.config.apiKey,n.name)}async function X9(n,e,t=!1){if(cr(n.app))return Promise.reject(Js(n));const r=Ka(n),s=V9(r,e),o=await new H9(r,s,t).execute();return o&&!t&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q9=10*60*1e3;class J9{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Z9(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!aO(e)){const s=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";t.onError(_s(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Q9&&this.cachedEventUids.clear(),this.cachedEventUids.has(ST(e))}saveEventToCache(e){this.cachedEventUids.add(ST(e)),this.lastProcessedEventTime=Date.now()}}function ST(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function aO({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function Z9(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return aO(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function e8(n,e={}){return Mo(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t8=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,n8=/^https?/;async function r8(n){if(n.config.emulator)return;const{authorizedDomains:e}=await e8(n);for(const t of e)try{if(s8(t))return}catch{}Qr(n,"unauthorized-domain")}function s8(n){const e=Pw(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!n8.test(t))return!1;if(t8.test(n))return r===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i8=new xd(3e4,6e4);function ET(){const n=xs().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function o8(n){return new Promise((e,t)=>{var s,i,o;function r(){ET(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{ET(),t(_s(n,"network-request-failed"))},timeout:i8.get()})}if((i=(s=xs().gapi)==null?void 0:s.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((o=xs().gapi)!=null&&o.load)r();else{const a=Qz("iframefcb");return xs()[a]=()=>{gapi.load?r():t(_s(n,"network-request-failed"))},H2(`${Xz()}?onload=${a}`).catch(l=>t(l))}}).catch(e=>{throw Rp=null,e})}let Rp=null;function a8(n){return Rp=Rp||o8(n),Rp}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l8=new xd(5e3,15e3),c8="__/auth/iframe",u8="emulator/auth/iframe",h8={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},d8=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function f8(n){const e=n.config;me(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Jx(e,u8):`https://${n.config.authDomain}/${c8}`,r={apiKey:e.apiKey,appName:n.name,v:Wc},s=d8.get(n.config.apiHost);s&&(r.eid=s);const i=n._getFrameworks();return i.length&&(r.fw=i.join(",")),`${t}?${_d(r).slice(1)}`}async function p8(n){const e=await a8(n),t=xs().gapi;return me(t,n,"internal-error"),e.open({where:document.body,url:f8(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:h8,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=_s(n,"network-request-failed"),a=xs().setTimeout(()=>{i(o)},l8.get());function l(){xs().clearTimeout(a),s(r)}r.ping(l).then(l,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g8={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},m8=500,y8=600,v8="_blank",w8="http://localhost";class TT{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function _8(n,e,t,r=m8,s=y8){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l={...g8,width:r.toString(),height:s.toString(),top:i,left:o},c=hn().toLowerCase();t&&(a=F2(c)?v8:t),M2(c)&&(e=e||w8,l.scrollbars="yes");const u=Object.entries(l).reduce((f,[p,y])=>`${f}${p}=${y},`,"");if($z(c)&&a!=="_self")return x8(e||"",a),new TT(null);const h=window.open(e||"",a,u);me(h,n,"popup-blocked");try{h.focus()}catch{}return new TT(h)}function x8(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b8="__/auth/handler",S8="emulator/auth/handler",E8=encodeURIComponent("fac");async function CT(n,e,t,r,s,i){me(n.config.authDomain,n,"auth-domain-config-required"),me(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Wc,eventId:s};if(e instanceof K2){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",cB(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,h]of Object.entries({}))o[u]=h}if(e instanceof Sd){const u=e.getScopes().filter(h=>h!=="");u.length>0&&(o.scopes=u.join(","))}n.tenantId&&(o.tid=n.tenantId);const a=o;for(const u of Object.keys(a))a[u]===void 0&&delete a[u];const l=await n._getAppCheckToken(),c=l?`#${E8}=${encodeURIComponent(l)}`:"";return`${T8(n)}?${_d(a).slice(1)}${c}`}function T8({config:n}){return n.emulator?Jx(n,S8):`https://${n.authDomain}/${b8}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iv="webStorageSupport";class C8{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=tO,this._completeRedirectFn=X9,this._overrideRedirectResult=G9}async _openPopup(e,t,r,s){var o;ci((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const i=await CT(e,t,r,Pw(),s);return _8(e,i,rb())}async _openRedirect(e,t,r,s){await this._originValidation(e);const i=await CT(e,t,r,Pw(),s);return P9(i),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:i}=this.eventManagers[t];return s?Promise.resolve(s):(ci(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await p8(e),r=new J9(e);return t.register("authEvent",s=>(me(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Iv,{type:Iv},s=>{var o;const i=(o=s==null?void 0:s[0])==null?void 0:o[Iv];i!==void 0&&t(!!i),Qr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=r8(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return z2()||L2()||eb()}}const k8=C8;var kT="@firebase/auth",AT="1.12.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A8{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){me(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P8(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function I8(n){bc(new Ma("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;me(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:W2(n)},c=new Gz(r,s,i,l);return r9(c,t),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),bc(new Ma("auth-internal",e=>{const t=Ka(e.getProvider("auth").getImmediate());return(r=>new A8(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),mo(kT,AT,P8(n)),mo(kT,AT,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R8=5*60,O8=w2("authIdTokenMaxAge")||R8;let PT=null;const N8=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>O8)return;const s=t==null?void 0:t.token;PT!==s&&(PT=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function j8(n=T2()){const e=Xx(n,"auth");if(e.isInitialized())return e.getImmediate();const t=n9(n,{popupRedirectResolver:k8,persistence:[F9,C9,tO]}),r=w2("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=N8(i.toString());x9(t,o,()=>o(t.currentUser)),_9(t,a=>o(a))}}const s=y2("auth");return s&&s9(t,`http://${s}`),t}function D8(){var n;return((n=document.getElementsByTagName("head"))==null?void 0:n[0])??document}Kz({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=s=>{const i=_s("internal-error");i.customData=s,t(i)},r.type="text/javascript",r.charset="UTF-8",D8().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});I8("Browser");var M8="firebase",L8="12.7.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */mo(M8,L8,"app");var IT=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var yo,lO;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(S,T){function P(){}P.prototype=T.prototype,S.F=T.prototype,S.prototype=new P,S.prototype.constructor=S,S.D=function(R,D,I){for(var k=Array(arguments.length-2),F=2;F<arguments.length;F++)k[F-2]=arguments[F];return T.prototype[D].apply(R,k)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(S,T,P){P||(P=0);const R=Array(16);if(typeof T=="string")for(var D=0;D<16;++D)R[D]=T.charCodeAt(P++)|T.charCodeAt(P++)<<8|T.charCodeAt(P++)<<16|T.charCodeAt(P++)<<24;else for(D=0;D<16;++D)R[D]=T[P++]|T[P++]<<8|T[P++]<<16|T[P++]<<24;T=S.g[0],P=S.g[1],D=S.g[2];let I=S.g[3],k;k=T+(I^P&(D^I))+R[0]+3614090360&4294967295,T=P+(k<<7&4294967295|k>>>25),k=I+(D^T&(P^D))+R[1]+3905402710&4294967295,I=T+(k<<12&4294967295|k>>>20),k=D+(P^I&(T^P))+R[2]+606105819&4294967295,D=I+(k<<17&4294967295|k>>>15),k=P+(T^D&(I^T))+R[3]+3250441966&4294967295,P=D+(k<<22&4294967295|k>>>10),k=T+(I^P&(D^I))+R[4]+4118548399&4294967295,T=P+(k<<7&4294967295|k>>>25),k=I+(D^T&(P^D))+R[5]+1200080426&4294967295,I=T+(k<<12&4294967295|k>>>20),k=D+(P^I&(T^P))+R[6]+2821735955&4294967295,D=I+(k<<17&4294967295|k>>>15),k=P+(T^D&(I^T))+R[7]+4249261313&4294967295,P=D+(k<<22&4294967295|k>>>10),k=T+(I^P&(D^I))+R[8]+1770035416&4294967295,T=P+(k<<7&4294967295|k>>>25),k=I+(D^T&(P^D))+R[9]+2336552879&4294967295,I=T+(k<<12&4294967295|k>>>20),k=D+(P^I&(T^P))+R[10]+4294925233&4294967295,D=I+(k<<17&4294967295|k>>>15),k=P+(T^D&(I^T))+R[11]+2304563134&4294967295,P=D+(k<<22&4294967295|k>>>10),k=T+(I^P&(D^I))+R[12]+1804603682&4294967295,T=P+(k<<7&4294967295|k>>>25),k=I+(D^T&(P^D))+R[13]+4254626195&4294967295,I=T+(k<<12&4294967295|k>>>20),k=D+(P^I&(T^P))+R[14]+2792965006&4294967295,D=I+(k<<17&4294967295|k>>>15),k=P+(T^D&(I^T))+R[15]+1236535329&4294967295,P=D+(k<<22&4294967295|k>>>10),k=T+(D^I&(P^D))+R[1]+4129170786&4294967295,T=P+(k<<5&4294967295|k>>>27),k=I+(P^D&(T^P))+R[6]+3225465664&4294967295,I=T+(k<<9&4294967295|k>>>23),k=D+(T^P&(I^T))+R[11]+643717713&4294967295,D=I+(k<<14&4294967295|k>>>18),k=P+(I^T&(D^I))+R[0]+3921069994&4294967295,P=D+(k<<20&4294967295|k>>>12),k=T+(D^I&(P^D))+R[5]+3593408605&4294967295,T=P+(k<<5&4294967295|k>>>27),k=I+(P^D&(T^P))+R[10]+38016083&4294967295,I=T+(k<<9&4294967295|k>>>23),k=D+(T^P&(I^T))+R[15]+3634488961&4294967295,D=I+(k<<14&4294967295|k>>>18),k=P+(I^T&(D^I))+R[4]+3889429448&4294967295,P=D+(k<<20&4294967295|k>>>12),k=T+(D^I&(P^D))+R[9]+568446438&4294967295,T=P+(k<<5&4294967295|k>>>27),k=I+(P^D&(T^P))+R[14]+3275163606&4294967295,I=T+(k<<9&4294967295|k>>>23),k=D+(T^P&(I^T))+R[3]+4107603335&4294967295,D=I+(k<<14&4294967295|k>>>18),k=P+(I^T&(D^I))+R[8]+1163531501&4294967295,P=D+(k<<20&4294967295|k>>>12),k=T+(D^I&(P^D))+R[13]+2850285829&4294967295,T=P+(k<<5&4294967295|k>>>27),k=I+(P^D&(T^P))+R[2]+4243563512&4294967295,I=T+(k<<9&4294967295|k>>>23),k=D+(T^P&(I^T))+R[7]+1735328473&4294967295,D=I+(k<<14&4294967295|k>>>18),k=P+(I^T&(D^I))+R[12]+2368359562&4294967295,P=D+(k<<20&4294967295|k>>>12),k=T+(P^D^I)+R[5]+4294588738&4294967295,T=P+(k<<4&4294967295|k>>>28),k=I+(T^P^D)+R[8]+2272392833&4294967295,I=T+(k<<11&4294967295|k>>>21),k=D+(I^T^P)+R[11]+1839030562&4294967295,D=I+(k<<16&4294967295|k>>>16),k=P+(D^I^T)+R[14]+4259657740&4294967295,P=D+(k<<23&4294967295|k>>>9),k=T+(P^D^I)+R[1]+2763975236&4294967295,T=P+(k<<4&4294967295|k>>>28),k=I+(T^P^D)+R[4]+1272893353&4294967295,I=T+(k<<11&4294967295|k>>>21),k=D+(I^T^P)+R[7]+4139469664&4294967295,D=I+(k<<16&4294967295|k>>>16),k=P+(D^I^T)+R[10]+3200236656&4294967295,P=D+(k<<23&4294967295|k>>>9),k=T+(P^D^I)+R[13]+681279174&4294967295,T=P+(k<<4&4294967295|k>>>28),k=I+(T^P^D)+R[0]+3936430074&4294967295,I=T+(k<<11&4294967295|k>>>21),k=D+(I^T^P)+R[3]+3572445317&4294967295,D=I+(k<<16&4294967295|k>>>16),k=P+(D^I^T)+R[6]+76029189&4294967295,P=D+(k<<23&4294967295|k>>>9),k=T+(P^D^I)+R[9]+3654602809&4294967295,T=P+(k<<4&4294967295|k>>>28),k=I+(T^P^D)+R[12]+3873151461&4294967295,I=T+(k<<11&4294967295|k>>>21),k=D+(I^T^P)+R[15]+530742520&4294967295,D=I+(k<<16&4294967295|k>>>16),k=P+(D^I^T)+R[2]+3299628645&4294967295,P=D+(k<<23&4294967295|k>>>9),k=T+(D^(P|~I))+R[0]+4096336452&4294967295,T=P+(k<<6&4294967295|k>>>26),k=I+(P^(T|~D))+R[7]+1126891415&4294967295,I=T+(k<<10&4294967295|k>>>22),k=D+(T^(I|~P))+R[14]+2878612391&4294967295,D=I+(k<<15&4294967295|k>>>17),k=P+(I^(D|~T))+R[5]+4237533241&4294967295,P=D+(k<<21&4294967295|k>>>11),k=T+(D^(P|~I))+R[12]+1700485571&4294967295,T=P+(k<<6&4294967295|k>>>26),k=I+(P^(T|~D))+R[3]+2399980690&4294967295,I=T+(k<<10&4294967295|k>>>22),k=D+(T^(I|~P))+R[10]+4293915773&4294967295,D=I+(k<<15&4294967295|k>>>17),k=P+(I^(D|~T))+R[1]+2240044497&4294967295,P=D+(k<<21&4294967295|k>>>11),k=T+(D^(P|~I))+R[8]+1873313359&4294967295,T=P+(k<<6&4294967295|k>>>26),k=I+(P^(T|~D))+R[15]+4264355552&4294967295,I=T+(k<<10&4294967295|k>>>22),k=D+(T^(I|~P))+R[6]+2734768916&4294967295,D=I+(k<<15&4294967295|k>>>17),k=P+(I^(D|~T))+R[13]+1309151649&4294967295,P=D+(k<<21&4294967295|k>>>11),k=T+(D^(P|~I))+R[4]+4149444226&4294967295,T=P+(k<<6&4294967295|k>>>26),k=I+(P^(T|~D))+R[11]+3174756917&4294967295,I=T+(k<<10&4294967295|k>>>22),k=D+(T^(I|~P))+R[2]+718787259&4294967295,D=I+(k<<15&4294967295|k>>>17),k=P+(I^(D|~T))+R[9]+3951481745&4294967295,S.g[0]=S.g[0]+T&4294967295,S.g[1]=S.g[1]+(D+(k<<21&4294967295|k>>>11))&4294967295,S.g[2]=S.g[2]+D&4294967295,S.g[3]=S.g[3]+I&4294967295}r.prototype.v=function(S,T){T===void 0&&(T=S.length);const P=T-this.blockSize,R=this.C;let D=this.h,I=0;for(;I<T;){if(D==0)for(;I<=P;)s(this,S,I),I+=this.blockSize;if(typeof S=="string"){for(;I<T;)if(R[D++]=S.charCodeAt(I++),D==this.blockSize){s(this,R),D=0;break}}else for(;I<T;)if(R[D++]=S[I++],D==this.blockSize){s(this,R),D=0;break}}this.h=D,this.o+=T},r.prototype.A=function(){var S=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);S[0]=128;for(var T=1;T<S.length-8;++T)S[T]=0;T=this.o*8;for(var P=S.length-8;P<S.length;++P)S[P]=T&255,T/=256;for(this.v(S),S=Array(16),T=0,P=0;P<4;++P)for(let R=0;R<32;R+=8)S[T++]=this.g[P]>>>R&255;return S};function i(S,T){var P=a;return Object.prototype.hasOwnProperty.call(P,S)?P[S]:P[S]=T(S)}function o(S,T){this.h=T;const P=[];let R=!0;for(let D=S.length-1;D>=0;D--){const I=S[D]|0;R&&I==T||(P[D]=I,R=!1)}this.g=P}var a={};function l(S){return-128<=S&&S<128?i(S,function(T){return new o([T|0],T<0?-1:0)}):new o([S|0],S<0?-1:0)}function c(S){if(isNaN(S)||!isFinite(S))return h;if(S<0)return v(c(-S));const T=[];let P=1;for(let R=0;S>=P;R++)T[R]=S/P|0,P*=4294967296;return new o(T,0)}function u(S,T){if(S.length==0)throw Error("number format error: empty string");if(T=T||10,T<2||36<T)throw Error("radix out of range: "+T);if(S.charAt(0)=="-")return v(u(S.substring(1),T));if(S.indexOf("-")>=0)throw Error('number format error: interior "-" character');const P=c(Math.pow(T,8));let R=h;for(let I=0;I<S.length;I+=8){var D=Math.min(8,S.length-I);const k=parseInt(S.substring(I,I+D),T);D<8?(D=c(Math.pow(T,D)),R=R.j(D).add(c(k))):(R=R.j(P),R=R.add(c(k)))}return R}var h=l(0),f=l(1),p=l(16777216);n=o.prototype,n.m=function(){if(m(this))return-v(this).m();let S=0,T=1;for(let P=0;P<this.g.length;P++){const R=this.i(P);S+=(R>=0?R:4294967296+R)*T,T*=4294967296}return S},n.toString=function(S){if(S=S||10,S<2||36<S)throw Error("radix out of range: "+S);if(y(this))return"0";if(m(this))return"-"+v(this).toString(S);const T=c(Math.pow(S,6));var P=this;let R="";for(;;){const D=A(P,T).g;P=w(P,D.j(T));let I=((P.g.length>0?P.g[0]:P.h)>>>0).toString(S);if(P=D,y(P))return I+R;for(;I.length<6;)I="0"+I;R=I+R}},n.i=function(S){return S<0?0:S<this.g.length?this.g[S]:this.h};function y(S){if(S.h!=0)return!1;for(let T=0;T<S.g.length;T++)if(S.g[T]!=0)return!1;return!0}function m(S){return S.h==-1}n.l=function(S){return S=w(this,S),m(S)?-1:y(S)?0:1};function v(S){const T=S.g.length,P=[];for(let R=0;R<T;R++)P[R]=~S.g[R];return new o(P,~S.h).add(f)}n.abs=function(){return m(this)?v(this):this},n.add=function(S){const T=Math.max(this.g.length,S.g.length),P=[];let R=0;for(let D=0;D<=T;D++){let I=R+(this.i(D)&65535)+(S.i(D)&65535),k=(I>>>16)+(this.i(D)>>>16)+(S.i(D)>>>16);R=k>>>16,I&=65535,k&=65535,P[D]=k<<16|I}return new o(P,P[P.length-1]&-2147483648?-1:0)};function w(S,T){return S.add(v(T))}n.j=function(S){if(y(this)||y(S))return h;if(m(this))return m(S)?v(this).j(v(S)):v(v(this).j(S));if(m(S))return v(this.j(v(S)));if(this.l(p)<0&&S.l(p)<0)return c(this.m()*S.m());const T=this.g.length+S.g.length,P=[];for(var R=0;R<2*T;R++)P[R]=0;for(R=0;R<this.g.length;R++)for(let D=0;D<S.g.length;D++){const I=this.i(R)>>>16,k=this.i(R)&65535,F=S.i(D)>>>16,K=S.i(D)&65535;P[2*R+2*D]+=k*K,_(P,2*R+2*D),P[2*R+2*D+1]+=I*K,_(P,2*R+2*D+1),P[2*R+2*D+1]+=k*F,_(P,2*R+2*D+1),P[2*R+2*D+2]+=I*F,_(P,2*R+2*D+2)}for(S=0;S<T;S++)P[S]=P[2*S+1]<<16|P[2*S];for(S=T;S<2*T;S++)P[S]=0;return new o(P,0)};function _(S,T){for(;(S[T]&65535)!=S[T];)S[T+1]+=S[T]>>>16,S[T]&=65535,T++}function x(S,T){this.g=S,this.h=T}function A(S,T){if(y(T))throw Error("division by zero");if(y(S))return new x(h,h);if(m(S))return T=A(v(S),T),new x(v(T.g),v(T.h));if(m(T))return T=A(S,v(T)),new x(v(T.g),T.h);if(S.g.length>30){if(m(S)||m(T))throw Error("slowDivide_ only works with positive integers.");for(var P=f,R=T;R.l(S)<=0;)P=j(P),R=j(R);var D=N(P,1),I=N(R,1);for(R=N(R,2),P=N(P,2);!y(R);){var k=I.add(R);k.l(S)<=0&&(D=D.add(P),I=k),R=N(R,1),P=N(P,1)}return T=w(S,D.j(T)),new x(D,T)}for(D=h;S.l(T)>=0;){for(P=Math.max(1,Math.floor(S.m()/T.m())),R=Math.ceil(Math.log(P)/Math.LN2),R=R<=48?1:Math.pow(2,R-48),I=c(P),k=I.j(T);m(k)||k.l(S)>0;)P-=R,I=c(P),k=I.j(T);y(I)&&(I=f),D=D.add(I),S=w(S,k)}return new x(D,S)}n.B=function(S){return A(this,S).h},n.and=function(S){const T=Math.max(this.g.length,S.g.length),P=[];for(let R=0;R<T;R++)P[R]=this.i(R)&S.i(R);return new o(P,this.h&S.h)},n.or=function(S){const T=Math.max(this.g.length,S.g.length),P=[];for(let R=0;R<T;R++)P[R]=this.i(R)|S.i(R);return new o(P,this.h|S.h)},n.xor=function(S){const T=Math.max(this.g.length,S.g.length),P=[];for(let R=0;R<T;R++)P[R]=this.i(R)^S.i(R);return new o(P,this.h^S.h)};function j(S){const T=S.g.length+1,P=[];for(let R=0;R<T;R++)P[R]=S.i(R)<<1|S.i(R-1)>>>31;return new o(P,S.h)}function N(S,T){const P=T>>5;T%=32;const R=S.g.length-P,D=[];for(let I=0;I<R;I++)D[I]=T>0?S.i(I+P)>>>T|S.i(I+P+1)<<32-T:S.i(I+P);return new o(D,S.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,lO=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=u,yo=o}).apply(typeof IT<"u"?IT:typeof self<"u"?self:typeof window<"u"?window:{});var Sf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var cO,Vu,uO,Op,Nw,hO,dO,fO;(function(){var n,e=Object.defineProperty;function t(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof Sf=="object"&&Sf];for(var b=0;b<d.length;++b){var E=d[b];if(E&&E.Math==Math)return E}throw Error("Cannot find global object")}var r=t(this);function s(d,b){if(b)e:{var E=r;d=d.split(".");for(var O=0;O<d.length-1;O++){var U=d[O];if(!(U in E))break e;E=E[U]}d=d[d.length-1],O=E[d],b=b(O),b!=O&&b!=null&&e(E,d,{configurable:!0,writable:!0,value:b})}}s("Symbol.dispose",function(d){return d||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(d){return d||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(d){return d||function(b){var E=[],O;for(O in b)Object.prototype.hasOwnProperty.call(b,O)&&E.push([O,b[O]]);return E}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},o=this||self;function a(d){var b=typeof d;return b=="object"&&d!=null||b=="function"}function l(d,b,E){return d.call.apply(d.bind,arguments)}function c(d,b,E){return c=l,c.apply(null,arguments)}function u(d,b){var E=Array.prototype.slice.call(arguments,1);return function(){var O=E.slice();return O.push.apply(O,arguments),d.apply(this,O)}}function h(d,b){function E(){}E.prototype=b.prototype,d.Z=b.prototype,d.prototype=new E,d.prototype.constructor=d,d.Ob=function(O,U,B){for(var ee=Array(arguments.length-2),Ee=2;Ee<arguments.length;Ee++)ee[Ee-2]=arguments[Ee];return b.prototype[U].apply(O,ee)}}var f=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?d=>d&&AsyncContext.Snapshot.wrap(d):d=>d;function p(d){const b=d.length;if(b>0){const E=Array(b);for(let O=0;O<b;O++)E[O]=d[O];return E}return[]}function y(d,b){for(let O=1;O<arguments.length;O++){const U=arguments[O];var E=typeof U;if(E=E!="object"?E:U?Array.isArray(U)?"array":E:"null",E=="array"||E=="object"&&typeof U.length=="number"){E=d.length||0;const B=U.length||0;d.length=E+B;for(let ee=0;ee<B;ee++)d[E+ee]=U[ee]}else d.push(U)}}class m{constructor(b,E){this.i=b,this.j=E,this.h=0,this.g=null}get(){let b;return this.h>0?(this.h--,b=this.g,this.g=b.next,b.next=null):b=this.i(),b}}function v(d){o.setTimeout(()=>{throw d},0)}function w(){var d=S;let b=null;return d.g&&(b=d.g,d.g=d.g.next,d.g||(d.h=null),b.next=null),b}class _{constructor(){this.h=this.g=null}add(b,E){const O=x.get();O.set(b,E),this.h?this.h.next=O:this.g=O,this.h=O}}var x=new m(()=>new A,d=>d.reset());class A{constructor(){this.next=this.g=this.h=null}set(b,E){this.h=b,this.g=E,this.next=null}reset(){this.next=this.g=this.h=null}}let j,N=!1,S=new _,T=()=>{const d=Promise.resolve(void 0);j=()=>{d.then(P)}};function P(){for(var d;d=w();){try{d.h.call(d.g)}catch(E){v(E)}var b=x;b.j(d),b.h<100&&(b.h++,d.next=b.g,b.g=d)}N=!1}function R(){this.u=this.u,this.C=this.C}R.prototype.u=!1,R.prototype.dispose=function(){this.u||(this.u=!0,this.N())},R.prototype[Symbol.dispose]=function(){this.dispose()},R.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function D(d,b){this.type=d,this.g=this.target=b,this.defaultPrevented=!1}D.prototype.h=function(){this.defaultPrevented=!0};var I=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var d=!1,b=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const E=()=>{};o.addEventListener("test",E,b),o.removeEventListener("test",E,b)}catch{}return d}();function k(d){return/^[\s\xa0]*$/.test(d)}function F(d,b){D.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d&&this.init(d,b)}h(F,D),F.prototype.init=function(d,b){const E=this.type=d.type,O=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;this.target=d.target||d.srcElement,this.g=b,b=d.relatedTarget,b||(E=="mouseover"?b=d.fromElement:E=="mouseout"&&(b=d.toElement)),this.relatedTarget=b,O?(this.clientX=O.clientX!==void 0?O.clientX:O.pageX,this.clientY=O.clientY!==void 0?O.clientY:O.pageY,this.screenX=O.screenX||0,this.screenY=O.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=d.pointerType,this.state=d.state,this.i=d,d.defaultPrevented&&F.Z.h.call(this)},F.prototype.h=function(){F.Z.h.call(this);const d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var K="closure_listenable_"+(Math.random()*1e6|0),G=0;function Y(d,b,E,O,U){this.listener=d,this.proxy=null,this.src=b,this.type=E,this.capture=!!O,this.ha=U,this.key=++G,this.da=this.fa=!1}function V(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function z(d,b,E){for(const O in d)b.call(E,d[O],O,d)}function Q(d,b){for(const E in d)b.call(void 0,d[E],E,d)}function ue(d){const b={};for(const E in d)b[E]=d[E];return b}const oe="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function fe(d,b){let E,O;for(let U=1;U<arguments.length;U++){O=arguments[U];for(E in O)d[E]=O[E];for(let B=0;B<oe.length;B++)E=oe[B],Object.prototype.hasOwnProperty.call(O,E)&&(d[E]=O[E])}}function ce(d){this.src=d,this.g={},this.h=0}ce.prototype.add=function(d,b,E,O,U){const B=d.toString();d=this.g[B],d||(d=this.g[B]=[],this.h++);const ee=je(d,b,O,U);return ee>-1?(b=d[ee],E||(b.fa=!1)):(b=new Y(b,this.src,B,!!O,U),b.fa=E,d.push(b)),b};function Ne(d,b){const E=b.type;if(E in d.g){var O=d.g[E],U=Array.prototype.indexOf.call(O,b,void 0),B;(B=U>=0)&&Array.prototype.splice.call(O,U,1),B&&(V(b),d.g[E].length==0&&(delete d.g[E],d.h--))}}function je(d,b,E,O){for(let U=0;U<d.length;++U){const B=d[U];if(!B.da&&B.listener==b&&B.capture==!!E&&B.ha==O)return U}return-1}var Z="closure_lm_"+(Math.random()*1e6|0),Re={};function ze(d,b,E,O,U){if(Array.isArray(b)){for(let B=0;B<b.length;B++)ze(d,b[B],E,O,U);return null}return E=xi(E),d&&d[K]?d.J(b,E,a(O)?!!O.capture:!!O,U):xe(d,b,E,!1,O,U)}function xe(d,b,E,O,U,B){if(!b)throw Error("Invalid event type");const ee=a(U)?!!U.capture:!!U;let Ee=rr(d);if(Ee||(d[Z]=Ee=new ce(d)),E=Ee.add(b,E,O,ee,B),E.proxy)return E;if(O=ke(),E.proxy=O,O.src=d,O.listener=E,d.addEventListener)I||(U=ee),U===void 0&&(U=!1),d.addEventListener(b.toString(),O,U);else if(d.attachEvent)d.attachEvent(dn(b.toString()),O);else if(d.addListener&&d.removeListener)d.addListener(O);else throw Error("addEventListener and attachEvent are unavailable.");return E}function ke(){function d(E){return b.call(d.src,d.listener,E)}const b=Os;return d}function Oe(d,b,E,O,U){if(Array.isArray(b))for(var B=0;B<b.length;B++)Oe(d,b[B],E,O,U);else O=a(O)?!!O.capture:!!O,E=xi(E),d&&d[K]?(d=d.i,B=String(b).toString(),B in d.g&&(b=d.g[B],E=je(b,E,O,U),E>-1&&(V(b[E]),Array.prototype.splice.call(b,E,1),b.length==0&&(delete d.g[B],d.h--)))):d&&(d=rr(d))&&(b=d.g[b.toString()],d=-1,b&&(d=je(b,E,O,U)),(E=d>-1?b[d]:null)&&bt(E))}function bt(d){if(typeof d!="number"&&d&&!d.da){var b=d.src;if(b&&b[K])Ne(b.i,d);else{var E=d.type,O=d.proxy;b.removeEventListener?b.removeEventListener(E,O,d.capture):b.detachEvent?b.detachEvent(dn(E),O):b.addListener&&b.removeListener&&b.removeListener(O),(E=rr(b))?(Ne(E,d),E.h==0&&(E.src=null,b[Z]=null)):V(d)}}}function dn(d){return d in Re?Re[d]:Re[d]="on"+d}function Os(d,b){if(d.da)d=!0;else{b=new F(b,this);const E=d.listener,O=d.ha||d.src;d.fa&&bt(d),d=E.call(O,b)}return d}function rr(d){return d=d[Z],d instanceof ce?d:null}var _r="__closure_events_fn_"+(Math.random()*1e9>>>0);function xi(d){return typeof d=="function"?d:(d[_r]||(d[_r]=function(b){return d.handleEvent(b)}),d[_r])}function at(){R.call(this),this.i=new ce(this),this.M=this,this.G=null}h(at,R),at.prototype[K]=!0,at.prototype.removeEventListener=function(d,b,E,O){Oe(this,d,b,E,O)};function Ft(d,b){var E,O=d.G;if(O)for(E=[];O;O=O.G)E.push(O);if(d=d.M,O=b.type||b,typeof b=="string")b=new D(b,d);else if(b instanceof D)b.target=b.target||d;else{var U=b;b=new D(O,d),fe(b,U)}U=!0;let B,ee;if(E)for(ee=E.length-1;ee>=0;ee--)B=b.g=E[ee],U=es(B,O,!0,b)&&U;if(B=b.g=d,U=es(B,O,!0,b)&&U,U=es(B,O,!1,b)&&U,E)for(ee=0;ee<E.length;ee++)B=b.g=E[ee],U=es(B,O,!1,b)&&U}at.prototype.N=function(){if(at.Z.N.call(this),this.i){var d=this.i;for(const b in d.g){const E=d.g[b];for(let O=0;O<E.length;O++)V(E[O]);delete d.g[b],d.h--}}this.G=null},at.prototype.J=function(d,b,E,O){return this.i.add(String(d),b,!1,E,O)},at.prototype.K=function(d,b,E,O){return this.i.add(String(d),b,!0,E,O)};function es(d,b,E,O){if(b=d.i.g[String(b)],!b)return!0;b=b.concat();let U=!0;for(let B=0;B<b.length;++B){const ee=b[B];if(ee&&!ee.da&&ee.capture==E){const Ee=ee.listener,Rt=ee.ha||ee.src;ee.fa&&Ne(d.i,ee),U=Ee.call(Rt,O)!==!1&&U}}return U&&!O.defaultPrevented}function Fd(d,b){if(typeof d!="function")if(d&&typeof d.handleEvent=="function")d=c(d.handleEvent,d);else throw Error("Invalid listener argument");return Number(b)>2147483647?-1:o.setTimeout(d,b||0)}function ts(d){d.g=Fd(()=>{d.g=null,d.i&&(d.i=!1,ts(d))},d.l);const b=d.h;d.h=null,d.m.apply(null,b)}class Cy extends R{constructor(b,E){super(),this.m=b,this.l=E,this.h=null,this.i=!1,this.g=null}j(b){this.h=arguments,this.g?this.i=!0:ts(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ho(d){R.call(this),this.h=d,this.g={}}h(Ho,R);var fn=[];function Ns(d){z(d.g,function(b,E){this.g.hasOwnProperty(E)&&bt(b)},d),d.g={}}Ho.prototype.N=function(){Ho.Z.N.call(this),Ns(this)},Ho.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var au=o.JSON.stringify,ky=o.JSON.parse,Za=class{stringify(d){return o.JSON.stringify(d,void 0)}parse(d){return o.JSON.parse(d,void 0)}};function Vd(){}function lu(){}var js={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function ns(){D.call(this,"d")}h(ns,D);function el(){D.call(this,"c")}h(el,D);var Tn={},Ud=null;function tl(){return Ud=Ud||new at}Tn.Ia="serverreachability";function cu(d){D.call(this,Tn.Ia,d)}h(cu,D);function bi(d){const b=tl();Ft(b,new cu(b))}Tn.STAT_EVENT="statevent";function $d(d,b){D.call(this,Tn.STAT_EVENT,d),this.stat=b}h($d,D);function It(d){const b=tl();Ft(b,new $d(b,d))}Tn.Ja="timingevent";function xr(d,b){D.call(this,Tn.Ja,d),this.size=b}h(xr,D);function qo(d,b){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){d()},b)}function ge(){this.g=!0}ge.prototype.ua=function(){this.g=!1};function Ue(d,b,E,O,U,B){d.info(function(){if(d.g)if(B){var ee="",Ee=B.split("&");for(let qe=0;qe<Ee.length;qe++){var Rt=Ee[qe].split("=");if(Rt.length>1){const Ut=Rt[0];Rt=Rt[1];const is=Ut.split("_");ee=is.length>=2&&is[1]=="type"?ee+(Ut+"="+Rt+"&"):ee+(Ut+"=redacted&")}}}else ee=null;else ee=B;return"XMLHTTP REQ ("+O+") [attempt "+U+"]: "+b+`
`+E+`
`+ee})}function Ke(d,b,E,O,U,B,ee){d.info(function(){return"XMLHTTP RESP ("+O+") [ attempt "+U+"]: "+b+`
`+E+`
`+B+" "+ee})}function Vt(d,b,E,O){d.info(function(){return"XMLHTTP TEXT ("+b+"): "+rs(d,E)+(O?" "+O:"")})}function Un(d,b){d.info(function(){return"TIMEOUT: "+b})}ge.prototype.info=function(){};function rs(d,b){if(!d.g)return b;if(!b)return null;try{const B=JSON.parse(b);if(B){for(d=0;d<B.length;d++)if(Array.isArray(B[d])){var E=B[d];if(!(E.length<2)){var O=E[1];if(Array.isArray(O)&&!(O.length<1)){var U=O[0];if(U!="noop"&&U!="stop"&&U!="close")for(let ee=1;ee<O.length;ee++)O[ee]=""}}}}return au(B)}catch{return b}}var sr={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Cn={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},br;function Ay(){}h(Ay,Vd),Ay.prototype.g=function(){return new XMLHttpRequest},br=new Ay;function uu(d){return encodeURIComponent(String(d))}function sL(d){var b=1;d=d.split(":");const E=[];for(;b>0&&d.length;)E.push(d.shift()),b--;return d.length&&E.push(d.join(":")),E}function Si(d,b,E,O){this.j=d,this.i=b,this.l=E,this.S=O||1,this.V=new Ho(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new v1}function v1(){this.i=null,this.g="",this.h=!1}var w1={},Py={};function Iy(d,b,E){d.M=1,d.A=zd(ss(b)),d.u=E,d.R=!0,_1(d,null)}function _1(d,b){d.F=Date.now(),Bd(d),d.B=ss(d.A);var E=d.B,O=d.S;Array.isArray(O)||(O=[String(O)]),N1(E.i,"t",O),d.C=0,E=d.j.L,d.h=new v1,d.g=Q1(d.j,E?b:null,!d.u),d.P>0&&(d.O=new Cy(c(d.Y,d,d.g),d.P)),b=d.V,E=d.g,O=d.ba;var U="readystatechange";Array.isArray(U)||(U&&(fn[0]=U.toString()),U=fn);for(let B=0;B<U.length;B++){const ee=ze(E,U[B],O||b.handleEvent,!1,b.h||b);if(!ee)break;b.g[ee.key]=ee}b=d.J?ue(d.J):{},d.u?(d.v||(d.v="POST"),b["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.B,d.v,d.u,b)):(d.v="GET",d.g.ea(d.B,d.v,null,b)),bi(),Ue(d.i,d.v,d.B,d.l,d.S,d.u)}Si.prototype.ba=function(d){d=d.target;const b=this.O;b&&Ci(d)==3?b.j():this.Y(d)},Si.prototype.Y=function(d){try{if(d==this.g)e:{const Ee=Ci(this.g),Rt=this.g.ya(),qe=this.g.ca();if(!(Ee<3)&&(Ee!=3||this.g&&(this.h.h||this.g.la()||U1(this.g)))){this.K||Ee!=4||Rt==7||(Rt==8||qe<=0?bi(3):bi(2)),Ry(this);var b=this.g.ca();this.X=b;var E=iL(this);if(this.o=b==200,Ke(this.i,this.v,this.B,this.l,this.S,Ee,b),this.o){if(this.U&&!this.L){t:{if(this.g){var O,U=this.g;if((O=U.g?U.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(O)){var B=O;break t}}B=null}if(d=B)Vt(this.i,this.l,d,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Oy(this,d);else{this.o=!1,this.m=3,It(12),Go(this),hu(this);break e}}if(this.R){d=!0;let Ut;for(;!this.K&&this.C<E.length;)if(Ut=oL(this,E),Ut==Py){Ee==4&&(this.m=4,It(14),d=!1),Vt(this.i,this.l,null,"[Incomplete Response]");break}else if(Ut==w1){this.m=4,It(15),Vt(this.i,this.l,E,"[Invalid Chunk]"),d=!1;break}else Vt(this.i,this.l,Ut,null),Oy(this,Ut);if(x1(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ee!=4||E.length!=0||this.h.h||(this.m=1,It(16),d=!1),this.o=this.o&&d,!d)Vt(this.i,this.l,E,"[Invalid Chunked Response]"),Go(this),hu(this);else if(E.length>0&&!this.W){this.W=!0;var ee=this.j;ee.g==this&&ee.aa&&!ee.P&&(ee.j.info("Great, no buffering proxy detected. Bytes received: "+E.length),Uy(ee),ee.P=!0,It(11))}}else Vt(this.i,this.l,E,null),Oy(this,E);Ee==4&&Go(this),this.o&&!this.K&&(Ee==4?G1(this.j,this):(this.o=!1,Bd(this)))}else _L(this.g),b==400&&E.indexOf("Unknown SID")>0?(this.m=3,It(12)):(this.m=0,It(13)),Go(this),hu(this)}}}catch{}finally{}};function iL(d){if(!x1(d))return d.g.la();const b=U1(d.g);if(b==="")return"";let E="";const O=b.length,U=Ci(d.g)==4;if(!d.h.i){if(typeof TextDecoder>"u")return Go(d),hu(d),"";d.h.i=new o.TextDecoder}for(let B=0;B<O;B++)d.h.h=!0,E+=d.h.i.decode(b[B],{stream:!(U&&B==O-1)});return b.length=0,d.h.g+=E,d.C=0,d.h.g}function x1(d){return d.g?d.v=="GET"&&d.M!=2&&d.j.Aa:!1}function oL(d,b){var E=d.C,O=b.indexOf(`
`,E);return O==-1?Py:(E=Number(b.substring(E,O)),isNaN(E)?w1:(O+=1,O+E>b.length?Py:(b=b.slice(O,O+E),d.C=O+E,b)))}Si.prototype.cancel=function(){this.K=!0,Go(this)};function Bd(d){d.T=Date.now()+d.H,b1(d,d.H)}function b1(d,b){if(d.D!=null)throw Error("WatchDog timer not null");d.D=qo(c(d.aa,d),b)}function Ry(d){d.D&&(o.clearTimeout(d.D),d.D=null)}Si.prototype.aa=function(){this.D=null;const d=Date.now();d-this.T>=0?(Un(this.i,this.B),this.M!=2&&(bi(),It(17)),Go(this),this.m=2,hu(this)):b1(this,this.T-d)};function hu(d){d.j.I==0||d.K||G1(d.j,d)}function Go(d){Ry(d);var b=d.O;b&&typeof b.dispose=="function"&&b.dispose(),d.O=null,Ns(d.V),d.g&&(b=d.g,d.g=null,b.abort(),b.dispose())}function Oy(d,b){try{var E=d.j;if(E.I!=0&&(E.g==d||Ny(E.h,d))){if(!d.L&&Ny(E.h,d)&&E.I==3){try{var O=E.Ba.g.parse(b)}catch{O=null}if(Array.isArray(O)&&O.length==3){var U=O;if(U[0]==0){e:if(!E.v){if(E.g)if(E.g.F+3e3<d.F)Kd(E),qd(E);else break e;Vy(E),It(18)}}else E.xa=U[1],0<E.xa-E.K&&U[2]<37500&&E.F&&E.A==0&&!E.C&&(E.C=qo(c(E.Va,E),6e3));T1(E.h)<=1&&E.ta&&(E.ta=void 0)}else Yo(E,11)}else if((d.L||E.g==d)&&Kd(E),!k(b))for(U=E.Ba.g.parse(b),b=0;b<U.length;b++){let qe=U[b];const Ut=qe[0];if(!(Ut<=E.K))if(E.K=Ut,qe=qe[1],E.I==2)if(qe[0]=="c"){E.M=qe[1],E.ba=qe[2];const is=qe[3];is!=null&&(E.ka=is,E.j.info("VER="+E.ka));const Xo=qe[4];Xo!=null&&(E.za=Xo,E.j.info("SVER="+E.za));const ki=qe[5];ki!=null&&typeof ki=="number"&&ki>0&&(O=1.5*ki,E.O=O,E.j.info("backChannelRequestTimeoutMs_="+O)),O=E;const Ai=d.g;if(Ai){const Xd=Ai.g?Ai.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Xd){var B=O.h;B.g||Xd.indexOf("spdy")==-1&&Xd.indexOf("quic")==-1&&Xd.indexOf("h2")==-1||(B.j=B.l,B.g=new Set,B.h&&(jy(B,B.h),B.h=null))}if(O.G){const $y=Ai.g?Ai.g.getResponseHeader("X-HTTP-Session-Id"):null;$y&&(O.wa=$y,Ze(O.J,O.G,$y))}}E.I=3,E.l&&E.l.ra(),E.aa&&(E.T=Date.now()-d.F,E.j.info("Handshake RTT: "+E.T+"ms")),O=E;var ee=d;if(O.na=X1(O,O.L?O.ba:null,O.W),ee.L){C1(O.h,ee);var Ee=ee,Rt=O.O;Rt&&(Ee.H=Rt),Ee.D&&(Ry(Ee),Bd(Ee)),O.g=ee}else H1(O);E.i.length>0&&Gd(E)}else qe[0]!="stop"&&qe[0]!="close"||Yo(E,7);else E.I==3&&(qe[0]=="stop"||qe[0]=="close"?qe[0]=="stop"?Yo(E,7):Fy(E):qe[0]!="noop"&&E.l&&E.l.qa(qe),E.A=0)}}bi(4)}catch{}}var aL=class{constructor(d,b){this.g=d,this.map=b}};function S1(d){this.l=d||10,o.PerformanceNavigationTiming?(d=o.performance.getEntriesByType("navigation"),d=d.length>0&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function E1(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function T1(d){return d.h?1:d.g?d.g.size:0}function Ny(d,b){return d.h?d.h==b:d.g?d.g.has(b):!1}function jy(d,b){d.g?d.g.add(b):d.h=b}function C1(d,b){d.h&&d.h==b?d.h=null:d.g&&d.g.has(b)&&d.g.delete(b)}S1.prototype.cancel=function(){if(this.i=k1(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function k1(d){if(d.h!=null)return d.i.concat(d.h.G);if(d.g!=null&&d.g.size!==0){let b=d.i;for(const E of d.g.values())b=b.concat(E.G);return b}return p(d.i)}var A1=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function lL(d,b){if(d){d=d.split("&");for(let E=0;E<d.length;E++){const O=d[E].indexOf("=");let U,B=null;O>=0?(U=d[E].substring(0,O),B=d[E].substring(O+1)):U=d[E],b(U,B?decodeURIComponent(B.replace(/\+/g," ")):"")}}}function Ei(d){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let b;d instanceof Ei?(this.l=d.l,du(this,d.j),this.o=d.o,this.g=d.g,fu(this,d.u),this.h=d.h,Dy(this,j1(d.i)),this.m=d.m):d&&(b=String(d).match(A1))?(this.l=!1,du(this,b[1]||"",!0),this.o=pu(b[2]||""),this.g=pu(b[3]||"",!0),fu(this,b[4]),this.h=pu(b[5]||"",!0),Dy(this,b[6]||"",!0),this.m=pu(b[7]||"")):(this.l=!1,this.i=new mu(null,this.l))}Ei.prototype.toString=function(){const d=[];var b=this.j;b&&d.push(gu(b,P1,!0),":");var E=this.g;return(E||b=="file")&&(d.push("//"),(b=this.o)&&d.push(gu(b,P1,!0),"@"),d.push(uu(E).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),E=this.u,E!=null&&d.push(":",String(E))),(E=this.h)&&(this.g&&E.charAt(0)!="/"&&d.push("/"),d.push(gu(E,E.charAt(0)=="/"?hL:uL,!0))),(E=this.i.toString())&&d.push("?",E),(E=this.m)&&d.push("#",gu(E,fL)),d.join("")},Ei.prototype.resolve=function(d){const b=ss(this);let E=!!d.j;E?du(b,d.j):E=!!d.o,E?b.o=d.o:E=!!d.g,E?b.g=d.g:E=d.u!=null;var O=d.h;if(E)fu(b,d.u);else if(E=!!d.h){if(O.charAt(0)!="/")if(this.g&&!this.h)O="/"+O;else{var U=b.h.lastIndexOf("/");U!=-1&&(O=b.h.slice(0,U+1)+O)}if(U=O,U==".."||U==".")O="";else if(U.indexOf("./")!=-1||U.indexOf("/.")!=-1){O=U.lastIndexOf("/",0)==0,U=U.split("/");const B=[];for(let ee=0;ee<U.length;){const Ee=U[ee++];Ee=="."?O&&ee==U.length&&B.push(""):Ee==".."?((B.length>1||B.length==1&&B[0]!="")&&B.pop(),O&&ee==U.length&&B.push("")):(B.push(Ee),O=!0)}O=B.join("/")}else O=U}return E?b.h=O:E=d.i.toString()!=="",E?Dy(b,j1(d.i)):E=!!d.m,E&&(b.m=d.m),b};function ss(d){return new Ei(d)}function du(d,b,E){d.j=E?pu(b,!0):b,d.j&&(d.j=d.j.replace(/:$/,""))}function fu(d,b){if(b){if(b=Number(b),isNaN(b)||b<0)throw Error("Bad port number "+b);d.u=b}else d.u=null}function Dy(d,b,E){b instanceof mu?(d.i=b,pL(d.i,d.l)):(E||(b=gu(b,dL)),d.i=new mu(b,d.l))}function Ze(d,b,E){d.i.set(b,E)}function zd(d){return Ze(d,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),d}function pu(d,b){return d?b?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function gu(d,b,E){return typeof d=="string"?(d=encodeURI(d).replace(b,cL),E&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function cL(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var P1=/[#\/\?@]/g,uL=/[#\?:]/g,hL=/[#\?]/g,dL=/[#\?@]/g,fL=/#/g;function mu(d,b){this.h=this.g=null,this.i=d||null,this.j=!!b}function Ko(d){d.g||(d.g=new Map,d.h=0,d.i&&lL(d.i,function(b,E){d.add(decodeURIComponent(b.replace(/\+/g," ")),E)}))}n=mu.prototype,n.add=function(d,b){Ko(this),this.i=null,d=nl(this,d);let E=this.g.get(d);return E||this.g.set(d,E=[]),E.push(b),this.h+=1,this};function I1(d,b){Ko(d),b=nl(d,b),d.g.has(b)&&(d.i=null,d.h-=d.g.get(b).length,d.g.delete(b))}function R1(d,b){return Ko(d),b=nl(d,b),d.g.has(b)}n.forEach=function(d,b){Ko(this),this.g.forEach(function(E,O){E.forEach(function(U){d.call(b,U,O,this)},this)},this)};function O1(d,b){Ko(d);let E=[];if(typeof b=="string")R1(d,b)&&(E=E.concat(d.g.get(nl(d,b))));else for(d=Array.from(d.g.values()),b=0;b<d.length;b++)E=E.concat(d[b]);return E}n.set=function(d,b){return Ko(this),this.i=null,d=nl(this,d),R1(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[b]),this.h+=1,this},n.get=function(d,b){return d?(d=O1(this,d),d.length>0?String(d[0]):b):b};function N1(d,b,E){I1(d,b),E.length>0&&(d.i=null,d.g.set(nl(d,b),p(E)),d.h+=E.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],b=Array.from(this.g.keys());for(let O=0;O<b.length;O++){var E=b[O];const U=uu(E);E=O1(this,E);for(let B=0;B<E.length;B++){let ee=U;E[B]!==""&&(ee+="="+uu(E[B])),d.push(ee)}}return this.i=d.join("&")};function j1(d){const b=new mu;return b.i=d.i,d.g&&(b.g=new Map(d.g),b.h=d.h),b}function nl(d,b){return b=String(b),d.j&&(b=b.toLowerCase()),b}function pL(d,b){b&&!d.j&&(Ko(d),d.i=null,d.g.forEach(function(E,O){const U=O.toLowerCase();O!=U&&(I1(this,O),N1(this,U,E))},d)),d.j=b}function gL(d,b){const E=new ge;if(o.Image){const O=new Image;O.onload=u(Ti,E,"TestLoadImage: loaded",!0,b,O),O.onerror=u(Ti,E,"TestLoadImage: error",!1,b,O),O.onabort=u(Ti,E,"TestLoadImage: abort",!1,b,O),O.ontimeout=u(Ti,E,"TestLoadImage: timeout",!1,b,O),o.setTimeout(function(){O.ontimeout&&O.ontimeout()},1e4),O.src=d}else b(!1)}function mL(d,b){const E=new ge,O=new AbortController,U=setTimeout(()=>{O.abort(),Ti(E,"TestPingServer: timeout",!1,b)},1e4);fetch(d,{signal:O.signal}).then(B=>{clearTimeout(U),B.ok?Ti(E,"TestPingServer: ok",!0,b):Ti(E,"TestPingServer: server error",!1,b)}).catch(()=>{clearTimeout(U),Ti(E,"TestPingServer: error",!1,b)})}function Ti(d,b,E,O,U){try{U&&(U.onload=null,U.onerror=null,U.onabort=null,U.ontimeout=null),O(E)}catch{}}function yL(){this.g=new Za}function My(d){this.i=d.Sb||null,this.h=d.ab||!1}h(My,Vd),My.prototype.g=function(){return new Wd(this.i,this.h)};function Wd(d,b){at.call(this),this.H=d,this.o=b,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}h(Wd,at),n=Wd.prototype,n.open=function(d,b){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=d,this.D=b,this.readyState=1,vu(this)},n.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const b={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};d&&(b.body=d),(this.H||o).fetch(new Request(this.D,b)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,yu(this)),this.readyState=0},n.Pa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,vu(this)),this.g&&(this.readyState=3,vu(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;D1(this)}else d.text().then(this.Oa.bind(this),this.ga.bind(this))};function D1(d){d.j.read().then(d.Ma.bind(d)).catch(d.ga.bind(d))}n.Ma=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var b=d.value?d.value:new Uint8Array(0);(b=this.B.decode(b,{stream:!d.done}))&&(this.response=this.responseText+=b)}d.done?yu(this):vu(this),this.readyState==3&&D1(this)}},n.Oa=function(d){this.g&&(this.response=this.responseText=d,yu(this))},n.Na=function(d){this.g&&(this.response=d,yu(this))},n.ga=function(){this.g&&yu(this)};function yu(d){d.readyState=4,d.l=null,d.j=null,d.B=null,vu(d)}n.setRequestHeader=function(d,b){this.A.append(d,b)},n.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],b=this.h.entries();for(var E=b.next();!E.done;)E=E.value,d.push(E[0]+": "+E[1]),E=b.next();return d.join(`\r
`)};function vu(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(Wd.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function M1(d){let b="";return z(d,function(E,O){b+=O,b+=":",b+=E,b+=`\r
`}),b}function Ly(d,b,E){e:{for(O in E){var O=!1;break e}O=!0}O||(E=M1(E),typeof d=="string"?E!=null&&uu(E):Ze(d,b,E))}function pt(d){at.call(this),this.headers=new Map,this.L=d||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}h(pt,at);var vL=/^https?$/i,wL=["POST","PUT"];n=pt.prototype,n.Fa=function(d){this.H=d},n.ea=function(d,b,E,O){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);b=b?b.toUpperCase():"GET",this.D=d,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():br.g(),this.g.onreadystatechange=f(c(this.Ca,this));try{this.B=!0,this.g.open(b,String(d),!0),this.B=!1}catch(B){L1(this,B);return}if(d=E||"",E=new Map(this.headers),O)if(Object.getPrototypeOf(O)===Object.prototype)for(var U in O)E.set(U,O[U]);else if(typeof O.keys=="function"&&typeof O.get=="function")for(const B of O.keys())E.set(B,O.get(B));else throw Error("Unknown input type for opt_headers: "+String(O));O=Array.from(E.keys()).find(B=>B.toLowerCase()=="content-type"),U=o.FormData&&d instanceof o.FormData,!(Array.prototype.indexOf.call(wL,b,void 0)>=0)||O||U||E.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[B,ee]of E)this.g.setRequestHeader(B,ee);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(d),this.v=!1}catch(B){L1(this,B)}};function L1(d,b){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=b,d.o=5,F1(d),Hd(d)}function F1(d){d.A||(d.A=!0,Ft(d,"complete"),Ft(d,"error"))}n.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=d||7,Ft(this,"complete"),Ft(this,"abort"),Hd(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Hd(this,!0)),pt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?V1(this):this.Xa())},n.Xa=function(){V1(this)};function V1(d){if(d.h&&typeof i<"u"){if(d.v&&Ci(d)==4)setTimeout(d.Ca.bind(d),0);else if(Ft(d,"readystatechange"),Ci(d)==4){d.h=!1;try{const B=d.ca();e:switch(B){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var b=!0;break e;default:b=!1}var E;if(!(E=b)){var O;if(O=B===0){let ee=String(d.D).match(A1)[1]||null;!ee&&o.self&&o.self.location&&(ee=o.self.location.protocol.slice(0,-1)),O=!vL.test(ee?ee.toLowerCase():"")}E=O}if(E)Ft(d,"complete"),Ft(d,"success");else{d.o=6;try{var U=Ci(d)>2?d.g.statusText:""}catch{U=""}d.l=U+" ["+d.ca()+"]",F1(d)}}finally{Hd(d)}}}}function Hd(d,b){if(d.g){d.m&&(clearTimeout(d.m),d.m=null);const E=d.g;d.g=null,b||Ft(d,"ready");try{E.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Ci(d){return d.g?d.g.readyState:0}n.ca=function(){try{return Ci(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(d){if(this.g){var b=this.g.responseText;return d&&b.indexOf(d)==0&&(b=b.substring(d.length)),ky(b)}};function U1(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.F){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function _L(d){const b={};d=(d.g&&Ci(d)>=2&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let O=0;O<d.length;O++){if(k(d[O]))continue;var E=sL(d[O]);const U=E[0];if(E=E[1],typeof E!="string")continue;E=E.trim();const B=b[U]||[];b[U]=B,B.push(E)}Q(b,function(O){return O.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function wu(d,b,E){return E&&E.internalChannelParams&&E.internalChannelParams[d]||b}function $1(d){this.za=0,this.i=[],this.j=new ge,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=wu("failFast",!1,d),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=wu("baseRetryDelayMs",5e3,d),this.Za=wu("retryDelaySeedMs",1e4,d),this.Ta=wu("forwardChannelMaxRetries",2,d),this.va=wu("forwardChannelRequestTimeoutMs",2e4,d),this.ma=d&&d.xmlHttpFactory||void 0,this.Ua=d&&d.Rb||void 0,this.Aa=d&&d.useFetchStreams||!1,this.O=void 0,this.L=d&&d.supportsCrossDomainXhr||!1,this.M="",this.h=new S1(d&&d.concurrentRequestLimit),this.Ba=new yL,this.S=d&&d.fastHandshake||!1,this.R=d&&d.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=d&&d.Pb||!1,d&&d.ua&&this.j.ua(),d&&d.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&d&&d.detectBufferingProxy||!1,this.ia=void 0,d&&d.longPollingTimeout&&d.longPollingTimeout>0&&(this.ia=d.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=$1.prototype,n.ka=8,n.I=1,n.connect=function(d,b,E,O){It(0),this.W=d,this.H=b||{},E&&O!==void 0&&(this.H.OSID=E,this.H.OAID=O),this.F=this.X,this.J=X1(this,null,this.W),Gd(this)};function Fy(d){if(B1(d),d.I==3){var b=d.V++,E=ss(d.J);if(Ze(E,"SID",d.M),Ze(E,"RID",b),Ze(E,"TYPE","terminate"),_u(d,E),b=new Si(d,d.j,b),b.M=2,b.A=zd(ss(E)),E=!1,o.navigator&&o.navigator.sendBeacon)try{E=o.navigator.sendBeacon(b.A.toString(),"")}catch{}!E&&o.Image&&(new Image().src=b.A,E=!0),E||(b.g=Q1(b.j,null),b.g.ea(b.A)),b.F=Date.now(),Bd(b)}Y1(d)}function qd(d){d.g&&(Uy(d),d.g.cancel(),d.g=null)}function B1(d){qd(d),d.v&&(o.clearTimeout(d.v),d.v=null),Kd(d),d.h.cancel(),d.m&&(typeof d.m=="number"&&o.clearTimeout(d.m),d.m=null)}function Gd(d){if(!E1(d.h)&&!d.m){d.m=!0;var b=d.Ea;j||T(),N||(j(),N=!0),S.add(b,d),d.D=0}}function xL(d,b){return T1(d.h)>=d.h.j-(d.m?1:0)?!1:d.m?(d.i=b.G.concat(d.i),!0):d.I==1||d.I==2||d.D>=(d.Sa?0:d.Ta)?!1:(d.m=qo(c(d.Ea,d,b),K1(d,d.D)),d.D++,!0)}n.Ea=function(d){if(this.m)if(this.m=null,this.I==1){if(!d){this.V=Math.floor(Math.random()*1e5),d=this.V++;const U=new Si(this,this.j,d);let B=this.o;if(this.U&&(B?(B=ue(B),fe(B,this.U)):B=this.U),this.u!==null||this.R||(U.J=B,B=null),this.S)e:{for(var b=0,E=0;E<this.i.length;E++){t:{var O=this.i[E];if("__data__"in O.map&&(O=O.map.__data__,typeof O=="string")){O=O.length;break t}O=void 0}if(O===void 0)break;if(b+=O,b>4096){b=E;break e}if(b===4096||E===this.i.length-1){b=E+1;break e}}b=1e3}else b=1e3;b=W1(this,U,b),E=ss(this.J),Ze(E,"RID",d),Ze(E,"CVER",22),this.G&&Ze(E,"X-HTTP-Session-Id",this.G),_u(this,E),B&&(this.R?b="headers="+uu(M1(B))+"&"+b:this.u&&Ly(E,this.u,B)),jy(this.h,U),this.Ra&&Ze(E,"TYPE","init"),this.S?(Ze(E,"$req",b),Ze(E,"SID","null"),U.U=!0,Iy(U,E,null)):Iy(U,E,b),this.I=2}}else this.I==3&&(d?z1(this,d):this.i.length==0||E1(this.h)||z1(this))};function z1(d,b){var E;b?E=b.l:E=d.V++;const O=ss(d.J);Ze(O,"SID",d.M),Ze(O,"RID",E),Ze(O,"AID",d.K),_u(d,O),d.u&&d.o&&Ly(O,d.u,d.o),E=new Si(d,d.j,E,d.D+1),d.u===null&&(E.J=d.o),b&&(d.i=b.G.concat(d.i)),b=W1(d,E,1e3),E.H=Math.round(d.va*.5)+Math.round(d.va*.5*Math.random()),jy(d.h,E),Iy(E,O,b)}function _u(d,b){d.H&&z(d.H,function(E,O){Ze(b,O,E)}),d.l&&z({},function(E,O){Ze(b,O,E)})}function W1(d,b,E){E=Math.min(d.i.length,E);const O=d.l?c(d.l.Ka,d.l,d):null;e:{var U=d.i;let Ee=-1;for(;;){const Rt=["count="+E];Ee==-1?E>0?(Ee=U[0].g,Rt.push("ofs="+Ee)):Ee=0:Rt.push("ofs="+Ee);let qe=!0;for(let Ut=0;Ut<E;Ut++){var B=U[Ut].g;const is=U[Ut].map;if(B-=Ee,B<0)Ee=Math.max(0,U[Ut].g-100),qe=!1;else try{B="req"+B+"_"||"";try{var ee=is instanceof Map?is:Object.entries(is);for(const[Xo,ki]of ee){let Ai=ki;a(ki)&&(Ai=au(ki)),Rt.push(B+Xo+"="+encodeURIComponent(Ai))}}catch(Xo){throw Rt.push(B+"type="+encodeURIComponent("_badmap")),Xo}}catch{O&&O(is)}}if(qe){ee=Rt.join("&");break e}}ee=void 0}return d=d.i.splice(0,E),b.G=d,ee}function H1(d){if(!d.g&&!d.v){d.Y=1;var b=d.Da;j||T(),N||(j(),N=!0),S.add(b,d),d.A=0}}function Vy(d){return d.g||d.v||d.A>=3?!1:(d.Y++,d.v=qo(c(d.Da,d),K1(d,d.A)),d.A++,!0)}n.Da=function(){if(this.v=null,q1(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var d=4*this.T;this.j.info("BP detection timer enabled: "+d),this.B=qo(c(this.Wa,this),d)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,It(10),qd(this),q1(this))};function Uy(d){d.B!=null&&(o.clearTimeout(d.B),d.B=null)}function q1(d){d.g=new Si(d,d.j,"rpc",d.Y),d.u===null&&(d.g.J=d.o),d.g.P=0;var b=ss(d.na);Ze(b,"RID","rpc"),Ze(b,"SID",d.M),Ze(b,"AID",d.K),Ze(b,"CI",d.F?"0":"1"),!d.F&&d.ia&&Ze(b,"TO",d.ia),Ze(b,"TYPE","xmlhttp"),_u(d,b),d.u&&d.o&&Ly(b,d.u,d.o),d.O&&(d.g.H=d.O);var E=d.g;d=d.ba,E.M=1,E.A=zd(ss(b)),E.u=null,E.R=!0,_1(E,d)}n.Va=function(){this.C!=null&&(this.C=null,qd(this),Vy(this),It(19))};function Kd(d){d.C!=null&&(o.clearTimeout(d.C),d.C=null)}function G1(d,b){var E=null;if(d.g==b){Kd(d),Uy(d),d.g=null;var O=2}else if(Ny(d.h,b))E=b.G,C1(d.h,b),O=1;else return;if(d.I!=0){if(b.o)if(O==1){E=b.u?b.u.length:0,b=Date.now()-b.F;var U=d.D;O=tl(),Ft(O,new xr(O,E)),Gd(d)}else H1(d);else if(U=b.m,U==3||U==0&&b.X>0||!(O==1&&xL(d,b)||O==2&&Vy(d)))switch(E&&E.length>0&&(b=d.h,b.i=b.i.concat(E)),U){case 1:Yo(d,5);break;case 4:Yo(d,10);break;case 3:Yo(d,6);break;default:Yo(d,2)}}}function K1(d,b){let E=d.Qa+Math.floor(Math.random()*d.Za);return d.isActive()||(E*=2),E*b}function Yo(d,b){if(d.j.info("Error code "+b),b==2){var E=c(d.bb,d),O=d.Ua;const U=!O;O=new Ei(O||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||du(O,"https"),zd(O),U?gL(O.toString(),E):mL(O.toString(),E)}else It(2);d.I=0,d.l&&d.l.pa(b),Y1(d),B1(d)}n.bb=function(d){d?(this.j.info("Successfully pinged google.com"),It(2)):(this.j.info("Failed to ping google.com"),It(1))};function Y1(d){if(d.I=0,d.ja=[],d.l){const b=k1(d.h);(b.length!=0||d.i.length!=0)&&(y(d.ja,b),y(d.ja,d.i),d.h.i.length=0,p(d.i),d.i.length=0),d.l.oa()}}function X1(d,b,E){var O=E instanceof Ei?ss(E):new Ei(E);if(O.g!="")b&&(O.g=b+"."+O.g),fu(O,O.u);else{var U=o.location;O=U.protocol,b=b?b+"."+U.hostname:U.hostname,U=+U.port;const B=new Ei(null);O&&du(B,O),b&&(B.g=b),U&&fu(B,U),E&&(B.h=E),O=B}return E=d.G,b=d.wa,E&&b&&Ze(O,E,b),Ze(O,"VER",d.ka),_u(d,O),O}function Q1(d,b,E){if(b&&!d.L)throw Error("Can't create secondary domain capable XhrIo object.");return b=d.Aa&&!d.ma?new pt(new My({ab:E})):new pt(d.ma),b.Fa(d.L),b}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function J1(){}n=J1.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Yd(){}Yd.prototype.g=function(d,b){return new $n(d,b)};function $n(d,b){at.call(this),this.g=new $1(b),this.l=d,this.h=b&&b.messageUrlParams||null,d=b&&b.messageHeaders||null,b&&b.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=b&&b.initMessageHeaders||null,b&&b.messageContentType&&(d?d["X-WebChannel-Content-Type"]=b.messageContentType:d={"X-WebChannel-Content-Type":b.messageContentType}),b&&b.sa&&(d?d["X-WebChannel-Client-Profile"]=b.sa:d={"X-WebChannel-Client-Profile":b.sa}),this.g.U=d,(d=b&&b.Qb)&&!k(d)&&(this.g.u=d),this.A=b&&b.supportsCrossDomainXhr||!1,this.v=b&&b.sendRawJson||!1,(b=b&&b.httpSessionIdParam)&&!k(b)&&(this.g.G=b,d=this.h,d!==null&&b in d&&(d=this.h,b in d&&delete d[b])),this.j=new rl(this)}h($n,at),$n.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},$n.prototype.close=function(){Fy(this.g)},$n.prototype.o=function(d){var b=this.g;if(typeof d=="string"){var E={};E.__data__=d,d=E}else this.v&&(E={},E.__data__=au(d),d=E);b.i.push(new aL(b.Ya++,d)),b.I==3&&Gd(b)},$n.prototype.N=function(){this.g.l=null,delete this.j,Fy(this.g),delete this.g,$n.Z.N.call(this)};function Z1(d){ns.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var b=d.__sm__;if(b){e:{for(const E in b){d=E;break e}d=void 0}(this.i=d)&&(d=this.i,b=b!==null&&d in b?b[d]:void 0),this.data=b}else this.data=d}h(Z1,ns);function eS(){el.call(this),this.status=1}h(eS,el);function rl(d){this.g=d}h(rl,J1),rl.prototype.ra=function(){Ft(this.g,"a")},rl.prototype.qa=function(d){Ft(this.g,new Z1(d))},rl.prototype.pa=function(d){Ft(this.g,new eS)},rl.prototype.oa=function(){Ft(this.g,"b")},Yd.prototype.createWebChannel=Yd.prototype.g,$n.prototype.send=$n.prototype.o,$n.prototype.open=$n.prototype.m,$n.prototype.close=$n.prototype.close,fO=function(){return new Yd},dO=function(){return tl()},hO=Tn,Nw={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},sr.NO_ERROR=0,sr.TIMEOUT=8,sr.HTTP_ERROR=6,Op=sr,Cn.COMPLETE="complete",uO=Cn,lu.EventType=js,js.OPEN="a",js.CLOSE="b",js.ERROR="c",js.MESSAGE="d",at.prototype.listen=at.prototype.J,Vu=lu,pt.prototype.listenOnce=pt.prototype.K,pt.prototype.getLastError=pt.prototype.Ha,pt.prototype.getLastErrorCode=pt.prototype.ya,pt.prototype.getStatus=pt.prototype.ca,pt.prototype.getResponseJson=pt.prototype.La,pt.prototype.getResponseText=pt.prototype.la,pt.prototype.send=pt.prototype.ea,pt.prototype.setWithCredentials=pt.prototype.Fa,cO=pt}).apply(typeof Sf<"u"?Sf:typeof self<"u"?self:typeof window<"u"?window:{});const RT="@firebase/firestore",OT="4.9.3";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class on{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}on.UNAUTHENTICATED=new on(null),on.GOOGLE_CREDENTIALS=new on("google-credentials-uid"),on.FIRST_PARTY=new on("first-party-uid"),on.MOCK_USER=new on("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let qc="12.7.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Va=new Kx("@firebase/firestore");function ml(){return Va.logLevel}function ne(n,...e){if(Va.logLevel<=Ae.DEBUG){const t=e.map(ib);Va.debug(`Firestore (${qc}): ${n}`,...t)}}function ui(n,...e){if(Va.logLevel<=Ae.ERROR){const t=e.map(ib);Va.error(`Firestore (${qc}): ${n}`,...t)}}function Sc(n,...e){if(Va.logLevel<=Ae.WARN){const t=e.map(ib);Va.warn(`Firestore (${qc}): ${n}`,...t)}}function ib(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ye(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,pO(n,r,t)}function pO(n,e,t){let r=`FIRESTORE (${qc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw ui(r),new Error(r)}function Be(n,e,t,r){let s="Unexpected state";typeof t=="string"?s=t:r=t,n||pO(e,s,r)}function we(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class te extends vi{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zs{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gO{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class F8{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(on.UNAUTHENTICATED))}shutdown(){}}class V8{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class U8{constructor(e){this.t=e,this.currentUser=on.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Be(this.o===void 0,42304);let r=this.i;const s=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve();let i=new Zs;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Zs,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const l=i;e.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},a=l=>{ne("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(ne("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Zs)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(ne("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Be(typeof r.accessToken=="string",31837,{l:r}),new gO(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Be(e===null||typeof e=="string",2055,{h:e}),new on(e)}}class $8{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=on.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class B8{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new $8(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(on.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class NT{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class z8{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,cr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Be(this.o===void 0,3512);const r=i=>{i.error!=null&&ne("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,ne("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{ne("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):ne("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new NT(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Be(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new NT(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W8(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ob{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=W8(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<t&&(r+=e.charAt(s[i]%62))}return r}}function Pe(n,e){return n<e?-1:n>e?1:0}function jw(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const s=n.charAt(r),i=e.charAt(r);if(s!==i)return Rv(s)===Rv(i)?Pe(s,i):Rv(s)?1:-1}return Pe(n.length,e.length)}const H8=55296,q8=57343;function Rv(n){const e=n.charCodeAt(0);return e>=H8&&e<=q8}function Ec(n,e,t){return n.length===e.length&&n.every((r,s)=>t(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jT="__name__";class ls{constructor(e,t,r){t===void 0?t=0:t>e.length&&ye(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&ye(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return ls.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof ls?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let s=0;s<r;s++){const i=ls.compareSegments(e.get(s),t.get(s));if(i!==0)return i}return Pe(e.length,t.length)}static compareSegments(e,t){const r=ls.isNumericId(e),s=ls.isNumericId(t);return r&&!s?-1:!r&&s?1:r&&s?ls.extractNumericId(e).compare(ls.extractNumericId(t)):jw(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return yo.fromString(e.substring(4,e.length-2))}}class Xe extends ls{construct(e,t,r){return new Xe(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new te(H.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(s=>s.length>0))}return new Xe(t)}static emptyPath(){return new Xe([])}}const G8=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Kt extends ls{construct(e,t,r){return new Kt(e,t,r)}static isValidIdentifier(e){return G8.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Kt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===jT}static keyField(){return new Kt([jT])}static fromServerFormat(e){const t=[];let r="",s=0;const i=()=>{if(r.length===0)throw new te(H.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new te(H.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new te(H.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new te(H.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Kt(t)}static emptyPath(){return new Kt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class he{constructor(e){this.path=e}static fromPath(e){return new he(Xe.fromString(e))}static fromName(e){return new he(Xe.fromString(e).popFirst(5))}static empty(){return new he(Xe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Xe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Xe.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new he(new Xe(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mO(n,e,t){if(!t)throw new te(H.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function K8(n,e,t,r){if(e===!0&&r===!0)throw new te(H.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function DT(n){if(!he.isDocumentKey(n))throw new te(H.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function MT(n){if(he.isDocumentKey(n))throw new te(H.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function yO(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function $m(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":ye(12329,{type:typeof n})}function Jr(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new te(H.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=$m(n);throw new te(H.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function At(n,e){const t={typeString:n};return e&&(t.value=e),t}function Td(n,e){if(!yO(n))throw new te(H.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const o=n[r];if(s&&typeof o!==s){t=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&o!==i.value){t=`Expected '${r}' field to equal '${i.value}'`;break}}if(t)throw new te(H.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LT=-62135596800,FT=1e6;class nt{static now(){return nt.fromMillis(Date.now())}static fromDate(e){return nt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*FT);return new nt(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new te(H.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new te(H.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<LT)throw new te(H.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new te(H.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/FT}_compareTo(e){return this.seconds===e.seconds?Pe(this.nanoseconds,e.nanoseconds):Pe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:nt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Td(e,nt._jsonSchema))return new nt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-LT;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}nt._jsonSchemaVersion="firestore/timestamp/1.0",nt._jsonSchema={type:At("string",nt._jsonSchemaVersion),seconds:At("number"),nanoseconds:At("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ve{static fromTimestamp(e){return new ve(e)}static min(){return new ve(new nt(0,0))}static max(){return new ve(new nt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $h=-1;function Y8(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=ve.fromTimestamp(r===1e9?new nt(t+1,0):new nt(t,r));return new So(s,he.empty(),e)}function X8(n){return new So(n.readTime,n.key,$h)}class So{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new So(ve.min(),he.empty(),$h)}static max(){return new So(ve.max(),he.empty(),$h)}}function Q8(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=he.comparator(n.documentKey,e.documentKey),t!==0?t:Pe(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J8="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Z8{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gc(n){if(n.code!==H.FAILED_PRECONDITION||n.message!==J8)throw n;ne("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ye(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new q((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(t,i).next(r,s)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof q?t:q.resolve(t)}catch(t){return q.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):q.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):q.reject(t)}static resolve(e){return new q((t,r)=>{t(e)})}static reject(e){return new q((t,r)=>{r(e)})}static waitFor(e){return new q((t,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&t()},l=>r(l))}),o=!0,i===s&&t()})}static or(e){let t=q.resolve(!1);for(const r of e)t=t.next(s=>s?q.resolve(s):r());return t}static forEach(e,t){const r=[];return e.forEach((s,i)=>{r.push(t.call(this,s,i))}),this.waitFor(r)}static mapArray(e,t){return new q((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let l=0;l<i;l++){const c=l;t(e[c]).next(u=>{o[c]=u,++a,a===i&&r(o)},u=>s(u))}})}static doWhile(e,t){return new q((r,s)=>{const i=()=>{e()===!0?t().next(()=>{i()},s):r()};i()})}}function eW(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Kc(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bm{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Bm.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ab=-1;function zm(n){return n==null}function Ng(n){return n===0&&1/n==-1/0}function tW(n){return typeof n=="number"&&Number.isInteger(n)&&!Ng(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vO="";function nW(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=VT(e)),e=rW(n.get(t),e);return VT(e)}function rW(n,e){let t=e;const r=n.length;for(let s=0;s<r;s++){const i=n.charAt(s);switch(i){case"\0":t+="";break;case vO:t+="";break;default:t+=i}}return t}function VT(n){return n+vO+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UT(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Lo(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function wO(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ft{constructor(e,t){this.comparator=e,this.root=t||Gt.EMPTY}insert(e,t){return new ft(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Gt.BLACK,null,null))}remove(e){return new ft(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Gt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return t+r.left.size;s<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ef(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ef(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ef(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ef(this.root,e,this.comparator,!0)}}class Ef{constructor(e,t,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?r(e.key,t):1,t&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Gt{constructor(e,t,r,s,i){this.key=e,this.value=t,this.color=r??Gt.RED,this.left=s??Gt.EMPTY,this.right=i??Gt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,s,i){return new Gt(e??this.key,t??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,t,r),null):i===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Gt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return Gt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Gt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Gt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ye(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ye(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ye(27949);return e+(this.isRed()?0:1)}}Gt.EMPTY=null,Gt.RED=!0,Gt.BLACK=!1;Gt.EMPTY=new class{constructor(){this.size=0}get key(){throw ye(57766)}get value(){throw ye(16141)}get color(){throw ye(16727)}get left(){throw ye(29726)}get right(){throw ye(36894)}copy(e,t,r,s,i){return this}insert(e,t,r){return new Gt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dt{constructor(e){this.comparator=e,this.data=new ft(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new $T(this.data.getIterator())}getIteratorFrom(e){return new $T(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof Dt)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Dt(this.comparator);return t.data=e,t}}class $T{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xn{constructor(e){this.fields=e,e.sort(Kt.comparator)}static empty(){return new Xn([])}unionWith(e){let t=new Dt(Kt.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Xn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Ec(this.fields,e.fields,(t,r)=>t.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _O extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new _O("Invalid base64 string: "+i):i}}(e);return new Zt(t)}static fromUint8Array(e){const t=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new Zt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Pe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Zt.EMPTY_BYTE_STRING=new Zt("");const sW=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Eo(n){if(Be(!!n,39018),typeof n=="string"){let e=0;const t=sW.exec(n);if(Be(!!t,46558,{timestamp:n}),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:yt(n.seconds),nanos:yt(n.nanos)}}function yt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function To(n){return typeof n=="string"?Zt.fromBase64String(n):Zt.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xO="server_timestamp",bO="__type__",SO="__previous_value__",EO="__local_write_time__";function lb(n){var t,r;return((r=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[bO])==null?void 0:r.stringValue)===xO}function Wm(n){const e=n.mapValue.fields[SO];return lb(e)?Wm(e):e}function Bh(n){const e=Eo(n.mapValue.fields[EO].timestampValue);return new nt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iW{constructor(e,t,r,s,i,o,a,l,c,u){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c,this.isUsingEmulator=u}}const jg="(default)";class zh{constructor(e,t){this.projectId=e,this.database=t||jg}static empty(){return new zh("","")}get isDefaultDatabase(){return this.database===jg}isEqual(e){return e instanceof zh&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TO="__type__",CO="__max__",Tf={mapValue:{fields:{__type__:{stringValue:CO}}}},kO="__vector__",Dg="value";function Co(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?lb(n)?4:aW(n)?9007199254740991:oW(n)?10:11:ye(28295,{value:n})}function ks(n,e){if(n===e)return!0;const t=Co(n);if(t!==Co(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Bh(n).isEqual(Bh(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Eo(s.timestampValue),a=Eo(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(s,i){return To(s.bytesValue).isEqual(To(i.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(s,i){return yt(s.geoPointValue.latitude)===yt(i.geoPointValue.latitude)&&yt(s.geoPointValue.longitude)===yt(i.geoPointValue.longitude)}(n,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return yt(s.integerValue)===yt(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=yt(s.doubleValue),a=yt(i.doubleValue);return o===a?Ng(o)===Ng(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return Ec(n.arrayValue.values||[],e.arrayValue.values||[],ks);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(UT(o)!==UT(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!ks(o[l],a[l])))return!1;return!0}(n,e);default:return ye(52216,{left:n})}}function Wh(n,e){return(n.values||[]).find(t=>ks(t,e))!==void 0}function Tc(n,e){if(n===e)return 0;const t=Co(n),r=Co(e);if(t!==r)return Pe(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Pe(n.booleanValue,e.booleanValue);case 2:return function(i,o){const a=yt(i.integerValue||i.doubleValue),l=yt(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(n,e);case 3:return BT(n.timestampValue,e.timestampValue);case 4:return BT(Bh(n),Bh(e));case 5:return jw(n.stringValue,e.stringValue);case 6:return function(i,o){const a=To(i),l=To(o);return a.compareTo(l)}(n.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),l=o.split("/");for(let c=0;c<a.length&&c<l.length;c++){const u=Pe(a[c],l[c]);if(u!==0)return u}return Pe(a.length,l.length)}(n.referenceValue,e.referenceValue);case 8:return function(i,o){const a=Pe(yt(i.latitude),yt(o.latitude));return a!==0?a:Pe(yt(i.longitude),yt(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return zT(n.arrayValue,e.arrayValue);case 10:return function(i,o){var f,p,y,m;const a=i.fields||{},l=o.fields||{},c=(f=a[Dg])==null?void 0:f.arrayValue,u=(p=l[Dg])==null?void 0:p.arrayValue,h=Pe(((y=c==null?void 0:c.values)==null?void 0:y.length)||0,((m=u==null?void 0:u.values)==null?void 0:m.length)||0);return h!==0?h:zT(c,u)}(n.mapValue,e.mapValue);case 11:return function(i,o){if(i===Tf.mapValue&&o===Tf.mapValue)return 0;if(i===Tf.mapValue)return 1;if(o===Tf.mapValue)return-1;const a=i.fields||{},l=Object.keys(a),c=o.fields||{},u=Object.keys(c);l.sort(),u.sort();for(let h=0;h<l.length&&h<u.length;++h){const f=jw(l[h],u[h]);if(f!==0)return f;const p=Tc(a[l[h]],c[u[h]]);if(p!==0)return p}return Pe(l.length,u.length)}(n.mapValue,e.mapValue);default:throw ye(23264,{he:t})}}function BT(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Pe(n,e);const t=Eo(n),r=Eo(e),s=Pe(t.seconds,r.seconds);return s!==0?s:Pe(t.nanos,r.nanos)}function zT(n,e){const t=n.values||[],r=e.values||[];for(let s=0;s<t.length&&s<r.length;++s){const i=Tc(t[s],r[s]);if(i)return i}return Pe(t.length,r.length)}function Cc(n){return Dw(n)}function Dw(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=Eo(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return To(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return he.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",s=!0;for(const i of t.values||[])s?s=!1:r+=",",r+=Dw(i);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${Dw(t.fields[o])}`;return s+"}"}(n.mapValue):ye(61005,{value:n})}function Np(n){switch(Co(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Wm(n);return e?16+Np(e):16;case 5:return 2*n.stringValue.length;case 6:return To(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+Np(i),0)}(n.arrayValue);case 10:case 11:return function(r){let s=0;return Lo(r.fields,(i,o)=>{s+=i.length+Np(o)}),s}(n.mapValue);default:throw ye(13486,{value:n})}}function WT(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Mw(n){return!!n&&"integerValue"in n}function cb(n){return!!n&&"arrayValue"in n}function HT(n){return!!n&&"nullValue"in n}function qT(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function jp(n){return!!n&&"mapValue"in n}function oW(n){var t,r;return((r=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[TO])==null?void 0:r.stringValue)===kO}function sh(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Lo(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=sh(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=sh(n.arrayValue.values[t]);return e}return{...n}}function aW(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===CO}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rn{constructor(e){this.value=e}static empty(){return new Rn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!jp(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=sh(t)}setAll(e){let t=Kt.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const l=this.getFieldsMap(t);this.applyChanges(l,r,s),r={},s=[],t=a.popLast()}o?r[a.lastSegment()]=sh(o):s.push(a.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,r,s)}delete(e){const t=this.field(e.popLast());jp(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ks(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=t.mapValue.fields[e.get(r)];jp(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,r){Lo(t,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Rn(sh(this.value))}}function AO(n){const e=[];return Lo(n.fields,(t,r)=>{const s=new Kt([t]);if(jp(r)){const i=AO(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new Xn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ln{constructor(e,t,r,s,i,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new ln(e,0,ve.min(),ve.min(),ve.min(),Rn.empty(),0)}static newFoundDocument(e,t,r,s){return new ln(e,1,t,ve.min(),r,s,0)}static newNoDocument(e,t){return new ln(e,2,t,ve.min(),ve.min(),Rn.empty(),0)}static newUnknownDocument(e,t){return new ln(e,3,t,ve.min(),ve.min(),Rn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ve.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Rn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Rn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ve.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ln&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ln(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mg{constructor(e,t){this.position=e,this.inclusive=t}}function GT(n,e,t){let r=0;for(let s=0;s<n.position.length;s++){const i=e[s],o=n.position[s];if(i.field.isKeyField()?r=he.comparator(he.fromName(o.referenceValue),t.key):r=Tc(o,t.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function KT(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!ks(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lg{constructor(e,t="asc"){this.field=e,this.dir=t}}function lW(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PO{}class kt extends PO{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new uW(e,t,r):t==="array-contains"?new fW(e,r):t==="in"?new pW(e,r):t==="not-in"?new gW(e,r):t==="array-contains-any"?new mW(e,r):new kt(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new hW(e,r):new dW(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Tc(t,this.value)):t!==null&&Co(this.value)===Co(t)&&this.matchesComparison(Tc(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ye(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Zr extends PO{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Zr(e,t)}matches(e){return IO(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function IO(n){return n.op==="and"}function RO(n){return cW(n)&&IO(n)}function cW(n){for(const e of n.filters)if(e instanceof Zr)return!1;return!0}function Lw(n){if(n instanceof kt)return n.field.canonicalString()+n.op.toString()+Cc(n.value);if(RO(n))return n.filters.map(e=>Lw(e)).join(",");{const e=n.filters.map(t=>Lw(t)).join(",");return`${n.op}(${e})`}}function OO(n,e){return n instanceof kt?function(r,s){return s instanceof kt&&r.op===s.op&&r.field.isEqual(s.field)&&ks(r.value,s.value)}(n,e):n instanceof Zr?function(r,s){return s instanceof Zr&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,a)=>i&&OO(o,s.filters[a]),!0):!1}(n,e):void ye(19439)}function NO(n){return n instanceof kt?function(t){return`${t.field.canonicalString()} ${t.op} ${Cc(t.value)}`}(n):n instanceof Zr?function(t){return t.op.toString()+" {"+t.getFilters().map(NO).join(" ,")+"}"}(n):"Filter"}class uW extends kt{constructor(e,t,r){super(e,t,r),this.key=he.fromName(r.referenceValue)}matches(e){const t=he.comparator(e.key,this.key);return this.matchesComparison(t)}}class hW extends kt{constructor(e,t){super(e,"in",t),this.keys=jO("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class dW extends kt{constructor(e,t){super(e,"not-in",t),this.keys=jO("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function jO(n,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map(r=>he.fromName(r.referenceValue))}class fW extends kt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return cb(t)&&Wh(t.arrayValue,this.value)}}class pW extends kt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Wh(this.value.arrayValue,t)}}class gW extends kt{constructor(e,t){super(e,"not-in",t)}matches(e){if(Wh(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Wh(this.value.arrayValue,t)}}class mW extends kt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!cb(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Wh(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yW{constructor(e,t=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.Te=null}}function YT(n,e=null,t=[],r=[],s=null,i=null,o=null){return new yW(n,e,t,r,s,i,o)}function ub(n){const e=we(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Lw(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),zm(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Cc(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Cc(r)).join(",")),e.Te=t}return e.Te}function hb(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!lW(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!OO(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!KT(n.startAt,e.startAt)&&KT(n.endAt,e.endAt)}function Fw(n){return he.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cd{constructor(e,t=null,r=[],s=[],i=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function vW(n,e,t,r,s,i,o,a){return new Cd(n,e,t,r,s,i,o,a)}function db(n){return new Cd(n)}function XT(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function DO(n){return n.collectionGroup!==null}function ih(n){const e=we(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),t.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Dt(Kt.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(i=>{t.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new Lg(i,r))}),t.has(Kt.keyField().canonicalString())||e.Ie.push(new Lg(Kt.keyField(),r))}return e.Ie}function bs(n){const e=we(n);return e.Ee||(e.Ee=wW(e,ih(n))),e.Ee}function wW(n,e){if(n.limitType==="F")return YT(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Lg(s.field,i)});const t=n.endAt?new Mg(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Mg(n.startAt.position,n.startAt.inclusive):null;return YT(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Vw(n,e){const t=n.filters.concat([e]);return new Cd(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Uw(n,e,t){return new Cd(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Hm(n,e){return hb(bs(n),bs(e))&&n.limitType===e.limitType}function MO(n){return`${ub(bs(n))}|lt:${n.limitType}`}function yl(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(s=>NO(s)).join(", ")}]`),zm(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(s=>Cc(s)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(s=>Cc(s)).join(",")),`Target(${r})`}(bs(n))}; limitType=${n.limitType})`}function qm(n,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):he.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(n,e)&&function(r,s){for(const i of ih(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(n,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(n,e)&&function(r,s){return!(r.startAt&&!function(o,a,l){const c=GT(o,a,l);return o.inclusive?c<=0:c<0}(r.startAt,ih(r),s)||r.endAt&&!function(o,a,l){const c=GT(o,a,l);return o.inclusive?c>=0:c>0}(r.endAt,ih(r),s))}(n,e)}function _W(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function LO(n){return(e,t)=>{let r=!1;for(const s of ih(n)){const i=xW(s,e,t);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function xW(n,e,t){const r=n.field.isKeyField()?he.comparator(e.key,t.key):function(i,o,a){const l=o.data.field(i),c=a.data.field(i);return l!==null&&c!==null?Tc(l,c):ye(42886)}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return ye(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ya{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[t]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Lo(this.inner,(t,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return wO(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bW=new ft(he.comparator);function hi(){return bW}const FO=new ft(he.comparator);function Uu(...n){let e=FO;for(const t of n)e=e.insert(t.key,t);return e}function VO(n){let e=FO;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function ha(){return oh()}function UO(){return oh()}function oh(){return new Ya(n=>n.toString(),(n,e)=>n.isEqual(e))}const SW=new ft(he.comparator),EW=new Dt(he.comparator);function Ie(...n){let e=EW;for(const t of n)e=e.add(t);return e}const TW=new Dt(Pe);function CW(){return TW}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fb(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ng(e)?"-0":e}}function $O(n){return{integerValue:""+n}}function kW(n,e){return tW(e)?$O(e):fb(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gm{constructor(){this._=void 0}}function AW(n,e,t){return n instanceof Hh?function(s,i){const o={fields:{[bO]:{stringValue:xO},[EO]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&lb(i)&&(i=Wm(i)),i&&(o.fields[SO]=i),{mapValue:o}}(t,e):n instanceof qh?zO(n,e):n instanceof Gh?WO(n,e):function(s,i){const o=BO(s,i),a=QT(o)+QT(s.Ae);return Mw(o)&&Mw(s.Ae)?$O(a):fb(s.serializer,a)}(n,e)}function PW(n,e,t){return n instanceof qh?zO(n,e):n instanceof Gh?WO(n,e):t}function BO(n,e){return n instanceof Fg?function(r){return Mw(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class Hh extends Gm{}class qh extends Gm{constructor(e){super(),this.elements=e}}function zO(n,e){const t=HO(e);for(const r of n.elements)t.some(s=>ks(s,r))||t.push(r);return{arrayValue:{values:t}}}class Gh extends Gm{constructor(e){super(),this.elements=e}}function WO(n,e){let t=HO(e);for(const r of n.elements)t=t.filter(s=>!ks(s,r));return{arrayValue:{values:t}}}class Fg extends Gm{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function QT(n){return yt(n.integerValue||n.doubleValue)}function HO(n){return cb(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IW{constructor(e,t){this.field=e,this.transform=t}}function RW(n,e){return n.field.isEqual(e.field)&&function(r,s){return r instanceof qh&&s instanceof qh||r instanceof Gh&&s instanceof Gh?Ec(r.elements,s.elements,ks):r instanceof Fg&&s instanceof Fg?ks(r.Ae,s.Ae):r instanceof Hh&&s instanceof Hh}(n.transform,e.transform)}class OW{constructor(e,t){this.version=e,this.transformResults=t}}class gr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new gr}static exists(e){return new gr(void 0,e)}static updateTime(e){return new gr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Dp(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Km{}function qO(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new pb(n.key,gr.none()):new kd(n.key,n.data,gr.none());{const t=n.data,r=Rn.empty();let s=new Dt(Kt.comparator);for(let i of e.fields)if(!s.has(i)){let o=t.field(i);o===null&&i.length>1&&(i=i.popLast(),o=t.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new Fo(n.key,r,new Xn(s.toArray()),gr.none())}}function NW(n,e,t){n instanceof kd?function(s,i,o){const a=s.value.clone(),l=ZT(s.fieldTransforms,i,o.transformResults);a.setAll(l),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof Fo?function(s,i,o){if(!Dp(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=ZT(s.fieldTransforms,i,o.transformResults),l=i.data;l.setAll(GO(s)),l.setAll(a),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(n,e,t):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function ah(n,e,t,r){return n instanceof kd?function(i,o,a,l){if(!Dp(i.precondition,o))return a;const c=i.value.clone(),u=eC(i.fieldTransforms,l,o);return c.setAll(u),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(n,e,t,r):n instanceof Fo?function(i,o,a,l){if(!Dp(i.precondition,o))return a;const c=eC(i.fieldTransforms,l,o),u=o.data;return u.setAll(GO(i)),u.setAll(c),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(h=>h.field))}(n,e,t,r):function(i,o,a){return Dp(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,e,t)}function jW(n,e){let t=null;for(const r of n.fieldTransforms){const s=e.data.field(r.field),i=BO(r.transform,s||null);i!=null&&(t===null&&(t=Rn.empty()),t.set(r.field,i))}return t||null}function JT(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Ec(r,s,(i,o)=>RW(i,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class kd extends Km{constructor(e,t,r,s=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Fo extends Km{constructor(e,t,r,s,i=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function GO(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function ZT(n,e,t){const r=new Map;Be(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let s=0;s<t.length;s++){const i=n[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,PW(o,a,t[s]))}return r}function eC(n,e,t){const r=new Map;for(const s of n){const i=s.transform,o=t.data.field(s.field);r.set(s.field,AW(i,o,e))}return r}class pb extends Km{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class DW extends Km{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MW{constructor(e,t,r,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&NW(i,e,r[s])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=ah(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=ah(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=UO();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=t.has(s.key)?null:a;const l=qO(o,a);l!==null&&r.set(s.key,l),o.isValidDocument()||o.convertToNoDocument(ve.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Ie())}isEqual(e){return this.batchId===e.batchId&&Ec(this.mutations,e.mutations,(t,r)=>JT(t,r))&&Ec(this.baseMutations,e.baseMutations,(t,r)=>JT(t,r))}}class gb{constructor(e,t,r,s){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=s}static from(e,t,r){Be(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=function(){return SW}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new gb(e,t,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LW{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FW{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var St,De;function VW(n){switch(n){case H.OK:return ye(64938);case H.CANCELLED:case H.UNKNOWN:case H.DEADLINE_EXCEEDED:case H.RESOURCE_EXHAUSTED:case H.INTERNAL:case H.UNAVAILABLE:case H.UNAUTHENTICATED:return!1;case H.INVALID_ARGUMENT:case H.NOT_FOUND:case H.ALREADY_EXISTS:case H.PERMISSION_DENIED:case H.FAILED_PRECONDITION:case H.ABORTED:case H.OUT_OF_RANGE:case H.UNIMPLEMENTED:case H.DATA_LOSS:return!0;default:return ye(15467,{code:n})}}function KO(n){if(n===void 0)return ui("GRPC error has no .code"),H.UNKNOWN;switch(n){case St.OK:return H.OK;case St.CANCELLED:return H.CANCELLED;case St.UNKNOWN:return H.UNKNOWN;case St.DEADLINE_EXCEEDED:return H.DEADLINE_EXCEEDED;case St.RESOURCE_EXHAUSTED:return H.RESOURCE_EXHAUSTED;case St.INTERNAL:return H.INTERNAL;case St.UNAVAILABLE:return H.UNAVAILABLE;case St.UNAUTHENTICATED:return H.UNAUTHENTICATED;case St.INVALID_ARGUMENT:return H.INVALID_ARGUMENT;case St.NOT_FOUND:return H.NOT_FOUND;case St.ALREADY_EXISTS:return H.ALREADY_EXISTS;case St.PERMISSION_DENIED:return H.PERMISSION_DENIED;case St.FAILED_PRECONDITION:return H.FAILED_PRECONDITION;case St.ABORTED:return H.ABORTED;case St.OUT_OF_RANGE:return H.OUT_OF_RANGE;case St.UNIMPLEMENTED:return H.UNIMPLEMENTED;case St.DATA_LOSS:return H.DATA_LOSS;default:return ye(39323,{code:n})}}(De=St||(St={}))[De.OK=0]="OK",De[De.CANCELLED=1]="CANCELLED",De[De.UNKNOWN=2]="UNKNOWN",De[De.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",De[De.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",De[De.NOT_FOUND=5]="NOT_FOUND",De[De.ALREADY_EXISTS=6]="ALREADY_EXISTS",De[De.PERMISSION_DENIED=7]="PERMISSION_DENIED",De[De.UNAUTHENTICATED=16]="UNAUTHENTICATED",De[De.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",De[De.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",De[De.ABORTED=10]="ABORTED",De[De.OUT_OF_RANGE=11]="OUT_OF_RANGE",De[De.UNIMPLEMENTED=12]="UNIMPLEMENTED",De[De.INTERNAL=13]="INTERNAL",De[De.UNAVAILABLE=14]="UNAVAILABLE",De[De.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UW(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $W=new yo([4294967295,4294967295],0);function tC(n){const e=UW().encode(n),t=new lO;return t.update(e),new Uint8Array(t.digest())}function nC(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new yo([t,r],0),new yo([s,i],0)]}class mb{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new $u(`Invalid padding: ${t}`);if(r<0)throw new $u(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new $u(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new $u(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=yo.fromNumber(this.ge)}ye(e,t,r){let s=e.add(t.multiply(yo.fromNumber(r)));return s.compare($W)===1&&(s=new yo([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=tC(e),[r,s]=nC(t);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);if(!this.we(o))return!1}return!0}static create(e,t,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new mb(i,s,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.ge===0)return;const t=tC(e),[r,s]=nC(t);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);this.Se(o)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class $u extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ym{constructor(e,t,r,s,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const s=new Map;return s.set(e,Ad.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Ym(ve.min(),s,new ft(Pe),hi(),Ie())}}class Ad{constructor(e,t,r,s,i){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Ad(r,t,Ie(),Ie(),Ie())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mp{constructor(e,t,r,s){this.be=e,this.removedTargetIds=t,this.key=r,this.De=s}}class YO{constructor(e,t){this.targetId=e,this.Ce=t}}class XO{constructor(e,t,r=Zt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=s}}class rC{constructor(){this.ve=0,this.Fe=sC(),this.Me=Zt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Ie(),t=Ie(),r=Ie();return this.Fe.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:r=r.add(s);break;default:ye(38017,{changeType:i})}}),new Ad(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=sC()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Be(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class BW{constructor(e){this.Ge=e,this.ze=new Map,this.je=hi(),this.Je=Cf(),this.He=Cf(),this.Ye=new ft(Pe)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:ye(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((r,s)=>{this.rt(s)&&t(s)})}st(e){const t=e.targetId,r=e.Ce.count,s=this.ot(t);if(s){const i=s.target;if(Fw(i))if(r===0){const o=new he(i.path);this.et(t,o,ln.newNoDocument(o,ve.min()))}else Be(r===1,20013,{expectedCount:r});else{const o=this._t(t);if(o!==r){const a=this.ut(e),l=a?this.ct(a,e,o):1;if(l!==0){this.it(t);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,c)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=t;let o,a;try{o=To(r).toUint8Array()}catch(l){if(l instanceof _O)return Sc("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new mb(o,s,i)}catch(l){return Sc(l instanceof $u?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.ge===0?null:a}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let s=0;return r.forEach(i=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.et(t,i,null),s++)}),s}Tt(e){const t=new Map;this.ze.forEach((i,o)=>{const a=this.ot(o);if(a){if(i.current&&Fw(a.target)){const l=new he(a.target.path);this.It(l).has(o)||this.Et(o,l)||this.et(o,l,ln.newNoDocument(l,e))}i.Be&&(t.set(o,i.ke()),i.qe())}});let r=Ie();this.He.forEach((i,o)=>{let a=!0;o.forEachWhile(l=>{const c=this.ot(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.je.forEach((i,o)=>o.setReadTime(e));const s=new Ym(e,t,this.Ye,this.je,r);return this.je=hi(),this.Je=Cf(),this.He=Cf(),this.Ye=new ft(Pe),s}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,t)?s.Qe(t,1):s.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new rC,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Dt(Pe),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Dt(Pe),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||ne("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new rC),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Cf(){return new ft(he.comparator)}function sC(){return new ft(he.comparator)}const zW={asc:"ASCENDING",desc:"DESCENDING"},WW={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},HW={and:"AND",or:"OR"};class qW{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function $w(n,e){return n.useProto3Json||zm(e)?e:{value:e}}function Vg(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function QO(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function GW(n,e){return Vg(n,e.toTimestamp())}function Ss(n){return Be(!!n,49232),ve.fromTimestamp(function(t){const r=Eo(t);return new nt(r.seconds,r.nanos)}(n))}function yb(n,e){return Bw(n,e).canonicalString()}function Bw(n,e){const t=function(s){return new Xe(["projects",s.projectId,"databases",s.database])}(n).child("documents");return e===void 0?t:t.child(e)}function JO(n){const e=Xe.fromString(n);return Be(rN(e),10190,{key:e.toString()}),e}function zw(n,e){return yb(n.databaseId,e.path)}function Ov(n,e){const t=JO(e);if(t.get(1)!==n.databaseId.projectId)throw new te(H.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new te(H.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new he(eN(t))}function ZO(n,e){return yb(n.databaseId,e)}function KW(n){const e=JO(n);return e.length===4?Xe.emptyPath():eN(e)}function Ww(n){return new Xe(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function eN(n){return Be(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function iC(n,e,t){return{name:zw(n,e),fields:t.value.mapValue.fields}}function YW(n,e){let t;if("targetChange"in e){e.targetChange;const r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:ye(39313,{state:c})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(c,u){return c.useProto3Json?(Be(u===void 0||typeof u=="string",58123),Zt.fromBase64String(u||"")):(Be(u===void 0||u instanceof Buffer||u instanceof Uint8Array,16193),Zt.fromUint8Array(u||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const u=c.code===void 0?H.UNKNOWN:KO(c.code);return new te(u,c.message||"")}(o);t=new XO(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Ov(n,r.document.name),i=Ss(r.document.updateTime),o=r.document.createTime?Ss(r.document.createTime):ve.min(),a=new Rn({mapValue:{fields:r.document.fields}}),l=ln.newFoundDocument(s,i,o,a),c=r.targetIds||[],u=r.removedTargetIds||[];t=new Mp(c,u,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Ov(n,r.document),i=r.readTime?Ss(r.readTime):ve.min(),o=ln.newNoDocument(s,i),a=r.removedTargetIds||[];t=new Mp([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Ov(n,r.document),i=r.removedTargetIds||[];t=new Mp([],i,s,null)}else{if(!("filter"in e))return ye(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new FW(s,i),a=r.targetId;t=new YO(a,o)}}return t}function XW(n,e){let t;if(e instanceof kd)t={update:iC(n,e.key,e.value)};else if(e instanceof pb)t={delete:zw(n,e.key)};else if(e instanceof Fo)t={update:iC(n,e.key,e.data),updateMask:iH(e.fieldMask)};else{if(!(e instanceof DW))return ye(16599,{Vt:e.type});t={verify:zw(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const a=o.transform;if(a instanceof Hh)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof qh)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Gh)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Fg)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw ye(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(t.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:GW(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:ye(27497)}(n,e.precondition)),t}function QW(n,e){return n&&n.length>0?(Be(e!==void 0,14353),n.map(t=>function(s,i){let o=s.updateTime?Ss(s.updateTime):Ss(i);return o.isEqual(ve.min())&&(o=Ss(i)),new OW(o,s.transformResults||[])}(t,e))):[]}function JW(n,e){return{documents:[ZO(n,e.path)]}}function ZW(n,e){const t={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=ZO(n,s);const i=function(c){if(c.length!==0)return nN(Zr.create(c,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const o=function(c){if(c.length!==0)return c.map(u=>function(f){return{field:vl(f.field),direction:nH(f.dir)}}(u))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const a=$w(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{ft:t,parent:s}}function eH(n){let e=KW(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let s=null;if(r>0){Be(r===1,65062);const u=t.from[0];u.allDescendants?s=u.collectionId:e=e.child(u.collectionId)}let i=[];t.where&&(i=function(h){const f=tN(h);return f instanceof Zr&&RO(f)?f.getFilters():[f]}(t.where));let o=[];t.orderBy&&(o=function(h){return h.map(f=>function(y){return new Lg(wl(y.field),function(v){switch(v){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(y.direction))}(f))}(t.orderBy));let a=null;t.limit&&(a=function(h){let f;return f=typeof h=="object"?h.value:h,zm(f)?null:f}(t.limit));let l=null;t.startAt&&(l=function(h){const f=!!h.before,p=h.values||[];return new Mg(p,f)}(t.startAt));let c=null;return t.endAt&&(c=function(h){const f=!h.before,p=h.values||[];return new Mg(p,f)}(t.endAt)),vW(e,s,o,i,a,"F",l,c)}function tH(n,e){const t=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ye(28987,{purpose:s})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function tN(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=wl(t.unaryFilter.field);return kt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=wl(t.unaryFilter.field);return kt.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=wl(t.unaryFilter.field);return kt.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=wl(t.unaryFilter.field);return kt.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ye(61313);default:return ye(60726)}}(n):n.fieldFilter!==void 0?function(t){return kt.create(wl(t.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ye(58110);default:return ye(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Zr.create(t.compositeFilter.filters.map(r=>tN(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return ye(1026)}}(t.compositeFilter.op))}(n):ye(30097,{filter:n})}function nH(n){return zW[n]}function rH(n){return WW[n]}function sH(n){return HW[n]}function vl(n){return{fieldPath:n.canonicalString()}}function wl(n){return Kt.fromServerFormat(n.fieldPath)}function nN(n){return n instanceof kt?function(t){if(t.op==="=="){if(qT(t.value))return{unaryFilter:{field:vl(t.field),op:"IS_NAN"}};if(HT(t.value))return{unaryFilter:{field:vl(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(qT(t.value))return{unaryFilter:{field:vl(t.field),op:"IS_NOT_NAN"}};if(HT(t.value))return{unaryFilter:{field:vl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:vl(t.field),op:rH(t.op),value:t.value}}}(n):n instanceof Zr?function(t){const r=t.getFilters().map(s=>nN(s));return r.length===1?r[0]:{compositeFilter:{op:sH(t.op),filters:r}}}(n):ye(54877,{filter:n})}function iH(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function rN(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ro{constructor(e,t,r,s,i=ve.min(),o=ve.min(),a=Zt.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new ro(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new ro(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ro(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ro(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oH{constructor(e){this.yt=e}}function aH(n){const e=eH({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Uw(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lH{constructor(){this.Cn=new cH}addToCollectionParentIndex(e,t){return this.Cn.add(t),q.resolve()}getCollectionParents(e,t){return q.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return q.resolve()}deleteFieldIndex(e,t){return q.resolve()}deleteAllFieldIndexes(e){return q.resolve()}createTargetIndexes(e,t){return q.resolve()}getDocumentsMatchingTarget(e,t){return q.resolve(null)}getIndexType(e,t){return q.resolve(0)}getFieldIndexes(e,t){return q.resolve([])}getNextCollectionGroupToUpdate(e){return q.resolve(null)}getMinOffset(e,t){return q.resolve(So.min())}getMinOffsetFromCollectionGroup(e,t){return q.resolve(So.min())}updateCollectionGroup(e,t,r){return q.resolve()}updateIndexEntries(e,t){return q.resolve()}}class cH{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t]||new Dt(Xe.comparator),i=!s.has(r);return this.index[t]=s.add(r),i}has(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Dt(Xe.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oC={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},sN=41943040;class An{static withCacheSize(e){return new An(e,An.DEFAULT_COLLECTION_PERCENTILE,An.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */An.DEFAULT_COLLECTION_PERCENTILE=10,An.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,An.DEFAULT=new An(sN,An.DEFAULT_COLLECTION_PERCENTILE,An.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),An.DISABLED=new An(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kc{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new kc(0)}static cr(){return new kc(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aC="LruGarbageCollector",uH=1048576;function lC([n,e],[t,r]){const s=Pe(n,t);return s===0?Pe(e,r):s}class hH{constructor(e){this.Ir=e,this.buffer=new Dt(lC),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();lC(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class dH{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){ne(aC,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Kc(t)?ne(aC,"Ignoring IndexedDB error during garbage collection: ",t):await Gc(t)}await this.Vr(3e5)})}}class fH{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return q.resolve(Bm.ce);const r=new hH(t);return this.mr.forEachTarget(e,s=>r.Ar(s.sequenceNumber)).next(()=>this.mr.pr(e,s=>r.Ar(s))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ne("LruGarbageCollector","Garbage collection skipped; disabled"),q.resolve(oC)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(ne("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),oC):this.yr(e,t))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,s,i,o,a,l,c;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(ne("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),s=this.params.maximumSequenceNumbersToCollect):s=h,o=Date.now(),this.nthSequenceNumber(e,s))).next(h=>(r=h,a=Date.now(),this.removeTargets(e,r,t))).next(h=>(i=h,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(h=>(c=Date.now(),ml()<=Ae.DEBUG&&ne("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-u}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${i} targets in `+(l-a)+`ms
	Removed ${h} documents in `+(c-l)+`ms
Total Duration: ${c-u}ms`),q.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:h})))}}function pH(n,e){return new fH(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gH{constructor(){this.changes=new Ya(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ln.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?q.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mH{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yH{constructor(e,t,r,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,t))).next(s=>(r!==null&&ah(r.mutation,s,Xn.empty(),nt.now()),s))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,Ie()).next(()=>r))}getLocalViewOfDocuments(e,t,r=Ie()){const s=ha();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,r).next(i=>{let o=Uu();return i.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const r=ha();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,Ie()))}populateOverlays(e,t,r){const s=[];return r.forEach(i=>{t.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,s){let i=hi();const o=oh(),a=function(){return oh()}();return t.forEach((l,c)=>{const u=r.get(c.key);s.has(c.key)&&(u===void 0||u.mutation instanceof Fo)?i=i.insert(c.key,c):u!==void 0?(o.set(c.key,u.mutation.getFieldMask()),ah(u.mutation,c,u.mutation.getFieldMask(),nt.now())):o.set(c.key,Xn.empty())}),this.recalculateAndSaveOverlays(e,i).next(l=>(l.forEach((c,u)=>o.set(c,u)),t.forEach((c,u)=>a.set(c,new mH(u,o.get(c)??null))),a))}recalculateAndSaveOverlays(e,t){const r=oh();let s=new ft((o,a)=>o-a),i=Ie();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(l=>{const c=t.get(l);if(c===null)return;let u=r.get(l)||Xn.empty();u=a.applyToLocalView(c,u),r.set(l,u);const h=(s.get(a.batchId)||Ie()).add(l);s=s.insert(a.batchId,h)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,u=l.value,h=UO();u.forEach(f=>{if(!i.has(f)){const p=qO(t.get(f),r.get(f));p!==null&&h.set(f,p),i=i.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,h))}return q.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,s){return function(o){return he.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):DO(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,s):this.getDocumentsMatchingCollectionQuery(e,t,r,s)}getNextDocuments(e,t,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,s-i.size):q.resolve(ha());let a=$h,l=i;return o.next(c=>q.forEach(c,(u,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),i.get(u)?q.resolve():this.remoteDocumentCache.getEntry(e,u).next(f=>{l=l.insert(u,f)}))).next(()=>this.populateOverlays(e,c,i)).next(()=>this.computeViews(e,l,c,Ie())).next(u=>({batchId:a,changes:VO(u)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new he(t)).next(r=>{let s=Uu();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,t,r,s){const i=t.collectionGroup;let o=Uu();return this.indexManager.getCollectionParents(e,i).next(a=>q.forEach(a,l=>{const c=function(h,f){return new Cd(f,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(t,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,c,r,s).next(u=>{u.forEach((h,f)=>{o=o.insert(h,f)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,i,s))).next(o=>{i.forEach((l,c)=>{const u=c.getKey();o.get(u)===null&&(o=o.insert(u,ln.newInvalidDocument(u)))});let a=Uu();return o.forEach((l,c)=>{const u=i.get(l);u!==void 0&&ah(u.mutation,c,Xn.empty(),nt.now()),qm(t,c)&&(a=a.insert(l,c))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vH{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return q.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,function(s){return{id:s.id,version:s.version,createTime:Ss(s.createTime)}}(t)),q.resolve()}getNamedQuery(e,t){return q.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,function(s){return{name:s.name,query:aH(s.bundledQuery),readTime:Ss(s.readTime)}}(t)),q.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wH{constructor(){this.overlays=new ft(he.comparator),this.qr=new Map}getOverlay(e,t){return q.resolve(this.overlays.get(t))}getOverlays(e,t){const r=ha();return q.forEach(t,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((s,i)=>{this.St(e,t,i)}),q.resolve()}removeOverlaysForBatchId(e,t,r){const s=this.qr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(r)),q.resolve()}getOverlaysForCollection(e,t,r){const s=ha(),i=t.length+1,o=new he(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!t.isPrefixOf(c.path))break;c.path.length===i&&l.largestBatchId>r&&s.set(l.getKey(),l)}return q.resolve(s)}getOverlaysForCollectionGroup(e,t,r,s){let i=new ft((c,u)=>c-u);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===t&&c.largestBatchId>r){let u=i.get(c.largestBatchId);u===null&&(u=ha(),i=i.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}const a=ha(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,u)=>a.set(c,u)),!(a.size()>=s)););return q.resolve(a)}St(e,t,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.qr.get(s.largestBatchId).delete(r.key);this.qr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new LW(t,r));let i=this.qr.get(t);i===void 0&&(i=Ie(),this.qr.set(t,i)),this.qr.set(t,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _H{constructor(){this.sessionToken=Zt.EMPTY_BYTE_STRING}getSessionToken(e){return q.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,q.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vb{constructor(){this.Qr=new Dt($t.$r),this.Ur=new Dt($t.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new $t(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Gr(new $t(e,t))}zr(e,t){e.forEach(r=>this.removeReference(r,t))}jr(e){const t=new he(new Xe([])),r=new $t(t,e),s=new $t(t,e+1),i=[];return this.Ur.forEachInRange([r,s],o=>{this.Gr(o),i.push(o.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new he(new Xe([])),r=new $t(t,e),s=new $t(t,e+1);let i=Ie();return this.Ur.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const t=new $t(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class $t{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return he.comparator(e.key,t.key)||Pe(e.Yr,t.Yr)}static Kr(e,t){return Pe(e.Yr,t.Yr)||he.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xH{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Dt($t.$r)}checkEmpty(e){return q.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new MW(i,t,r,s);this.mutationQueue.push(o);for(const a of s)this.Zr=this.Zr.add(new $t(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return q.resolve(o)}lookupMutationBatch(e,t){return q.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=this.ei(r),i=s<0?0:s;return q.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return q.resolve(this.mutationQueue.length===0?ab:this.tr-1)}getAllMutationBatches(e){return q.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new $t(t,0),s=new $t(t,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([r,s],o=>{const a=this.Xr(o.Yr);i.push(a)}),q.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Dt(Pe);return t.forEach(s=>{const i=new $t(s,0),o=new $t(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,o],a=>{r=r.add(a.Yr)})}),q.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1;let i=r;he.isDocumentKey(i)||(i=i.child(""));const o=new $t(new he(i),0);let a=new Dt(Pe);return this.Zr.forEachWhile(l=>{const c=l.key.path;return!!r.isPrefixOf(c)&&(c.length===s&&(a=a.add(l.Yr)),!0)},o),q.resolve(this.ti(a))}ti(e){const t=[];return e.forEach(r=>{const s=this.Xr(r);s!==null&&t.push(s)}),t}removeMutationBatch(e,t){Be(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return q.forEach(t.mutations,s=>{const i=new $t(s.key,t.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,t){const r=new $t(t,0),s=this.Zr.firstAfterOrEqual(r);return q.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,q.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bH{constructor(e){this.ri=e,this.docs=function(){return new ft(he.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,s=this.docs.get(r),i=s?s.size:0,o=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return q.resolve(r?r.document.mutableCopy():ln.newInvalidDocument(t))}getEntries(e,t){let r=hi();return t.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():ln.newInvalidDocument(s))}),q.resolve(r)}getDocumentsMatchingQuery(e,t,r,s){let i=hi();const o=t.path,a=new he(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:c,value:{document:u}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||Q8(X8(u),r)<=0||(s.has(u.key)||qm(t,u))&&(i=i.insert(u.key,u.mutableCopy()))}return q.resolve(i)}getAllFromCollectionGroup(e,t,r,s){ye(9500)}ii(e,t){return q.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new SH(this)}getSize(e){return q.resolve(this.size)}}class SH extends gH{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?t.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(r)}),q.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EH{constructor(e){this.persistence=e,this.si=new Ya(t=>ub(t),hb),this.lastRemoteSnapshotVersion=ve.min(),this.highestTargetId=0,this.oi=0,this._i=new vb,this.targetCount=0,this.ai=kc.ur()}forEachTarget(e,t){return this.si.forEach((r,s)=>t(s)),q.resolve()}getLastRemoteSnapshotVersion(e){return q.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return q.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),q.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),q.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new kc(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,q.resolve()}updateTargetData(e,t){return this.Pr(t),q.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,q.resolve()}removeTargets(e,t,r){let s=0;const i=[];return this.si.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),q.waitFor(i).next(()=>s)}getTargetCount(e){return q.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return q.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),q.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const s=this.persistence.referenceDelegate,i=[];return s&&t.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),q.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),q.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return q.resolve(r)}containsKey(e,t){return q.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iN{constructor(e,t){this.ui={},this.overlays={},this.ci=new Bm(0),this.li=!1,this.li=!0,this.hi=new _H,this.referenceDelegate=e(this),this.Pi=new EH(this),this.indexManager=new lH,this.remoteDocumentCache=function(s){return new bH(s)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new oH(t),this.Ii=new vH(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new wH,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new xH(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){ne("MemoryPersistence","Starting transaction:",e);const s=new TH(this.ci.next());return this.referenceDelegate.Ei(),r(s).next(i=>this.referenceDelegate.di(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ai(e,t){return q.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,t)))}}class TH extends Z8{constructor(e){super(),this.currentSequenceNumber=e}}class wb{constructor(e){this.persistence=e,this.Ri=new vb,this.Vi=null}static mi(e){return new wb(e)}get fi(){if(this.Vi)return this.Vi;throw ye(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),q.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),q.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),q.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(s=>this.fi.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(s=>{s.forEach(i=>this.fi.add(i.toString()))}).next(()=>r.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return q.forEach(this.fi,r=>{const s=he.fromPath(r);return this.gi(e,s).next(i=>{i||t.removeEntry(s,ve.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return q.or([()=>q.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Ug{constructor(e,t){this.persistence=e,this.pi=new Ya(r=>nW(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=pH(this,t)}static mi(e,t){return new Ug(e,t)}Ei(){}di(e){return q.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(s=>r+s))}wr(e){let t=0;return this.pr(e,r=>{t++}).next(()=>t)}pr(e,t){return q.forEach(this.pi,(r,s)=>this.br(e,r,s).next(i=>i?q.resolve():t(s)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,o=>this.br(e,o,t).next(a=>{a||(r++,i.removeEntry(o,ve.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),q.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),q.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),q.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),q.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Np(e.data.value)),t}br(e,t,r){return q.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const s=this.pi.get(t);return q.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _b{constructor(e,t,r,s){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=s}static As(e,t){let r=Ie(),s=Ie();for(const i of t.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new _b(e,t.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CH{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kH{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return rB()?8:eW(hn())>0?6:4}()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,s){const i={result:null};return this.ys(e,t).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ws(e,t,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new CH;return this.Ss(e,t,o).next(a=>{if(i.result=a,this.Vs)return this.bs(e,t,o,a.size)})}).next(()=>i.result)}bs(e,t,r,s){return r.documentReadCount<this.fs?(ml()<=Ae.DEBUG&&ne("QueryEngine","SDK will not create cache indexes for query:",yl(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),q.resolve()):(ml()<=Ae.DEBUG&&ne("QueryEngine","Query:",yl(t),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.gs*s?(ml()<=Ae.DEBUG&&ne("QueryEngine","The SDK decides to create cache indexes for query:",yl(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,bs(t))):q.resolve())}ys(e,t){if(XT(t))return q.resolve(null);let r=bs(t);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(t.limit!==null&&s===1&&(t=Uw(t,null,"F"),r=bs(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=Ie(...i);return this.ps.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const c=this.Ds(t,a);return this.Cs(t,c,o,l.readTime)?this.ys(e,Uw(t,null,"F")):this.vs(e,c,t,l)}))})))}ws(e,t,r,s){return XT(t)||s.isEqual(ve.min())?q.resolve(null):this.ps.getDocuments(e,r).next(i=>{const o=this.Ds(t,i);return this.Cs(t,o,r,s)?q.resolve(null):(ml()<=Ae.DEBUG&&ne("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),yl(t)),this.vs(e,o,t,Y8(s,$h)).next(a=>a))})}Ds(e,t){let r=new Dt(LO(e));return t.forEach((s,i)=>{qm(e,i)&&(r=r.add(i))}),r}Cs(e,t,r,s){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,t,r){return ml()<=Ae.DEBUG&&ne("QueryEngine","Using full collection scan to execute query:",yl(t)),this.ps.getDocumentsMatchingQuery(e,t,So.min(),r)}vs(e,t,r,s){return this.ps.getDocumentsMatchingQuery(e,r,s).next(i=>(t.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xb="LocalStore",AH=3e8;class PH{constructor(e,t,r,s){this.persistence=e,this.Fs=t,this.serializer=s,this.Ms=new ft(Pe),this.xs=new Ya(i=>ub(i),hb),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new yH(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}}function IH(n,e,t,r){return new PH(n,e,t,r)}async function oN(n,e){const t=we(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,t.Bs(e),t.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let l=Ie();for(const c of s){o.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}for(const c of i){a.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}return t.localDocuments.getDocuments(r,l).next(c=>({Ls:c,removedBatchIds:o,addedBatchIds:a}))})})}function RH(n,e){const t=we(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=t.Ns.newChangeBuffer({trackRemovals:!0});return function(a,l,c,u){const h=c.batch,f=h.keys();let p=q.resolve();return f.forEach(y=>{p=p.next(()=>u.getEntry(l,y)).next(m=>{const v=c.docVersions.get(y);Be(v!==null,48541),m.version.compareTo(v)<0&&(h.applyToRemoteDocument(m,c),m.isValidDocument()&&(m.setReadTime(c.commitVersion),u.addEntry(m)))})}),p.next(()=>a.mutationQueue.removeMutationBatch(l,h))}(t,r,e,i).next(()=>i.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=Ie();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l}(e))).next(()=>t.localDocuments.getDocuments(r,s))})}function aN(n){const e=we(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Pi.getLastRemoteSnapshotVersion(t))}function OH(n,e){const t=we(n),r=e.snapshotVersion;let s=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=t.Ns.newChangeBuffer({trackRemovals:!0});s=t.Ms;const a=[];e.targetChanges.forEach((u,h)=>{const f=s.get(h);if(!f)return;a.push(t.Pi.removeMatchingKeys(i,u.removedDocuments,h).next(()=>t.Pi.addMatchingKeys(i,u.addedDocuments,h)));let p=f.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(h)!==null?p=p.withResumeToken(Zt.EMPTY_BYTE_STRING,ve.min()).withLastLimboFreeSnapshotVersion(ve.min()):u.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(u.resumeToken,r)),s=s.insert(h,p),function(m,v,w){return m.resumeToken.approximateByteSize()===0||v.snapshotVersion.toMicroseconds()-m.snapshotVersion.toMicroseconds()>=AH?!0:w.addedDocuments.size+w.modifiedDocuments.size+w.removedDocuments.size>0}(f,p,u)&&a.push(t.Pi.updateTargetData(i,p))});let l=hi(),c=Ie();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(i,u))}),a.push(NH(i,o,e.documentUpdates).next(u=>{l=u.ks,c=u.qs})),!r.isEqual(ve.min())){const u=t.Pi.getLastRemoteSnapshotVersion(i).next(h=>t.Pi.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(u)}return q.waitFor(a).next(()=>o.apply(i)).next(()=>t.localDocuments.getLocalViewOfDocuments(i,l,c)).next(()=>l)}).then(i=>(t.Ms=s,i))}function NH(n,e,t){let r=Ie(),s=Ie();return t.forEach(i=>r=r.add(i)),e.getEntries(n,r).next(i=>{let o=hi();return t.forEach((a,l)=>{const c=i.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(a)),l.isNoDocument()&&l.version.isEqual(ve.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):ne(xb,"Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{ks:o,qs:s}})}function jH(n,e){const t=we(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=ab),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function DH(n,e){const t=we(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return t.Pi.getTargetData(r,e).next(i=>i?(s=i,q.resolve(s)):t.Pi.allocateTargetId(r).next(o=>(s=new ro(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=t.Ms.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r})}async function Hw(n,e,t){const r=we(n),s=r.Ms.get(e),i=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Kc(o))throw o;ne(xb,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(s.target)}function cC(n,e,t){const r=we(n);let s=ve.min(),i=Ie();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,c,u){const h=we(l),f=h.xs.get(u);return f!==void 0?q.resolve(h.Ms.get(f)):h.Pi.getTargetData(c,u)}(r,o,bs(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,a.targetId).next(l=>{i=l})}).next(()=>r.Fs.getDocumentsMatchingQuery(o,e,t?s:ve.min(),t?i:Ie())).next(a=>(MH(r,_W(e),a),{documents:a,Qs:i})))}function MH(n,e,t){let r=n.Os.get(e)||ve.min();t.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),n.Os.set(e,r)}class uC{constructor(){this.activeTargetIds=CW()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class LH{constructor(){this.Mo=new uC,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new uC,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FH{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hC="ConnectivityMonitor";class dC{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){ne(hC,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){ne(hC,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let kf=null;function qw(){return kf===null?kf=function(){return 268435456+Math.round(2147483648*Math.random())}():kf++,"0x"+kf.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nv="RestConnection",VH={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class UH{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${s}`,this.Wo=this.databaseId.database===jg?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Go(e,t,r,s,i){const o=qw(),a=this.zo(e,t.toUriEncodedString());ne(Nv,`Sending RPC '${e}' ${o}:`,a,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,s,i);const{host:c}=new URL(a),u=zc(c);return this.Jo(e,a,l,r,u).then(h=>(ne(Nv,`Received RPC '${e}' ${o}: `,h),h),h=>{throw Sc(Nv,`RPC '${e}' ${o} failed with error: `,h,"url: ",a,"request:",r),h})}Ho(e,t,r,s,i,o){return this.Go(e,t,r,s,i)}jo(e,t,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+qc}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}zo(e,t){const r=VH[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $H{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rn="WebChannelConnection";class BH extends UH{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,s,i){const o=qw();return new Promise((a,l)=>{const c=new cO;c.setWithCredentials(!0),c.listenOnce(uO.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Op.NO_ERROR:const h=c.getResponseJson();ne(rn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(h)),a(h);break;case Op.TIMEOUT:ne(rn,`RPC '${e}' ${o} timed out`),l(new te(H.DEADLINE_EXCEEDED,"Request time out"));break;case Op.HTTP_ERROR:const f=c.getStatus();if(ne(rn,`RPC '${e}' ${o} failed with status:`,f,"response text:",c.getResponseText()),f>0){let p=c.getResponseJson();Array.isArray(p)&&(p=p[0]);const y=p==null?void 0:p.error;if(y&&y.status&&y.message){const m=function(w){const _=w.toLowerCase().replace(/_/g,"-");return Object.values(H).indexOf(_)>=0?_:H.UNKNOWN}(y.status);l(new te(m,y.message))}else l(new te(H.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new te(H.UNAVAILABLE,"Connection failed."));break;default:ye(9055,{l_:e,streamId:o,h_:c.getLastErrorCode(),P_:c.getLastError()})}}finally{ne(rn,`RPC '${e}' ${o} completed.`)}});const u=JSON.stringify(s);ne(rn,`RPC '${e}' ${o} sending request:`,s),c.send(t,"POST",u,r,15)})}T_(e,t,r){const s=qw(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=fO(),a=dO(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;const u=i.join("");ne(rn,`Creating RPC '${e}' stream ${s}: ${u}`,l);const h=o.createWebChannel(u,l);this.I_(h);let f=!1,p=!1;const y=new $H({Yo:v=>{p?ne(rn,`Not sending because RPC '${e}' stream ${s} is closed:`,v):(f||(ne(rn,`Opening RPC '${e}' stream ${s} transport.`),h.open(),f=!0),ne(rn,`RPC '${e}' stream ${s} sending:`,v),h.send(v))},Zo:()=>h.close()}),m=(v,w,_)=>{v.listen(w,x=>{try{_(x)}catch(A){setTimeout(()=>{throw A},0)}})};return m(h,Vu.EventType.OPEN,()=>{p||(ne(rn,`RPC '${e}' stream ${s} transport opened.`),y.o_())}),m(h,Vu.EventType.CLOSE,()=>{p||(p=!0,ne(rn,`RPC '${e}' stream ${s} transport closed`),y.a_(),this.E_(h))}),m(h,Vu.EventType.ERROR,v=>{p||(p=!0,Sc(rn,`RPC '${e}' stream ${s} transport errored. Name:`,v.name,"Message:",v.message),y.a_(new te(H.UNAVAILABLE,"The operation could not be completed")))}),m(h,Vu.EventType.MESSAGE,v=>{var w;if(!p){const _=v.data[0];Be(!!_,16349);const x=_,A=(x==null?void 0:x.error)||((w=x[0])==null?void 0:w.error);if(A){ne(rn,`RPC '${e}' stream ${s} received error:`,A);const j=A.status;let N=function(P){const R=St[P];if(R!==void 0)return KO(R)}(j),S=A.message;N===void 0&&(N=H.INTERNAL,S="Unknown error status: "+j+" with message "+A.message),p=!0,y.a_(new te(N,S)),h.close()}else ne(rn,`RPC '${e}' stream ${s} received:`,_),y.u_(_)}}),m(a,hO.STAT_EVENT,v=>{v.stat===Nw.PROXY?ne(rn,`RPC '${e}' stream ${s} detected buffering proxy`):v.stat===Nw.NOPROXY&&ne(rn,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{y.__()},0),y}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}}function jv(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xm(n){return new qW(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lN{constructor(e,t,r=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,t-r);s>0&&ne("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fC="PersistentStream";class cN{constructor(e,t,r,s,i,o,a,l){this.Mi=e,this.S_=r,this.b_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new lN(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===H.RESOURCE_EXHAUSTED?(ui(t.toString()),ui("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===H.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.D_===t&&this.G_(r,s)},r=>{e(()=>{const s=new te(H.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)})})}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(s=>{r(()=>this.z_(s))}),this.stream.onMessage(s=>{r(()=>++this.F_==1?this.J_(s):this.onNext(s))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return ne(fC,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget(()=>this.D_===e?t():(ne(fC,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class zH extends cN{constructor(e,t,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,s,o),this.serializer=i}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=YW(this.serializer,e),r=function(i){if(!("targetChange"in i))return ve.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?ve.min():o.readTime?Ss(o.readTime):ve.min()}(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=Ww(this.serializer),t.addTarget=function(i,o){let a;const l=o.target;if(a=Fw(l)?{documents:JW(i,l)}:{query:ZW(i,l).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=QO(i,o.resumeToken);const c=$w(i,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(ve.min())>0){a.readTime=Vg(i,o.snapshotVersion.toTimestamp());const c=$w(i,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);const r=tH(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=Ww(this.serializer),t.removeTarget=e,this.q_(t)}}class WH extends cN{constructor(e,t,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,s,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Be(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Be(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Be(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=QW(e.writeResults,e.commitTime),r=Ss(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=Ww(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>XW(this.serializer,r))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HH{}class qH extends HH{constructor(e,t,r,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new te(H.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Go(e,Bw(t,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===H.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new te(H.UNKNOWN,i.toString())})}Ho(e,t,r,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Ho(e,Bw(t,r),s,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===H.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new te(H.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class GH{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ui(t),this.aa=!1):ne("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ua="RemoteStore";class KH{constructor(e,t,r,s,i){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(o=>{r.enqueueAndForget(async()=>{Xa(this)&&(ne(Ua,"Restarting streams for network reachability change."),await async function(l){const c=we(l);c.Ea.add(4),await Pd(c),c.Ra.set("Unknown"),c.Ea.delete(4),await Qm(c)}(this))})}),this.Ra=new GH(r,s)}}async function Qm(n){if(Xa(n))for(const e of n.da)await e(!0)}async function Pd(n){for(const e of n.da)await e(!1)}function uN(n,e){const t=we(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Tb(t)?Eb(t):Yc(t).O_()&&Sb(t,e))}function bb(n,e){const t=we(n),r=Yc(t);t.Ia.delete(e),r.O_()&&hN(t,e),t.Ia.size===0&&(r.O_()?r.L_():Xa(t)&&t.Ra.set("Unknown"))}function Sb(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ve.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Yc(n).Y_(e)}function hN(n,e){n.Va.Ue(e),Yc(n).Z_(e)}function Eb(n){n.Va=new BW({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Yc(n).start(),n.Ra.ua()}function Tb(n){return Xa(n)&&!Yc(n).x_()&&n.Ia.size>0}function Xa(n){return we(n).Ea.size===0}function dN(n){n.Va=void 0}async function YH(n){n.Ra.set("Online")}async function XH(n){n.Ia.forEach((e,t)=>{Sb(n,e)})}async function QH(n,e){dN(n),Tb(n)?(n.Ra.ha(e),Eb(n)):n.Ra.set("Unknown")}async function JH(n,e,t){if(n.Ra.set("Online"),e instanceof XO&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const a of i.targetIds)s.Ia.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.Ia.delete(a),s.Va.removeTarget(a))}(n,e)}catch(r){ne(Ua,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await $g(n,r)}else if(e instanceof Mp?n.Va.Ze(e):e instanceof YO?n.Va.st(e):n.Va.tt(e),!t.isEqual(ve.min()))try{const r=await aN(n.localStore);t.compareTo(r)>=0&&await function(i,o){const a=i.Va.Tt(o);return a.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const u=i.Ia.get(c);u&&i.Ia.set(c,u.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,c)=>{const u=i.Ia.get(l);if(!u)return;i.Ia.set(l,u.withResumeToken(Zt.EMPTY_BYTE_STRING,u.snapshotVersion)),hN(i,l);const h=new ro(u.target,l,c,u.sequenceNumber);Sb(i,h)}),i.remoteSyncer.applyRemoteEvent(a)}(n,t)}catch(r){ne(Ua,"Failed to raise snapshot:",r),await $g(n,r)}}async function $g(n,e,t){if(!Kc(e))throw e;n.Ea.add(1),await Pd(n),n.Ra.set("Offline"),t||(t=()=>aN(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{ne(Ua,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Qm(n)})}function fN(n,e){return e().catch(t=>$g(n,t,e))}async function Jm(n){const e=we(n),t=ko(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:ab;for(;ZH(e);)try{const s=await jH(e.localStore,r);if(s===null){e.Ta.length===0&&t.L_();break}r=s.batchId,e7(e,s)}catch(s){await $g(e,s)}pN(e)&&gN(e)}function ZH(n){return Xa(n)&&n.Ta.length<10}function e7(n,e){n.Ta.push(e);const t=ko(n);t.O_()&&t.X_&&t.ea(e.mutations)}function pN(n){return Xa(n)&&!ko(n).x_()&&n.Ta.length>0}function gN(n){ko(n).start()}async function t7(n){ko(n).ra()}async function n7(n){const e=ko(n);for(const t of n.Ta)e.ea(t.mutations)}async function r7(n,e,t){const r=n.Ta.shift(),s=gb.from(r,e,t);await fN(n,()=>n.remoteSyncer.applySuccessfulWrite(s)),await Jm(n)}async function s7(n,e){e&&ko(n).X_&&await async function(r,s){if(function(o){return VW(o)&&o!==H.ABORTED}(s.code)){const i=r.Ta.shift();ko(r).B_(),await fN(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Jm(r)}}(n,e),pN(n)&&gN(n)}async function pC(n,e){const t=we(n);t.asyncQueue.verifyOperationInProgress(),ne(Ua,"RemoteStore received new credentials");const r=Xa(t);t.Ea.add(3),await Pd(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Qm(t)}async function i7(n,e){const t=we(n);e?(t.Ea.delete(2),await Qm(t)):e||(t.Ea.add(2),await Pd(t),t.Ra.set("Unknown"))}function Yc(n){return n.ma||(n.ma=function(t,r,s){const i=we(t);return i.sa(),new zH(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(n.datastore,n.asyncQueue,{Xo:YH.bind(null,n),t_:XH.bind(null,n),r_:QH.bind(null,n),H_:JH.bind(null,n)}),n.da.push(async e=>{e?(n.ma.B_(),Tb(n)?Eb(n):n.Ra.set("Unknown")):(await n.ma.stop(),dN(n))})),n.ma}function ko(n){return n.fa||(n.fa=function(t,r,s){const i=we(t);return i.sa(),new WH(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:t7.bind(null,n),r_:s7.bind(null,n),ta:n7.bind(null,n),na:r7.bind(null,n)}),n.da.push(async e=>{e?(n.fa.B_(),await Jm(n)):(await n.fa.stop(),n.Ta.length>0&&(ne(Ua,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))})),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cb{constructor(e,t,r,s,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Zs,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,s,i){const o=Date.now()+r,a=new Cb(e,t,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new te(H.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function kb(n,e){if(ui("AsyncQueue",`${e}: ${n}`),Kc(n))return new te(H.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ql{static emptySet(e){return new Ql(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||he.comparator(t.key,r.key):(t,r)=>he.comparator(t.key,r.key),this.keyedMap=Uu(),this.sortedSet=new ft(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Ql)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Ql;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gC{constructor(){this.ga=new ft(he.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):ye(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal((t,r)=>{e.push(r)}),e}}class Ac{constructor(e,t,r,s,i,o,a,l,c){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,t,r,s,i){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new Ac(e,t,Ql.emptySet(t),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Hm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==r[s].type||!t[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o7{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class a7{constructor(){this.queries=mC(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const s=we(t),i=s.queries;s.queries=mC(),i.forEach((o,a)=>{for(const l of a.Sa)l.onError(r)})})(this,new te(H.ABORTED,"Firestore shutting down"))}}function mC(){return new Ya(n=>MO(n),Hm)}async function mN(n,e){const t=we(n);let r=3;const s=e.query;let i=t.queries.get(s);i?!i.ba()&&e.Da()&&(r=2):(i=new o7,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await t.onListen(s,!0);break;case 1:i.wa=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(o){const a=kb(o,`Initialization of query '${yl(e.query)}' failed`);return void e.onError(a)}t.queries.set(s,i),i.Sa.push(e),e.va(t.onlineState),i.wa&&e.Fa(i.wa)&&Ab(t)}async function yN(n,e){const t=we(n),r=e.query;let s=3;const i=t.queries.get(r);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function l7(n,e){const t=we(n);let r=!1;for(const s of e){const i=s.query,o=t.queries.get(i);if(o){for(const a of o.Sa)a.Fa(s)&&(r=!0);o.wa=s}}r&&Ab(t)}function c7(n,e,t){const r=we(n),s=r.queries.get(e);if(s)for(const i of s.Sa)i.onError(t);r.queries.delete(e)}function Ab(n){n.Ca.forEach(e=>{e.next()})}var Gw,yC;(yC=Gw||(Gw={})).Ma="default",yC.Cache="cache";class vN{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Ac(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Ac.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Gw.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wN{constructor(e){this.key=e}}class _N{constructor(e){this.key=e}}class u7{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Ie(),this.mutatedKeys=Ie(),this.eu=LO(e),this.tu=new Ql(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new gC,s=t?t.tu:this.tu;let i=t?t.mutatedKeys:this.mutatedKeys,o=s,a=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((u,h)=>{const f=s.get(u),p=qm(this.query,h)?h:null,y=!!f&&this.mutatedKeys.has(f.key),m=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let v=!1;f&&p?f.data.isEqual(p.data)?y!==m&&(r.track({type:3,doc:p}),v=!0):this.su(f,p)||(r.track({type:2,doc:p}),v=!0,(l&&this.eu(p,l)>0||c&&this.eu(p,c)<0)&&(a=!0)):!f&&p?(r.track({type:0,doc:p}),v=!0):f&&!p&&(r.track({type:1,doc:f}),v=!0,(l||c)&&(a=!0)),v&&(p?(o=o.add(p),i=m?i.add(u):i.delete(u)):(o=o.delete(u),i=i.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),i=i.delete(u.key),r.track({type:1,doc:u})}return{tu:o,iu:r,Cs:a,mutatedKeys:i}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((u,h)=>function(p,y){const m=v=>{switch(v){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ye(20277,{Rt:v})}};return m(p)-m(y)}(u.type,h.type)||this.eu(u.doc,h.doc)),this.ou(r),s=s??!1;const a=t&&!s?this._u():[],l=this.Xa.size===0&&this.current&&!s?1:0,c=l!==this.Za;return this.Za=l,o.length!==0||c?{snapshot:new Ac(this.query,e.tu,i,o,e.mutatedKeys,l===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new gC,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(t=>this.Ya=this.Ya.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ya=this.Ya.delete(t)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Ie(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const t=[];return e.forEach(r=>{this.Xa.has(r)||t.push(new _N(r))}),this.Xa.forEach(r=>{e.has(r)||t.push(new wN(r))}),t}cu(e){this.Ya=e.Qs,this.Xa=Ie();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Ac.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Pb="SyncEngine";class h7{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class d7{constructor(e){this.key=e,this.hu=!1}}class f7{constructor(e,t,r,s,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Ya(a=>MO(a),Hm),this.Iu=new Map,this.Eu=new Set,this.du=new ft(he.comparator),this.Au=new Map,this.Ru=new vb,this.Vu={},this.mu=new Map,this.fu=kc.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function p7(n,e,t=!0){const r=CN(n);let s;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await xN(r,e,t,!0),s}async function g7(n,e){const t=CN(n);await xN(t,e,!0,!1)}async function xN(n,e,t,r){const s=await DH(n.localStore,bs(e)),i=s.targetId,o=n.sharedClientState.addLocalQueryTarget(i,t);let a;return r&&(a=await m7(n,e,i,o==="current",s.resumeToken)),n.isPrimaryClient&&t&&uN(n.remoteStore,s),a}async function m7(n,e,t,r,s){n.pu=(h,f,p)=>async function(m,v,w,_){let x=v.view.ru(w);x.Cs&&(x=await cC(m.localStore,v.query,!1).then(({documents:S})=>v.view.ru(S,x)));const A=_&&_.targetChanges.get(v.targetId),j=_&&_.targetMismatches.get(v.targetId)!=null,N=v.view.applyChanges(x,m.isPrimaryClient,A,j);return wC(m,v.targetId,N.au),N.snapshot}(n,h,f,p);const i=await cC(n.localStore,e,!0),o=new u7(e,i.Qs),a=o.ru(i.documents),l=Ad.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",s),c=o.applyChanges(a,n.isPrimaryClient,l);wC(n,t,c.au);const u=new h7(e,t,o);return n.Tu.set(e,u),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),c.snapshot}async function y7(n,e,t){const r=we(n),s=r.Tu.get(e),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter(o=>!Hm(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Hw(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),t&&bb(r.remoteStore,s.targetId),Kw(r,s.targetId)}).catch(Gc)):(Kw(r,s.targetId),await Hw(r.localStore,s.targetId,!0))}async function v7(n,e){const t=we(n),r=t.Tu.get(e),s=t.Iu.get(r.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),bb(t.remoteStore,r.targetId))}async function w7(n,e,t){const r=C7(n);try{const s=await function(o,a){const l=we(o),c=nt.now(),u=a.reduce((p,y)=>p.add(y.key),Ie());let h,f;return l.persistence.runTransaction("Locally write mutations","readwrite",p=>{let y=hi(),m=Ie();return l.Ns.getEntries(p,u).next(v=>{y=v,y.forEach((w,_)=>{_.isValidDocument()||(m=m.add(w))})}).next(()=>l.localDocuments.getOverlayedDocuments(p,y)).next(v=>{h=v;const w=[];for(const _ of a){const x=jW(_,h.get(_.key).overlayedDocument);x!=null&&w.push(new Fo(_.key,x,AO(x.value.mapValue),gr.exists(!0)))}return l.mutationQueue.addMutationBatch(p,c,w,a)}).next(v=>{f=v;const w=v.applyToLocalDocumentSet(h,m);return l.documentOverlayCache.saveOverlays(p,v.batchId,w)})}).then(()=>({batchId:f.batchId,changes:VO(h)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,a,l){let c=o.Vu[o.currentUser.toKey()];c||(c=new ft(Pe)),c=c.insert(a,l),o.Vu[o.currentUser.toKey()]=c}(r,s.batchId,t),await Id(r,s.changes),await Jm(r.remoteStore)}catch(s){const i=kb(s,"Failed to persist write");t.reject(i)}}async function bN(n,e){const t=we(n);try{const r=await OH(t.localStore,e);e.targetChanges.forEach((s,i)=>{const o=t.Au.get(i);o&&(Be(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.hu=!0:s.modifiedDocuments.size>0?Be(o.hu,14607):s.removedDocuments.size>0&&(Be(o.hu,42227),o.hu=!1))}),await Id(t,r,e)}catch(r){await Gc(r)}}function vC(n,e,t){const r=we(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const s=[];r.Tu.forEach((i,o)=>{const a=o.view.va(e);a.snapshot&&s.push(a.snapshot)}),function(o,a){const l=we(o);l.onlineState=a;let c=!1;l.queries.forEach((u,h)=>{for(const f of h.Sa)f.va(a)&&(c=!0)}),c&&Ab(l)}(r.eventManager,e),s.length&&r.Pu.H_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function _7(n,e,t){const r=we(n);r.sharedClientState.updateQueryState(e,"rejected",t);const s=r.Au.get(e),i=s&&s.key;if(i){let o=new ft(he.comparator);o=o.insert(i,ln.newNoDocument(i,ve.min()));const a=Ie().add(i),l=new Ym(ve.min(),new Map,new ft(Pe),o,a);await bN(r,l),r.du=r.du.remove(i),r.Au.delete(e),Ib(r)}else await Hw(r.localStore,e,!1).then(()=>Kw(r,e,t)).catch(Gc)}async function x7(n,e){const t=we(n),r=e.batch.batchId;try{const s=await RH(t.localStore,e);EN(t,r,null),SN(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Id(t,s)}catch(s){await Gc(s)}}async function b7(n,e,t){const r=we(n);try{const s=await function(o,a){const l=we(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let u;return l.mutationQueue.lookupMutationBatch(c,a).next(h=>(Be(h!==null,37113),u=h.keys(),l.mutationQueue.removeMutationBatch(c,h))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,u,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,u)).next(()=>l.localDocuments.getDocuments(c,u))})}(r.localStore,e);EN(r,e,t),SN(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Id(r,s)}catch(s){await Gc(s)}}function SN(n,e){(n.mu.get(e)||[]).forEach(t=>{t.resolve()}),n.mu.delete(e)}function EN(n,e,t){const r=we(n);let s=r.Vu[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(t?i.reject(t):i.resolve(),s=s.remove(e)),r.Vu[r.currentUser.toKey()]=s}}function Kw(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach(r=>{n.Ru.containsKey(r)||TN(n,r)})}function TN(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(bb(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),Ib(n))}function wC(n,e,t){for(const r of t)r instanceof wN?(n.Ru.addReference(r.key,e),S7(n,r)):r instanceof _N?(ne(Pb,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||TN(n,r.key)):ye(19791,{wu:r})}function S7(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(ne(Pb,"New document in limbo: "+t),n.Eu.add(r),Ib(n))}function Ib(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new he(Xe.fromString(e)),r=n.fu.next();n.Au.set(r,new d7(t)),n.du=n.du.insert(t,r),uN(n.remoteStore,new ro(bs(db(t.path)),r,"TargetPurposeLimboResolution",Bm.ce))}}async function Id(n,e,t){const r=we(n),s=[],i=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((a,l)=>{o.push(r.pu(l,e,t).then(c=>{var u;if((c||t)&&r.isPrimaryClient){const h=c?!c.fromCache:(u=t==null?void 0:t.targetChanges.get(l.targetId))==null?void 0:u.current;r.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(c){s.push(c);const h=_b.As(l.targetId,c);i.push(h)}}))}),await Promise.all(o),r.Pu.H_(s),await async function(l,c){const u=we(l);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>q.forEach(c,f=>q.forEach(f.Es,p=>u.persistence.referenceDelegate.addReference(h,f.targetId,p)).next(()=>q.forEach(f.ds,p=>u.persistence.referenceDelegate.removeReference(h,f.targetId,p)))))}catch(h){if(!Kc(h))throw h;ne(xb,"Failed to update sequence numbers: "+h)}for(const h of c){const f=h.targetId;if(!h.fromCache){const p=u.Ms.get(f),y=p.snapshotVersion,m=p.withLastLimboFreeSnapshotVersion(y);u.Ms=u.Ms.insert(f,m)}}}(r.localStore,i))}async function E7(n,e){const t=we(n);if(!t.currentUser.isEqual(e)){ne(Pb,"User change. New user:",e.toKey());const r=await oN(t.localStore,e);t.currentUser=e,function(i,o){i.mu.forEach(a=>{a.forEach(l=>{l.reject(new te(H.CANCELLED,o))})}),i.mu.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Id(t,r.Ls)}}function T7(n,e){const t=we(n),r=t.Au.get(e);if(r&&r.hu)return Ie().add(r.key);{let s=Ie();const i=t.Iu.get(e);if(!i)return s;for(const o of i){const a=t.Tu.get(o);s=s.unionWith(a.view.nu)}return s}}function CN(n){const e=we(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=bN.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=T7.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=_7.bind(null,e),e.Pu.H_=l7.bind(null,e.eventManager),e.Pu.yu=c7.bind(null,e.eventManager),e}function C7(n){const e=we(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=x7.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=b7.bind(null,e),e}class Bg{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Xm(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return IH(this.persistence,new kH,e.initialUser,this.serializer)}Cu(e){return new iN(wb.mi,this.serializer)}Du(e){return new LH}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Bg.provider={build:()=>new Bg};class k7 extends Bg{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Be(this.persistence.referenceDelegate instanceof Ug,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new dH(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?An.withCacheSize(this.cacheSizeBytes):An.DEFAULT;return new iN(r=>Ug.mi(r,t),this.serializer)}}class Yw{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>vC(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=E7.bind(null,this.syncEngine),await i7(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new a7}()}createDatastore(e){const t=Xm(e.databaseInfo.databaseId),r=function(i){return new BH(i)}(e.databaseInfo);return function(i,o,a,l){return new qH(i,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,s,i,o,a){return new KH(r,s,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>vC(this.syncEngine,t,0),function(){return dC.v()?new dC:new FH}())}createSyncEngine(e,t){return function(s,i,o,a,l,c,u){const h=new f7(s,i,o,a,l,c);return u&&(h.gu=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(s){const i=we(s);ne(Ua,"RemoteStore shutting down."),i.Ea.add(5),await Pd(i),i.Aa.shutdown(),i.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}Yw.provider={build:()=>new Yw};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kN{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):ui("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ao="FirestoreClient";class A7{constructor(e,t,r,s,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=s,this.user=on.UNAUTHENTICATED,this.clientId=ob.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{ne(Ao,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(ne(Ao,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Zs;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=kb(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Dv(n,e){n.asyncQueue.verifyOperationInProgress(),ne(Ao,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async s=>{r.isEqual(s)||(await oN(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function _C(n,e){n.asyncQueue.verifyOperationInProgress();const t=await P7(n);ne(Ao,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>pC(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,s)=>pC(e.remoteStore,s)),n._onlineComponents=e}async function P7(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){ne(Ao,"Using user provided OfflineComponentProvider");try{await Dv(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(s){return s.name==="FirebaseError"?s.code===H.FAILED_PRECONDITION||s.code===H.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(t))throw t;Sc("Error using user provided cache. Falling back to memory cache: "+t),await Dv(n,new Bg)}}else ne(Ao,"Using default OfflineComponentProvider"),await Dv(n,new k7(void 0));return n._offlineComponents}async function AN(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(ne(Ao,"Using user provided OnlineComponentProvider"),await _C(n,n._uninitializedComponentsProvider._online)):(ne(Ao,"Using default OnlineComponentProvider"),await _C(n,new Yw))),n._onlineComponents}function I7(n){return AN(n).then(e=>e.syncEngine)}async function PN(n){const e=await AN(n),t=e.eventManager;return t.onListen=p7.bind(null,e.syncEngine),t.onUnlisten=y7.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=g7.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=v7.bind(null,e.syncEngine),t}function R7(n,e,t={}){const r=new Zs;return n.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,c){const u=new kN({next:f=>{u.Nu(),o.enqueueAndForget(()=>yN(i,h));const p=f.docs.has(a);!p&&f.fromCache?c.reject(new te(H.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&f.fromCache&&l&&l.source==="server"?c.reject(new te(H.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(f)},error:f=>c.reject(f)}),h=new vN(db(a.path),u,{includeMetadataChanges:!0,qa:!0});return mN(i,h)}(await PN(n),n.asyncQueue,e,t,r)),r.promise}function O7(n,e,t={}){const r=new Zs;return n.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,c){const u=new kN({next:f=>{u.Nu(),o.enqueueAndForget(()=>yN(i,h)),f.fromCache&&l.source==="server"?c.reject(new te(H.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(f)},error:f=>c.reject(f)}),h=new vN(a,u,{includeMetadataChanges:!0,qa:!0});return mN(i,h)}(await PN(n),n.asyncQueue,e,t,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IN(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xC=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RN="firestore.googleapis.com",bC=!0;class SC{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new te(H.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=RN,this.ssl=bC}else this.host=e.host,this.ssl=e.ssl??bC;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=sN;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<uH)throw new te(H.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}K8("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=IN(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new te(H.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new te(H.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new te(H.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Zm{constructor(e,t,r,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new SC({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new te(H.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new te(H.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new SC(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new F8;switch(r.type){case"firstParty":return new B8(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new te(H.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=xC.get(t);r&&(ne("ComponentProvider","Removing Datastore"),xC.delete(t),r.terminate())}(this),Promise.resolve()}}function N7(n,e,t,r={}){var c;n=Jr(n,Zm);const s=zc(e),i=n._getSettings(),o={...i,emulatorOptions:n._getEmulatorOptions()},a=`${e}:${t}`;s&&(_2(`https://${a}`),x2("Firestore",!0)),i.host!==RN&&i.host!==a&&Sc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...i,host:a,ssl:s,emulatorOptions:r};if(!Da(l,o)&&(n._setSettings(l),r.mockUserToken)){let u,h;if(typeof r.mockUserToken=="string")u=r.mockUserToken,h=on.MOCK_USER;else{u=K6(r.mockUserToken,(c=n._app)==null?void 0:c.options.projectId);const f=r.mockUserToken.sub||r.mockUserToken.user_id;if(!f)throw new te(H.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new on(f)}n._authCredentials=new V8(new gO(u,h))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xc{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Xc(this.firestore,e,this._query)}}class _t{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new vo(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new _t(this.firestore,e,this._key)}toJSON(){return{type:_t._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(Td(t,_t._jsonSchema))return new _t(e,r||null,new he(Xe.fromString(t.referencePath)))}}_t._jsonSchemaVersion="firestore/documentReference/1.0",_t._jsonSchema={type:At("string",_t._jsonSchemaVersion),referencePath:At("string")};class vo extends Xc{constructor(e,t,r){super(e,t,db(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new _t(this.firestore,null,new he(e))}withConverter(e){return new vo(this.firestore,e,this._path)}}function Rb(n,e,...t){if(n=Wt(n),mO("collection","path",e),n instanceof Zm){const r=Xe.fromString(e,...t);return MT(r),new vo(n,null,r)}{if(!(n instanceof _t||n instanceof vo))throw new te(H.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Xe.fromString(e,...t));return MT(r),new vo(n.firestore,null,r)}}function Qn(n,e,...t){if(n=Wt(n),arguments.length===1&&(e=ob.newId()),mO("doc","path",e),n instanceof Zm){const r=Xe.fromString(e,...t);return DT(r),new _t(n,null,new he(r))}{if(!(n instanceof _t||n instanceof vo))throw new te(H.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Xe.fromString(e,...t));return DT(r),new _t(n.firestore,n instanceof vo?n.converter:null,new he(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EC="AsyncQueue";class TC{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new lN(this,"async_queue_retry"),this._c=()=>{const r=jv();r&&ne(EC,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=jv();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=jv();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const t=new Zs;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Kc(e))throw e;ne(EC,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const t=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,ui("INTERNAL UNHANDLED ERROR: ",CC(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const s=Cb.createAndSchedule(this,e,t,r,i=>this.hc(i));return this.tc.push(s),s}uc(){this.nc&&ye(47125,{Pc:CC(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function CC(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class Qa extends Zm{constructor(e,t,r,s){super(e,t,r,s),this.type="firestore",this._queue=new TC,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new TC(e),this._firestoreClient=void 0,await e}}}function j7(n,e){const t=typeof n=="object"?n:T2(),r=typeof n=="string"?n:jg,s=Xx(t,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=q6("firestore");i&&N7(s,...i)}return s}function Ob(n){if(n._terminated)throw new te(H.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||D7(n),n._firestoreClient}function D7(n){var r,s,i;const e=n._freezeSettings(),t=function(a,l,c,u){return new iW(a,l,c,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,IN(u.experimentalLongPollingOptions),u.useFetchStreams,u.isUsingEmulator)}(n._databaseId,((r=n._app)==null?void 0:r.options.appId)||"",n._persistenceKey,e);n._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new A7(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ur{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ur(Zt.fromBase64String(e))}catch(t){throw new te(H.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new ur(Zt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ur._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Td(e,ur._jsonSchema))return ur.fromBase64String(e.bytes)}}ur._jsonSchemaVersion="firestore/bytes/1.0",ur._jsonSchema={type:At("string",ur._jsonSchemaVersion),bytes:At("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ey{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new te(H.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Kt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ty{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Es{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new te(H.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new te(H.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Pe(this._lat,e._lat)||Pe(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Es._jsonSchemaVersion}}static fromJSON(e){if(Td(e,Es._jsonSchema))return new Es(e.latitude,e.longitude)}}Es._jsonSchemaVersion="firestore/geoPoint/1.0",Es._jsonSchema={type:At("string",Es._jsonSchemaVersion),latitude:At("number"),longitude:At("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ts{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Ts._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Td(e,Ts._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new Ts(e.vectorValues);throw new te(H.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Ts._jsonSchemaVersion="firestore/vectorValue/1.0",Ts._jsonSchema={type:At("string",Ts._jsonSchemaVersion),vectorValues:At("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M7=/^__.*__$/;class L7{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Fo(e,this.data,this.fieldMask,t,this.fieldTransforms):new kd(e,this.data,t,this.fieldTransforms)}}class ON{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Fo(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function NN(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ye(40011,{Ac:n})}}class Nb{constructor(e,t,r,s,i,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Nb({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var s;const t=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){var s;const t=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return zg(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(NN(this.Ac)&&M7.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class F7{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Xm(e)}Cc(e,t,r,s=!1){return new Nb({Ac:e,methodName:t,Dc:r,path:Kt.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ny(n){const e=n._freezeSettings(),t=Xm(n._databaseId);return new F7(n._databaseId,!!e.ignoreUndefinedProperties,t)}function jN(n,e,t,r,s,i={}){const o=n.Cc(i.merge||i.mergeFields?2:0,e,t,s);Db("Data must be an object, but it was:",o,r);const a=DN(r,o);let l,c;if(i.merge)l=new Xn(o.fieldMask),c=o.fieldTransforms;else if(i.mergeFields){const u=[];for(const h of i.mergeFields){const f=Xw(e,h,t);if(!o.contains(f))throw new te(H.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);LN(u,f)||u.push(f)}l=new Xn(u),c=o.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,c=o.fieldTransforms;return new L7(new Rn(a),l,c)}class ry extends ty{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof ry}}class jb extends ty{_toFieldTransform(e){return new IW(e.path,new Hh)}isEqual(e){return e instanceof jb}}function V7(n,e,t,r){const s=n.Cc(1,e,t);Db("Data must be an object, but it was:",s,r);const i=[],o=Rn.empty();Lo(r,(l,c)=>{const u=Mb(e,l,t);c=Wt(c);const h=s.yc(u);if(c instanceof ry)i.push(u);else{const f=Rd(c,h);f!=null&&(i.push(u),o.set(u,f))}});const a=new Xn(i);return new ON(o,a,s.fieldTransforms)}function U7(n,e,t,r,s,i){const o=n.Cc(1,e,t),a=[Xw(e,r,t)],l=[s];if(i.length%2!=0)throw new te(H.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<i.length;f+=2)a.push(Xw(e,i[f])),l.push(i[f+1]);const c=[],u=Rn.empty();for(let f=a.length-1;f>=0;--f)if(!LN(c,a[f])){const p=a[f];let y=l[f];y=Wt(y);const m=o.yc(p);if(y instanceof ry)c.push(p);else{const v=Rd(y,m);v!=null&&(c.push(p),u.set(p,v))}}const h=new Xn(c);return new ON(u,h,o.fieldTransforms)}function $7(n,e,t,r=!1){return Rd(t,n.Cc(r?4:3,e))}function Rd(n,e){if(MN(n=Wt(n)))return Db("Unsupported field value:",e,n),DN(n,e);if(n instanceof ty)return function(r,s){if(!NN(s.Ac))throw s.Sc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const a of r){let l=Rd(a,s.wc(o));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),o++}return{arrayValue:{values:i}}}(n,e)}return function(r,s){if((r=Wt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return kW(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=nt.fromDate(r);return{timestampValue:Vg(s.serializer,i)}}if(r instanceof nt){const i=new nt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Vg(s.serializer,i)}}if(r instanceof Es)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ur)return{bytesValue:QO(s.serializer,r._byteString)};if(r instanceof _t){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:yb(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Ts)return function(o,a){return{mapValue:{fields:{[TO]:{stringValue:kO},[Dg]:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw a.Sc("VectorValues must only contain numeric values.");return fb(a.serializer,c)})}}}}}}(r,s);throw s.Sc(`Unsupported field value: ${$m(r)}`)}(n,e)}function DN(n,e){const t={};return wO(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Lo(n,(r,s)=>{const i=Rd(s,e.mc(r));i!=null&&(t[r]=i)}),{mapValue:{fields:t}}}function MN(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof nt||n instanceof Es||n instanceof ur||n instanceof _t||n instanceof ty||n instanceof Ts)}function Db(n,e,t){if(!MN(t)||!yO(t)){const r=$m(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function Xw(n,e,t){if((e=Wt(e))instanceof ey)return e._internalPath;if(typeof e=="string")return Mb(n,e);throw zg("Field path arguments must be of type string or ",n,!1,void 0,t)}const B7=new RegExp("[~\\*/\\[\\]]");function Mb(n,e,t){if(e.search(B7)>=0)throw zg(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new ey(...e.split("."))._internalPath}catch{throw zg(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function zg(n,e,t,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(i||o)&&(l+=" (found",i&&(l+=` in field ${r}`),o&&(l+=` in document ${s}`),l+=")"),new te(H.INVALID_ARGUMENT,a+n+l)}function LN(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FN{constructor(e,t,r,s,i){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new _t(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new z7(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Lb("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class z7 extends FN{data(){return super.data()}}function Lb(n,e){return typeof e=="string"?Mb(n,e):e instanceof ey?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W7(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new te(H.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Fb{}class H7 extends Fb{}function q7(n,e,...t){let r=[];e instanceof Fb&&r.push(e),r=r.concat(t),function(i){const o=i.filter(l=>l instanceof Vb).length,a=i.filter(l=>l instanceof sy).length;if(o>1||o>0&&a>0)throw new te(H.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)n=s._apply(n);return n}class sy extends H7{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new sy(e,t,r)}_apply(e){const t=this._parse(e);return VN(e._query,t),new Xc(e.firestore,e.converter,Vw(e._query,t))}_parse(e){const t=ny(e.firestore);return function(i,o,a,l,c,u,h){let f;if(c.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new te(H.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){AC(h,u);const y=[];for(const m of h)y.push(kC(l,i,m));f={arrayValue:{values:y}}}else f=kC(l,i,h)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||AC(h,u),f=$7(a,o,h,u==="in"||u==="not-in");return kt.create(c,u,f)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function G7(n,e,t){const r=e,s=Lb("where",n);return sy._create(s,r,t)}class Vb extends Fb{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Vb(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:Zr.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(s,i){let o=s;const a=i.getFlattenedFilters();for(const l of a)VN(o,l),o=Vw(o,l)}(e._query,t),new Xc(e.firestore,e.converter,Vw(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function kC(n,e,t){if(typeof(t=Wt(t))=="string"){if(t==="")throw new te(H.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!DO(e)&&t.indexOf("/")!==-1)throw new te(H.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(Xe.fromString(t));if(!he.isDocumentKey(r))throw new te(H.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return WT(n,new he(r))}if(t instanceof _t)return WT(n,t._key);throw new te(H.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${$m(t)}.`)}function AC(n,e){if(!Array.isArray(n)||n.length===0)throw new te(H.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function VN(n,e){const t=function(s,i){for(const o of s)for(const a of o.getFlattenedFilters())if(i.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new te(H.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new te(H.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class K7{convertValue(e,t="none"){switch(Co(e)){case 0:return null;case 1:return e.booleanValue;case 2:return yt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(To(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw ye(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Lo(e,(s,i)=>{r[s]=this.convertValue(i,t)}),r}convertVectorValue(e){var r,s,i;const t=(i=(s=(r=e.fields)==null?void 0:r[Dg].arrayValue)==null?void 0:s.values)==null?void 0:i.map(o=>yt(o.doubleValue));return new Ts(t)}convertGeoPoint(e){return new Es(yt(e.latitude),yt(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Wm(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Bh(e));default:return null}}convertTimestamp(e){const t=Eo(e);return new nt(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Xe.fromString(e);Be(rN(r),9688,{name:e});const s=new zh(r.get(1),r.get(3)),i=new he(r.popFirst(5));return s.isEqual(t)||ui(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UN(n,e,t){let r;return r=n?n.toFirestore(e):e,r}class Bu{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ea extends FN{constructor(e,t,r,s,i,o){super(e,t,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Lp(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(Lb("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new te(H.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Ea._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Ea._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ea._jsonSchema={type:At("string",Ea._jsonSchemaVersion),bundleSource:At("string","DocumentSnapshot"),bundleName:At("string"),bundle:At("string")};class Lp extends Ea{data(e={}){return super.data(e)}}class Jl{constructor(e,t,r,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new Bu(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Lp(this._firestore,this._userDataWriter,r.key,r,new Bu(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new te(H.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(a=>{const l=new Lp(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Bu(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const l=new Lp(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Bu(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,u=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),u=o.indexOf(a.doc.key)),{type:Y7(a.type),doc:l,oldIndex:c,newIndex:u}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new te(H.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Jl._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=ob.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],s=[];return this.docs.forEach(i=>{i._document!==null&&(t.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Y7(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ye(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iy(n){n=Jr(n,_t);const e=Jr(n.firestore,Qa);return R7(Ob(e),n._key).then(t=>J7(e,n,t))}Jl._jsonSchemaVersion="firestore/querySnapshot/1.0",Jl._jsonSchema={type:At("string",Jl._jsonSchemaVersion),bundleSource:At("string","QuerySnapshot"),bundleName:At("string"),bundle:At("string")};class $N extends K7{constructor(e){super(),this.firestore=e}convertBytes(e){return new ur(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new _t(this.firestore,null,t)}}function BN(n){n=Jr(n,Xc);const e=Jr(n.firestore,Qa),t=Ob(e),r=new $N(e);return W7(n._query),O7(t,n._query).then(s=>new Jl(e,r,n,s))}function X7(n,e,t){n=Jr(n,_t);const r=Jr(n.firestore,Qa),s=UN(n.converter,e);return oy(r,[jN(ny(r),"setDoc",n._key,s,n.converter!==null,t).toMutation(n._key,gr.none())])}function Kh(n,e,t,...r){n=Jr(n,_t);const s=Jr(n.firestore,Qa),i=ny(s);let o;return o=typeof(e=Wt(e))=="string"||e instanceof ey?U7(i,"updateDoc",n._key,e,t,r):V7(i,"updateDoc",n._key,e),oy(s,[o.toMutation(n._key,gr.exists(!0))])}function zN(n){return oy(Jr(n.firestore,Qa),[new pb(n._key,gr.none())])}function Q7(n,e){const t=Jr(n.firestore,Qa),r=Qn(n),s=UN(n.converter,e);return oy(t,[jN(ny(n.firestore),"addDoc",r._key,s,n.converter!==null,{}).toMutation(r._key,gr.exists(!1))]).then(()=>r)}function oy(n,e){return function(r,s){const i=new Zs;return r.asyncQueue.enqueueAndForget(async()=>w7(await I7(r),s,i)),i.promise}(Ob(n),e)}function J7(n,e,t){const r=t.docs.get(e._key),s=new $N(n);return new Ea(n,s,e._key,r,new Bu(t.hasPendingWrites,t.fromCache),e.converter)}function PC(){return new jb("serverTimestamp")}(function(e,t=!0){(function(s){qc=s})(Wc),bc(new Ma("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),a=new Qa(new U8(r.getProvider("auth-internal")),new z8(o,r.getProvider("app-check-internal")),function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new te(H.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new zh(c.options.projectId,u)}(o,s),o);return i={useFetchStreams:t,...i},a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),mo(RT,OT,e),mo(RT,OT,"esm2020")})();const Z7={apiKey:"AIzaSyBefj7Oddil_MkHjW3BZFnlZyu0kO8AQjw",authDomain:"learning-550cc.firebaseapp.com",projectId:"learning-550cc",storageBucket:"learning-550cc.firebasestorage.app",messagingSenderId:"323754363842",appId:"1:323754363842:web:50de9833d0f12676a6a45b"},WN=E2(Z7),Af=j8(WN),_n=j7(WN),HN=C.createContext(void 0),Is=()=>{const n=C.useContext(HN);if(!n)throw new Error("useAuth must be used within AuthProvider");return n},eq=({children:n})=>{const[e,t]=C.useState(null),[r,s]=C.useState(!0);C.useEffect(()=>b9(Af,c=>{t(c),s(!1)}),[]);const i=async(l,c)=>{await w9(Af,l,c)},o=async(l,c)=>await v9(Af,l,c),a=async()=>{await S9(Af)};return g.jsx(HN.Provider,{value:{user:e,loading:r,signIn:i,signUp:o,signOut:a},children:n})},Mv=({children:n})=>{const{user:e,loading:t}=Is(),[r,s]=C.useState(null),[i,o]=C.useState(!0);return C.useEffect(()=>{t||(async()=>{if(e)try{const l=await iy(Qn(_n,"users",e.uid));l.exists()&&s(l.data().status)}catch(l){console.error("Error checking user status:",l)}o(!1)})()},[e,t]),t||i?g.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-purple-50",children:g.jsxs("div",{className:"text-center",children:[g.jsx("div",{className:"w-16 h-16 border-4 border-indigo-200 border-t-indigo-600 rounded-full animate-spin mx-auto mb-4"}),g.jsx("p",{className:"text-gray-600 font-medium",children:" ..."})]})}):e?r==="pending"?g.jsx(Sv,{to:"/pending-approval",replace:!0}):r==="rejected"?g.jsx(Sv,{to:"/account-rejected",replace:!0}):g.jsx(g.Fragment,{children:n}):g.jsx(Sv,{to:"/login",replace:!0})},tq=Rx("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),ae=C.forwardRef(({className:n,variant:e,size:t,asChild:r=!1,...s},i)=>{const o=r?eV:"button";return g.jsx(o,{className:Ge(tq({variant:e,size:t,className:n})),ref:i,...s})});ae.displayName="Button";const Ta=C.forwardRef(({className:n,...e},t)=>g.jsx("div",{ref:t,className:Ge("rounded-lg border bg-card text-card-foreground shadow-sm",n),...e}));Ta.displayName="Card";const Pc=C.forwardRef(({className:n,...e},t)=>g.jsx("div",{ref:t,className:Ge("flex flex-col space-y-1.5 p-6",n),...e}));Pc.displayName="CardHeader";const Ic=C.forwardRef(({className:n,...e},t)=>g.jsx("h3",{ref:t,className:Ge("text-2xl font-semibold leading-none tracking-tight",n),...e}));Ic.displayName="CardTitle";const Od=C.forwardRef(({className:n,...e},t)=>g.jsx("p",{ref:t,className:Ge("text-sm text-muted-foreground",n),...e}));Od.displayName="CardDescription";const Ca=C.forwardRef(({className:n,...e},t)=>g.jsx("div",{ref:t,className:Ge("p-6 pt-0",n),...e}));Ca.displayName="CardContent";const nq=C.forwardRef(({className:n,...e},t)=>g.jsx("div",{ref:t,className:Ge("flex items-center p-6 pt-0",n),...e}));nq.displayName="CardFooter";var Qw=function(n,e){return Qw=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])},Qw(n,e)};function qN(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Qw(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var hr=function(){return hr=Object.assign||function(e){for(var t,r=1,s=arguments.length;r<s;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},hr.apply(this,arguments)};function Vo(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t}function GN(n,e,t,r){var s=arguments.length,i=s<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(n,e,t,r);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i}function KN(n,e){return function(t,r){e(t,r,n)}}function YN(n,e,t,r,s,i){function o(w){if(w!==void 0&&typeof w!="function")throw new TypeError("Function expected");return w}for(var a=r.kind,l=a==="getter"?"get":a==="setter"?"set":"value",c=!e&&n?r.static?n:n.prototype:null,u=e||(c?Object.getOwnPropertyDescriptor(c,r.name):{}),h,f=!1,p=t.length-1;p>=0;p--){var y={};for(var m in r)y[m]=m==="access"?{}:r[m];for(var m in r.access)y.access[m]=r.access[m];y.addInitializer=function(w){if(f)throw new TypeError("Cannot add initializers after decoration has completed");i.push(o(w||null))};var v=(0,t[p])(a==="accessor"?{get:u.get,set:u.set}:u[l],y);if(a==="accessor"){if(v===void 0)continue;if(v===null||typeof v!="object")throw new TypeError("Object expected");(h=o(v.get))&&(u.get=h),(h=o(v.set))&&(u.set=h),(h=o(v.init))&&s.unshift(h)}else(h=o(v))&&(a==="field"?s.unshift(h):u[l]=h)}c&&Object.defineProperty(c,r.name,u),f=!0}function XN(n,e,t){for(var r=arguments.length>2,s=0;s<e.length;s++)t=r?e[s].call(n,t):e[s].call(n);return r?t:void 0}function QN(n){return typeof n=="symbol"?n:"".concat(n)}function JN(n,e,t){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(n,"name",{configurable:!0,value:t?"".concat(t," ",e):e})}function ZN(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)}function ie(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(a,l)}c((r=r.apply(n,e||[])).next())})}function ej(n,e){var t={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=a(0),o.throw=a(1),o.return=a(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(c){return function(u){return l([c,u])}}function l(c){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(t=0)),t;)try{if(r=1,s&&(i=c[0]&2?s.return:c[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,c[1])).done)return i;switch(s=0,i&&(c=[c[0]&2,i.value]),c[0]){case 0:case 1:i=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,s=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(i=t.trys,!(i=i.length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){t.label=c[1];break}if(c[0]===6&&t.label<i[1]){t.label=i[1],i=c;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(c);break}i[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(n,t)}catch(u){c=[6,u],s=0}finally{r=i=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}var ay=Object.create?function(n,e,t,r){r===void 0&&(r=t);var s=Object.getOwnPropertyDescriptor(e,t);(!s||("get"in s?!e.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,s)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]};function tj(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&ay(e,n,t)}function Wg(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ub(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),s,i=[],o;try{for(;(e===void 0||e-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(a){o={error:a}}finally{try{s&&!s.done&&(t=r.return)&&t.call(r)}finally{if(o)throw o.error}}return i}function nj(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(Ub(arguments[e]));return n}function rj(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),s=0,e=0;e<t;e++)for(var i=arguments[e],o=0,a=i.length;o<a;o++,s++)r[s]=i[o];return r}function $b(n,e,t){if(t||arguments.length===2)for(var r=0,s=e.length,i;r<s;r++)(i||!(r in e))&&(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return n.concat(i||Array.prototype.slice.call(e))}function Rc(n){return this instanceof Rc?(this.v=n,this):new Rc(n)}function sj(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),s,i=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),s[Symbol.asyncIterator]=function(){return this},s;function o(p){return function(y){return Promise.resolve(y).then(p,h)}}function a(p,y){r[p]&&(s[p]=function(m){return new Promise(function(v,w){i.push([p,m,v,w])>1||l(p,m)})},y&&(s[p]=y(s[p])))}function l(p,y){try{c(r[p](y))}catch(m){f(i[0][3],m)}}function c(p){p.value instanceof Rc?Promise.resolve(p.value.v).then(u,h):f(i[0][2],p)}function u(p){l("next",p)}function h(p){l("throw",p)}function f(p,y){p(y),i.shift(),i.length&&l(i[0][0],i[0][1])}}function ij(n){var e,t;return e={},r("next"),r("throw",function(s){throw s}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(s,i){e[s]=n[s]?function(o){return(t=!t)?{value:Rc(n[s](o)),done:!1}:i?i(o):o}:i}}function oj(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof Wg=="function"?Wg(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(i){t[i]=n[i]&&function(o){return new Promise(function(a,l){o=n[i](o),s(a,l,o.done,o.value)})}}function s(i,o,a,l){Promise.resolve(l).then(function(c){i({value:c,done:a})},o)}}function aj(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}var rq=Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e},Jw=function(n){return Jw=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},Jw(n)};function lj(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t=Jw(n),r=0;r<t.length;r++)t[r]!=="default"&&ay(e,n,t[r]);return rq(e,n),e}function cj(n){return n&&n.__esModule?n:{default:n}}function uj(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)}function hj(n,e,t,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!s:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(n,t):s?s.value=t:e.set(n,t),t}function dj(n,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof n=="function"?e===n:n.has(e)}function fj(n,e,t){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var r,s;if(t){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=e[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=e[Symbol.dispose],t&&(s=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");s&&(r=function(){try{s.call(this)}catch(i){return Promise.reject(i)}}),n.stack.push({value:e,dispose:r,async:t})}else t&&n.stack.push({async:!0});return e}var sq=typeof SuppressedError=="function"?SuppressedError:function(n,e,t){var r=new Error(t);return r.name="SuppressedError",r.error=n,r.suppressed=e,r};function pj(n){function e(i){n.error=n.hasError?new sq(i,n.error,"An error was suppressed during disposal."):i,n.hasError=!0}var t,r=0;function s(){for(;t=n.stack.pop();)try{if(!t.async&&r===1)return r=0,n.stack.push(t),Promise.resolve().then(s);if(t.dispose){var i=t.dispose.call(t.value);if(t.async)return r|=2,Promise.resolve(i).then(s,function(o){return e(o),s()})}else r|=1}catch(o){e(o)}if(r===1)return n.hasError?Promise.reject(n.error):Promise.resolve();if(n.hasError)throw n.error}return s()}function gj(n,e){return typeof n=="string"&&/^\.\.?\//.test(n)?n.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(t,r,s,i,o){return r?e?".jsx":".js":s&&(!i||!o)?t:s+i+"."+o.toLowerCase()+"js"}):n}const iq={__extends:qN,__assign:hr,__rest:Vo,__decorate:GN,__param:KN,__esDecorate:YN,__runInitializers:XN,__propKey:QN,__setFunctionName:JN,__metadata:ZN,__awaiter:ie,__generator:ej,__createBinding:ay,__exportStar:tj,__values:Wg,__read:Ub,__spread:nj,__spreadArrays:rj,__spreadArray:$b,__await:Rc,__asyncGenerator:sj,__asyncDelegator:ij,__asyncValues:oj,__makeTemplateObject:aj,__importStar:lj,__importDefault:cj,__classPrivateFieldGet:uj,__classPrivateFieldSet:hj,__classPrivateFieldIn:dj,__addDisposableResource:fj,__disposeResources:pj,__rewriteRelativeImportExtension:gj},oq=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:fj,get __assign(){return hr},__asyncDelegator:ij,__asyncGenerator:sj,__asyncValues:oj,__await:Rc,__awaiter:ie,__classPrivateFieldGet:uj,__classPrivateFieldIn:dj,__classPrivateFieldSet:hj,__createBinding:ay,__decorate:GN,__disposeResources:pj,__esDecorate:YN,__exportStar:tj,__extends:qN,__generator:ej,__importDefault:cj,__importStar:lj,__makeTemplateObject:aj,__metadata:ZN,__param:KN,__propKey:QN,__read:Ub,__rest:Vo,__rewriteRelativeImportExtension:gj,__runInitializers:XN,__setFunctionName:JN,__spread:nj,__spreadArray:$b,__spreadArrays:rj,__values:Wg,default:iq},Symbol.toStringTag,{value:"Module"})),aq=n=>n?(...e)=>n(...e):(...e)=>fetch(...e);class Bb extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class lq extends Bb{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class IC extends Bb{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class RC extends Bb{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Zw;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(Zw||(Zw={}));class cq{constructor(e,{headers:t={},customFetch:r,region:s=Zw.Any}={}){this.url=e,this.headers=t,this.region=s,this.fetch=aq(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return ie(this,arguments,void 0,function*(t,r={}){var s;let i,o;try{const{headers:a,method:l,body:c,signal:u,timeout:h}=r;let f={},{region:p}=r;p||(p=this.region);const y=new URL(`${this.url}/${t}`);p&&p!=="any"&&(f["x-region"]=p,y.searchParams.set("forceFunctionRegion",p));let m;c&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)?typeof Blob<"u"&&c instanceof Blob||c instanceof ArrayBuffer?(f["Content-Type"]="application/octet-stream",m=c):typeof c=="string"?(f["Content-Type"]="text/plain",m=c):typeof FormData<"u"&&c instanceof FormData?m=c:(f["Content-Type"]="application/json",m=JSON.stringify(c)):m=c;let v=u;h&&(o=new AbortController,i=setTimeout(()=>o.abort(),h),u?(v=o.signal,u.addEventListener("abort",()=>o.abort())):v=o.signal);const w=yield this.fetch(y.toString(),{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},f),this.headers),a),body:m,signal:v}).catch(j=>{throw new lq(j)}),_=w.headers.get("x-relay-error");if(_&&_==="true")throw new IC(w);if(!w.ok)throw new RC(w);let x=((s=w.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),A;return x==="application/json"?A=yield w.json():x==="application/octet-stream"||x==="application/pdf"?A=yield w.blob():x==="text/event-stream"?A=w:x==="multipart/form-data"?A=yield w.formData():A=yield w.text(),{data:A,error:null,response:w}}catch(a){return{data:null,error:a,response:a instanceof RC||a instanceof IC?a.context:void 0}}finally{i&&clearTimeout(i)}})}}var vn={};const Qc=bL(oq);var Pf={},If={},Rf={},Of={},Nf={},jf={},OC;function mj(){if(OC)return jf;OC=1,Object.defineProperty(jf,"__esModule",{value:!0});class n extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return jf.default=n,jf}var NC;function yj(){if(NC)return Nf;NC=1,Object.defineProperty(Nf,"__esModule",{value:!0});const e=Qc.__importDefault(mj());class t{constructor(s){var i,o;this.shouldThrowOnError=!1,this.method=s.method,this.url=s.url,this.headers=new Headers(s.headers),this.schema=s.schema,this.body=s.body,this.shouldThrowOnError=(i=s.shouldThrowOnError)!==null&&i!==void 0?i:!1,this.signal=s.signal,this.isMaybeSingle=(o=s.isMaybeSingle)!==null&&o!==void 0?o:!1,s.fetch?this.fetch=s.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(s,i){return this.headers=new Headers(this.headers),this.headers.set(s,i),this}then(s,i){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const o=this.fetch;let a=o(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async l=>{var c,u,h,f;let p=null,y=null,m=null,v=l.status,w=l.statusText;if(l.ok){if(this.method!=="HEAD"){const j=await l.text();j===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((c=this.headers.get("Accept"))===null||c===void 0)&&c.includes("application/vnd.pgrst.plan+text"))?y=j:y=JSON.parse(j))}const x=(u=this.headers.get("Prefer"))===null||u===void 0?void 0:u.match(/count=(exact|planned|estimated)/),A=(h=l.headers.get("content-range"))===null||h===void 0?void 0:h.split("/");x&&A&&A.length>1&&(m=parseInt(A[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(y)&&(y.length>1?(p={code:"PGRST116",details:`Results contain ${y.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},y=null,m=null,v=406,w="Not Acceptable"):y.length===1?y=y[0]:y=null)}else{const x=await l.text();try{p=JSON.parse(x),Array.isArray(p)&&l.status===404&&(y=[],p=null,v=200,w="OK")}catch{l.status===404&&x===""?(v=204,w="No Content"):p={message:x}}if(p&&this.isMaybeSingle&&(!((f=p==null?void 0:p.details)===null||f===void 0)&&f.includes("0 rows"))&&(p=null,v=200,w="OK"),p&&this.shouldThrowOnError)throw new e.default(p)}return{error:p,data:y,count:m,status:v,statusText:w}});return this.shouldThrowOnError||(a=a.catch(l=>{var c,u,h,f,p,y;let m="";const v=l==null?void 0:l.cause;if(v){const w=(c=v==null?void 0:v.message)!==null&&c!==void 0?c:"",_=(u=v==null?void 0:v.code)!==null&&u!==void 0?u:"";m=`${(h=l==null?void 0:l.name)!==null&&h!==void 0?h:"FetchError"}: ${l==null?void 0:l.message}`,m+=`

Caused by: ${(f=v==null?void 0:v.name)!==null&&f!==void 0?f:"Error"}: ${w}`,_&&(m+=` (${_})`),v!=null&&v.stack&&(m+=`
${v.stack}`)}else m=(p=l==null?void 0:l.stack)!==null&&p!==void 0?p:"";return{error:{message:`${(y=l==null?void 0:l.name)!==null&&y!==void 0?y:"FetchError"}: ${l==null?void 0:l.message}`,details:m,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),a.then(s,i)}returns(){return this}overrideTypes(){return this}}return Nf.default=t,Nf}var jC;function vj(){if(jC)return Of;jC=1,Object.defineProperty(Of,"__esModule",{value:!0});const e=Qc.__importDefault(yj());class t extends e.default{select(s){let i=!1;const o=(s??"*").split("").map(a=>/\s/.test(a)&&!i?"":(a==='"'&&(i=!i),a)).join("");return this.url.searchParams.set("select",o),this.headers.append("Prefer","return=representation"),this}order(s,{ascending:i=!0,nullsFirst:o,foreignTable:a,referencedTable:l=a}={}){const c=l?`${l}.order`:"order",u=this.url.searchParams.get(c);return this.url.searchParams.set(c,`${u?`${u},`:""}${s}.${i?"asc":"desc"}${o===void 0?"":o?".nullsfirst":".nullslast"}`),this}limit(s,{foreignTable:i,referencedTable:o=i}={}){const a=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(a,`${s}`),this}range(s,i,{foreignTable:o,referencedTable:a=o}={}){const l=typeof a>"u"?"offset":`${a}.offset`,c=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(l,`${s}`),this.url.searchParams.set(c,`${i-s+1}`),this}abortSignal(s){return this.signal=s,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:s=!1,verbose:i=!1,settings:o=!1,buffers:a=!1,wal:l=!1,format:c="text"}={}){var u;const h=[s?"analyze":null,i?"verbose":null,o?"settings":null,a?"buffers":null,l?"wal":null].filter(Boolean).join("|"),f=(u=this.headers.get("Accept"))!==null&&u!==void 0?u:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${c}; for="${f}"; options=${h};`),c==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(s){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${s}`),this}}return Of.default=t,Of}var DC;function zb(){if(DC)return Rf;DC=1,Object.defineProperty(Rf,"__esModule",{value:!0});const e=Qc.__importDefault(vj()),t=new RegExp("[,()]");class r extends e.default{eq(i,o){return this.url.searchParams.append(i,`eq.${o}`),this}neq(i,o){return this.url.searchParams.append(i,`neq.${o}`),this}gt(i,o){return this.url.searchParams.append(i,`gt.${o}`),this}gte(i,o){return this.url.searchParams.append(i,`gte.${o}`),this}lt(i,o){return this.url.searchParams.append(i,`lt.${o}`),this}lte(i,o){return this.url.searchParams.append(i,`lte.${o}`),this}like(i,o){return this.url.searchParams.append(i,`like.${o}`),this}likeAllOf(i,o){return this.url.searchParams.append(i,`like(all).{${o.join(",")}}`),this}likeAnyOf(i,o){return this.url.searchParams.append(i,`like(any).{${o.join(",")}}`),this}ilike(i,o){return this.url.searchParams.append(i,`ilike.${o}`),this}ilikeAllOf(i,o){return this.url.searchParams.append(i,`ilike(all).{${o.join(",")}}`),this}ilikeAnyOf(i,o){return this.url.searchParams.append(i,`ilike(any).{${o.join(",")}}`),this}regexMatch(i,o){return this.url.searchParams.append(i,`match.${o}`),this}regexIMatch(i,o){return this.url.searchParams.append(i,`imatch.${o}`),this}is(i,o){return this.url.searchParams.append(i,`is.${o}`),this}isDistinct(i,o){return this.url.searchParams.append(i,`isdistinct.${o}`),this}in(i,o){const a=Array.from(new Set(o)).map(l=>typeof l=="string"&&t.test(l)?`"${l}"`:`${l}`).join(",");return this.url.searchParams.append(i,`in.(${a})`),this}contains(i,o){return typeof o=="string"?this.url.searchParams.append(i,`cs.${o}`):Array.isArray(o)?this.url.searchParams.append(i,`cs.{${o.join(",")}}`):this.url.searchParams.append(i,`cs.${JSON.stringify(o)}`),this}containedBy(i,o){return typeof o=="string"?this.url.searchParams.append(i,`cd.${o}`):Array.isArray(o)?this.url.searchParams.append(i,`cd.{${o.join(",")}}`):this.url.searchParams.append(i,`cd.${JSON.stringify(o)}`),this}rangeGt(i,o){return this.url.searchParams.append(i,`sr.${o}`),this}rangeGte(i,o){return this.url.searchParams.append(i,`nxl.${o}`),this}rangeLt(i,o){return this.url.searchParams.append(i,`sl.${o}`),this}rangeLte(i,o){return this.url.searchParams.append(i,`nxr.${o}`),this}rangeAdjacent(i,o){return this.url.searchParams.append(i,`adj.${o}`),this}overlaps(i,o){return typeof o=="string"?this.url.searchParams.append(i,`ov.${o}`):this.url.searchParams.append(i,`ov.{${o.join(",")}}`),this}textSearch(i,o,{config:a,type:l}={}){let c="";l==="plain"?c="pl":l==="phrase"?c="ph":l==="websearch"&&(c="w");const u=a===void 0?"":`(${a})`;return this.url.searchParams.append(i,`${c}fts${u}.${o}`),this}match(i){return Object.entries(i).forEach(([o,a])=>{this.url.searchParams.append(o,`eq.${a}`)}),this}not(i,o,a){return this.url.searchParams.append(i,`not.${o}.${a}`),this}or(i,{foreignTable:o,referencedTable:a=o}={}){const l=a?`${a}.or`:"or";return this.url.searchParams.append(l,`(${i})`),this}filter(i,o,a){return this.url.searchParams.append(i,`${o}.${a}`),this}}return Rf.default=r,Rf}var MC;function wj(){if(MC)return If;MC=1,Object.defineProperty(If,"__esModule",{value:!0});const e=Qc.__importDefault(zb());class t{constructor(s,{headers:i={},schema:o,fetch:a}){this.url=s,this.headers=new Headers(i),this.schema=o,this.fetch=a}select(s,i){const{head:o=!1,count:a}=i??{},l=o?"HEAD":"GET";let c=!1;const u=(s??"*").split("").map(h=>/\s/.test(h)&&!c?"":(h==='"'&&(c=!c),h)).join("");return this.url.searchParams.set("select",u),a&&this.headers.append("Prefer",`count=${a}`),new e.default({method:l,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(s,{count:i,defaultToNull:o=!0}={}){var a;const l="POST";if(i&&this.headers.append("Prefer",`count=${i}`),o||this.headers.append("Prefer","missing=default"),Array.isArray(s)){const c=s.reduce((u,h)=>u.concat(Object.keys(h)),[]);if(c.length>0){const u=[...new Set(c)].map(h=>`"${h}"`);this.url.searchParams.set("columns",u.join(","))}}return new e.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}upsert(s,{onConflict:i,ignoreDuplicates:o=!1,count:a,defaultToNull:l=!0}={}){var c;const u="POST";if(this.headers.append("Prefer",`resolution=${o?"ignore":"merge"}-duplicates`),i!==void 0&&this.url.searchParams.set("on_conflict",i),a&&this.headers.append("Prefer",`count=${a}`),l||this.headers.append("Prefer","missing=default"),Array.isArray(s)){const h=s.reduce((f,p)=>f.concat(Object.keys(p)),[]);if(h.length>0){const f=[...new Set(h)].map(p=>`"${p}"`);this.url.searchParams.set("columns",f.join(","))}}return new e.default({method:u,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}update(s,{count:i}={}){var o;const a="PATCH";return i&&this.headers.append("Prefer",`count=${i}`),new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}delete({count:s}={}){var i;const o="DELETE";return s&&this.headers.append("Prefer",`count=${s}`),new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}}return If.default=t,If}var LC;function uq(){if(LC)return Pf;LC=1,Object.defineProperty(Pf,"__esModule",{value:!0});const n=Qc,e=n.__importDefault(wj()),t=n.__importDefault(zb());class r{constructor(i,{headers:o={},schema:a,fetch:l}={}){this.url=i,this.headers=new Headers(o),this.schemaName=a,this.fetch=l}from(i){if(!i||typeof i!="string"||i.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");const o=new URL(`${this.url}/${i}`);return new e.default(o,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(i){return new r(this.url,{headers:this.headers,schema:i,fetch:this.fetch})}rpc(i,o={},{head:a=!1,get:l=!1,count:c}={}){var u;let h;const f=new URL(`${this.url}/rpc/${i}`);let p;a||l?(h=a?"HEAD":"GET",Object.entries(o).filter(([m,v])=>v!==void 0).map(([m,v])=>[m,Array.isArray(v)?`{${v.join(",")}}`:`${v}`]).forEach(([m,v])=>{f.searchParams.append(m,v)})):(h="POST",p=o);const y=new Headers(this.headers);return c&&y.set("Prefer",`count=${c}`),new t.default({method:h,url:f,headers:y,schema:this.schemaName,body:p,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}}return Pf.default=r,Pf}Object.defineProperty(vn,"__esModule",{value:!0});var _j=vn.PostgrestError=Ij=vn.PostgrestBuilder=Aj=vn.PostgrestTransformBuilder=Cj=vn.PostgrestFilterBuilder=Ej=vn.PostgrestQueryBuilder=bj=vn.PostgrestClient=void 0;const Jc=Qc,xj=Jc.__importDefault(uq());var bj=vn.PostgrestClient=xj.default;const Sj=Jc.__importDefault(wj());var Ej=vn.PostgrestQueryBuilder=Sj.default;const Tj=Jc.__importDefault(zb());var Cj=vn.PostgrestFilterBuilder=Tj.default;const kj=Jc.__importDefault(vj());var Aj=vn.PostgrestTransformBuilder=kj.default;const Pj=Jc.__importDefault(yj());var Ij=vn.PostgrestBuilder=Pj.default;const Rj=Jc.__importDefault(mj());_j=vn.PostgrestError=Rj.default;var Oj=vn.default={PostgrestClient:xj.default,PostgrestQueryBuilder:Sj.default,PostgrestFilterBuilder:Tj.default,PostgrestTransformBuilder:kj.default,PostgrestBuilder:Pj.default,PostgrestError:Rj.default};const hq=pA({__proto__:null,get PostgrestBuilder(){return Ij},get PostgrestClient(){return bj},get PostgrestError(){return _j},get PostgrestFilterBuilder(){return Cj},get PostgrestQueryBuilder(){return Ej},get PostgrestTransformBuilder(){return Aj},default:Oj},[vn]),{PostgrestClient:dq,PostgrestQueryBuilder:AZ,PostgrestFilterBuilder:PZ,PostgrestTransformBuilder:IZ,PostgrestBuilder:RZ,PostgrestError:OZ}=Oj||hq;class fq{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const t=process.versions;if(t&&t.node){const r=t.node,s=parseInt(r.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const r=this.getWebSocketConstructor();return new r(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const pq="2.86.0",gq=`realtime-js/${pq}`,Nj="1.0.0",mq="2.0.0",FC=Nj,e_=1e4,yq=1e3,vq=100;var ra;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(ra||(ra={}));var Ot;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(Ot||(Ot={}));var Mr;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(Mr||(Mr={}));var t_;(function(n){n.websocket="websocket"})(t_||(t_={}));var sa;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(sa||(sa={}));class wq{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,t){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return t(this._binaryEncodeUserBroadcastPush(e));let r=[e.join_ref,e.ref,e.topic,e.event,e.payload];return t(JSON.stringify(r))}_binaryEncodeUserBroadcastPush(e){var t;return this._isArrayBuffer((t=e.payload)===null||t===void 0?void 0:t.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var t,r;const s=(r=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&r!==void 0?r:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,s)}_encodeJsonUserBroadcastPush(e){var t,r;const s=(r=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&r!==void 0?r:{},o=new TextEncoder().encode(JSON.stringify(s)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,o)}_encodeUserBroadcastPush(e,t,r){var s,i;const o=e.topic,a=(s=e.ref)!==null&&s!==void 0?s:"",l=(i=e.join_ref)!==null&&i!==void 0?i:"",c=e.payload.event,u=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},h=Object.keys(u).length===0?"":JSON.stringify(u);if(l.length>255)throw new Error(`joinRef length ${l.length} exceeds maximum of 255`);if(a.length>255)throw new Error(`ref length ${a.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`topic length ${o.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`userEvent length ${c.length} exceeds maximum of 255`);if(h.length>255)throw new Error(`metadata length ${h.length} exceeds maximum of 255`);const f=this.USER_BROADCAST_PUSH_META_LENGTH+l.length+a.length+o.length+c.length+h.length,p=new ArrayBuffer(this.HEADER_LENGTH+f);let y=new DataView(p),m=0;y.setUint8(m++,this.KINDS.userBroadcastPush),y.setUint8(m++,l.length),y.setUint8(m++,a.length),y.setUint8(m++,o.length),y.setUint8(m++,c.length),y.setUint8(m++,h.length),y.setUint8(m++,t),Array.from(l,w=>y.setUint8(m++,w.charCodeAt(0))),Array.from(a,w=>y.setUint8(m++,w.charCodeAt(0))),Array.from(o,w=>y.setUint8(m++,w.charCodeAt(0))),Array.from(c,w=>y.setUint8(m++,w.charCodeAt(0))),Array.from(h,w=>y.setUint8(m++,w.charCodeAt(0)));var v=new Uint8Array(p.byteLength+r.byteLength);return v.set(new Uint8Array(p),0),v.set(new Uint8Array(r),p.byteLength),v.buffer}decode(e,t){if(this._isArrayBuffer(e)){let r=this._binaryDecode(e);return t(r)}if(typeof e=="string"){const r=JSON.parse(e),[s,i,o,a,l]=r;return t({join_ref:s,ref:i,topic:o,event:a,payload:l})}return t({})}_binaryDecode(e){const t=new DataView(e),r=t.getUint8(0),s=new TextDecoder;switch(r){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,t,s)}}_decodeUserBroadcast(e,t,r){const s=t.getUint8(1),i=t.getUint8(2),o=t.getUint8(3),a=t.getUint8(4);let l=this.HEADER_LENGTH+4;const c=r.decode(e.slice(l,l+s));l=l+s;const u=r.decode(e.slice(l,l+i));l=l+i;const h=r.decode(e.slice(l,l+o));l=l+o;const f=e.slice(l,e.byteLength),p=a===this.JSON_ENCODING?JSON.parse(r.decode(f)):f,y={type:this.BROADCAST_EVENT,event:u,payload:p};return o>0&&(y.meta=JSON.parse(h)),{join_ref:null,ref:null,topic:c,event:this.BROADCAST_EVENT,payload:y}}_isArrayBuffer(e){var t;return e instanceof ArrayBuffer||((t=e==null?void 0:e.constructor)===null||t===void 0?void 0:t.name)==="ArrayBuffer"}_pick(e,t){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([r])=>t.includes(r)))}}class jj{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ye;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(Ye||(Ye={}));const VC=(n,e,t={})=>{var r;const s=(r=t.skipTypes)!==null&&r!==void 0?r:[];return e?Object.keys(e).reduce((i,o)=>(i[o]=_q(o,n,e,s),i),{}):{}},_q=(n,e,t,r)=>{const s=e.find(a=>a.name===n),i=s==null?void 0:s.type,o=t[n];return i&&!r.includes(i)?Dj(i,o):n_(o)},Dj=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return Eq(e,t)}switch(n){case Ye.bool:return xq(e);case Ye.float4:case Ye.float8:case Ye.int2:case Ye.int4:case Ye.int8:case Ye.numeric:case Ye.oid:return bq(e);case Ye.json:case Ye.jsonb:return Sq(e);case Ye.timestamp:return Tq(e);case Ye.abstime:case Ye.date:case Ye.daterange:case Ye.int4range:case Ye.int8range:case Ye.money:case Ye.reltime:case Ye.text:case Ye.time:case Ye.timestamptz:case Ye.timetz:case Ye.tsrange:case Ye.tstzrange:return n_(e);default:return n_(e)}},n_=n=>n,xq=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},bq=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},Sq=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log(`JSON parse error: ${e}`),n}return n},Eq=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,r=n[t];if(n[0]==="{"&&r==="}"){let i;const o=n.slice(1,t);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(a=>Dj(e,a))}return n},Tq=n=>typeof n=="string"?n.replace(" ","T"):n,Mj=n=>{const e=new URL(n);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class Lv{constructor(e,t,r={},s=e_){this.channel=e,this.event=t,this.payload=r,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var UC;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(UC||(UC={}));class lh{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},s=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=lh.syncState(this.state,s,i,o),this.pendingDiffs.forEach(l=>{this.state=lh.syncDiff(this.state,l,i,o)}),this.pendingDiffs=[],a()}),this.channel._on(r.diff,{},s=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=lh.syncDiff(this.state,s,i,o),a())}),this.onJoin((s,i,o)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:o})}),this.onLeave((s,i,o)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,s){const i=this.cloneDeep(e),o=this.transformState(t),a={},l={};return this.map(i,(c,u)=>{o[c]||(l[c]=u)}),this.map(o,(c,u)=>{const h=i[c];if(h){const f=u.map(v=>v.presence_ref),p=h.map(v=>v.presence_ref),y=u.filter(v=>p.indexOf(v.presence_ref)<0),m=h.filter(v=>f.indexOf(v.presence_ref)<0);y.length>0&&(a[c]=y),m.length>0&&(l[c]=m)}else a[c]=u}),this.syncDiff(i,{joins:a,leaves:l},r,s)}static syncDiff(e,t,r,s){const{joins:i,leaves:o}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),s||(s=()=>{}),this.map(i,(a,l)=>{var c;const u=(c=e[a])!==null&&c!==void 0?c:[];if(e[a]=this.cloneDeep(l),u.length>0){const h=e[a].map(p=>p.presence_ref),f=u.filter(p=>h.indexOf(p.presence_ref)<0);e[a].unshift(...f)}r(a,u,l)}),this.map(o,(a,l)=>{let c=e[a];if(!c)return;const u=l.map(h=>h.presence_ref);c=c.filter(h=>u.indexOf(h.presence_ref)<0),e[a]=c,s(a,c,l),c.length===0&&delete e[a]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const s=e[r];return"metas"in s?t[r]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):t[r]=s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var $C;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})($C||($C={}));var ch;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(ch||(ch={}));var Vs;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(Vs||(Vs={}));class Wb{constructor(e,t={config:{}},r){var s,i;if(this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=Ot.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Lv(this,Mr.join,this.params,this.timeout),this.rejoinTimer=new jj(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ot.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Ot.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=Ot.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ot.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=Ot.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Mr.reply,{},(o,a)=>{this._trigger(this._replyEventName(a),o)}),this.presence=new lh(this),this.broadcastEndpointURL=Mj(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((i=(s=this.params.config)===null||s===void 0?void 0:s.broadcast)===null||i===void 0)&&i.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,t=this.timeout){var r,s,i;if(this.socket.isConnected()||this.socket.connect(),this.state==Ot.closed){const{config:{broadcast:o,presence:a,private:l}}=this.params,c=(s=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(p=>p.filter))!==null&&s!==void 0?s:[],u=!!this.bindings[ch.PRESENCE]&&this.bindings[ch.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,h={},f={broadcast:o,presence:Object.assign(Object.assign({},a),{enabled:u}),postgres_changes:c,private:l};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(p=>e==null?void 0:e(Vs.CHANNEL_ERROR,p)),this._onClose(()=>e==null?void 0:e(Vs.CLOSED)),this.updateJoinPayload(Object.assign({config:f},h)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:p})=>{var y;if(this.socket.setAuth(),p===void 0){e==null||e(Vs.SUBSCRIBED);return}else{const m=this.bindings.postgres_changes,v=(y=m==null?void 0:m.length)!==null&&y!==void 0?y:0,w=[];for(let _=0;_<v;_++){const x=m[_],{filter:{event:A,schema:j,table:N,filter:S}}=x,T=p&&p[_];if(T&&T.event===A&&T.schema===j&&T.table===N&&T.filter===S)w.push(Object.assign(Object.assign({},x),{id:T.id}));else{this.unsubscribe(),this.state=Ot.errored,e==null||e(Vs.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=w,e&&e(Vs.SUBSCRIBED);return}}).receive("error",p=>{this.state=Ot.errored,e==null||e(Vs.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(p).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(Vs.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this.state===Ot.joined&&e===ch.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,r)}async httpSend(e,t,r={}){var s;const i=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(t==null)return Promise.reject("Payload is required for httpSend()");const o={method:"POST",headers:{Authorization:i,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:t,private:this.private}]})},a=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(s=r.timeout)!==null&&s!==void 0?s:this.timeout);if(a.status===202)return{success:!0};let l=a.statusText;try{const c=await a.json();l=c.error||c.message||l}catch{}return Promise.reject(new Error(l))}async send(e,t={}){var r,s;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:i,payload:o}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(r=t.timeout)!==null&&r!==void 0?r:this.timeout);return await((s=c.body)===null||s===void 0?void 0:s.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,a,l;const c=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(a=(o=this.params)===null||o===void 0?void 0:o.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),c.receive("ok",()=>i("ok")),c.receive("error",()=>i("error")),c.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Ot.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Mr.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(s=>{r=new Lv(this,Mr.leave,{},e),r.receive("ok",()=>{t(),s("ok")}).receive("timeout",()=>{t(),s("timed out")}).receive("error",()=>{s("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r==null||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Ot.closed,this.bindings={}}async _fetchWithTimeout(e,t,r){const s=new AbortController,i=setTimeout(()=>s.abort(),r),o=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:s.signal}));return clearTimeout(i),o}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new Lv(this,e,t,r);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>vq){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var s,i;const o=e.toLocaleLowerCase(),{close:a,error:l,leave:c,join:u}=Mr;if(r&&[a,l,c,u].indexOf(o)>=0&&r!==this._joinRef())return;let f=this._onMessage(o,t,r);if(t&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(p=>{var y,m,v;return((y=p.filter)===null||y===void 0?void 0:y.event)==="*"||((v=(m=p.filter)===null||m===void 0?void 0:m.event)===null||v===void 0?void 0:v.toLocaleLowerCase())===o}).map(p=>p.callback(f,r)):(i=this.bindings[o])===null||i===void 0||i.filter(p=>{var y,m,v,w,_,x;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in p){const A=p.id,j=(y=p.filter)===null||y===void 0?void 0:y.event;return A&&((m=t.ids)===null||m===void 0?void 0:m.includes(A))&&(j==="*"||(j==null?void 0:j.toLocaleLowerCase())===((v=t.data)===null||v===void 0?void 0:v.type.toLocaleLowerCase()))}else{const A=(_=(w=p==null?void 0:p.filter)===null||w===void 0?void 0:w.event)===null||_===void 0?void 0:_.toLocaleLowerCase();return A==="*"||A===((x=t==null?void 0:t.event)===null||x===void 0?void 0:x.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===o}).map(p=>{if(typeof f=="object"&&"ids"in f){const y=f.data,{schema:m,table:v,commit_timestamp:w,type:_,errors:x}=y;f=Object.assign(Object.assign({},{schema:m,table:v,commit_timestamp:w,eventType:_,new:{},old:{},errors:x}),this._getPayloadRecords(y))}p.callback(f,r)})}_isClosed(){return this.state===Ot.closed}_isJoined(){return this.state===Ot.joined}_isJoining(){return this.state===Ot.joining}_isLeaving(){return this.state===Ot.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const s=e.toLocaleLowerCase(),i={type:s,filter:t,callback:r};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===r&&Wb.isEqual(s.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Mr.close,{},e)}_onError(e){this._on(Mr.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ot.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=VC(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=VC(e.columns,e.old_record)),t}}const Fv=()=>{},Df={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Cq=[1e3,2e3,5e3,1e4],kq=1e4,Aq=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Pq{constructor(e,t){var r;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=e_,this.transport=null,this.heartbeatIntervalMs=Df.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Fv,this.ref=0,this.reconnectTimer=null,this.vsn=FC,this.logger=Fv,this.conn=null,this.sendBuffer=[],this.serializer=new wq,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>s?(...i)=>s(...i):(...i)=>fetch(...i),!(!((r=t==null?void 0:t.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${t_.websocket}`,this.httpEndpoint=Mj(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t==null?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=fq.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,t??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case ra.connecting:return sa.Connecting;case ra.open:return sa.Open;case ra.closing:return sa.Closing;default:return sa.Closed}}isConnected(){return this.connectionState()===sa.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const r=`realtime:${e}`,s=this.getChannels().find(i=>i.topic===r);if(s)return s;{const i=new Wb(`realtime:${e}`,t,this);return this.channels.push(i),i}}push(e){const{topic:t,event:r,payload:s,ref:i}=e,o=()=>{this.encode(e,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};this.log("push",`${t} ${r} (${i})`,s),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(yq,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},Df.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{if(t.topic==="phoenix"&&t.event==="phx_reply")try{this.heartbeatCallback(t.payload.status==="ok"?"ok":"error")}catch(c){this.log("error","error in heartbeat callback",c)}t.ref&&t.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:r,event:s,payload:i,ref:o}=t,a=o?`(${o})`:"",l=i.status||"";this.log("receive",`${l} ${r} ${s} ${a}`.trim(),i),this.channels.filter(c=>c._isMember(r)).forEach(c=>c._trigger(s,i,o)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){if(this.conn){if(this.conn.readyState===ra.open||this.conn.readyState===ra.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(t=>{this.log("error","error waiting for auth on connect",t),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Mr.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const r=e.match(/\?/)?"&":"?",s=new URLSearchParams(t);return`${e}${r}${s}`}_workerObjectUrl(e){let t;if(e)t=e;else{const r=new Blob([Aq],{type:"application/javascript"});t=URL.createObjectURL(r)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;e?t=e:this.accessToken?t=await this.accessToken():t=this.accessTokenValue,this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(r=>{const s={access_token:t,version:gq};t&&r.updateJoinPayload(s),r.joinedOnce&&r._isJoined()&&r._push(Mr.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(t)}catch(s){this.log("error",`error in ${e} callback`,s)}})}catch(r){this.log("error",`error triggering ${e} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new jj(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Df.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,r,s,i,o,a,l,c,u,h,f,p;switch(this.transport=(t=e==null?void 0:e.transport)!==null&&t!==void 0?t:null,this.timeout=(r=e==null?void 0:e.timeout)!==null&&r!==void 0?r:e_,this.heartbeatIntervalMs=(s=e==null?void 0:e.heartbeatIntervalMs)!==null&&s!==void 0?s:Df.HEARTBEAT_INTERVAL,this.worker=(i=e==null?void 0:e.worker)!==null&&i!==void 0?i:!1,this.accessToken=(o=e==null?void 0:e.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(a=e==null?void 0:e.heartbeatCallback)!==null&&a!==void 0?a:Fv,this.vsn=(l=e==null?void 0:e.vsn)!==null&&l!==void 0?l:FC,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=e==null?void 0:e.reconnectAfterMs)!==null&&c!==void 0?c:y=>Cq[y-1]||kq,this.vsn){case Nj:this.encode=(u=e==null?void 0:e.encode)!==null&&u!==void 0?u:(y,m)=>m(JSON.stringify(y)),this.decode=(h=e==null?void 0:e.decode)!==null&&h!==void 0?h:(y,m)=>m(JSON.parse(y));break;case mq:this.encode=(f=e==null?void 0:e.encode)!==null&&f!==void 0?f:this.serializer.encode.bind(this.serializer),this.decode=(p=e==null?void 0:e.decode)!==null&&p!==void 0?p:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class ly extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function ct(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class Iq extends ly{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class r_ extends ly{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}const Hb=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),Rq=()=>Response,s_=n=>{if(Array.isArray(n))return n.map(t=>s_(t));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([t,r])=>{const s=t.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[s]=s_(r)}),e},Oq=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)},Nq=n=>!n||typeof n!="string"||n.length===0||n.length>100||n.trim()!==n||n.includes("/")||n.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(n),Vv=n=>{var e;return n.msg||n.message||n.error_description||(typeof n.error=="string"?n.error:(e=n.error)===null||e===void 0?void 0:e.message)||JSON.stringify(n)},jq=(n,e,t)=>ie(void 0,void 0,void 0,function*(){const r=yield Rq();n instanceof r&&!(t!=null&&t.noResolveJson)?n.json().then(s=>{const i=n.status||500,o=(s==null?void 0:s.statusCode)||i+"";e(new Iq(Vv(s),i,o))}).catch(s=>{e(new r_(Vv(s),s))}):e(new r_(Vv(n),n))}),Dq=(n,e,t,r)=>{const s={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"||!r?s:(Oq(r)?(s.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),s.body=JSON.stringify(r)):s.body=r,e!=null&&e.duplex&&(s.duplex=e.duplex),Object.assign(Object.assign({},s),t))};function Nd(n,e,t,r,s,i){return ie(this,void 0,void 0,function*(){return new Promise((o,a)=>{n(t,Dq(e,r,s,i)).then(l=>{if(!l.ok)throw l;return r!=null&&r.noResolveJson?l:l.json()}).then(l=>o(l)).catch(l=>jq(l,a,r))})})}function Yh(n,e,t,r){return ie(this,void 0,void 0,function*(){return Nd(n,"GET",e,t,r)})}function Or(n,e,t,r,s){return ie(this,void 0,void 0,function*(){return Nd(n,"POST",e,r,s,t)})}function i_(n,e,t,r,s){return ie(this,void 0,void 0,function*(){return Nd(n,"PUT",e,r,s,t)})}function Mq(n,e,t,r){return ie(this,void 0,void 0,function*(){return Nd(n,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),r)})}function qb(n,e,t,r,s){return ie(this,void 0,void 0,function*(){return Nd(n,"DELETE",e,r,s,t)})}class Lq{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}execute(){return ie(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(ct(e))return{data:null,error:e};throw e}})}}var Lj;class Fq{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[Lj]="BlobDownloadBuilder",this.promise=null}asStream(){return new Lq(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return ie(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(ct(e))return{data:null,error:e};throw e}})}}Lj=Symbol.toStringTag;const Vq={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},BC={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Uq{constructor(e,t={},r,s){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=r,this.fetch=Hb(s)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,t,r,s){return ie(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},BC),s);let a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const l=o.metadata;typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),l&&i.append("metadata",this.encodeMetadata(l)),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.has("cacheControl")||i.append("cacheControl",o.cacheControl),l&&!i.has("metadata")&&i.append("metadata",this.encodeMetadata(l))):(i=r,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType,l&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(l))),(typeof ReadableStream<"u"&&i instanceof ReadableStream||i&&typeof i=="object"&&"pipe"in i&&typeof i.pipe=="function")&&!o.duplex&&(o.duplex="half")),s!=null&&s.headers&&(a=Object.assign(Object.assign({},a),s.headers));const c=this._removeEmptyFolders(t),u=this._getFinalPath(c),h=yield(e=="PUT"?i_:Or)(this.fetch,`${this.url}/object/${u}`,i,Object.assign({headers:a},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:c,id:h.Id,fullPath:h.Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(ct(i))return{data:null,error:i};throw i}})}upload(e,t,r){return ie(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,s){return ie(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),o=this._getFinalPath(i),a=new URL(this.url+`/object/upload/sign/${o}`);a.searchParams.set("token",t);try{let l;const c=Object.assign({upsert:BC.upsert},s),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",c.cacheControl)):(l=r,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const h=yield i_(this.fetch,a.toString(),l,{headers:u});return{data:{path:i,fullPath:h.Key},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(ct(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,t){return ie(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const s=Object.assign({},this.headers);t!=null&&t.upsert&&(s["x-upsert"]="true");const i=yield Or(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:s}),o=new URL(this.url+i.url),a=o.searchParams.get("token");if(!a)throw new ly("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:a},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ct(r))return{data:null,error:r};throw r}})}update(e,t,r){return ie(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return ie(this,void 0,void 0,function*(){try{return{data:yield Or(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ct(s))return{data:null,error:s};throw s}})}copy(e,t,r){return ie(this,void 0,void 0,function*(){try{return{data:{path:(yield Or(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ct(s))return{data:null,error:s};throw s}})}createSignedUrl(e,t,r){return ie(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),i=yield Or(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const o=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ct(s))return{data:null,error:s};throw s}})}createSignedUrls(e,t,r){return ie(this,void 0,void 0,function*(){try{const s=yield Or(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:s.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ct(s))return{data:null,error:s};throw s}})}download(e,t){const s=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),o=i?`?${i}`:"",a=this._getFinalPath(e),l=()=>Yh(this.fetch,`${this.url}/${s}/${a}${o}`,{headers:this.headers,noResolveJson:!0});return new Fq(l,this.shouldThrowOnError)}info(e){return ie(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const r=yield Yh(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:s_(r),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ct(r))return{data:null,error:r};throw r}})}exists(e){return ie(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield Mq(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ct(r)&&r instanceof r_){const s=r.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,t){const r=this._getFinalPath(e),s=[],i=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";i!==""&&s.push(i);const a=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});l!==""&&s.push(l);let c=s.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${r}${c}`)}}}remove(e){return ie(this,void 0,void 0,function*(){try{return{data:yield qb(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ct(t))return{data:null,error:t};throw t}})}list(e,t,r){return ie(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},Vq),t),{prefix:e||""});return{data:yield Or(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},r),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ct(s))return{data:null,error:s};throw s}})}listV2(e,t){return ie(this,void 0,void 0,function*(){try{const r=Object.assign({},e);return{data:yield Or(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,r,{headers:this.headers},t),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ct(r))return{data:null,error:r};throw r}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const Fj="2.86.0",Vj={"X-Client-Info":`storage-js/${Fj}`};class $q{constructor(e,t={},r,s){this.shouldThrowOnError=!1;const i=new URL(e);s!=null&&s.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Vj),t),this.fetch=Hb(r)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(e){return ie(this,void 0,void 0,function*(){try{const t=this.listBucketOptionsToQueryString(e);return{data:yield Yh(this.fetch,`${this.url}/bucket${t}`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ct(t))return{data:null,error:t};throw t}})}getBucket(e){return ie(this,void 0,void 0,function*(){try{return{data:yield Yh(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ct(t))return{data:null,error:t};throw t}})}createBucket(e){return ie(this,arguments,void 0,function*(t,r={public:!1}){try{return{data:yield Or(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ct(s))return{data:null,error:s};throw s}})}updateBucket(e,t){return ie(this,void 0,void 0,function*(){try{return{data:yield i_(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ct(r))return{data:null,error:r};throw r}})}emptyBucket(e){return ie(this,void 0,void 0,function*(){try{return{data:yield Or(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ct(t))return{data:null,error:t};throw t}})}deleteBucket(e){return ie(this,void 0,void 0,function*(){try{return{data:yield qb(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ct(t))return{data:null,error:t};throw t}})}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}}var Xh=class extends Error{constructor(n,e){var t;super(n),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&((t=e.icebergType)==null?void 0:t.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function Bq(n,e,t){const r=new URL(e,n);if(t)for(const[s,i]of Object.entries(t))i!==void 0&&r.searchParams.set(s,i);return r.toString()}async function zq(n){return!n||n.type==="none"?{}:n.type==="bearer"?{Authorization:`Bearer ${n.token}`}:n.type==="header"?{[n.name]:n.value}:n.type==="custom"?await n.getHeaders():{}}function Wq(n){const e=n.fetchImpl??globalThis.fetch;return{async request({method:t,path:r,query:s,body:i,headers:o}){const a=Bq(n.baseUrl,r,s),l=await zq(n.auth),c=await e(a,{method:t,headers:{...i?{"Content-Type":"application/json"}:{},...l,...o},body:i?JSON.stringify(i):void 0}),u=await c.text(),h=(c.headers.get("content-type")||"").includes("application/json"),f=h&&u?JSON.parse(u):u;if(!c.ok){const p=h?f:void 0,y=p==null?void 0:p.error;throw new Xh((y==null?void 0:y.message)??`Request failed with status ${c.status}`,{status:c.status,icebergType:y==null?void 0:y.type,icebergCode:y==null?void 0:y.code,details:p})}return{status:c.status,headers:c.headers,data:f}}}}function Mf(n){return n.join("")}var Hq=class{constructor(n,e=""){this.client=n,this.prefix=e}async listNamespaces(n){const e=n?{parent:Mf(n.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(r=>({namespace:r}))}async createNamespace(n,e){const t={namespace:n.namespace,properties:e==null?void 0:e.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:t})).data}async dropNamespace(n){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Mf(n.namespace)}`})}async loadNamespaceMetadata(n){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Mf(n.namespace)}`})).data.properties}}async namespaceExists(n){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Mf(n.namespace)}`}),!0}catch(e){if(e instanceof Xh&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(n,e){try{return await this.createNamespace(n,e)}catch(t){if(t instanceof Xh&&t.status===409)return;throw t}}};function il(n){return n.join("")}var qq=class{constructor(n,e="",t){this.client=n,this.prefix=e,this.accessDelegation=t}async listTables(n){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${il(n.namespace)}/tables`})).data.identifiers}async createTable(n,e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${il(n.namespace)}/tables`,body:e,headers:t})).data.metadata}async updateTable(n,e){const t=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${il(n.namespace)}/tables/${n.name}`,body:e});return{"metadata-location":t.data["metadata-location"],metadata:t.data.metadata}}async dropTable(n,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${il(n.namespace)}/tables/${n.name}`,query:{purgeRequested:String((e==null?void 0:e.purge)??!1)}})}async loadTable(n){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${il(n.namespace)}/tables/${n.name}`,headers:e})).data.metadata}async tableExists(n){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${il(n.namespace)}/tables/${n.name}`,headers:e}),!0}catch(t){if(t instanceof Xh&&t.status===404)return!1;throw t}}async createTableIfNotExists(n,e){try{return await this.createTable(n,e)}catch(t){if(t instanceof Xh&&t.status===409)return await this.loadTable({namespace:n.namespace,name:e.name});throw t}}},Gq=class{constructor(n){var r;let e="v1";n.catalogName&&(e+=`/${n.catalogName}`);const t=n.baseUrl.endsWith("/")?n.baseUrl:`${n.baseUrl}/`;this.client=Wq({baseUrl:t,auth:n.auth,fetchImpl:n.fetch}),this.accessDelegation=(r=n.accessDelegation)==null?void 0:r.join(","),this.namespaceOps=new Hq(this.client,e),this.tableOps=new qq(this.client,e,this.accessDelegation)}async listNamespaces(n){return this.namespaceOps.listNamespaces(n)}async createNamespace(n,e){return this.namespaceOps.createNamespace(n,e)}async dropNamespace(n){await this.namespaceOps.dropNamespace(n)}async loadNamespaceMetadata(n){return this.namespaceOps.loadNamespaceMetadata(n)}async listTables(n){return this.tableOps.listTables(n)}async createTable(n,e){return this.tableOps.createTable(n,e)}async updateTable(n,e){return this.tableOps.updateTable(n,e)}async dropTable(n,e){await this.tableOps.dropTable(n,e)}async loadTable(n){return this.tableOps.loadTable(n)}async namespaceExists(n){return this.namespaceOps.namespaceExists(n)}async tableExists(n){return this.tableOps.tableExists(n)}async createNamespaceIfNotExists(n,e){return this.namespaceOps.createNamespaceIfNotExists(n,e)}async createTableIfNotExists(n,e){return this.tableOps.createTableIfNotExists(n,e)}};class Kq{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Vj),t),this.fetch=Hb(r)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return ie(this,void 0,void 0,function*(){try{return{data:yield Or(this.fetch,`${this.url}/bucket`,{name:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ct(t))return{data:null,error:t};throw t}})}listBuckets(e){return ie(this,void 0,void 0,function*(){try{const t=new URLSearchParams;(e==null?void 0:e.limit)!==void 0&&t.set("limit",e.limit.toString()),(e==null?void 0:e.offset)!==void 0&&t.set("offset",e.offset.toString()),e!=null&&e.sortColumn&&t.set("sortColumn",e.sortColumn),e!=null&&e.sortOrder&&t.set("sortOrder",e.sortOrder),e!=null&&e.search&&t.set("search",e.search);const r=t.toString(),s=r?`${this.url}/bucket?${r}`:`${this.url}/bucket`;return{data:yield Yh(this.fetch,s,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ct(t))return{data:null,error:t};throw t}})}deleteBucket(e){return ie(this,void 0,void 0,function*(){try{return{data:yield qb(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ct(t))return{data:null,error:t};throw t}})}from(e){if(!Nq(e))throw new ly("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");return new Gq({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:()=>ie(this,void 0,void 0,function*(){return this.headers})},fetch:this.fetch})}}const Gb={"X-Client-Info":`storage-js/${Fj}`,"Content-Type":"application/json"};class Uj extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function Gn(n){return typeof n=="object"&&n!==null&&"__isStorageVectorsError"in n}class Uv extends Uj{constructor(e,t,r){super(e),this.name="StorageVectorsApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Yq extends Uj{constructor(e,t){super(e),this.name="StorageVectorsUnknownError",this.originalError=t}}var zC;(function(n){n.InternalError="InternalError",n.S3VectorConflictException="S3VectorConflictException",n.S3VectorNotFoundException="S3VectorNotFoundException",n.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",n.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",n.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(zC||(zC={}));const Kb=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),Xq=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)},WC=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),Qq=(n,e,t)=>ie(void 0,void 0,void 0,function*(){if(n&&typeof n=="object"&&"status"in n&&"ok"in n&&typeof n.status=="number"&&!(t!=null&&t.noResolveJson)){const s=n.status||500,i=n;if(typeof i.json=="function")i.json().then(o=>{const a=(o==null?void 0:o.statusCode)||(o==null?void 0:o.code)||s+"";e(new Uv(WC(o),s,a))}).catch(()=>{const o=s+"",a=i.statusText||`HTTP ${s} error`;e(new Uv(a,s,o))});else{const o=s+"",a=i.statusText||`HTTP ${s} error`;e(new Uv(a,s,o))}}else e(new Yq(WC(n),n))}),Jq=(n,e,t,r)=>{const s={method:n,headers:(e==null?void 0:e.headers)||{}};return r?(Xq(r)?(s.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),s.body=JSON.stringify(r)):s.body=r,Object.assign(Object.assign({},s),t)):s};function Zq(n,e,t,r,s,i){return ie(this,void 0,void 0,function*(){return new Promise((o,a)=>{n(t,Jq(e,r,s,i)).then(l=>{if(!l.ok)throw l;if(r!=null&&r.noResolveJson)return l;const c=l.headers.get("content-type");return!c||!c.includes("application/json")?{}:l.json()}).then(l=>o(l)).catch(l=>Qq(l,a,r))})})}function Kn(n,e,t,r,s){return ie(this,void 0,void 0,function*(){return Zq(n,"POST",e,r,s,t)})}class eG{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Gb),t),this.fetch=Kb(r)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(e){return ie(this,void 0,void 0,function*(){try{return{data:(yield Kn(this.fetch,`${this.url}/CreateIndex`,e,{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Gn(t))return{data:null,error:t};throw t}})}getIndex(e,t){return ie(this,void 0,void 0,function*(){try{return{data:yield Kn(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Gn(r))return{data:null,error:r};throw r}})}listIndexes(e){return ie(this,void 0,void 0,function*(){try{return{data:yield Kn(this.fetch,`${this.url}/ListIndexes`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Gn(t))return{data:null,error:t};throw t}})}deleteIndex(e,t){return ie(this,void 0,void 0,function*(){try{return{data:(yield Kn(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Gn(r))return{data:null,error:r};throw r}})}}class tG{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Gb),t),this.fetch=Kb(r)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(e){return ie(this,void 0,void 0,function*(){try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield Kn(this.fetch,`${this.url}/PutVectors`,e,{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Gn(t))return{data:null,error:t};throw t}})}getVectors(e){return ie(this,void 0,void 0,function*(){try{return{data:yield Kn(this.fetch,`${this.url}/GetVectors`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Gn(t))return{data:null,error:t};throw t}})}listVectors(e){return ie(this,void 0,void 0,function*(){try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:yield Kn(this.fetch,`${this.url}/ListVectors`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Gn(t))return{data:null,error:t};throw t}})}queryVectors(e){return ie(this,void 0,void 0,function*(){try{return{data:yield Kn(this.fetch,`${this.url}/QueryVectors`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Gn(t))return{data:null,error:t};throw t}})}deleteVectors(e){return ie(this,void 0,void 0,function*(){try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield Kn(this.fetch,`${this.url}/DeleteVectors`,e,{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Gn(t))return{data:null,error:t};throw t}})}}class nG{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Gb),t),this.fetch=Kb(r)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return ie(this,void 0,void 0,function*(){try{return{data:(yield Kn(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Gn(t))return{data:null,error:t};throw t}})}getBucket(e){return ie(this,void 0,void 0,function*(){try{return{data:yield Kn(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Gn(t))return{data:null,error:t};throw t}})}listBuckets(){return ie(this,arguments,void 0,function*(e={}){try{return{data:yield Kn(this.fetch,`${this.url}/ListVectorBuckets`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Gn(t))return{data:null,error:t};throw t}})}deleteBucket(e){return ie(this,void 0,void 0,function*(){try{return{data:(yield Kn(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Gn(t))return{data:null,error:t};throw t}})}}class rG extends nG{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new sG(this.url,this.headers,e,this.fetch)}createBucket(e){const t=Object.create(null,{createBucket:{get:()=>super.createBucket}});return ie(this,void 0,void 0,function*(){return t.createBucket.call(this,e)})}getBucket(e){const t=Object.create(null,{getBucket:{get:()=>super.getBucket}});return ie(this,void 0,void 0,function*(){return t.getBucket.call(this,e)})}listBuckets(){const e=Object.create(null,{listBuckets:{get:()=>super.listBuckets}});return ie(this,arguments,void 0,function*(t={}){return e.listBuckets.call(this,t)})}deleteBucket(e){const t=Object.create(null,{deleteBucket:{get:()=>super.deleteBucket}});return ie(this,void 0,void 0,function*(){return t.deleteBucket.call(this,e)})}}class sG extends eG{constructor(e,t,r,s){super(e,t,s),this.vectorBucketName=r}createIndex(e){const t=Object.create(null,{createIndex:{get:()=>super.createIndex}});return ie(this,void 0,void 0,function*(){return t.createIndex.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const e=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return ie(this,arguments,void 0,function*(t={}){return e.listIndexes.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}getIndex(e){const t=Object.create(null,{getIndex:{get:()=>super.getIndex}});return ie(this,void 0,void 0,function*(){return t.getIndex.call(this,this.vectorBucketName,e)})}deleteIndex(e){const t=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return ie(this,void 0,void 0,function*(){return t.deleteIndex.call(this,this.vectorBucketName,e)})}index(e){return new iG(this.url,this.headers,this.vectorBucketName,e,this.fetch)}}class iG extends tG{constructor(e,t,r,s,i){super(e,t,i),this.vectorBucketName=r,this.indexName=s}putVectors(e){const t=Object.create(null,{putVectors:{get:()=>super.putVectors}});return ie(this,void 0,void 0,function*(){return t.putVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(e){const t=Object.create(null,{getVectors:{get:()=>super.getVectors}});return ie(this,void 0,void 0,function*(){return t.getVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const e=Object.create(null,{listVectors:{get:()=>super.listVectors}});return ie(this,arguments,void 0,function*(t={}){return e.listVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(e){const t=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return ie(this,void 0,void 0,function*(){return t.queryVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(e){const t=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return ie(this,void 0,void 0,function*(){return t.deleteVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class oG extends $q{constructor(e,t={},r,s){super(e,t,r,s)}from(e){return new Uq(this.url,this.headers,e,this.fetch)}get vectors(){return new rG(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new Kq(this.url+"/iceberg",this.headers,this.fetch)}}const aG="2.86.0";let zu="";typeof Deno<"u"?zu="deno":typeof document<"u"?zu="web":typeof navigator<"u"&&navigator.product==="ReactNative"?zu="react-native":zu="node";const lG={"X-Client-Info":`supabase-js-${zu}/${aG}`},cG={headers:lG},uG={schema:"public"},hG={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},dG={},fG=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),pG=()=>Headers,gG=(n,e,t)=>{const r=fG(t),s=pG();return async(i,o)=>{var a;const l=(a=await e())!==null&&a!==void 0?a:n;let c=new s(o==null?void 0:o.headers);return c.has("apikey")||c.set("apikey",n),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),r(i,Object.assign(Object.assign({},o),{headers:c}))}};function mG(n){return n.endsWith("/")?n:n+"/"}function yG(n,e){var t,r;const{db:s,auth:i,realtime:o,global:a}=n,{db:l,auth:c,realtime:u,global:h}=e,f={db:Object.assign(Object.assign({},l),s),auth:Object.assign(Object.assign({},c),i),realtime:Object.assign(Object.assign({},u),o),storage:{},global:Object.assign(Object.assign(Object.assign({},h),a),{headers:Object.assign(Object.assign({},(t=h==null?void 0:h.headers)!==null&&t!==void 0?t:{}),(r=a==null?void 0:a.headers)!==null&&r!==void 0?r:{})}),accessToken:async()=>""};return n.accessToken?f.accessToken=n.accessToken:delete f.accessToken,f}function vG(n){const e=n==null?void 0:n.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(mG(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const $j="2.86.0",_l=30*1e3,o_=3,$v=o_*_l,wG="http://localhost:9999",_G="supabase.auth.token",xG={"X-Client-Info":`gotrue-js/${$j}`},a_="X-Supabase-Api-Version",Bj={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},bG=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,SG=10*60*1e3;class Qh extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function le(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class EG extends Qh{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}function TG(n){return le(n)&&n.name==="AuthApiError"}class ia extends Qh{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Uo extends Qh{constructor(e,t,r,s){super(e,r,s),this.name=t,this.status=r}}class zn extends Uo{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function CG(n){return le(n)&&n.name==="AuthSessionMissingError"}class ol extends Uo{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Lf extends Uo{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Ff extends Uo{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function kG(n){return le(n)&&n.name==="AuthImplicitGrantRedirectError"}class HC extends Uo{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class l_ extends Uo{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Bv(n){return le(n)&&n.name==="AuthRetryableFetchError"}class qC extends Uo{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}class c_ extends Uo{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Hg="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),GC=` 	
\r=`.split(""),AG=(()=>{const n=new Array(128);for(let e=0;e<n.length;e+=1)n[e]=-1;for(let e=0;e<GC.length;e+=1)n[GC[e].charCodeAt(0)]=-2;for(let e=0;e<Hg.length;e+=1)n[Hg[e].charCodeAt(0)]=e;return n})();function KC(n,e,t){if(n!==null)for(e.queue=e.queue<<8|n,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;t(Hg[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;t(Hg[r]),e.queuedBits-=6}}function zj(n,e,t){const r=AG[n];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function YC(n){const e=[],t=o=>{e.push(String.fromCodePoint(o))},r={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},i=o=>{RG(o,r,t)};for(let o=0;o<n.length;o+=1)zj(n.charCodeAt(o),s,i);return e.join("")}function PG(n,e){if(n<=127){e(n);return}else if(n<=2047){e(192|n>>6),e(128|n&63);return}else if(n<=65535){e(224|n>>12),e(128|n>>6&63),e(128|n&63);return}else if(n<=1114111){e(240|n>>18),e(128|n>>12&63),e(128|n>>6&63),e(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function IG(n,e){for(let t=0;t<n.length;t+=1){let r=n.charCodeAt(t);if(r>55295&&r<=56319){const s=(r-55296)*1024&65535;r=(n.charCodeAt(t+1)-56320&65535|s)+65536,t+=1}PG(r,e)}}function RG(n,e,t){if(e.utf8seq===0){if(n<=127){t(n);return}for(let r=1;r<6;r+=1)if(!(n>>7-r&1)){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=n&31;else if(e.utf8seq===3)e.codepoint=n&15;else if(e.utf8seq===4)e.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|n&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function Zl(n){const e=[],t={queue:0,queuedBits:0},r=s=>{e.push(s)};for(let s=0;s<n.length;s+=1)zj(n.charCodeAt(s),t,r);return new Uint8Array(e)}function OG(n){const e=[];return IG(n,t=>e.push(t)),new Uint8Array(e)}function da(n){const e=[],t={queue:0,queuedBits:0},r=s=>{e.push(s)};return n.forEach(s=>KC(s,t,r)),KC(null,t,r),e.join("")}function NG(n){return Math.round(Date.now()/1e3)+n}function jG(){return Symbol("auth-callback")}const Ht=()=>typeof window<"u"&&typeof document<"u",Qo={tested:!1,writable:!1},Wj=()=>{if(!Ht())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Qo.tested)return Qo.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),Qo.tested=!0,Qo.writable=!0}catch{Qo.tested=!0,Qo.writable=!1}return Qo.writable};function DG(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((s,i)=>{e[i]=s})}catch{}return t.searchParams.forEach((r,s)=>{e[s]=r}),e}const Hj=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),MG=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",xl=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},Jo=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},Ni=async(n,e)=>{await n.removeItem(e)};class cy{constructor(){this.promise=new cy.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}cy.promiseConstructor=Promise;function zv(n){const e=n.split(".");if(e.length!==3)throw new c_("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!bG.test(e[r]))throw new c_("JWT not in base64url format");return{header:JSON.parse(YC(e[0])),payload:JSON.parse(YC(e[1])),signature:Zl(e[2]),raw:{header:e[0],payload:e[1]}}}async function LG(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function FG(n,e){return new Promise((r,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await n(i);if(!e(i,null,o)){r(o);return}}catch(o){if(!e(i,o)){s(o);return}}})()})}function VG(n){return("0"+n.toString(16)).substr(-2)}function UG(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=t.length;let s="";for(let i=0;i<56;i++)s+=t.charAt(Math.floor(Math.random()*r));return s}return crypto.getRandomValues(e),Array.from(e,VG).join("")}async function $G(n){const t=new TextEncoder().encode(n),r=await crypto.subtle.digest("SHA-256",t),s=new Uint8Array(r);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}async function BG(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await $G(n);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function al(n,e,t=!1){const r=UG();let s=r;t&&(s+="/PASSWORD_RECOVERY"),await xl(n,`${e}-code-verifier`,s);const i=await BG(r);return[i,r===i?"plain":"s256"]}const zG=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function WG(n){const e=n.headers.get(a_);if(!e||!e.match(zG))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function HG(n){if(!n)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(n<=e)throw new Error("JWT has expired")}function qG(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const GG=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function ll(n){if(!GG.test(n))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Wv(){const n={};return new Proxy(n,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const r=t.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function KG(n,e){return new Proxy(n,{get:(t,r,s)=>{if(r==="__isInsecureUserWarningProxy")return!0;if(typeof r=="symbol"){const i=r.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)"||i==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(t,r,s)}return!e.value&&typeof r=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(t,r,s)}})}function XC(n){return JSON.parse(JSON.stringify(n))}const na=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),YG=[502,503,504];async function QC(n){var e;if(!MG(n))throw new l_(na(n),0);if(YG.includes(n.status))throw new l_(na(n),n.status);let t;try{t=await n.json()}catch(i){throw new ia(na(i),i)}let r;const s=WG(n);if(s&&s.getTime()>=Bj["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?r=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(r=t.error_code),r){if(r==="weak_password")throw new qC(na(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new zn}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new qC(na(t),n.status,t.weak_password.reasons);throw new EG(na(t),n.status||500,r)}const XG=(n,e,t,r)=>{const s={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),s.body=JSON.stringify(r),Object.assign(Object.assign({},s),t))};async function pe(n,e,t,r){var s;const i=Object.assign({},r==null?void 0:r.headers);i[a_]||(i[a_]=Bj["2024-01-01"].name),r!=null&&r.jwt&&(i.Authorization=`Bearer ${r.jwt}`);const o=(s=r==null?void 0:r.query)!==null&&s!==void 0?s:{};r!=null&&r.redirectTo&&(o.redirect_to=r.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await QG(n,e,t+a,{headers:i,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(l):{data:Object.assign({},l),error:null}}async function QG(n,e,t,r,s,i){const o=XG(e,r,s,i);let a;try{a=await n(t,Object.assign({},o))}catch(l){throw console.error(l),new l_(na(l),0)}if(a.ok||await QC(a),r!=null&&r.noResolveJson)return a;try{return await a.json()}catch(l){await QC(l)}}function kr(n){var e;let t=null;eK(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=NG(n.expires_in)));const r=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:r},error:null}}function JC(n){const e=kr(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,r)=>t&&typeof r=="string",!0)&&(e.data.weak_password=n.weak_password),e}function Gi(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function JG(n){return{data:n,error:null}}function ZG(n){const{action_link:e,email_otp:t,hashed_token:r,redirect_to:s,verification_type:i}=n,o=Vo(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:t,hashed_token:r,redirect_to:s,verification_type:i},l=Object.assign({},o);return{data:{properties:a,user:l},error:null}}function ZC(n){return n}function eK(n){return n.access_token&&n.refresh_token&&n.expires_in}const Hv=["global","local","others"];class tK{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=Hj(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,t=Hv[0]){if(Hv.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Hv.join(", ")}`);try{return await pe(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(le(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,t={}){try{return await pe(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Gi})}catch(r){if(le(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=Vo(e,["options"]),s=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(s.new_email=r==null?void 0:r.newEmail,delete s.newEmail),await pe(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:ZG,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(le(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await pe(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Gi})}catch(t){if(le(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,s,i,o,a,l;try{const c={nextPage:null,lastPage:0,total:0},u=await pe(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(i=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:ZC});if(u.error)throw u.error;const h=await u.json(),f=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,p=(l=(a=u.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return p.length>0&&(p.forEach(y=>{const m=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(y.split(";")[1].split("=")[1]);c[`${v}Page`]=m}),c.total=parseInt(f)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(le(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){ll(e);try{return await pe(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Gi})}catch(t){if(le(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){ll(e);try{return await pe(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Gi})}catch(r){if(le(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,t=!1){ll(e);try{return await pe(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Gi})}catch(r){if(le(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){ll(e.userId);try{const{data:t,error:r}=await pe(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:t,error:r}}catch(t){if(le(t))return{data:null,error:t};throw t}}async _deleteFactor(e){ll(e.userId),ll(e.id);try{return{data:await pe(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(le(t))return{data:null,error:t};throw t}}async _listOAuthClients(e){var t,r,s,i,o,a,l;try{const c={nextPage:null,lastPage:0,total:0},u=await pe(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(i=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:ZC});if(u.error)throw u.error;const h=await u.json(),f=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,p=(l=(a=u.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return p.length>0&&(p.forEach(y=>{const m=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(y.split(";")[1].split("=")[1]);c[`${v}Page`]=m}),c.total=parseInt(f)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(le(c))return{data:{clients:[]},error:c};throw c}}async _createOAuthClient(e){try{return await pe(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(le(t))return{data:null,error:t};throw t}}async _getOAuthClient(e){try{return await pe(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(le(t))return{data:null,error:t};throw t}}async _updateOAuthClient(e,t){try{return await pe(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(le(r))return{data:null,error:r};throw r}}async _deleteOAuthClient(e){try{return await pe(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(t){if(le(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(e){try{return await pe(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(le(t))return{data:null,error:t};throw t}}}function ek(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}const cl={debug:!!(globalThis&&Wj()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class qj extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class nK extends qj{}async function rK(n,e,t){cl.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),cl.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async s=>{if(s){cl.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,s.name);try{return await t()}finally{cl.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,s.name)}}else{if(e===0)throw cl.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new nK(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(cl.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}function sK(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Gj(n){if(!/^0x[a-fA-F0-9]{40}$/.test(n))throw new Error(`@supabase/auth-js: Address "${n}" is invalid.`);return n.toLowerCase()}function iK(n){return parseInt(n,16)}function oK(n){const e=new TextEncoder().encode(n);return"0x"+Array.from(e,r=>r.toString(16).padStart(2,"0")).join("")}function aK(n){var e;const{chainId:t,domain:r,expirationTime:s,issuedAt:i=new Date,nonce:o,notBefore:a,requestId:l,resources:c,scheme:u,uri:h,version:f}=n;{if(!Number.isInteger(t))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${t}`);if(!r)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!h)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(f!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${f}`);if(!((e=n.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${n.statement}`)}const p=Gj(n.address),y=u?`${u}://${r}`:r,m=n.statement?`${n.statement}
`:"",v=`${y} wants you to sign in with your Ethereum account:
${p}

${m}`;let w=`URI: ${h}
Version: ${f}
Chain ID: ${t}${o?`
Nonce: ${o}`:""}
Issued At: ${i.toISOString()}`;if(s&&(w+=`
Expiration Time: ${s.toISOString()}`),a&&(w+=`
Not Before: ${a.toISOString()}`),l&&(w+=`
Request ID: ${l}`),c){let _=`
Resources:`;for(const x of c){if(!x||typeof x!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${x}`);_+=`
- ${x}`}w+=_}return`${v}
${w}`}class Et extends Error{constructor({message:e,code:t,cause:r,name:s}){var i;super(e,{cause:r}),this.__isWebAuthnError=!0,this.name=(i=s??(r instanceof Error?r.name:void 0))!==null&&i!==void 0?i:"Unknown Error",this.code=t}}class qg extends Et{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}function lK({error:n,options:e}){var t,r,s;const{publicKey:i}=e;if(!i)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Et({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else if(n.name==="ConstraintError"){if(((t=i.authenticatorSelection)===null||t===void 0?void 0:t.requireResidentKey)===!0)return new Et({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:n});if(e.mediation==="conditional"&&((r=i.authenticatorSelection)===null||r===void 0?void 0:r.userVerification)==="required")return new Et({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:n});if(((s=i.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new Et({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:n})}else{if(n.name==="InvalidStateError")return new Et({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:n});if(n.name==="NotAllowedError")return new Et({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="NotSupportedError")return i.pubKeyCredParams.filter(a=>a.type==="public-key").length===0?new Et({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:n}):new Et({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:n});if(n.name==="SecurityError"){const o=window.location.hostname;if(Kj(o)){if(i.rp.id!==o)return new Et({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new Et({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new Et({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:n})}else if(n.name==="UnknownError")return new Et({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new Et({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}function cK({error:n,options:e}){const{publicKey:t}=e;if(!t)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Et({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else{if(n.name==="NotAllowedError")return new Et({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="SecurityError"){const r=window.location.hostname;if(Kj(r)){if(t.rpId!==r)return new Et({message:`The RP ID "${t.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new Et({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="UnknownError")return new Et({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new Et({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}class uK{createNewAbortSignal(){if(this.controller){const t=new Error("Cancelling existing WebAuthn API call for new one");t.name="AbortError",this.controller.abort(t)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const hK=new uK;function dK(n){if(!n)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(n);const{challenge:e,user:t,excludeCredentials:r}=n,s=Vo(n,["challenge","user","excludeCredentials"]),i=Zl(e).buffer,o=Object.assign(Object.assign({},t),{id:Zl(t.id).buffer}),a=Object.assign(Object.assign({},s),{challenge:i,user:o});if(r&&r.length>0){a.excludeCredentials=new Array(r.length);for(let l=0;l<r.length;l++){const c=r[l];a.excludeCredentials[l]=Object.assign(Object.assign({},c),{id:Zl(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return a}function fK(n){if(!n)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(n);const{challenge:e,allowCredentials:t}=n,r=Vo(n,["challenge","allowCredentials"]),s=Zl(e).buffer,i=Object.assign(Object.assign({},r),{challenge:s});if(t&&t.length>0){i.allowCredentials=new Array(t.length);for(let o=0;o<t.length;o++){const a=t[o];i.allowCredentials[o]=Object.assign(Object.assign({},a),{id:Zl(a.id).buffer,type:a.type||"public-key",transports:a.transports})}}return i}function pK(n){var e;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();const t=n;return{id:n.id,rawId:n.id,response:{attestationObject:da(new Uint8Array(n.response.attestationObject)),clientDataJSON:da(new Uint8Array(n.response.clientDataJSON))},type:"public-key",clientExtensionResults:n.getClientExtensionResults(),authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function gK(n){var e;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();const t=n,r=n.getClientExtensionResults(),s=n.response;return{id:n.id,rawId:n.id,response:{authenticatorData:da(new Uint8Array(s.authenticatorData)),clientDataJSON:da(new Uint8Array(s.clientDataJSON)),signature:da(new Uint8Array(s.signature)),userHandle:s.userHandle?da(new Uint8Array(s.userHandle)):void 0},type:"public-key",clientExtensionResults:r,authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function Kj(n){return n==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(n)}function tk(){var n,e;return!!(Ht()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((n=navigator==null?void 0:navigator.credentials)===null||n===void 0?void 0:n.create)=="function"&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.get)=="function")}async function mK(n){try{const e=await navigator.credentials.create(n);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new qg("Browser returned unexpected credential type",e)}:{data:null,error:new qg("Empty credential response",e)}}catch(e){return{data:null,error:lK({error:e,options:n})}}}async function yK(n){try{const e=await navigator.credentials.get(n);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new qg("Browser returned unexpected credential type",e)}:{data:null,error:new qg("Empty credential response",e)}}catch(e){return{data:null,error:cK({error:e,options:n})}}}const vK={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},wK={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Gg(...n){const e=s=>s!==null&&typeof s=="object"&&!Array.isArray(s),t=s=>s instanceof ArrayBuffer||ArrayBuffer.isView(s),r={};for(const s of n)if(s)for(const i in s){const o=s[i];if(o!==void 0)if(Array.isArray(o))r[i]=o;else if(t(o))r[i]=o;else if(e(o)){const a=r[i];e(a)?r[i]=Gg(a,o):r[i]=Gg(o)}else r[i]=o}return r}function _K(n,e){return Gg(vK,n,e||{})}function xK(n,e){return Gg(wK,n,e||{})}class bK{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:t,friendlyName:r,signal:s},i){try{const{data:o,error:a}=await this.client.mfa.challenge({factorId:e,webauthn:t});if(!o)return{data:null,error:a};const l=s??hK.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:c}=o.webauthn.credential_options.publicKey;c.name||(c.name=`${c.id}:${r}`),c.displayName||(c.displayName=c.name)}switch(o.webauthn.type){case"create":{const c=_K(o.webauthn.credential_options.publicKey,i==null?void 0:i.create),{data:u,error:h}=await mK({publicKey:c,signal:l});return u?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:u}},error:null}:{data:null,error:h}}case"request":{const c=xK(o.webauthn.credential_options.publicKey,i==null?void 0:i.request),{data:u,error:h}=await yK(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:c,signal:l}));return u?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:u}},error:null}:{data:null,error:h}}}}catch(o){return le(o)?{data:null,error:o}:{data:null,error:new ia("Unexpected error in challenge",o)}}}async _verify({challengeId:e,factorId:t,webauthn:r}){return this.client.mfa.verify({factorId:t,challengeId:e,webauthn:r})}async _authenticate({factorId:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:r=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},i){if(!t)return{data:null,error:new Qh("rpId is required for WebAuthn authentication")};try{if(!tk())return{data:null,error:new ia("Browser does not support WebAuthn",null)};const{data:o,error:a}=await this.challenge({factorId:e,webauthn:{rpId:t,rpOrigins:r},signal:s},{request:i});if(!o)return{data:null,error:a};const{webauthn:l}=o;return this._verify({factorId:e,challengeId:o.challengeId,webauthn:{type:l.type,rpId:t,rpOrigins:r,credential_response:l.credential_response}})}catch(o){return le(o)?{data:null,error:o}:{data:null,error:new ia("Unexpected error in authenticate",o)}}}async _register({friendlyName:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:r=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},i){if(!t)return{data:null,error:new Qh("rpId is required for WebAuthn registration")};try{if(!tk())return{data:null,error:new ia("Browser does not support WebAuthn",null)};const{data:o,error:a}=await this._enroll({friendlyName:e});if(!o)return await this.client.mfa.listFactors().then(u=>{var h;return(h=u.data)===null||h===void 0?void 0:h.all.find(f=>f.factor_type==="webauthn"&&f.friendly_name===e&&f.status!=="unverified")}).then(u=>u?this.client.mfa.unenroll({factorId:u==null?void 0:u.id}):void 0),{data:null,error:a};const{data:l,error:c}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:t,rpOrigins:r},signal:s},{create:i});return l?this._verify({factorId:o.id,challengeId:l.challengeId,webauthn:{rpId:t,rpOrigins:r,type:l.webauthn.type,credential_response:l.webauthn.credential_response}}):{data:null,error:c}}catch(o){return le(o)?{data:null,error:o}:{data:null,error:new ia("Unexpected error in register",o)}}}}sK();const SK={url:wG,storageKey:_G,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:xG,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function nk(n,e,t){return await t()}const ul={};class Jh{get jwks(){var e,t;return(t=(e=ul[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){ul[this.storageKey]=Object.assign(Object.assign({},ul[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=ul[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){ul[this.storageKey]=Object.assign(Object.assign({},ul[this.storageKey]),{cachedAt:e})}constructor(e){var t,r,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const i=Object.assign(Object.assign({},SK),e);if(this.storageKey=i.storageKey,this.instanceID=(t=Jh.nextInstanceID[this.storageKey])!==null&&t!==void 0?t:0,Jh.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.instanceID>0&&Ht()){const o=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(o),this.logDebugMessages&&console.trace(o)}if(this.persistSession=i.persistSession,this.autoRefreshToken=i.autoRefreshToken,this.admin=new tK({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=Hj(i.fetch),this.lock=i.lock||nk,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,this.throwOnError=i.throwOnError,i.lock?this.lock=i.lock:Ht()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=rK:this.lock=nk,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new bK(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:Wj()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=ek(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=ek(this.memoryStorage)),Ht()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${$j}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let t={},r="none";if(Ht()&&(t=DG(window.location.href),this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce")),Ht()&&this.detectSessionInUrl&&r!=="none"){const{data:s,error:i}=await this._getSessionFromURL(t,r);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),kG(i)){const l=(e=i.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:a}=s;return this._debug("#_initialize()","detected session in URL",o,"redirect type",a),await this._saveSession(o),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return le(t)?this._returnResult({error:t}):this._returnResult({error:new ia("Unexpected error during initialization",t)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,s;try{const i=await pe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(s=e==null?void 0:e.options)===null||s===void 0?void 0:s.captchaToken}},xform:kr}),{data:o,error:a}=i;if(a||!o)return this._returnResult({data:{user:null,session:null},error:a});const l=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(i){if(le(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signUp(e){var t,r,s;try{let i;if("email"in e){const{email:u,password:h,options:f}=e;let p=null,y=null;this.flowType==="pkce"&&([p,y]=await al(this.storage,this.storageKey)),i=await pe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:u,password:h,data:(t=f==null?void 0:f.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:p,code_challenge_method:y},xform:kr})}else if("phone"in e){const{phone:u,password:h,options:f}=e;i=await pe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(r=f==null?void 0:f.data)!==null&&r!==void 0?r:{},channel:(s=f==null?void 0:f.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:kr})}else throw new Lf("You must provide either an email or phone number and a password");const{data:o,error:a}=i;if(a||!o)return this._returnResult({data:{user:null,session:null},error:a});const l=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(i){if(le(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithPassword(e){try{let t;if("email"in e){const{email:i,password:o,options:a}=e;t=await pe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:JC})}else if("phone"in e){const{phone:i,password:o,options:a}=e;t=await pe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:JC})}else throw new Lf("You must provide either an email or phone number and a password");const{data:r,error:s}=t;if(s)return this._returnResult({data:{user:null,session:null},error:s});if(!r||!r.session||!r.user){const i=new ol;return this._returnResult({data:{user:null,session:null},error:i})}return r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),this._returnResult({data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:s})}catch(t){if(le(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOAuth(e){var t,r,s,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}}async signInWithEthereum(e){var t,r,s,i,o,a,l,c,u,h,f;let p,y;if("message"in e)p=e.message,y=e.signature;else{const{chain:m,wallet:v,statement:w,options:_}=e;let x;if(Ht())if(typeof v=="object")x=v;else{const P=window;if("ethereum"in P&&typeof P.ethereum=="object"&&"request"in P.ethereum&&typeof P.ethereum.request=="function")x=P.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof v!="object"||!(_!=null&&_.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");x=v}const A=new URL((t=_==null?void 0:_.url)!==null&&t!==void 0?t:window.location.href),j=await x.request({method:"eth_requestAccounts"}).then(P=>P).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!j||j.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const N=Gj(j[0]);let S=(r=_==null?void 0:_.signInWithEthereum)===null||r===void 0?void 0:r.chainId;if(!S){const P=await x.request({method:"eth_chainId"});S=iK(P)}const T={domain:A.host,address:N,statement:w,uri:A.href,version:"1",chainId:S,nonce:(s=_==null?void 0:_.signInWithEthereum)===null||s===void 0?void 0:s.nonce,issuedAt:(o=(i=_==null?void 0:_.signInWithEthereum)===null||i===void 0?void 0:i.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(a=_==null?void 0:_.signInWithEthereum)===null||a===void 0?void 0:a.expirationTime,notBefore:(l=_==null?void 0:_.signInWithEthereum)===null||l===void 0?void 0:l.notBefore,requestId:(c=_==null?void 0:_.signInWithEthereum)===null||c===void 0?void 0:c.requestId,resources:(u=_==null?void 0:_.signInWithEthereum)===null||u===void 0?void 0:u.resources};p=aK(T),y=await x.request({method:"personal_sign",params:[oK(p),N]})}try{const{data:m,error:v}=await pe(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:p,signature:y},!((h=e.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(f=e.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:kr});if(v)throw v;if(!m||!m.session||!m.user){const w=new ol;return this._returnResult({data:{user:null,session:null},error:w})}return m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),this._returnResult({data:Object.assign({},m),error:v})}catch(m){if(le(m))return this._returnResult({data:{user:null,session:null},error:m});throw m}}async signInWithSolana(e){var t,r,s,i,o,a,l,c,u,h,f,p;let y,m;if("message"in e)y=e.message,m=e.signature;else{const{chain:v,wallet:w,statement:_,options:x}=e;let A;if(Ht())if(typeof w=="object")A=w;else{const N=window;if("solana"in N&&typeof N.solana=="object"&&("signIn"in N.solana&&typeof N.solana.signIn=="function"||"signMessage"in N.solana&&typeof N.solana.signMessage=="function"))A=N.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof w!="object"||!(x!=null&&x.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");A=w}const j=new URL((t=x==null?void 0:x.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in A&&A.signIn){const N=await A.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},x==null?void 0:x.signInWithSolana),{version:"1",domain:j.host,uri:j.href}),_?{statement:_}:null));let S;if(Array.isArray(N)&&N[0]&&typeof N[0]=="object")S=N[0];else if(N&&typeof N=="object"&&"signedMessage"in N&&"signature"in N)S=N;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in S&&"signature"in S&&(typeof S.signedMessage=="string"||S.signedMessage instanceof Uint8Array)&&S.signature instanceof Uint8Array)y=typeof S.signedMessage=="string"?S.signedMessage:new TextDecoder().decode(S.signedMessage),m=S.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in A)||typeof A.signMessage!="function"||!("publicKey"in A)||typeof A!="object"||!A.publicKey||!("toBase58"in A.publicKey)||typeof A.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");y=[`${j.host} wants you to sign in with your Solana account:`,A.publicKey.toBase58(),..._?["",_,""]:[""],"Version: 1",`URI: ${j.href}`,`Issued At: ${(s=(r=x==null?void 0:x.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((i=x==null?void 0:x.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${x.signInWithSolana.notBefore}`]:[],...!((o=x==null?void 0:x.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${x.signInWithSolana.expirationTime}`]:[],...!((a=x==null?void 0:x.signInWithSolana)===null||a===void 0)&&a.chainId?[`Chain ID: ${x.signInWithSolana.chainId}`]:[],...!((l=x==null?void 0:x.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${x.signInWithSolana.nonce}`]:[],...!((c=x==null?void 0:x.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${x.signInWithSolana.requestId}`]:[],...!((h=(u=x==null?void 0:x.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||h===void 0)&&h.length?["Resources",...x.signInWithSolana.resources.map(S=>`- ${S}`)]:[]].join(`
`);const N=await A.signMessage(new TextEncoder().encode(y),"utf8");if(!N||!(N instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=N}}try{const{data:v,error:w}=await pe(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:y,signature:da(m)},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(p=e.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:kr});if(w)throw w;if(!v||!v.session||!v.user){const _=new ol;return this._returnResult({data:{user:null,session:null},error:_})}return v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("SIGNED_IN",v.session)),this._returnResult({data:Object.assign({},v),error:w})}catch(v){if(le(v))return this._returnResult({data:{user:null,session:null},error:v});throw v}}async _exchangeCodeForSession(e){const t=await Jo(this.storage,`${this.storageKey}-code-verifier`),[r,s]=(t??"").split("/");try{const{data:i,error:o}=await pe(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:kr});if(await Ni(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!i||!i.session||!i.user){const a=new ol;return this._returnResult({data:{user:null,session:null,redirectType:null},error:a})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:o})}catch(i){if(le(i))return this._returnResult({data:{user:null,session:null,redirectType:null},error:i});throw i}}async signInWithIdToken(e){try{const{options:t,provider:r,token:s,access_token:i,nonce:o}=e,a=await pe(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:s,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:kr}),{data:l,error:c}=a;if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l||!l.session||!l.user){const u=new ol;return this._returnResult({data:{user:null,session:null},error:u})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:l,error:c})}catch(t){if(le(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOtp(e){var t,r,s,i,o;try{if("email"in e){const{email:a,options:l}=e;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await al(this.storage,this.storageKey));const{error:h}=await pe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(t=l==null?void 0:l.data)!==null&&t!==void 0?t:{},create_user:(r=l==null?void 0:l.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l==null?void 0:l.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:h})}if("phone"in e){const{phone:a,options:l}=e,{data:c,error:u}=await pe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(s=l==null?void 0:l.data)!==null&&s!==void 0?s:{},create_user:(i=l==null?void 0:l.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(o=l==null?void 0:l.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u})}throw new Lf("You must provide either an email or phone number.")}catch(a){if(le(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async verifyOtp(e){var t,r;try{let s,i;"options"in e&&(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo,i=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:o,error:a}=await pe(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:kr});if(a)throw a;if(!o)throw new Error("An error occurred on token verification.");const l=o.session,c=o.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(s){if(le(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithSSO(e){var t,r,s,i,o;try{let a=null,l=null;this.flowType==="pkce"&&([a,l]=await al(this.storage,this.storageKey));const c=await pe(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&r!==void 0?r:void 0}),!((s=e==null?void 0:e.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:l}),headers:this.headers,xform:JG});return!((i=c.data)===null||i===void 0)&&i.url&&Ht()&&!(!((o=e.options)===null||o===void 0)&&o.skipBrowserRedirect)&&window.location.assign(c.data.url),this._returnResult(c)}catch(a){if(le(a))return this._returnResult({data:null,error:a});throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new zn;const{error:s}=await pe(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return this._returnResult({data:{user:null,session:null},error:s})})}catch(e){if(le(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:r,type:s,options:i}=e,{error:o}=await pe(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in e){const{phone:r,type:s,options:i}=e,{data:o,error:a}=await pe(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:a})}throw new Lf("You must provide either an email or phone number and a type")}catch(t){if(le(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await r,await t()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=t();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await Jo(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<$v:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const o=await Jo(this.userStorage,this.storageKey+"-user");o!=null&&o.user?e.user=o.user:e.user=Wv()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};e.user=KG(e.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{session:null},error:i}):this._returnResult({data:{session:s},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await pe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Gi}):await this._useSession(async t=>{var r,s,i;const{data:o,error:a}=t;if(a)throw a;return!(!((r=o.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new zn}:await pe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:Gi})})}catch(t){if(le(t))return CG(t)&&(await this._removeSession(),await Ni(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:t});throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{const{data:s,error:i}=r;if(i)throw i;if(!s.session)throw new zn;const o=s.session;let a=null,l=null;this.flowType==="pkce"&&e.email!=null&&([a,l]=await al(this.storage,this.storageKey));const{data:c,error:u}=await pe(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:l}),jwt:o.access_token,xform:Gi});if(u)throw u;return o.user=c.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(r){if(le(r))return this._returnResult({data:{user:null},error:r});throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new zn;const t=Date.now()/1e3;let r=t,s=!0,i=null;const{payload:o}=zv(e.access_token);if(o.exp&&(r=o.exp,s=r<=t),s){const{data:a,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return this._returnResult({data:{user:null,session:null},error:l});if(!a)return{data:{user:null,session:null},error:null};i=a}else{const{data:a,error:l}=await this._getUser(e.access_token);if(l)throw l;i={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return this._returnResult({data:{user:i.user,session:i},error:null})}catch(t){if(le(t))return this._returnResult({data:{session:null,user:null},error:t});throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:o,error:a}=t;if(a)throw a;e=(r=o.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new zn;const{data:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{user:null,session:null},error:i}):s?this._returnResult({data:{user:s.user,session:s},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(t){if(le(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async _getSessionFromURL(e,t){try{if(!Ht())throw new Ff("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Ff(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new HC("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ff("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new HC("No code detected.");const{data:_,error:x}=await this._exchangeCodeForSession(e.code);if(x)throw x;const A=new URL(window.location.href);return A.searchParams.delete("code"),window.history.replaceState(window.history.state,"",A.toString()),{data:{session:_.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:s,access_token:i,refresh_token:o,expires_in:a,expires_at:l,token_type:c}=e;if(!i||!a||!o||!c)throw new Ff("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(a);let f=u+h;l&&(f=parseInt(l));const p=f-u;p*1e3<=_l&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${h}s`);const y=f-h;u-y>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",y,f,u):u-y<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",y,f,u);const{data:m,error:v}=await this._getUser(i);if(v)throw v;const w={provider_token:r,provider_refresh_token:s,access_token:i,expires_in:h,expires_at:f,refresh_token:o,token_type:c,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:w,redirectType:e.type},error:null})}catch(r){if(le(r))return this._returnResult({data:{session:null,redirectType:null},error:r});throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Jo(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;const{data:s,error:i}=t;if(i)return this._returnResult({error:i});const o=(r=s.session)===null||r===void 0?void 0:r.access_token;if(o){const{error:a}=await this.admin.signOut(o,e);if(a&&!(TG(a)&&(a.status===404||a.status===401||a.status===403)))return this._returnResult({error:a})}return e!=="others"&&(await this._removeSession(),await Ni(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const t=jG(),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,s;try{const{data:{session:i},error:o}=t;if(o)throw o;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,t={}){let r=null,s=null;this.flowType==="pkce"&&([r,s]=await al(this.storage,this.storageKey,!0));try{return await pe(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:s,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(i){if(le(i))return this._returnResult({data:null,error:i});throw i}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return this._returnResult({data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(t){if(le(t))return this._returnResult({data:null,error:t});throw t}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{const{data:r,error:s}=await this._useSession(async i=>{var o,a,l,c,u;const{data:h,error:f}=i;if(f)throw f;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await pe(this.fetch,"GET",p,{headers:this.headers,jwt:(u=(c=h.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(s)throw s;return Ht()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),this._returnResult({data:{provider:e.provider,url:r==null?void 0:r.url},error:null})}catch(r){if(le(r))return this._returnResult({data:{provider:e.provider,url:null},error:r});throw r}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var r;try{const{error:s,data:{session:i}}=t;if(s)throw s;const{options:o,provider:a,token:l,access_token:c,nonce:u}=e,h=await pe(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(r=i==null?void 0:i.access_token)!==null&&r!==void 0?r:void 0,body:{provider:a,id_token:l,access_token:c,nonce:u,link_identity:!0,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:kr}),{data:f,error:p}=h;return p?this._returnResult({data:{user:null,session:null},error:p}):!f||!f.session||!f.user?this._returnResult({data:{user:null,session:null},error:new ol}):(f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("USER_UPDATED",f.session)),this._returnResult({data:f,error:p}))}catch(s){if(le(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,s;const{data:i,error:o}=t;if(o)throw o;return await pe(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(r=i.session)===null||r===void 0?void 0:r.access_token)!==null&&s!==void 0?s:void 0})})}catch(t){if(le(t))return this._returnResult({data:null,error:t});throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const r=Date.now();return await FG(async s=>(s>0&&await LG(200*Math.pow(2,s-1)),this._debug(t,"refreshing attempt",s),await pe(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:kr})),(s,i)=>{const o=200*Math.pow(2,s);return i&&Bv(i)&&Date.now()+o-r<_l})}catch(r){if(this._debug(t,"error",r),le(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),Ht()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const s=await Jo(this.storage,this.storageKey);if(s&&this.userStorage){let o=await Jo(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:s.user},await xl(this.userStorage,this.storageKey+"-user",o)),s.user=(e=o==null?void 0:o.user)!==null&&e!==void 0?e:Wv()}else if(s&&!s.user&&!s.user){const o=await Jo(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(s.user=o.user,await Ni(this.storage,this.storageKey+"-user"),await xl(this.storage,this.storageKey,s)):s.user=Wv()}if(this._debug(r,"session from storage",s),!this._isValidSession(s)){this._debug(r,"session is not valid"),s!==null&&await this._removeSession();return}const i=((t=s.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<$v;if(this._debug(r,`session has${i?"":" not"} expired with margin of ${$v}s`),i){if(this.autoRefreshToken&&s.refresh_token){const{error:o}=await this._callRefreshToken(s.refresh_token);o&&(console.error(o),Bv(o)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:a}=await this._getUser(s.access_token);!a&&(o!=null&&o.user)?(s.user=o.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(r,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(r,"error",s),console.error(s);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new zn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new cy;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new zn;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const a={data:i.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(i){if(this._debug(s,"error",i),le(i)){const o={data:null,error:i};return Bv(i)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(o),o}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,t,r=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,t)}catch(l){i.push(l)}});if(await Promise.all(o),i.length>0){for(let a=0;a<i.length;a+=1)console.error(i[a]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),r=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&t.user&&await xl(this.userStorage,this.storageKey+"-user",{user:t.user});const s=Object.assign({},t);delete s.user;const i=XC(s);await xl(this.storage,this.storageKey,i)}else{const s=XC(t);await xl(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),await Ni(this.storage,this.storageKey),await Ni(this.storage,this.storageKey+"-code-verifier"),await Ni(this.storage,this.storageKey+"-user"),this.userStorage&&await Ni(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Ht()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),_l);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((r.expires_at*1e3-e)/_l);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${_l}ms, refresh threshold is ${o_} ticks`),s<=o_&&await this._callRefreshToken(r.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof qj)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Ht()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const s=[`provider=${encodeURIComponent(t)}`];if(r!=null&&r.redirectTo&&s.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&s.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[i,o]=await al(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});s.push(a.toString())}if(r!=null&&r.queryParams){const i=new URLSearchParams(r.queryParams);s.push(i.toString())}return r!=null&&r.skipBrowserRedirect&&s.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:s,error:i}=t;return i?this._returnResult({data:null,error:i}):await pe(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(le(t))return this._returnResult({data:null,error:t});throw t}}async _enroll(e){try{return await this._useSession(async t=>{var r,s;const{data:i,error:o}=t;if(o)return this._returnResult({data:null,error:o});const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:l,error:c}=await pe(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return c?this._returnResult({data:null,error:c}):(e.factorType==="totp"&&l.type==="totp"&&(!((s=l==null?void 0:l.totp)===null||s===void 0)&&s.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),this._returnResult({data:l,error:null}))})}catch(t){if(le(t))return this._returnResult({data:null,error:t});throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:s,error:i}=t;if(i)return this._returnResult({data:null,error:i});const o=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?pK(e.webauthn.credential_response):gK(e.webauthn.credential_response)})}:{code:e.code}),{data:a,error:l}=await pe(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:o,headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});return l?this._returnResult({data:null,error:l}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),this._returnResult({data:a,error:l}))})}catch(t){if(le(t))return this._returnResult({data:null,error:t});throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:s,error:i}=t;if(i)return this._returnResult({data:null,error:i});const o=await pe(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});if(o.error)return o;const{data:a}=o;if(a.type!=="webauthn")return{data:a,error:null};switch(a.webauthn.type){case"create":return{data:Object.assign(Object.assign({},a),{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_options:Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:dK(a.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},a),{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_options:Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:fK(a.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if(le(t))return this._returnResult({data:null,error:t});throw t}})}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?this._returnResult({data:null,error:r}):await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const s={all:[],phone:[],totp:[],webauthn:[]};for(const i of(e=t==null?void 0:t.factors)!==null&&e!==void 0?e:[])s.all.push(i),i.status==="verified"&&s[i.factor_type].push(i);return{data:s,error:null}}async _getAuthenticatorAssuranceLevel(){var e,t;const{data:{session:r},error:s}=await this.getSession();if(s)return this._returnResult({data:null,error:s});if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=zv(r.access_token);let o=null;i.aal&&(o=i.aal);let a=o;((t=(e=r.user.factors)===null||e===void 0?void 0:e.filter(u=>u.status==="verified"))!==null&&t!==void 0?t:[]).length>0&&(a="aal2");const c=i.amr||[];return{data:{currentLevel:o,nextLevel:a,currentAuthenticationMethods:c},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async t=>{const{data:{session:r},error:s}=t;return s?this._returnResult({data:null,error:s}):r?await pe(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:r.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new zn})})}catch(t){if(le(t))return this._returnResult({data:null,error:t});throw t}}async _approveAuthorization(e,t){try{return await this._useSession(async r=>{const{data:{session:s},error:i}=r;if(i)return this._returnResult({data:null,error:i});if(!s)return this._returnResult({data:null,error:new zn});const o=await pe(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"approve"},xform:a=>({data:a,error:null})});return o.data&&o.data.redirect_url&&Ht()&&!(t!=null&&t.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(r){if(le(r))return this._returnResult({data:null,error:r});throw r}}async _denyAuthorization(e,t){try{return await this._useSession(async r=>{const{data:{session:s},error:i}=r;if(i)return this._returnResult({data:null,error:i});if(!s)return this._returnResult({data:null,error:new zn});const o=await pe(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"deny"},xform:a=>({data:a,error:null})});return o.data&&o.data.redirect_url&&Ht()&&!(t!=null&&t.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(r){if(le(r))return this._returnResult({data:null,error:r});throw r}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;return r?this._returnResult({data:null,error:r}):t?await pe(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:t.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new zn})})}catch(e){if(le(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async t=>{const{data:{session:r},error:s}=t;return s?this._returnResult({data:null,error:s}):r?(await pe(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new zn})})}catch(t){if(le(t))return this._returnResult({data:null,error:t});throw t}}async fetchJwk(e,t={keys:[]}){let r=t.keys.find(a=>a.kid===e);if(r)return r;const s=Date.now();if(r=this.jwks.keys.find(a=>a.kid===e),r&&this.jwks_cached_at+SG>s)return r;const{data:i,error:o}=await pe(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=s,r=i.keys.find(a=>a.kid===e),!r)?null:r}async getClaims(e,t={}){try{let r=e;if(!r){const{data:p,error:y}=await this.getSession();if(y||!p.session)return this._returnResult({data:null,error:y});r=p.session.access_token}const{header:s,payload:i,signature:o,raw:{header:a,payload:l}}=zv(r);t!=null&&t.allowExpired||HG(i.exp);const c=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,t!=null&&t.keys?{keys:t.keys}:t==null?void 0:t.jwks);if(!c){const{error:p}=await this.getUser(r);if(p)throw p;return{data:{claims:i,header:s,signature:o},error:null}}const u=qG(s.alg),h=await crypto.subtle.importKey("jwk",c,u,!0,["verify"]);if(!await crypto.subtle.verify(u,h,o,OG(`${a}.${l}`)))throw new c_("Invalid JWT signature");return{data:{claims:i,header:s,signature:o},error:null}}catch(r){if(le(r))return this._returnResult({data:null,error:r});throw r}}}Jh.nextInstanceID={};const EK=Jh;class TK extends EK{constructor(e){super(e)}}class CK{constructor(e,t,r){var s,i,o;this.supabaseUrl=e,this.supabaseKey=t;const a=vG(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",a),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",a),this.storageUrl=new URL("storage/v1",a),this.functionsUrl=new URL("functions/v1",a);const l=`sb-${a.hostname.split(".")[0]}-auth-token`,c={db:uG,realtime:dG,auth:Object.assign(Object.assign({},hG),{storageKey:l}),global:cG},u=yG(r??{},c);this.storageKey=(s=u.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(i=u.global.headers)!==null&&i!==void 0?i:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(h,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=u.auth)!==null&&o!==void 0?o:{},this.headers,u.global.fetch),this.fetch=gG(t,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.accessToken&&this.accessToken().then(h=>this.realtime.setAuth(h)).catch(h=>console.warn("Failed to set initial Realtime auth token:",h)),this.rest=new dq(new URL("rest/v1",a).href,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),this.storage=new oG(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),u.accessToken||this._listenForAuthEvents()}get functions(){return new cq(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e,t;if(this.accessToken)return await this.accessToken();const{data:r}=await this.auth.getSession();return(t=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,userStorage:i,storageKey:o,flowType:a,lock:l,debug:c,throwOnError:u},h,f){const p={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new TK({url:this.authUrl.href,headers:Object.assign(Object.assign({},p),h),storageKey:o,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,userStorage:i,flowType:a,lock:l,debug:c,throwOnError:u,fetch:f,hasCustomAuthorizationHeader:Object.keys(this.headers).some(y=>y.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new Pq(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,r)=>{this._handleTokenChanged(t,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const kK=(n,e,t)=>new CK(n,e,t);function AK(){if(typeof window<"u"||typeof process>"u")return!1;const n=process.version;if(n==null)return!1;const e=n.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}AK()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const PK="https://plnzcqokenskmeglclis.supabase.co",IK="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBsbnpjcW9rZW5za21lZ2xjbGlzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQyNzA0NDQsImV4cCI6MjA3OTg0NjQ0NH0.bV3qNSkr0aumjzEa5q9LaVg9cz0itYxRi2PZyfhLlFo",RK=kK(PK,IK,{auth:{storage:localStorage,persistSession:!0,autoRefreshToken:!0}}),OK=()=>{var j;const[n,e]=C.useState(null),[t,r]=C.useState(!1),[s,i]=C.useState(null),[o,a]=C.useState([]),[l,c]=C.useState(!0),[u,h]=C.useState(""),f=yi(),{toast:p}=jo(),{user:y,signOut:m}=Is();C.useEffect(()=>{const N=async()=>{if(y)try{const T=Qn(_n,"users",y.uid),P=await iy(T);P.exists()&&i(P.data())}catch(T){console.error("Error fetching teacher data:",T)}},S=async()=>{if(!y){console.log("FetchLessons: No user logged in");return}c(!0);try{console.log("FetchLessons: Fetching lessons for user:",y.uid);const T=q7(Rb(_n,"lessons"),G7("userId","==",y.uid)),P=await BN(T);console.log("FetchLessons: Snapshot size:",P.size);const R=[];P.forEach(D=>{const I=D.data();R.push({id:D.id,...I})}),R.sort((D,I)=>{var K,G;const k=(K=D.createdAt)!=null&&K.toDate?D.createdAt.toDate().getTime():new Date(D.createdAt||0).getTime();return((G=I.createdAt)!=null&&G.toDate?I.createdAt.toDate().getTime():new Date(I.createdAt||0).getTime())-k}),console.log("FetchLessons: Final processed lessons:",R.length),a(R)}catch(T){console.error("FetchLessons: Error fetching lessons:",T),p({title:"   ",description:T.message,variant:"destructive"})}finally{c(!1)}};N(),S()},[y]);const v=async(N,S)=>{if(N.stopPropagation(),!!confirm("      "))try{await zN(Qn(_n,"lessons",S)),a(o.filter(T=>T.id!==S)),p({title:" ",description:"   "})}catch{p({title:"",description:"  ",variant:"destructive"})}},w=o.filter(N=>{var S,T;return((S=N.title)==null?void 0:S.toLowerCase().includes(u.toLowerCase()))||((T=N.subject)==null?void 0:T.toLowerCase().includes(u.toLowerCase()))}),_=N=>{N.target.files&&e(N.target.files)},x=async()=>{try{await m(),p({title:"  ",description:" !"}),f("/login")}catch{p({title:"",description:"    ",variant:"destructive"})}},A=async()=>{if(!n||n.length===0){p({title:"",description:"    ",variant:"destructive"});return}r(!0);try{const N=new FormData;Array.from(n).forEach(P=>{N.append("files",P)});const{data:S,error:T}=await RK.functions.invoke("process-lesson",{body:N});if(T)throw T;p({title:"!",description:"   "}),f("/preparation",{state:{lessonData:S}})}catch(N){console.error("Upload error:",N),p({title:"",description:"    ",variant:"destructive"})}finally{r(!1)}};return console.log("Index page - teacherData:",s,"role:",s==null?void 0:s.role),g.jsxs("div",{className:"min-h-screen bg-[#f8fafc] text-slate-900",children:[g.jsx("nav",{className:"sticky top-0 z-50 glass border-b border-slate-200/50 backdrop-blur-md",children:g.jsxs("div",{className:"container mx-auto px-4 h-16 flex items-center justify-between",children:[g.jsxs("div",{className:"flex items-center gap-2 group cursor-pointer",onClick:()=>f("/"),children:[g.jsx("div",{className:"w-10 h-10 rounded-xl bg-primary flex items-center justify-center shadow-lg shadow-primary/20 group-hover:scale-105 transition-transform",children:g.jsx(mg,{className:"h-6 w-6 text-white"})}),g.jsx("span",{className:"text-xl font-bold bg-gradient-to-r from-slate-900 to-slate-600 bg-clip-text text-transparent hidden sm:block",children:" "})]}),g.jsxs("div",{className:"flex items-center gap-3",children:[((s==null?void 0:s.role)==="admin"||(y==null?void 0:y.email)==="mahmoudgadmostafa@gmail.com")&&g.jsxs(ae,{variant:"ghost",onClick:()=>f("/admin"),className:"gap-2 text-indigo-600 hover:bg-indigo-50 font-medium",children:[g.jsx(Na,{className:"h-4 w-4"}),g.jsx("span",{className:"hidden sm:inline",children:" "})]}),g.jsx("div",{className:"h-6 w-px bg-slate-200 mx-1 hidden sm:block"}),g.jsxs(ae,{variant:"ghost",onClick:x,className:"gap-2 text-rose-600 hover:bg-rose-50 font-medium",children:[g.jsx(Cm,{className:"h-4 w-4"}),g.jsx("span",{className:"hidden sm:inline",children:""})]})]})]})}),g.jsxs("header",{className:"relative pt-12 pb-20 overflow-hidden",children:[g.jsx("div",{className:"absolute top-0 right-0 -translate-y-1/2 translate-x-1/4 w-[500px] h-[500px] bg-primary/5 rounded-full blur-[100px] pointer-events-none"}),g.jsx("div",{className:"absolute bottom-0 left-0 translate-y-1/2 -translate-x-1/4 w-[400px] h-[400px] bg-accent/5 rounded-full blur-[80px] pointer-events-none"}),g.jsx("div",{className:"container mx-auto px-4 relative",children:g.jsxs("div",{className:"max-w-5xl mx-auto flex flex-col items-center text-center",children:[g.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-primary/10 text-primary text-xs font-bold mb-6 animate-fade-in",children:[g.jsx(Ui,{className:"h-3 w-3"}),"  "]}),g.jsxs("h1",{className:"text-4xl md:text-6xl font-extrabold tracking-tight text-slate-900 mb-6 text-balance leading-tight",children:["    ",g.jsxs("span",{className:"text-primary relative inline-block",children:[" ",g.jsx("svg",{className:"absolute -bottom-2 left-0 w-full",viewBox:"0 0 100 10",preserveAspectRatio:"none",children:g.jsx("path",{d:"M0 5 Q 25 0, 50 5 T 100 5",stroke:"currentColor",strokeWidth:"2",fill:"none",className:"opacity-30"})})]}),"  "]}),g.jsx("p",{className:"text-lg md:text-xl text-slate-600 mb-10 max-w-2xl text-balance",children:"          .    !"}),s&&g.jsxs("div",{className:"glass p-4 rounded-2xl flex flex-wrap items-center gap-4 border border-slate-200/50 shadow-xl mb-12",children:[g.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-primary to-blue-600 flex items-center justify-center text-white shadow-inner",children:g.jsx("span",{className:"text-xl font-bold",children:(j=s.teacherName)==null?void 0:j[0]})}),g.jsxs("div",{className:"text-right",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsxs("p",{className:"font-bold text-slate-900 leading-none",children:["/ ",s.teacherName]}),(s.role==="admin"||(y==null?void 0:y.email)==="mahmoudgadmostafa@gmail.com")&&g.jsxs("span",{className:"bg-indigo-100 text-indigo-700 px-2 py-0.5 rounded-full text-[10px] font-bold border border-indigo-200 flex items-center gap-1",children:[g.jsx(Na,{className:"h-2.5 w-2.5"}),""]})]}),g.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[": ",s.subject,"  ",s.phone]})]})]})]})})]}),g.jsxs("main",{className:"container mx-auto px-4 -mt-10 mb-24 relative z-10",children:[g.jsxs("div",{className:"max-w-6xl mx-auto grid lg:grid-cols-12 gap-8",children:[g.jsx("div",{className:"lg:col-span-12 xl:col-span-7",children:g.jsxs(Ta,{className:"border-none shadow-premium overflow-hidden bg-white h-full group transition-all duration-300",children:[g.jsx("div",{className:"h-2 w-full bg-gradient-to-r from-primary via-indigo-500 to-accent"}),g.jsxs(Pc,{className:"pt-8 px-8",children:[g.jsxs("div",{className:"flex items-center justify-between mb-4",children:[g.jsx("div",{className:"p-3 rounded-2xl bg-primary/5 text-primary group-hover:scale-110 transition-transform",children:g.jsx(bE,{className:"h-8 w-8"})}),g.jsx("div",{className:"text-left",children:g.jsx("span",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest",children:" 01"})})]}),g.jsx(Ic,{className:"text-2xl font-bold",children:"  "}),g.jsx(Od,{className:"text-slate-500 text-base",children:"         ."})]}),g.jsxs(Ca,{className:"p-8 pt-4 space-y-6",children:[g.jsxs("div",{className:`relative border-2 border-dashed rounded-3xl p-10 text-center transition-all duration-300 cursor-pointer
                    ${n&&n.length>0?"border-primary bg-primary/5":"border-slate-200 hover:border-primary/50 hover:bg-slate-50/50"}`,children:[g.jsx("input",{type:"file",multiple:!0,accept:".jpg,.jpeg,.png,.webp,.pdf,.doc,.docx,.txt",onChange:_,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",id:"dropzone-file"}),g.jsxs("div",{className:"flex flex-col items-center",children:[g.jsx("div",{className:"w-20 h-20 rounded-full bg-slate-100 flex items-center justify-center mb-4 group-hover:bg-primary/10 transition-colors",children:g.jsx(bE,{className:`h-10 w-10 ${n&&n.length>0?"text-primary":"text-slate-400"}`})}),g.jsx("p",{className:"text-xl font-bold text-slate-900 mb-2",children:n&&n.length>0?`  ${n.length} `:"     "}),g.jsx("div",{className:"flex flex-wrap justify-center gap-2 mt-4",children:["JPG","PNG","PDF","Word"].map(N=>g.jsx("span",{className:"text-[10px] font-bold px-2 py-1 rounded-md bg-white border border-slate-200 text-slate-500",children:N},N))})]})]}),n&&n.length>0&&g.jsxs("div",{className:"animate-in fade-in slide-in-from-bottom-2",children:[g.jsxs("div",{className:"flex items-center justify-between mb-3",children:[g.jsx("h4",{className:"text-sm font-bold text-slate-700",children:" "}),g.jsx(ae,{variant:"ghost",size:"sm",onClick:()=>e(null),className:"text-rose-500 h-7 text-xs font-bold",children:" "})]}),g.jsx("div",{className:"max-h-40 overflow-y-auto pr-2 space-y-2 scrollbar-thin",children:Array.from(n).map((N,S)=>g.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-xl bg-slate-50 border border-slate-100 hover:border-primary/20 transition-colors",children:[g.jsx("div",{className:"w-8 h-8 rounded-lg bg-white flex items-center justify-center shadow-sm",children:g.jsx(vf,{className:"h-4 w-4 text-primary"})}),g.jsx("span",{className:"text-xs font-bold text-slate-700 flex-1 truncate",children:N.name}),g.jsxs("span",{className:"text-[10px] font-bold text-slate-400",children:[(N.size/1024/1024).toFixed(1)," MB"]})]},S))})]}),g.jsx(ae,{onClick:A,disabled:!n||t,className:"w-full h-14 text-lg font-bold shadow-lg shadow-primary/20 hover:shadow-xl hover:shadow-primary/30 active:scale-[0.98] transition-all rounded-2xl gap-3",children:t?g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"h-5 w-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"  ..."]}):g.jsxs(g.Fragment,{children:[g.jsx(Ui,{className:"h-6 w-6"}),"  "]})})]})]})}),g.jsxs("div",{className:"lg:col-span-12 xl:col-span-5 space-y-6",children:[g.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-1 gap-4",children:[{icon:g.jsx(Ui,{className:"h-6 w-6"}),title:"  ",desc:"      ",color:"text-amber-600",bg:"bg-amber-50"},{icon:g.jsx(vf,{className:"h-6 w-6"}),title:"  ",desc:"     ",color:"text-blue-600",bg:"bg-blue-50"},{icon:g.jsx(XV,{className:"h-6 w-6"}),title:" ",desc:"      ",color:"text-indigo-600",bg:"bg-indigo-50"}].map((N,S)=>g.jsxs("div",{className:"flex gap-4 p-5 rounded-2xl bg-white shadow-sm border border-slate-100 hover:shadow-md transition-shadow group",children:[g.jsx("div",{className:`w-12 h-12 rounded-xl ${N.bg} ${N.color} flex items-center justify-center shrink-0 group-hover:scale-110 transition-transform`,children:N.icon}),g.jsxs("div",{children:[g.jsx("h4",{className:"font-bold text-slate-900 mb-1",children:N.title}),g.jsx("p",{className:"text-sm text-slate-500 leading-relaxed",children:N.desc})]})]},S))}),g.jsxs("div",{className:"p-6 rounded-3xl bg-slate-900 text-white relative overflow-hidden shadow-xl",children:[g.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-10",children:g.jsx(Ui,{className:"h-20 w-20"})}),g.jsxs("h4",{className:"text-lg font-bold mb-3 flex items-center gap-2",children:[g.jsx(Ui,{className:"h-5 w-5 text-yellow-400"})," "]}),g.jsxs("ul",{className:"space-y-3 text-slate-300 text-sm",children:[g.jsxs("li",{className:"flex gap-2",children:[g.jsx("span",{className:"text-yellow-400 font-bold",children:""}),"     ."]}),g.jsxs("li",{className:"flex gap-2",children:[g.jsx("span",{className:"text-yellow-400 font-bold",children:""}),"      ."]}),g.jsxs("li",{className:"flex gap-2",children:[g.jsx("span",{className:"text-yellow-400 font-bold",children:""}),"       ."]})]})]})]})]}),g.jsxs("div",{className:"max-w-6xl mx-auto mt-24",children:[g.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-6 mb-10",children:[g.jsxs("div",{children:[g.jsx("h2",{className:"text-3xl font-extrabold text-slate-900 mb-2",children:" "}),g.jsx("p",{className:"text-slate-500 font-medium",children:"     "})]}),g.jsxs("div",{className:"relative group",children:[g.jsx("div",{className:"absolute inset-y-0 right-0 pr-4 flex items-center pointer-events-none text-slate-400 group-focus-within:text-primary transition-colors",children:g.jsx(p5,{className:"h-5 w-5"})}),g.jsx("input",{type:"text",placeholder:"   ...",value:u,onChange:N=>h(N.target.value),className:"w-full md:w-80 h-14 pr-12 pl-6 rounded-2xl bg-white border border-slate-200 shadow-sm outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary transition-all font-medium text-slate-700"})]})]}),l?g.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3].map(N=>g.jsx("div",{className:"h-64 rounded-3xl bg-slate-200/50 animate-pulse border border-slate-100"},N))}):w.length>0?g.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 animate-in fade-in slide-in-from-bottom-6",children:w.map(N=>{var S;return g.jsxs("div",{onClick:()=>f("/preparation",{state:{lessonData:N,lessonId:N.id}}),className:"group relative bg-white rounded-3xl p-6 border border-slate-100 shadow-sm hover:shadow-xl hover:border-primary/20 transition-all duration-300 cursor-pointer overflow-hidden flex flex-col h-full",children:[g.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-0 group-hover:opacity-100 transition-all translate-y-2 group-hover:translate-y-0 z-20",children:g.jsx(ae,{size:"icon",variant:"destructive",className:"h-10 w-10 rounded-xl shadow-lg ring-4 ring-rose-500/10",onClick:T=>v(T,N.id),children:g.jsx(Rh,{className:"h-5 w-5"})})}),g.jsxs("div",{className:"flex-1",children:[g.jsx("div",{className:"w-14 h-14 rounded-2xl bg-slate-50 text-slate-400 group-hover:bg-primary/10 group-hover:text-primary flex items-center justify-center mb-6 transition-colors shadow-inner",children:g.jsx(vf,{className:"h-7 w-7"})}),g.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-2 line-clamp-1 group-hover:text-primary transition-colors",children:N.title}),g.jsxs("div",{className:"flex flex-wrap gap-2 mb-6",children:[g.jsx("span",{className:"px-3 py-1 rounded-lg bg-slate-50 text-slate-500 text-[10px] font-bold border border-slate-100",children:N.subject||" "}),N.className&&g.jsxs("span",{className:"px-3 py-1 rounded-lg bg-indigo-50 text-indigo-500 text-[10px] font-bold border border-indigo-100",children:[": ",N.className]})]})]}),g.jsxs("div",{className:"pt-6 border-t border-slate-50 mt-auto flex items-center justify-between",children:[g.jsxs("div",{className:"flex items-center gap-2 text-slate-400",children:[g.jsx(aR,{className:"h-4 w-4"}),g.jsx("span",{className:"text-xs font-bold",children:(S=N.createdAt)!=null&&S.toDate?N.createdAt.toDate().toLocaleDateString("ar-EG",{day:"numeric",month:"short"}):" "})]}),g.jsxs("div",{className:"flex items-center gap-1 text-primary text-xs font-bold",children:[" ",g.jsx(Ui,{className:"h-3 w-3"})]})]})]},N.id)})}):g.jsxs("div",{className:"text-center py-24 bg-white rounded-[40px] border-2 border-dashed border-slate-200 shadow-sm max-w-2xl mx-auto",children:[g.jsx("div",{className:"w-24 h-24 rounded-full bg-slate-50 flex items-center justify-center mx-auto mb-6 text-slate-300",children:g.jsx(vf,{className:"h-12 w-12"})}),g.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-2",children:"   "}),g.jsx("p",{className:"text-slate-500 mb-8 max-w-xs mx-auto",children:"            ."}),g.jsx(ae,{variant:"outline",onClick:()=>{var N;return(N=document.getElementById("dropzone-file"))==null?void 0:N.click()},className:"rounded-xl px-8 font-bold",children:" "})]})]})]}),g.jsx("footer",{className:"py-12 border-t border-slate-100 bg-white",children:g.jsxs("div",{className:"container mx-auto px-4 text-center",children:[g.jsxs("div",{className:"flex items-center justify-center gap-2 mb-4",children:[g.jsx("div",{className:"w-8 h-8 rounded-lg bg-slate-100 flex items-center justify-center",children:g.jsx(mg,{className:"h-4 w-4 text-slate-400"})}),g.jsx("span",{className:"text-lg font-bold text-slate-800",children:" "})]}),g.jsx("p",{className:"text-sm text-slate-400 font-medium italic",children:"      "}),g.jsx("p",{className:"text-[10px] text-slate-300 mt-8",children:" 2025      "})]})})]})};function M(n,e,t){return(e=function(r){var s=function(i,o){if(typeof i!="object"||!i)return i;var a=i[Symbol.toPrimitive];if(a!==void 0){var l=a.call(i,o||"default");if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(o==="string"?String:Number)(i)}(r,"string");return typeof s=="symbol"?s:s+""}(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function rk(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,r)}return t}function L(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?rk(Object(t),!0).forEach(function(r){M(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):rk(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function st(n,e){if(n==null)return{};var t,r,s=function(o,a){if(o==null)return{};var l={};for(var c in o)if({}.hasOwnProperty.call(o,c)){if(a.indexOf(c)>=0)continue;l[c]=o[c]}return l}(n,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);for(r=0;r<i.length;r++)t=i[r],e.indexOf(t)>=0||{}.propertyIsEnumerable.call(n,t)&&(s[t]=n[t])}return s}function Rs(n,e){return e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}}))}class sk{constructor(){M(this,"browserShadowBlurConstant",1),M(this,"DPI",96),M(this,"devicePixelRatio",typeof window<"u"?window.devicePixelRatio:1),M(this,"perfLimitSizeTotal",2097152),M(this,"maxCacheSideLimit",4096),M(this,"minCacheSideLimit",256),M(this,"disableStyleCopyPaste",!1),M(this,"enableGLFiltering",!0),M(this,"textureSize",4096),M(this,"forceGLPutImageData",!1),M(this,"cachesBoundsOfCurve",!1),M(this,"fontPaths",{}),M(this,"NUM_FRACTION_DIGITS",4)}}const Le=new class extends sk{constructor(n){super(),this.configure(n)}configure(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.assign(this,n)}addFonts(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.fontPaths=L(L({},this.fontPaths),n)}removeFonts(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>{delete this.fontPaths[n]})}clearFonts(){this.fontPaths={}}restoreDefaults(n){const e=new sk,t=(n==null?void 0:n.reduce((r,s)=>(r[s]=e[s],r),{}))||e;this.configure(t)}},Po=function(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];return console[n]("fabric",...t)};class ms extends Error{constructor(e,t){super("fabric: ".concat(e),t)}}class NK extends ms{constructor(e){super("".concat(e," 'options.signal' is in 'aborted' state"))}}class jK{}class DK extends jK{testPrecision(e,t){const r="precision ".concat(t,` float;
void main(){}`),s=e.createShader(e.FRAGMENT_SHADER);return!!s&&(e.shaderSource(s,r),e.compileShader(s),!!e.getShaderParameter(s,e.COMPILE_STATUS))}queryWebGL(e){const t=e.getContext("webgl");t&&(this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),this.GLPrecision=["highp","mediump","lowp"].find(r=>this.testPrecision(t,r)),t.getExtension("WEBGL_lose_context").loseContext(),Po("log","WebGL: max texture size ".concat(this.maxTextureSize)))}isSupported(e){return!!this.maxTextureSize&&this.maxTextureSize>=e}}const MK={};let ik;const As=()=>ik||(ik={document,window,isTouchSupported:"ontouchstart"in window||"ontouchstart"in document||window&&window.navigator&&window.navigator.maxTouchPoints>0,WebGLProbe:new DK,dispose(){},copyPasteData:MK}),Zc=()=>As().document,uy=()=>As().window,Yj=()=>{var n;return Math.max((n=Le.devicePixelRatio)!==null&&n!==void 0?n:uy().devicePixelRatio,1)},uh=new class{constructor(){M(this,"boundsOfCurveCache",{}),this.charWidthsCache=new Map}getFontCache(n){let{fontFamily:e,fontStyle:t,fontWeight:r}=n;e=e.toLowerCase();const s=this.charWidthsCache;s.has(e)||s.set(e,new Map);const i=s.get(e),o="".concat(t.toLowerCase(),"_").concat((r+"").toLowerCase());return i.has(o)||i.set(o,new Map),i.get(o)}clearFontCache(n){n?this.charWidthsCache.delete((n||"").toLowerCase()):this.charWidthsCache=new Map}limitDimsByArea(n){const{perfLimitSizeTotal:e}=Le,t=Math.sqrt(e*n);return[Math.floor(t),Math.floor(e/t)]}},u_="6.9.0";function Fp(){}const jd=Math.PI/2,Kg=2*Math.PI,Yb=Math.PI/180,bn=Object.freeze([1,0,0,1,0,0]),Xb=16,ji=.4477152502,Te="center",$e="left",Mn="top",h_="bottom",vt="right",Ln="none",Qb=/\r?\n/,Xj="moving",hy="scaling",Qj="rotating",Jb="rotate",Jj="skewing",Zh="resizing",LK="modifyPoly",FK="modifyPath",Yg="changed",dy="scale",Vn="scaleX",vr="scaleY",eu="skewX",tu="skewY",Mt="fill",Fn="stroke",Xg="modified",hl="json",qv="svg",re=new class{constructor(){this[hl]=new Map,this[qv]=new Map}has(n){return this[hl].has(n)}getClass(n){const e=this[hl].get(n);if(!e)throw new ms("No class registered for ".concat(n));return e}setClass(n,e){e?this[hl].set(e,n):(this[hl].set(n.type,n),this[hl].set(n.type.toLowerCase(),n))}getSVGClass(n){return this[qv].get(n)}setSVGClass(n,e){this[qv].set(e??n.type.toLowerCase(),n)}},Qg=new class extends Array{remove(n){const e=this.indexOf(n);e>-1&&this.splice(e,1)}cancelAll(){const n=this.splice(0);return n.forEach(e=>e.abort()),n}cancelByCanvas(n){if(!n)return[];const e=this.filter(t=>{var r;return t.target===n||typeof t.target=="object"&&((r=t.target)===null||r===void 0?void 0:r.canvas)===n});return e.forEach(t=>t.abort()),e}cancelByTarget(n){if(!n)return[];const e=this.filter(t=>t.target===n);return e.forEach(t=>t.abort()),e}};class VK{constructor(){M(this,"__eventListeners",{})}on(e,t){if(this.__eventListeners||(this.__eventListeners={}),typeof e=="object")return Object.entries(e).forEach(r=>{let[s,i]=r;this.on(s,i)}),()=>this.off(e);if(t){const r=e;return this.__eventListeners[r]||(this.__eventListeners[r]=[]),this.__eventListeners[r].push(t),()=>this.off(r,t)}return()=>!1}once(e,t){if(typeof e=="object"){const r=[];return Object.entries(e).forEach(s=>{let[i,o]=s;r.push(this.once(i,o))}),()=>r.forEach(s=>s())}if(t){const r=this.on(e,function(){for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];t.call(this,...i),r()});return r}return()=>!1}_removeEventListener(e,t){if(this.__eventListeners[e])if(t){const r=this.__eventListeners[e],s=r.indexOf(t);s>-1&&r.splice(s,1)}else this.__eventListeners[e]=[]}off(e,t){if(this.__eventListeners)if(e===void 0)for(const r in this.__eventListeners)this._removeEventListener(r);else typeof e=="object"?Object.entries(e).forEach(r=>{let[s,i]=r;this._removeEventListener(s,i)}):this._removeEventListener(e,t)}fire(e,t){var r;if(!this.__eventListeners)return;const s=(r=this.__eventListeners[e])===null||r===void 0?void 0:r.concat();if(s)for(let i=0;i<s.length;i++)s[i].call(this,t||{})}}const bl=(n,e)=>{const t=n.indexOf(e);return t!==-1&&n.splice(t,1),n},di=n=>{if(n===0)return 1;switch(Math.abs(n)/jd){case 1:case 3:return 0;case 2:return-1}return Math.cos(n)},fi=n=>{if(n===0)return 0;const e=n/jd,t=Math.sign(n);switch(e){case 1:return t;case 2:return 0;case 3:return-t}return Math.sin(n)};class ${constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;typeof e=="object"?(this.x=e.x,this.y=e.y):(this.x=e,this.y=t)}add(e){return new $(this.x+e.x,this.y+e.y)}addEquals(e){return this.x+=e.x,this.y+=e.y,this}scalarAdd(e){return new $(this.x+e,this.y+e)}scalarAddEquals(e){return this.x+=e,this.y+=e,this}subtract(e){return new $(this.x-e.x,this.y-e.y)}subtractEquals(e){return this.x-=e.x,this.y-=e.y,this}scalarSubtract(e){return new $(this.x-e,this.y-e)}scalarSubtractEquals(e){return this.x-=e,this.y-=e,this}multiply(e){return new $(this.x*e.x,this.y*e.y)}scalarMultiply(e){return new $(this.x*e,this.y*e)}scalarMultiplyEquals(e){return this.x*=e,this.y*=e,this}divide(e){return new $(this.x/e.x,this.y/e.y)}scalarDivide(e){return new $(this.x/e,this.y/e)}scalarDivideEquals(e){return this.x/=e,this.y/=e,this}eq(e){return this.x===e.x&&this.y===e.y}lt(e){return this.x<e.x&&this.y<e.y}lte(e){return this.x<=e.x&&this.y<=e.y}gt(e){return this.x>e.x&&this.y>e.y}gte(e){return this.x>=e.x&&this.y>=e.y}lerp(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.5;return t=Math.max(Math.min(1,t),0),new $(this.x+(e.x-this.x)*t,this.y+(e.y-this.y)*t)}distanceFrom(e){const t=this.x-e.x,r=this.y-e.y;return Math.sqrt(t*t+r*r)}midPointFrom(e){return this.lerp(e)}min(e){return new $(Math.min(this.x,e.x),Math.min(this.y,e.y))}max(e){return new $(Math.max(this.x,e.x),Math.max(this.y,e.y))}toString(){return"".concat(this.x,",").concat(this.y)}setXY(e,t){return this.x=e,this.y=t,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setFromPoint(e){return this.x=e.x,this.y=e.y,this}swap(e){const t=this.x,r=this.y;this.x=e.x,this.y=e.y,e.x=t,e.y=r}clone(){return new $(this.x,this.y)}rotate(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Zb;const r=fi(e),s=di(e),i=this.subtract(t);return new $(i.x*s-i.y*r,i.x*r+i.y*s).add(t)}transform(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new $(e[0]*this.x+e[2]*this.y+(t?0:e[4]),e[1]*this.x+e[3]*this.y+(t?0:e[5]))}}const Zb=new $(0,0),Vp=n=>!!n&&Array.isArray(n._objects);function Zj(n){class e extends n{constructor(){super(...arguments),M(this,"_objects",[])}_onObjectAdded(r){}_onObjectRemoved(r){}_onStackOrderChanged(r){}add(){for(var r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];const o=this._objects.push(...s);return s.forEach(a=>this._onObjectAdded(a)),o}insertAt(r){for(var s=arguments.length,i=new Array(s>1?s-1:0),o=1;o<s;o++)i[o-1]=arguments[o];return this._objects.splice(r,0,...i),i.forEach(a=>this._onObjectAdded(a)),this._objects.length}remove(){const r=this._objects,s=[];for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return o.forEach(l=>{const c=r.indexOf(l);c!==-1&&(r.splice(c,1),s.push(l),this._onObjectRemoved(l))}),s}forEachObject(r){this.getObjects().forEach((s,i,o)=>r(s,i,o))}getObjects(){for(var r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];return s.length===0?[...this._objects]:this._objects.filter(o=>o.isType(...s))}item(r){return this._objects[r]}isEmpty(){return this._objects.length===0}size(){return this._objects.length}contains(r,s){return!!this._objects.includes(r)||!!s&&this._objects.some(i=>i instanceof e&&i.contains(r,!0))}complexity(){return this._objects.reduce((r,s)=>r+=s.complexity?s.complexity():0,0)}sendObjectToBack(r){return!(!r||r===this._objects[0])&&(bl(this._objects,r),this._objects.unshift(r),this._onStackOrderChanged(r),!0)}bringObjectToFront(r){return!(!r||r===this._objects[this._objects.length-1])&&(bl(this._objects,r),this._objects.push(r),this._onStackOrderChanged(r),!0)}sendObjectBackwards(r,s){if(!r)return!1;const i=this._objects.indexOf(r);if(i!==0){const o=this.findNewLowerIndex(r,i,s);return bl(this._objects,r),this._objects.splice(o,0,r),this._onStackOrderChanged(r),!0}return!1}bringObjectForward(r,s){if(!r)return!1;const i=this._objects.indexOf(r);if(i!==this._objects.length-1){const o=this.findNewUpperIndex(r,i,s);return bl(this._objects,r),this._objects.splice(o,0,r),this._onStackOrderChanged(r),!0}return!1}moveObjectTo(r,s){return r!==this._objects[s]&&(bl(this._objects,r),this._objects.splice(s,0,r),this._onStackOrderChanged(r),!0)}findNewLowerIndex(r,s,i){let o;if(i){o=s;for(let a=s-1;a>=0;--a)if(r.isOverlapping(this._objects[a])){o=a;break}}else o=s-1;return o}findNewUpperIndex(r,s,i){let o;if(i){o=s;for(let a=s+1;a<this._objects.length;++a)if(r.isOverlapping(this._objects[a])){o=a;break}}else o=s+1;return o}collectObjects(r){let{left:s,top:i,width:o,height:a}=r,{includeIntersecting:l=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const c=[],u=new $(s,i),h=u.add(new $(o,a));for(let f=this._objects.length-1;f>=0;f--){const p=this._objects[f];p.selectable&&p.visible&&(l&&p.intersectsWithRect(u,h)||p.isContainedWithinRect(u,h)||l&&p.containsPoint(u)||l&&p.containsPoint(h))&&c.push(p)}return c}}return e}class eD extends VK{_setOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};for(const t in e)this.set(t,e[t])}_setObject(e){for(const t in e)this._set(t,e[t])}set(e,t){return typeof e=="object"?this._setObject(e):this._set(e,t),this}_set(e,t){this[e]=t}toggle(e){const t=this.get(e);return typeof t=="boolean"&&this.set(e,!t),this}get(e){return this[e]}}function Up(n){return uy().requestAnimationFrame(n)}function UK(n){return uy().cancelAnimationFrame(n)}let $K=0;const Io=()=>$K++,pi=()=>{const n=Zc().createElement("canvas");if(!n||n.getContext===void 0)throw new ms("Failed to create `canvas` element");return n},BK=()=>Zc().createElement("img"),wr=n=>{const e=pi();return e.width=n.width,e.height=n.height,e},tD=(n,e,t)=>n.toDataURL("image/".concat(e),t),nD=(n,e,t)=>new Promise((r,s)=>{n.toBlob(r,"image/".concat(e),t)}),xt=n=>n*Yb,gi=n=>n/Yb,zK=n=>n.every((e,t)=>e===bn[t]),Pn=(n,e,t)=>new $(n).transform(e,t),Br=n=>{const e=1/(n[0]*n[3]-n[1]*n[2]),t=[e*n[3],-e*n[1],-e*n[2],e*n[0],0,0],{x:r,y:s}=new $(n[4],n[5]).transform(t,!0);return t[4]=-r,t[5]=-s,t},Yt=(n,e,t)=>[n[0]*e[0]+n[2]*e[1],n[1]*e[0]+n[3]*e[1],n[0]*e[2]+n[2]*e[3],n[1]*e[2]+n[3]*e[3],t?0:n[0]*e[4]+n[2]*e[5]+n[4],t?0:n[1]*e[4]+n[3]*e[5]+n[5]],e1=(n,e)=>n.reduceRight((t,r)=>r&&t?Yt(r,t,e):r||t,void 0)||bn.concat(),rD=n=>{let[e,t]=n;return Math.atan2(t,e)},Jg=n=>{const e=rD(n),t=Math.pow(n[0],2)+Math.pow(n[1],2),r=Math.sqrt(t),s=(n[0]*n[3]-n[2]*n[1])/r,i=Math.atan2(n[0]*n[2]+n[1]*n[3],t);return{angle:gi(e),scaleX:r,scaleY:s,skewX:gi(i),skewY:0,translateX:n[4]||0,translateY:n[5]||0}},Dd=function(n){return[1,0,0,1,n,arguments.length>1&&arguments[1]!==void 0?arguments[1]:0]};function nu(){let{angle:n=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{x:e=0,y:t=0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=xt(n),s=di(r),i=fi(r);return[s,i,-i,s,e?e-(s*e-i*t):0,t?t-(i*e+s*t):0]}const t1=function(n){return[n,0,0,arguments.length>1&&arguments[1]!==void 0?arguments[1]:n,0,0]},sD=n=>Math.tan(xt(n)),iD=n=>[1,0,sD(n),1,0,0],oD=n=>[1,sD(n),0,1,0,0],fy=n=>{let{scaleX:e=1,scaleY:t=1,flipX:r=!1,flipY:s=!1,skewX:i=0,skewY:o=0}=n,a=t1(r?-e:e,s?-t:t);return i&&(a=Yt(a,iD(i),!0)),o&&(a=Yt(a,oD(o),!0)),a},WK=n=>{const{translateX:e=0,translateY:t=0,angle:r=0}=n;let s=Dd(e,t);r&&(s=Yt(s,nu({angle:r})));const i=fy(n);return zK(i)||(s=Yt(s,i)),s},$p=function(n){let{signal:e,crossOrigin:t=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(r,s){if(e&&e.aborted)return s(new NK("loadImage"));const i=BK();let o;e&&(o=function(l){i.src="",s(l)},e.addEventListener("abort",o,{once:!0}));const a=function(){i.onload=i.onerror=null,o&&(e==null||e.removeEventListener("abort",o)),r(i)};n?(i.onload=a,i.onerror=function(){o&&(e==null||e.removeEventListener("abort",o)),s(new ms("Error loading ".concat(i.src)))},t&&(i.crossOrigin=t),i.src=n):a()})},ed=function(n){let{signal:e,reviver:t=Fp}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((r,s)=>{const i=[];e&&e.addEventListener("abort",s,{once:!0}),Promise.all(n.map(o=>re.getClass(o.type).fromObject(o,{signal:e}).then(a=>(t(o,a),i.push(a),a)))).then(r).catch(o=>{i.forEach(a=>{a.dispose&&a.dispose()}),s(o)}).finally(()=>{e&&e.removeEventListener("abort",s)})})},py=function(n){let{signal:e}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((t,r)=>{const s=[];e&&e.addEventListener("abort",r,{once:!0});const i=Object.values(n).map(a=>a&&a.type&&re.has(a.type)?ed([a],{signal:e}).then(l=>{let[c]=l;return s.push(c),c}):a),o=Object.keys(n);Promise.all(i).then(a=>a.reduce((l,c,u)=>(l[o[u]]=c,l),{})).then(t).catch(a=>{s.forEach(l=>{l.dispose&&l.dispose()}),r(a)}).finally(()=>{e&&e.removeEventListener("abort",r)})})},ru=function(n){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:[]).reduce((e,t)=>(t in n&&(e[t]=n[t]),e),{})},n1=(n,e)=>Object.keys(n).reduce((t,r)=>(e(n[r],r,n)&&(t[r]=n[r]),t),{}),Qe=(n,e)=>parseFloat(Number(n).toFixed(e)),td=n=>"matrix("+n.map(e=>Qe(e,Le.NUM_FRACTION_DIGITS)).join(" ")+")",dr=n=>!!n&&n.toLive!==void 0,ok=n=>!!n&&typeof n.toObject=="function",ak=n=>!!n&&n.offsetX!==void 0&&"source"in n,oa=n=>!!n&&"multiSelectionStacking"in n;function aD(n){const e=n&&Ur(n);let t=0,r=0;if(!n||!e)return{left:t,top:r};let s=n;const i=e.documentElement,o=e.body||{scrollLeft:0,scrollTop:0};for(;s&&(s.parentNode||s.host)&&(s=s.parentNode||s.host,s===e?(t=o.scrollLeft||i.scrollLeft||0,r=o.scrollTop||i.scrollTop||0):(t+=s.scrollLeft||0,r+=s.scrollTop||0),s.nodeType!==1||s.style.position!=="fixed"););return{left:t,top:r}}const Ur=n=>n.ownerDocument||null,lD=n=>{var e;return((e=n.ownerDocument)===null||e===void 0?void 0:e.defaultView)||null},cD=function(n,e,t){let{width:r,height:s}=t,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;n.width=r,n.height=s,i>1&&(n.setAttribute("width",(r*i).toString()),n.setAttribute("height",(s*i).toString()),e.scale(i,i))},d_=(n,e)=>{let{width:t,height:r}=e;t&&(n.style.width=typeof t=="number"?"".concat(t,"px"):t),r&&(n.style.height=typeof r=="number"?"".concat(r,"px"):r)};function lk(n){return n.onselectstart!==void 0&&(n.onselectstart=()=>!1),n.style.userSelect=Ln,n}class uD{constructor(e){M(this,"_originalCanvasStyle",void 0),M(this,"lower",void 0);const t=this.createLowerCanvas(e);this.lower={el:t,ctx:t.getContext("2d")}}createLowerCanvas(e){const t=(r=e)&&r.getContext!==void 0?e:e&&Zc().getElementById(e)||pi();var r;if(t.hasAttribute("data-fabric"))throw new ms("Trying to initialize a canvas that has already been initialized. Did you forget to dispose the canvas?");return this._originalCanvasStyle=t.style.cssText,t.setAttribute("data-fabric","main"),t.classList.add("lower-canvas"),t}cleanupDOM(e){let{width:t,height:r}=e;const{el:s}=this.lower;s.classList.remove("lower-canvas"),s.removeAttribute("data-fabric"),s.setAttribute("width","".concat(t)),s.setAttribute("height","".concat(r)),s.style.cssText=this._originalCanvasStyle||"",this._originalCanvasStyle=void 0}setDimensions(e,t){const{el:r,ctx:s}=this.lower;cD(r,s,e,t)}setCSSDimensions(e){d_(this.lower.el,e)}calcOffset(){return function(e){var t;const r=e&&Ur(e),s={left:0,top:0};if(!r)return s;const i=((t=lD(e))===null||t===void 0?void 0:t.getComputedStyle(e,null))||{};s.left+=parseInt(i.borderLeftWidth,10)||0,s.top+=parseInt(i.borderTopWidth,10)||0,s.left+=parseInt(i.paddingLeft,10)||0,s.top+=parseInt(i.paddingTop,10)||0;let o={left:0,top:0};const a=r.documentElement;e.getBoundingClientRect!==void 0&&(o=e.getBoundingClientRect());const l=aD(e);return{left:o.left+l.left-(a.clientLeft||0)+s.left,top:o.top+l.top-(a.clientTop||0)+s.top}}(this.lower.el)}dispose(){As().dispose(this.lower.el),delete this.lower}}const HK={backgroundVpt:!0,backgroundColor:"",overlayVpt:!0,overlayColor:"",includeDefaultValues:!0,svgViewportTransformation:!0,renderOnAddRemove:!0,skipOffscreen:!0,enableRetinaScaling:!0,imageSmoothingEnabled:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,viewportTransform:[...bn]},qK=["objects"];class Md extends Zj(eD){get lowerCanvasEl(){var e;return(e=this.elements.lower)===null||e===void 0?void 0:e.el}get contextContainer(){var e;return(e=this.elements.lower)===null||e===void 0?void 0:e.ctx}static getDefaults(){return Md.ownDefaults}constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,this.constructor.getDefaults()),this.set(t),this.initElements(e),this._setDimensionsImpl({width:this.width||this.elements.lower.el.width||0,height:this.height||this.elements.lower.el.height||0}),this.skipControlsDrawing=!1,this.viewportTransform=[...this.viewportTransform],this.calcViewportBoundaries()}initElements(e){this.elements=new uD(e)}add(){const e=super.add(...arguments);return arguments.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),e}insertAt(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),s=1;s<t;s++)r[s-1]=arguments[s];const i=super.insertAt(e,...r);return r.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),i}remove(){const e=super.remove(...arguments);return e.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),e}_onObjectAdded(e){e.canvas&&e.canvas!==this&&(Po("warn",`Canvas is trying to add an object that belongs to a different canvas.
Resulting to default behavior: removing object from previous canvas and adding to new canvas`),e.canvas.remove(e)),e._set("canvas",this),e.setCoords(),this.fire("object:added",{target:e}),e.fire("added",{target:this})}_onObjectRemoved(e){e._set("canvas",void 0),this.fire("object:removed",{target:e}),e.fire("removed",{target:this})}_onStackOrderChanged(){this.renderOnAddRemove&&this.requestRenderAll()}getRetinaScaling(){return this.enableRetinaScaling?Yj():1}calcOffset(){return this._offset=this.elements.calcOffset()}getWidth(){return this.width}getHeight(){return this.height}setWidth(e,t){return this.setDimensions({width:e},t)}setHeight(e,t){return this.setDimensions({height:e},t)}_setDimensionsImpl(e){let{cssOnly:t=!1,backstoreOnly:r=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t){const s=L({width:this.width,height:this.height},e);this.elements.setDimensions(s,this.getRetinaScaling()),this.hasLostContext=!0,this.width=s.width,this.height=s.height}r||this.elements.setCSSDimensions(e),this.calcOffset()}setDimensions(e,t){this._setDimensionsImpl(e,t),t&&t.cssOnly||this.requestRenderAll()}getZoom(){return this.viewportTransform[0]}setViewportTransform(e){this.viewportTransform=e,this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll()}zoomToPoint(e,t){const r=e,s=[...this.viewportTransform],i=Pn(e,Br(s));s[0]=t,s[3]=t;const o=Pn(i,s);s[4]+=r.x-o.x,s[5]+=r.y-o.y,this.setViewportTransform(s)}setZoom(e){this.zoomToPoint(new $(0,0),e)}absolutePan(e){const t=[...this.viewportTransform];return t[4]=-e.x,t[5]=-e.y,this.setViewportTransform(t)}relativePan(e){return this.absolutePan(new $(-e.x-this.viewportTransform[4],-e.y-this.viewportTransform[5]))}getElement(){return this.elements.lower.el}clearContext(e){e.clearRect(0,0,this.width,this.height)}getContext(){return this.elements.lower.ctx}clear(){this.remove(...this.getObjects()),this.backgroundImage=void 0,this.overlayImage=void 0,this.backgroundColor="",this.overlayColor="",this.clearContext(this.getContext()),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll()}renderAll(){this.cancelRequestedRender(),this.destroyed||this.renderCanvas(this.getContext(),this._objects)}renderAndReset(){this.nextRenderHandle=0,this.renderAll()}requestRenderAll(){this.nextRenderHandle||this.disposed||this.destroyed||(this.nextRenderHandle=Up(()=>this.renderAndReset()))}calcViewportBoundaries(){const e=this.width,t=this.height,r=Br(this.viewportTransform),s=Pn({x:0,y:0},r),i=Pn({x:e,y:t},r),o=s.min(i),a=s.max(i);return this.vptCoords={tl:o,tr:new $(a.x,o.y),bl:new $(o.x,a.y),br:a}}cancelRequestedRender(){this.nextRenderHandle&&(UK(this.nextRenderHandle),this.nextRenderHandle=0)}drawControls(e){}renderCanvas(e,t){if(this.destroyed)return;const r=this.viewportTransform,s=this.clipPath;this.calcViewportBoundaries(),this.clearContext(e),e.imageSmoothingEnabled=this.imageSmoothingEnabled,e.patternQuality="best",this.fire("before:render",{ctx:e}),this._renderBackground(e),e.save(),e.transform(r[0],r[1],r[2],r[3],r[4],r[5]),this._renderObjects(e,t),e.restore(),this.controlsAboveOverlay||this.skipControlsDrawing||this.drawControls(e),s&&(s._set("canvas",this),s.shouldCache(),s._transformDone=!0,s.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(e,s)),this._renderOverlay(e),this.controlsAboveOverlay&&!this.skipControlsDrawing&&this.drawControls(e),this.fire("after:render",{ctx:e}),this.__cleanupTask&&(this.__cleanupTask(),this.__cleanupTask=void 0)}drawClipPathOnCanvas(e,t){const r=this.viewportTransform;e.save(),e.transform(...r),e.globalCompositeOperation="destination-in",t.transform(e),e.scale(1/t.zoomX,1/t.zoomY),e.drawImage(t._cacheCanvas,-t.cacheTranslationX,-t.cacheTranslationY),e.restore()}_renderObjects(e,t){for(let r=0,s=t.length;r<s;++r)t[r]&&t[r].render(e)}_renderBackgroundOrOverlay(e,t){const r=this["".concat(t,"Color")],s=this["".concat(t,"Image")],i=this.viewportTransform,o=this["".concat(t,"Vpt")];if(!r&&!s)return;const a=dr(r);if(r){if(e.save(),e.beginPath(),e.moveTo(0,0),e.lineTo(this.width,0),e.lineTo(this.width,this.height),e.lineTo(0,this.height),e.closePath(),e.fillStyle=a?r.toLive(e):r,o&&e.transform(...i),a){e.transform(1,0,0,1,r.offsetX||0,r.offsetY||0);const l=r.gradientTransform||r.patternTransform;l&&e.transform(...l)}e.fill(),e.restore()}if(s){e.save();const{skipOffscreen:l}=this;this.skipOffscreen=o,o&&e.transform(...i),s.render(e),this.skipOffscreen=l,e.restore()}}_renderBackground(e){this._renderBackgroundOrOverlay(e,"background")}_renderOverlay(e){this._renderBackgroundOrOverlay(e,"overlay")}getCenter(){return{top:this.height/2,left:this.width/2}}getCenterPoint(){return new $(this.width/2,this.height/2)}centerObjectH(e){return this._centerObject(e,new $(this.getCenterPoint().x,e.getCenterPoint().y))}centerObjectV(e){return this._centerObject(e,new $(e.getCenterPoint().x,this.getCenterPoint().y))}centerObject(e){return this._centerObject(e,this.getCenterPoint())}viewportCenterObject(e){return this._centerObject(e,this.getVpCenter())}viewportCenterObjectH(e){return this._centerObject(e,new $(this.getVpCenter().x,e.getCenterPoint().y))}viewportCenterObjectV(e){return this._centerObject(e,new $(e.getCenterPoint().x,this.getVpCenter().y))}getVpCenter(){return Pn(this.getCenterPoint(),Br(this.viewportTransform))}_centerObject(e,t){e.setXY(t,Te,Te),e.setCoords(),this.renderOnAddRemove&&this.requestRenderAll()}toDatalessJSON(e){return this.toDatalessObject(e)}toObject(e){return this._toObjectMethod("toObject",e)}toJSON(){return this.toObject()}toDatalessObject(e){return this._toObjectMethod("toDatalessObject",e)}_toObjectMethod(e,t){const r=this.clipPath,s=r&&!r.excludeFromExport?this._toObject(r,e,t):null;return L(L(L({version:u_},ru(this,t)),{},{objects:this._objects.filter(i=>!i.excludeFromExport).map(i=>this._toObject(i,e,t))},this.__serializeBgOverlay(e,t)),s?{clipPath:s}:null)}_toObject(e,t,r){let s;this.includeDefaultValues||(s=e.includeDefaultValues,e.includeDefaultValues=!1);const i=e[t](r);return this.includeDefaultValues||(e.includeDefaultValues=!!s),i}__serializeBgOverlay(e,t){const r={},s=this.backgroundImage,i=this.overlayImage,o=this.backgroundColor,a=this.overlayColor;return dr(o)?o.excludeFromExport||(r.background=o.toObject(t)):o&&(r.background=o),dr(a)?a.excludeFromExport||(r.overlay=a.toObject(t)):a&&(r.overlay=a),s&&!s.excludeFromExport&&(r.backgroundImage=this._toObject(s,e,t)),i&&!i.excludeFromExport&&(r.overlayImage=this._toObject(i,e,t)),r}toSVG(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;e.reviver=t;const r=[];return this._setSVGPreamble(r,e),this._setSVGHeader(r,e),this.clipPath&&r.push('<g clip-path="url(#'.concat(this.clipPath.clipPathId,`)" >
`)),this._setSVGBgOverlayColor(r,"background"),this._setSVGBgOverlayImage(r,"backgroundImage",t),this._setSVGObjects(r,t),this.clipPath&&r.push(`</g>
`),this._setSVGBgOverlayColor(r,"overlay"),this._setSVGBgOverlayImage(r,"overlayImage",t),r.push("</svg>"),r.join("")}_setSVGPreamble(e,t){t.suppressPreamble||e.push('<?xml version="1.0" encoding="',t.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)}_setSVGHeader(e,t){const r=t.width||"".concat(this.width),s=t.height||"".concat(this.height),i=Le.NUM_FRACTION_DIGITS,o=t.viewBox;let a;if(o)a='viewBox="'.concat(o.x," ").concat(o.y," ").concat(o.width," ").concat(o.height,'" ');else if(this.svgViewportTransformation){const l=this.viewportTransform;a='viewBox="'.concat(Qe(-l[4]/l[0],i)," ").concat(Qe(-l[5]/l[3],i)," ").concat(Qe(this.width/l[0],i)," ").concat(Qe(this.height/l[3],i),'" ')}else a='viewBox="0 0 '.concat(this.width," ").concat(this.height,'" ');e.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',r,'" ','height="',s,'" ',a,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",u_,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(t),`</defs>
`)}createSVGClipPathMarkup(e){const t=this.clipPath;return t?(t.clipPathId="CLIPPATH_".concat(Io()),'<clipPath id="'.concat(t.clipPathId,`" >
`).concat(t.toClipPathSVG(e.reviver),`</clipPath>
`)):""}createSVGRefElementsMarkup(){return["background","overlay"].map(e=>{const t=this["".concat(e,"Color")];if(dr(t)){const r=this["".concat(e,"Vpt")],s=this.viewportTransform,i={isType:()=>!1,width:this.width/(r?s[0]:1),height:this.height/(r?s[3]:1)};return t.toSVG(i,{additionalTransform:r?td(s):""})}}).join("")}createSVGFontFacesMarkup(){const e=[],t={},r=Le.fontPaths;this._objects.forEach(function i(o){e.push(o),Vp(o)&&o._objects.forEach(i)}),e.forEach(i=>{if(!(o=i)||typeof o._renderText!="function")return;var o;const{styles:a,fontFamily:l}=i;!t[l]&&r[l]&&(t[l]=!0,a&&Object.values(a).forEach(c=>{Object.values(c).forEach(u=>{let{fontFamily:h=""}=u;!t[h]&&r[h]&&(t[h]=!0)})}))});const s=Object.keys(t).map(i=>`		@font-face {
			font-family: '`.concat(i,`';
			src: url('`).concat(r[i],`');
		}
`)).join("");return s?`	<style type="text/css"><![CDATA[
`.concat(s,`]]></style>
`):""}_setSVGObjects(e,t){this.forEachObject(r=>{r.excludeFromExport||this._setSVGObject(e,r,t)})}_setSVGObject(e,t,r){e.push(t.toSVG(r))}_setSVGBgOverlayImage(e,t,r){const s=this[t];s&&!s.excludeFromExport&&s.toSVG&&e.push(s.toSVG(r))}_setSVGBgOverlayColor(e,t){const r=this["".concat(t,"Color")];if(r)if(dr(r)){const s=r.repeat||"",i=this.width,o=this.height,a=this["".concat(t,"Vpt")]?td(Br(this.viewportTransform)):"";e.push('<rect transform="'.concat(a," translate(").concat(i/2,",").concat(o/2,')" x="').concat(r.offsetX-i/2,'" y="').concat(r.offsetY-o/2,'" width="').concat(s!=="repeat-y"&&s!=="no-repeat"||!ak(r)?i:r.source.width,'" height="').concat(s!=="repeat-x"&&s!=="no-repeat"||!ak(r)?o:r.source.height,'" fill="url(#SVGID_').concat(r.id,`)"></rect>
`))}else e.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',r,'"',`></rect>
`)}loadFromJSON(e,t){let{signal:r}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!e)return Promise.reject(new ms("`json` is undefined"));const s=typeof e=="string"?JSON.parse(e):e,{objects:i=[]}=s,o=st(s,qK),{backgroundImage:a,background:l,overlayImage:c,overlay:u,clipPath:h}=o,f=this.renderOnAddRemove;return this.renderOnAddRemove=!1,Promise.all([ed(i,{reviver:t,signal:r}),py({backgroundImage:a,backgroundColor:l,overlayImage:c,overlayColor:u,clipPath:h},{signal:r})]).then(p=>{let[y,m]=p;return this.clear(),this.add(...y),this.set(o),this.set(m),this.renderOnAddRemove=f,this})}clone(e){const t=this.toObject(e);return this.cloneWithoutData().loadFromJSON(t)}cloneWithoutData(){const e=wr(this);return new this.constructor(e)}toDataURL(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{format:t="png",quality:r=1,multiplier:s=1,enableRetinaScaling:i=!1}=e,o=s*(i?this.getRetinaScaling():1);return tD(this.toCanvasElement(o,e),t,r)}toBlob(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{format:t="png",quality:r=1,multiplier:s=1,enableRetinaScaling:i=!1}=e,o=s*(i?this.getRetinaScaling():1);return nD(this.toCanvasElement(o,e),t,r)}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,{width:t,height:r,left:s,top:i,filter:o}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const a=(t||this.width)*e,l=(r||this.height)*e,c=this.getZoom(),u=this.width,h=this.height,f=this.skipControlsDrawing,p=c*e,y=this.viewportTransform,m=[p,0,0,p,(y[4]-(s||0))*e,(y[5]-(i||0))*e],v=this.enableRetinaScaling,w=wr({width:a,height:l}),_=o?this._objects.filter(x=>o(x)):this._objects;return this.enableRetinaScaling=!1,this.viewportTransform=m,this.width=a,this.height=l,this.skipControlsDrawing=!0,this.calcViewportBoundaries(),this.renderCanvas(w.getContext("2d"),_),this.viewportTransform=y,this.width=u,this.height=h,this.calcViewportBoundaries(),this.enableRetinaScaling=v,this.skipControlsDrawing=f,w}dispose(){return!this.disposed&&this.elements.cleanupDOM({width:this.width,height:this.height}),Qg.cancelByCanvas(this),this.disposed=!0,new Promise((e,t)=>{const r=()=>{this.destroy(),e(!0)};r.kill=t,this.__cleanupTask&&this.__cleanupTask.kill("aborted"),this.destroyed?e(!1):this.nextRenderHandle?this.__cleanupTask=r:r()})}destroy(){this.destroyed=!0,this.cancelRequestedRender(),this.forEachObject(e=>e.dispose()),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose(),this.backgroundImage=void 0,this.overlayImage&&this.overlayImage.dispose(),this.overlayImage=void 0,this.elements.dispose()}toString(){return"#<Canvas (".concat(this.complexity(),"): { objects: ").concat(this._objects.length," }>")}}M(Md,"ownDefaults",HK);const GK=["touchstart","touchmove","touchend"],KK=n=>{const e=aD(n.target),t=function(r){const s=r.changedTouches;return s&&s[0]?s[0]:r}(n);return new $(t.clientX+e.left,t.clientY+e.top)},f_=n=>GK.includes(n.type)||n.pointerType==="touch",ck=n=>{n.preventDefault(),n.stopPropagation()},ei=n=>{let e=0,t=0,r=0,s=0;for(let i=0,o=n.length;i<o;i++){const{x:a,y:l}=n[i];(a>r||!i)&&(r=a),(a<e||!i)&&(e=a),(l>s||!i)&&(s=l),(l<t||!i)&&(t=l)}return{left:e,top:t,width:r-e,height:s-t}},YK=["translateX","translateY","scaleX","scaleY"],XK=(n,e)=>Zg(n,Yt(e,n.calcOwnMatrix())),Zg=(n,e)=>{const t=Jg(e),{translateX:r,translateY:s,scaleX:i,scaleY:o}=t,a=st(t,YK),l=new $(r,s);n.flipX=!1,n.flipY=!1,Object.assign(n,a),n.set({scaleX:i,scaleY:o}),n.setPositionByOrigin(l,Te,Te)},QK=n=>{n.scaleX=1,n.scaleY=1,n.skewX=0,n.skewY=0,n.flipX=!1,n.flipY=!1,n.rotate(0)},hD=n=>({scaleX:n.scaleX,scaleY:n.scaleY,skewX:n.skewX,skewY:n.skewY,angle:n.angle,left:n.left,flipX:n.flipX,flipY:n.flipY,top:n.top}),r1=(n,e,t)=>{const r=n/2,s=e/2,i=[new $(-r,-s),new $(r,-s),new $(-r,s),new $(r,s)].map(a=>a.transform(t)),o=ei(i);return new $(o.width,o.height)},gy=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:bn;return Yt(Br(arguments.length>1&&arguments[1]!==void 0?arguments[1]:bn),n)},ec=function(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:bn,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:bn;return n.transform(gy(e,t))},JK=function(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:bn,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:bn;return n.transform(gy(e,t),!0)},ZK=(n,e,t)=>{const r=gy(e,t);return Zg(n,Yt(r,n.calcOwnMatrix())),r},dD=(n,e)=>{var t;const{transform:{target:r}}=e;(t=r.canvas)===null||t===void 0||t.fire("object:".concat(n),L(L({},e),{},{target:r})),r.fire(n,e)},eY={left:-.5,top:-.5,center:0,bottom:.5,right:.5},Tt=n=>typeof n=="string"?eY[n]:n-.5,em="not-allowed";function fD(n){return Tt(n.originX)===Tt(Te)&&Tt(n.originY)===Tt(Te)}function uk(n){return .5-Tt(n)}const qr=(n,e)=>n[e],pD=(n,e,t,r)=>({e:n,transform:e,pointer:new $(t,r)});function gD(n,e){const t=n.getTotalAngle()+gi(Math.atan2(e.y,e.x))+360;return Math.round(t%360/45)}function s1(n,e,t,r,s){var i;let{target:o,corner:a}=n;const l=o.controls[a],c=((i=o.canvas)===null||i===void 0?void 0:i.getZoom())||1,u=o.padding/c,h=function(f,p,y,m){const v=f.getRelativeCenterPoint(),w=y!==void 0&&m!==void 0?f.translateToGivenOrigin(v,Te,Te,y,m):new $(f.left,f.top);return(f.angle?p.rotate(-xt(f.angle),v):p).subtract(w)}(o,new $(r,s),e,t);return h.x>=u&&(h.x-=u),h.x<=-u&&(h.x+=u),h.y>=u&&(h.y-=u),h.y<=u&&(h.y+=u),h.x-=l.offsetX,h.y-=l.offsetY,h}const tY=(n,e,t,r)=>{const{target:s,offsetX:i,offsetY:o}=e,a=t-i,l=r-o,c=!qr(s,"lockMovementX")&&s.left!==a,u=!qr(s,"lockMovementY")&&s.top!==l;return c&&s.set($e,a),u&&s.set(Mn,l),(c||u)&&dD(Xj,pD(n,e,t,r)),c||u},tm=n=>n.replace(/\s+/g," "),hk={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#0FF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000",blanchedalmond:"#FFEBCD",blue:"#00F",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#0FF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#F0F",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#789",lightslategrey:"#789",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#0F0",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#F0F",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#639",red:"#F00",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFF",whitesmoke:"#F5F5F5",yellow:"#FF0",yellowgreen:"#9ACD32"},Gv=(n,e,t)=>(t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+6*(e-n)*t:t<.5?e:t<2/3?n+(e-n)*(2/3-t)*6:n),dk=(n,e,t,r)=>{n/=255,e/=255,t/=255;const s=Math.max(n,e,t),i=Math.min(n,e,t);let o,a;const l=(s+i)/2;if(s===i)o=a=0;else{const c=s-i;switch(a=l>.5?c/(2-s-i):c/(s+i),s){case n:o=(e-t)/c+(e<t?6:0);break;case e:o=(t-n)/c+2;break;case t:o=(n-e)/c+4}o/=6}return[Math.round(360*o),Math.round(100*a),Math.round(100*l),r]},fk=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"1";return parseFloat(n)/(n.endsWith("%")?100:1)},Vf=n=>Math.min(Math.round(n),255).toString(16).toUpperCase().padStart(2,"0"),pk=n=>{let[e,t,r,s=1]=n;const i=Math.round(.3*e+.59*t+.11*r);return[i,i,i,s]};class We{constructor(e){if(M(this,"isUnrecognised",!1),e)if(e instanceof We)this.setSource([...e._source]);else if(Array.isArray(e)){const[t,r,s,i=1]=e;this.setSource([t,r,s,i])}else this.setSource(this._tryParsingColor(e));else this.setSource([0,0,0,1])}_tryParsingColor(e){return(e=e.toLowerCase())in hk&&(e=hk[e]),e==="transparent"?[255,255,255,0]:We.sourceFromHex(e)||We.sourceFromRgb(e)||We.sourceFromHsl(e)||(this.isUnrecognised=!0)&&[0,0,0,1]}getSource(){return this._source}setSource(e){this._source=e}toRgb(){const[e,t,r]=this.getSource();return"rgb(".concat(e,",").concat(t,",").concat(r,")")}toRgba(){return"rgba(".concat(this.getSource().join(","),")")}toHsl(){const[e,t,r]=dk(...this.getSource());return"hsl(".concat(e,",").concat(t,"%,").concat(r,"%)")}toHsla(){const[e,t,r,s]=dk(...this.getSource());return"hsla(".concat(e,",").concat(t,"%,").concat(r,"%,").concat(s,")")}toHex(){return this.toHexa().slice(0,6)}toHexa(){const[e,t,r,s]=this.getSource();return"".concat(Vf(e)).concat(Vf(t)).concat(Vf(r)).concat(Vf(Math.round(255*s)))}getAlpha(){return this.getSource()[3]}setAlpha(e){return this._source[3]=e,this}toGrayscale(){return this.setSource(pk(this.getSource())),this}toBlackWhite(e){const[t,,,r]=pk(this.getSource()),s=t<(e||127)?0:255;return this.setSource([s,s,s,r]),this}overlayWith(e){e instanceof We||(e=new We(e));const t=this.getSource(),r=e.getSource(),[s,i,o]=t.map((a,l)=>Math.round(.5*a+.5*r[l]));return this.setSource([s,i,o,t[3]]),this}static fromRgb(e){return We.fromRgba(e)}static fromRgba(e){return new We(We.sourceFromRgb(e))}static sourceFromRgb(e){const t=tm(e).match(/^rgba?\(\s?(\d{0,3}(?:\.\d+)?%?)\s?[\s|,]\s?(\d{0,3}(?:\.\d+)?%?)\s?[\s|,]\s?(\d{0,3}(?:\.\d+)?%?)\s?(?:\s?[,/]\s?(\d{0,3}(?:\.\d+)?%?)\s?)?\)$/i);if(t){const[r,s,i]=t.slice(1,4).map(o=>{const a=parseFloat(o);return o.endsWith("%")?Math.round(2.55*a):a});return[r,s,i,fk(t[4])]}}static fromHsl(e){return We.fromHsla(e)}static fromHsla(e){return new We(We.sourceFromHsl(e))}static sourceFromHsl(e){const t=tm(e).match(/^hsla?\(\s?([+-]?\d{0,3}(?:\.\d+)?(?:deg|turn|rad)?)\s?[\s|,]\s?(\d{0,3}(?:\.\d+)?%?)\s?[\s|,]\s?(\d{0,3}(?:\.\d+)?%?)\s?(?:\s?[,/]\s?(\d*(?:\.\d+)?%?)\s?)?\)$/i);if(!t)return;const r=(We.parseAngletoDegrees(t[1])%360+360)%360/360,s=parseFloat(t[2])/100,i=parseFloat(t[3])/100;let o,a,l;if(s===0)o=a=l=i;else{const c=i<=.5?i*(s+1):i+s-i*s,u=2*i-c;o=Gv(u,c,r+1/3),a=Gv(u,c,r),l=Gv(u,c,r-1/3)}return[Math.round(255*o),Math.round(255*a),Math.round(255*l),fk(t[4])]}static fromHex(e){return new We(We.sourceFromHex(e))}static sourceFromHex(e){if(e.match(/^#?(([0-9a-f]){3,4}|([0-9a-f]{2}){3,4})$/i)){const t=e.slice(e.indexOf("#")+1);let r;r=t.length<=4?t.split("").map(l=>l+l):t.match(/.{2}/g);const[s,i,o,a=255]=r.map(l=>parseInt(l,16));return[s,i,o,a/255]}}static parseAngletoDegrees(e){const t=e.toLowerCase(),r=parseFloat(t);return t.includes("rad")?gi(r):t.includes("turn")?360*r:r}}const tc=function(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Xb;const t=/\D{0,2}$/.exec(n),r=parseFloat(n),s=Le.DPI;switch(t==null?void 0:t[0]){case"mm":return r*s/25.4;case"cm":return r*s/2.54;case"in":return r*s;case"pt":return r*s/72;case"pc":return r*s/72*12;case"em":return r*e;default:return r}},nY=n=>{const[e,t]=n.trim().split(" "),[r,s]=(i=e)&&i!==Ln?[i.slice(1,4),i.slice(5,8)]:i===Ln?[i,i]:["Mid","Mid"];var i;return{meetOrSlice:t||"meet",alignX:r,alignY:s}},nd=function(n,e){let t,r,s=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2];if(e)if(e.toLive)t="url(#SVGID_".concat(e.id,")");else{const i=new We(e),o=i.getAlpha();t=i.toRgb(),o!==1&&(r=o.toString())}else t="none";return s?"".concat(n,": ").concat(t,"; ").concat(r?"".concat(n,"-opacity: ").concat(r,"; "):""):"".concat(n,'="').concat(t,'" ').concat(r?"".concat(n,'-opacity="').concat(r,'" '):"")};class mD{getSvgStyles(e){const t=this.fillRule?this.fillRule:"nonzero",r=this.strokeWidth?this.strokeWidth:"0",s=this.strokeDashArray?this.strokeDashArray.join(" "):Ln,i=this.strokeDashOffset?this.strokeDashOffset:"0",o=this.strokeLineCap?this.strokeLineCap:"butt",a=this.strokeLineJoin?this.strokeLineJoin:"miter",l=this.strokeMiterLimit?this.strokeMiterLimit:"4",c=this.opacity!==void 0?this.opacity:"1",u=this.visible?"":" visibility: hidden;",h=e?"":this.getSvgFilter(),f=nd(Mt,this.fill);return[nd(Fn,this.stroke),"stroke-width: ",r,"; ","stroke-dasharray: ",s,"; ","stroke-linecap: ",o,"; ","stroke-dashoffset: ",i,"; ","stroke-linejoin: ",a,"; ","stroke-miterlimit: ",l,"; ",f,"fill-rule: ",t,"; ","opacity: ",c,";",h,u].join("")}getSvgFilter(){return this.shadow?"filter: url(#SVGID_".concat(this.shadow.id,");"):""}getSvgCommons(){return[this.id?'id="'.concat(this.id,'" '):"",this.clipPath?'clip-path="url(#'.concat(this.clipPath.clipPathId,')" '):""].join("")}getSvgTransform(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const r=e?this.calcTransformMatrix():this.calcOwnMatrix(),s='transform="'.concat(td(r));return"".concat(s).concat(t,'" ')}_toSVG(e){return[""]}toSVG(e){return this._createBaseSVGMarkup(this._toSVG(e),{reviver:e})}toClipPathSVG(e){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(e),{reviver:e})}_createBaseClipPathSVGMarkup(e){let{reviver:t,additionalTransform:r=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s=[this.getSvgTransform(!0,r),this.getSvgCommons()].join(""),i=e.indexOf("COMMON_PARTS");return e[i]=s,t?t(e.join("")):e.join("")}_createBaseSVGMarkup(e){let{noStyle:t,reviver:r,withShadow:s,additionalTransform:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const o=t?"":'style="'.concat(this.getSvgStyles(),'" '),a=s?'style="'.concat(this.getSvgFilter(),'" '):"",l=this.clipPath,c=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",u=l&&l.absolutePositioned,h=this.stroke,f=this.fill,p=this.shadow,y=[],m=e.indexOf("COMMON_PARTS");let v;l&&(l.clipPathId="CLIPPATH_".concat(Io()),v='<clipPath id="'.concat(l.clipPathId,`" >
`).concat(l.toClipPathSVG(r),`</clipPath>
`)),u&&y.push("<g ",a,this.getSvgCommons(),` >
`),y.push("<g ",this.getSvgTransform(!1),u?"":a+this.getSvgCommons(),` >
`);const w=[o,c,t?"":this.addPaintOrder()," ",i?'transform="'.concat(i,'" '):""].join("");return e[m]=w,dr(f)&&y.push(f.toSVG(this)),dr(h)&&y.push(h.toSVG(this)),p&&y.push(p.toSVG(this)),l&&y.push(v),y.push(e.join("")),y.push(`</g>
`),u&&y.push(`</g>
`),r?r(y.join("")):y.join("")}addPaintOrder(){return this.paintFirst!==Mt?' paint-order="'.concat(this.paintFirst,'" '):""}}function my(n){return new RegExp("^("+n.join("|")+")\\b","i")}const $a="textDecorationThickness",yD=["fontSize","fontWeight","fontFamily","fontStyle"],vD=["underline","overline","linethrough"],wD=[...yD,"lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],_D=[...wD,...vD,"textBackgroundColor","direction",$a],rY=[...yD,...vD,Fn,"strokeWidth",Mt,"deltaY","textBackgroundColor",$a],sY={_reNewline:Qb,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:$e,fontStyle:"normal",lineHeight:1.16,textBackgroundColor:"",stroke:null,shadow:null,path:void 0,pathStartOffset:0,pathSide:$e,pathAlign:"baseline",charSpacing:0,deltaY:0,direction:"ltr",CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.28167,overline:-.81333},_fontSizeMult:1.13,[$a]:66.667},ps="justify",nm="justify-left",hh="justify-right",dh="justify-center";var gk,mk,yk;const zr=String.raw(gk||(gk=Rs(["[-+]?(?:d*.d+|d+.?)(?:[eE][-+]?d+)?"],["[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?"]))),Kv=String.raw(mk||(mk=Rs(["(?:s*,?s+|s*,s*)"],["(?:\\s*,?\\s+|\\s*,\\s*)"]))),iY=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+zr+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+zr+"))?\\s+(.*)"),oY={cx:$e,x:$e,r:"radius",cy:Mn,y:Mn,display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing","text-decoration-thickness":$a},Yv="font-size",Xv="clip-path";my(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]);my(["symbol","image","marker","pattern","view","svg"]);const vk=my(["symbol","g","a","svg","clipPath","defs"]);new RegExp(String.raw(yk||(yk=Rs(["^s*(",")","(",")","(",")","(",")s*$"],["^\\s*(",")","(",")","(",")","(",")\\s*$"])),zr,Kv,zr,Kv,zr,Kv,zr));const aY=new $(1,0),xD=new $,bD=(n,e)=>n.rotate(e),p_=(n,e)=>new $(e).subtract(n),g_=n=>n.distanceFrom(xD),m_=(n,e)=>Math.atan2(fh(n,e),cY(n,e)),lY=n=>m_(aY,n),i1=n=>n.eq(xD)?n:n.scalarDivide(g_(n)),SD=function(n){let e=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return i1(new $(-n.y,n.x).scalarMultiply(e?1:-1))},fh=(n,e)=>n.x*e.y-n.y*e.x,cY=(n,e)=>n.x*e.x+n.y*e.y,wk=(n,e,t)=>{if(n.eq(e)||n.eq(t))return!0;const r=fh(e,t),s=fh(e,n),i=fh(t,n);return r>=0?s>=0&&i<=0:!(s<=0&&i>=0)},_k="(-?\\d+(?:\\.\\d*)?(?:px)?(?:\\s?|$))?",xk=new RegExp("(?:\\s|^)"+_k+_k+"("+zr+"?(?:px)?)?(?:\\s?|$)(?:$|\\s)");class ti{constructor(e){const t=typeof e=="string"?ti.parseShadow(e):e;Object.assign(this,ti.ownDefaults,t),this.id=Io()}static parseShadow(e){const t=e.trim(),[,r=0,s=0,i=0]=(xk.exec(t)||[]).map(o=>parseFloat(o)||0);return{color:(t.replace(xk,"")||"rgb(0,0,0)").trim(),offsetX:r,offsetY:s,blur:i}}toString(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")}toSVG(e){const t=bD(new $(this.offsetX,this.offsetY),xt(-e.angle)),r=new We(this.color);let s=40,i=40;return e.width&&e.height&&(s=100*Qe((Math.abs(t.x)+this.blur)/e.width,Le.NUM_FRACTION_DIGITS)+20,i=100*Qe((Math.abs(t.y)+this.blur)/e.height,Le.NUM_FRACTION_DIGITS)+20),e.flipX&&(t.x*=-1),e.flipY&&(t.y*=-1),'<filter id="SVGID_'.concat(this.id,'" y="-').concat(i,'%" height="').concat(100+2*i,'%" x="-').concat(s,'%" width="').concat(100+2*s,`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`).concat(Qe(this.blur?this.blur/2:0,Le.NUM_FRACTION_DIGITS),`"></feGaussianBlur>
	<feOffset dx="`).concat(Qe(t.x,Le.NUM_FRACTION_DIGITS),'" dy="').concat(Qe(t.y,Le.NUM_FRACTION_DIGITS),`" result="oBlur" ></feOffset>
	<feFlood flood-color="`).concat(r.toRgb(),'" flood-opacity="').concat(r.getAlpha(),`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`)}toObject(){const e={color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling,type:this.constructor.type},t=ti.ownDefaults;return this.includeDefaultValues?e:n1(e,(r,s)=>r!==t[s])}static async fromObject(e){return new this(e)}}M(ti,"ownDefaults",{color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1}),M(ti,"type","shadow"),re.setClass(ti,"shadow");const Oc=(n,e,t)=>Math.max(n,Math.min(e,t)),uY=[Mn,$e,Vn,vr,"flipX","flipY","originX","originY","angle","opacity","globalCompositeOperation","shadow","visible",eu,tu],wi=[Mt,Fn,"strokeWidth","strokeDashArray","width","height","paintFirst","strokeUniform","strokeLineCap","strokeDashOffset","strokeLineJoin","strokeMiterLimit","backgroundColor","clipPath"],hY={top:0,left:0,width:0,height:0,angle:0,flipX:!1,flipY:!1,scaleX:1,scaleY:1,minScaleLimit:0,skewX:0,skewY:0,originX:$e,originY:Mn,strokeWidth:1,strokeUniform:!1,padding:0,opacity:1,paintFirst:Mt,fill:"rgb(0,0,0)",fillRule:"nonzero",stroke:null,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,globalCompositeOperation:"source-over",backgroundColor:"",shadow:null,visible:!0,includeDefaultValues:!0,excludeFromExport:!1,objectCaching:!0,clipPath:void 0,inverted:!1,absolutePositioned:!1,centeredRotation:!0,centeredScaling:!1,dirty:!0},dY=(n,e,t,r)=>-t*Math.cos(n/r*jd)+t+e,fY=()=>!1;class o1{constructor(e){let{startValue:t,byValue:r,duration:s=500,delay:i=0,easing:o=dY,onStart:a=Fp,onChange:l=Fp,onComplete:c=Fp,abort:u=fY,target:h}=e;M(this,"_state","pending"),M(this,"durationProgress",0),M(this,"valueProgress",0),this.tick=this.tick.bind(this),this.duration=s,this.delay=i,this.easing=o,this._onStart=a,this._onChange=l,this._onComplete=c,this._abort=u,this.target=h,this.startValue=t,this.byValue=r,this.value=this.startValue,this.endValue=Object.freeze(this.calculate(this.duration).value)}get state(){return this._state}isDone(){return this._state==="aborted"||this._state==="completed"}start(){const e=t=>{this._state==="pending"&&(this.startTime=t||+new Date,this._state="running",this._onStart(),this.tick(this.startTime))};this.register(),this.delay>0?setTimeout(()=>Up(e),this.delay):Up(e)}tick(e){const t=(e||+new Date)-this.startTime,r=Math.min(t,this.duration);this.durationProgress=r/this.duration;const{value:s,valueProgress:i}=this.calculate(r);this.value=Object.freeze(s),this.valueProgress=i,this._state!=="aborted"&&(this._abort(this.value,this.valueProgress,this.durationProgress)?(this._state="aborted",this.unregister()):t>=this.duration?(this.durationProgress=this.valueProgress=1,this._onChange(this.endValue,this.valueProgress,this.durationProgress),this._state="completed",this._onComplete(this.endValue,this.valueProgress,this.durationProgress),this.unregister()):(this._onChange(this.value,this.valueProgress,this.durationProgress),Up(this.tick)))}register(){Qg.push(this)}unregister(){Qg.remove(this)}abort(){this._state="aborted",this.unregister()}}const pY=["startValue","endValue"];class gY extends o1{constructor(e){let{startValue:t=0,endValue:r=100}=e;super(L(L({},st(e,pY)),{},{startValue:t,byValue:r-t}))}calculate(e){const t=this.easing(e,this.startValue,this.byValue,this.duration);return{value:t,valueProgress:Math.abs((t-this.startValue)/this.byValue)}}}const mY=["startValue","endValue"];class yY extends o1{constructor(e){let{startValue:t=[0],endValue:r=[100]}=e;super(L(L({},st(e,mY)),{},{startValue:t,byValue:r.map((s,i)=>s-t[i])}))}calculate(e){const t=this.startValue.map((r,s)=>this.easing(e,r,this.byValue[s],this.duration,s));return{value:t,valueProgress:Math.abs((t[0]-this.startValue[0])/this.byValue[0])}}}const vY=["startValue","endValue","easing","onChange","onComplete","abort"],wY=(n,e,t,r)=>e+t*(1-Math.cos(n/r*jd)),Qv=n=>n&&((e,t,r)=>n(new We(e).toRgba(),t,r));class _Y extends o1{constructor(e){let{startValue:t,endValue:r,easing:s=wY,onChange:i,onComplete:o,abort:a}=e,l=st(e,vY);const c=new We(t).getSource(),u=new We(r).getSource();super(L(L({},l),{},{startValue:c,byValue:u.map((h,f)=>h-c[f]),easing:s,onChange:Qv(i),onComplete:Qv(o),abort:Qv(a)}))}calculate(e){const[t,r,s,i]=this.startValue.map((a,l)=>this.easing(e,a,this.byValue[l],this.duration,l)),o=[...[t,r,s].map(Math.round),Oc(0,i,1)];return{value:o,valueProgress:o.map((a,l)=>this.byValue[l]!==0?Math.abs((a-this.startValue[l])/this.byValue[l]):0).find(a=>a!==0)||0}}}function ED(n){const e=(t=>Array.isArray(t.startValue)||Array.isArray(t.endValue))(n)?new yY(n):new gY(n);return e.start(),e}function xY(n){const e=new _Y(n);return e.start(),e}class lt{constructor(e){this.status=e,this.points=[]}includes(e){return this.points.some(t=>t.eq(e))}append(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.points=this.points.concat(t.filter(s=>!this.includes(s))),this}static isPointContained(e,t,r){let s=arguments.length>3&&arguments[3]!==void 0&&arguments[3];if(t.eq(r))return e.eq(t);if(t.x===r.x)return e.x===t.x&&(s||e.y>=Math.min(t.y,r.y)&&e.y<=Math.max(t.y,r.y));if(t.y===r.y)return e.y===t.y&&(s||e.x>=Math.min(t.x,r.x)&&e.x<=Math.max(t.x,r.x));{const i=p_(t,r),o=p_(t,e).divide(i);return s?Math.abs(o.x)===Math.abs(o.y):o.x===o.y&&o.x>=0&&o.x<=1}}static isPointInPolygon(e,t){const r=new $(e).setX(Math.min(e.x-1,...t.map(i=>i.x)));let s=0;for(let i=0;i<t.length;i++){const o=this.intersectSegmentSegment(t[i],t[(i+1)%t.length],e,r);if(o.includes(e))return!0;s+=+(o.status==="Intersection")}return s%2==1}static intersectLineLine(e,t,r,s){let i=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4],o=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5];const a=t.x-e.x,l=t.y-e.y,c=s.x-r.x,u=s.y-r.y,h=e.x-r.x,f=e.y-r.y,p=c*f-u*h,y=a*f-l*h,m=u*a-c*l;if(m!==0){const v=p/m,w=y/m;return(i||0<=v&&v<=1)&&(o||0<=w&&w<=1)?new lt("Intersection").append(new $(e.x+v*a,e.y+v*l)):new lt}if(p===0||y===0){const v=i||o||lt.isPointContained(e,r,s)||lt.isPointContained(t,r,s)||lt.isPointContained(r,e,t)||lt.isPointContained(s,e,t);return new lt(v?"Coincident":void 0)}return new lt("Parallel")}static intersectSegmentLine(e,t,r,s){return lt.intersectLineLine(e,t,r,s,!1,!0)}static intersectSegmentSegment(e,t,r,s){return lt.intersectLineLine(e,t,r,s,!1,!1)}static intersectLinePolygon(e,t,r){let s=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];const i=new lt,o=r.length;for(let a,l,c,u=0;u<o;u++){if(a=r[u],l=r[(u+1)%o],c=lt.intersectLineLine(e,t,a,l,s,!1),c.status==="Coincident")return c;i.append(...c.points)}return i.points.length>0&&(i.status="Intersection"),i}static intersectSegmentPolygon(e,t,r){return lt.intersectLinePolygon(e,t,r,!1)}static intersectPolygonPolygon(e,t){const r=new lt,s=e.length,i=[];for(let o=0;o<s;o++){const a=e[o],l=e[(o+1)%s],c=lt.intersectSegmentPolygon(a,l,t);c.status==="Coincident"?(i.push(c),r.append(a,l)):r.append(...c.points)}return i.length>0&&i.length===e.length?new lt("Coincident"):(r.points.length>0&&(r.status="Intersection"),r)}static intersectPolygonRectangle(e,t,r){const s=t.min(r),i=t.max(r),o=new $(i.x,s.y),a=new $(s.x,i.y);return lt.intersectPolygonPolygon(e,[s,o,i,a])}}class bY extends eD{getX(){return this.getXY().x}setX(e){this.setXY(this.getXY().setX(e))}getY(){return this.getXY().y}setY(e){this.setXY(this.getXY().setY(e))}getRelativeX(){return this.left}setRelativeX(e){this.left=e}getRelativeY(){return this.top}setRelativeY(e){this.top=e}getXY(){const e=this.getRelativeXY();return this.group?Pn(e,this.group.calcTransformMatrix()):e}setXY(e,t,r){this.group&&(e=Pn(e,Br(this.group.calcTransformMatrix()))),this.setRelativeXY(e,t,r)}getRelativeXY(){return new $(this.left,this.top)}setRelativeXY(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.originX,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.originY;this.setPositionByOrigin(e,t,r)}isStrokeAccountedForInDimensions(){return!1}getCoords(){const{tl:e,tr:t,br:r,bl:s}=this.aCoords||(this.aCoords=this.calcACoords()),i=[e,t,r,s];if(this.group){const o=this.group.calcTransformMatrix();return i.map(a=>Pn(a,o))}return i}intersectsWithRect(e,t){return lt.intersectPolygonRectangle(this.getCoords(),e,t).status==="Intersection"}intersectsWithObject(e){const t=lt.intersectPolygonPolygon(this.getCoords(),e.getCoords());return t.status==="Intersection"||t.status==="Coincident"||e.isContainedWithinObject(this)||this.isContainedWithinObject(e)}isContainedWithinObject(e){return this.getCoords().every(t=>e.containsPoint(t))}isContainedWithinRect(e,t){const{left:r,top:s,width:i,height:o}=this.getBoundingRect();return r>=e.x&&r+i<=t.x&&s>=e.y&&s+o<=t.y}isOverlapping(e){return this.intersectsWithObject(e)||this.isContainedWithinObject(e)||e.isContainedWithinObject(this)}containsPoint(e){return lt.isPointInPolygon(e,this.getCoords())}isOnScreen(){if(!this.canvas)return!1;const{tl:e,br:t}=this.canvas.vptCoords;return!!this.getCoords().some(r=>r.x<=t.x&&r.x>=e.x&&r.y<=t.y&&r.y>=e.y)||!!this.intersectsWithRect(e,t)||this.containsPoint(e.midPointFrom(t))}isPartiallyOnScreen(){if(!this.canvas)return!1;const{tl:e,br:t}=this.canvas.vptCoords;return this.intersectsWithRect(e,t)?!0:this.getCoords().every(r=>(r.x>=t.x||r.x<=e.x)&&(r.y>=t.y||r.y<=e.y))&&this.containsPoint(e.midPointFrom(t))}getBoundingRect(){return ei(this.getCoords())}getScaledWidth(){return this._getTransformedDimensions().x}getScaledHeight(){return this._getTransformedDimensions().y}scale(e){this._set(Vn,e),this._set(vr,e),this.setCoords()}scaleToWidth(e){const t=this.getBoundingRect().width/this.getScaledWidth();return this.scale(e/this.width/t)}scaleToHeight(e){const t=this.getBoundingRect().height/this.getScaledHeight();return this.scale(e/this.height/t)}getCanvasRetinaScaling(){var e;return((e=this.canvas)===null||e===void 0?void 0:e.getRetinaScaling())||1}getTotalAngle(){return this.group?gi(rD(this.calcTransformMatrix())):this.angle}getViewportTransform(){var e;return((e=this.canvas)===null||e===void 0?void 0:e.viewportTransform)||bn.concat()}calcACoords(){const e=nu({angle:this.angle}),{x:t,y:r}=this.getRelativeCenterPoint(),s=Dd(t,r),i=Yt(s,e),o=this._getTransformedDimensions(),a=o.x/2,l=o.y/2;return{tl:Pn({x:-a,y:-l},i),tr:Pn({x:a,y:-l},i),bl:Pn({x:-a,y:l},i),br:Pn({x:a,y:l},i)}}setCoords(){this.aCoords=this.calcACoords()}transformMatrixKey(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],t=[];return!e&&this.group&&(t=this.group.transformMatrixKey(e)),t.push(this.top,this.left,this.width,this.height,this.scaleX,this.scaleY,this.angle,this.strokeWidth,this.skewX,this.skewY,+this.flipX,+this.flipY,Tt(this.originX),Tt(this.originY)),t}calcTransformMatrix(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],t=this.calcOwnMatrix();if(e||!this.group)return t;const r=this.transformMatrixKey(e),s=this.matrixCache;return s&&s.key.every((i,o)=>i===r[o])?s.value:(this.group&&(t=Yt(this.group.calcTransformMatrix(!1),t)),this.matrixCache={key:r,value:t},t)}calcOwnMatrix(){const e=this.transformMatrixKey(!0),t=this.ownMatrixCache;if(t&&t.key===e)return t.value;const r=this.getRelativeCenterPoint(),s={angle:this.angle,translateX:r.x,translateY:r.y,scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY},i=WK(s);return this.ownMatrixCache={key:e,value:i},i}_getNonTransformedDimensions(){return new $(this.width,this.height).scalarAdd(this.strokeWidth)}_calculateCurrentDimensions(e){return this._getTransformedDimensions(e).transform(this.getViewportTransform(),!0).scalarAdd(2*this.padding)}_getTransformedDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=L({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,width:this.width,height:this.height,strokeWidth:this.strokeWidth},e),r=t.strokeWidth;let s=r,i=0;this.strokeUniform&&(s=0,i=r);const o=t.width+s,a=t.height+s;let l;return l=t.skewX===0&&t.skewY===0?new $(o*t.scaleX,a*t.scaleY):r1(o,a,fy(t)),l.scalarAdd(i)}translateToGivenOrigin(e,t,r,s,i){let o=e.x,a=e.y;const l=Tt(s)-Tt(t),c=Tt(i)-Tt(r);if(l||c){const u=this._getTransformedDimensions();o+=l*u.x,a+=c*u.y}return new $(o,a)}translateToCenterPoint(e,t,r){if(t===Te&&r===Te)return e;const s=this.translateToGivenOrigin(e,t,r,Te,Te);return this.angle?s.rotate(xt(this.angle),e):s}translateToOriginPoint(e,t,r){const s=this.translateToGivenOrigin(e,Te,Te,t,r);return this.angle?s.rotate(xt(this.angle),e):s}getCenterPoint(){const e=this.getRelativeCenterPoint();return this.group?Pn(e,this.group.calcTransformMatrix()):e}getRelativeCenterPoint(){return this.translateToCenterPoint(new $(this.left,this.top),this.originX,this.originY)}getPointByOrigin(e,t){return this.translateToOriginPoint(this.getRelativeCenterPoint(),e,t)}setPositionByOrigin(e,t,r){const s=this.translateToCenterPoint(e,t,r),i=this.translateToOriginPoint(s,this.originX,this.originY);this.set({left:i.x,top:i.y})}_getLeftTopCoords(){return this.translateToOriginPoint(this.getRelativeCenterPoint(),$e,Mn)}}const SY=["type"],EY=["extraParam"];let Ls=class Bp extends bY{static getDefaults(){return Bp.ownDefaults}get type(){const e=this.constructor.type;return e==="FabricObject"?"object":e.toLowerCase()}set type(e){Po("warn","Setting type has no effect",e)}constructor(e){super(),M(this,"_cacheContext",null),Object.assign(this,Bp.ownDefaults),this.setOptions(e)}_createCacheCanvas(){this._cacheCanvas=pi(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0}_limitCacheSize(e){const t=e.width,r=e.height,s=Le.maxCacheSideLimit,i=Le.minCacheSideLimit;if(t<=s&&r<=s&&t*r<=Le.perfLimitSizeTotal)return t<i&&(e.width=i),r<i&&(e.height=i),e;const o=t/r,[a,l]=uh.limitDimsByArea(o),c=Oc(i,a,s),u=Oc(i,l,s);return t>c&&(e.zoomX/=t/c,e.width=c,e.capped=!0),r>u&&(e.zoomY/=r/u,e.height=u,e.capped=!0),e}_getCacheCanvasDimensions(){const e=this.getTotalObjectScaling(),t=this._getTransformedDimensions({skewX:0,skewY:0}),r=t.x*e.x/this.scaleX,s=t.y*e.y/this.scaleY;return{width:Math.ceil(r+2),height:Math.ceil(s+2),zoomX:e.x,zoomY:e.y,x:r,y:s}}_updateCacheCanvas(){const e=this._cacheCanvas,t=this._cacheContext,{width:r,height:s,zoomX:i,zoomY:o,x:a,y:l}=this._limitCacheSize(this._getCacheCanvasDimensions()),c=r!==e.width||s!==e.height,u=this.zoomX!==i||this.zoomY!==o;if(!e||!t)return!1;if(c||u){r!==e.width||s!==e.height?(e.width=r,e.height=s):(t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,e.width,e.height));const h=a/2,f=l/2;return this.cacheTranslationX=Math.round(e.width/2-h)+h,this.cacheTranslationY=Math.round(e.height/2-f)+f,t.translate(this.cacheTranslationX,this.cacheTranslationY),t.scale(i,o),this.zoomX=i,this.zoomY=o,!0}return!1}setOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setOptions(e)}transform(e){const t=this.group&&!this.group._transformDone||this.group&&this.canvas&&e===this.canvas.contextTop,r=this.calcTransformMatrix(!t);e.transform(r[0],r[1],r[2],r[3],r[4],r[5])}getObjectScaling(){if(!this.group)return new $(Math.abs(this.scaleX),Math.abs(this.scaleY));const e=Jg(this.calcTransformMatrix());return new $(Math.abs(e.scaleX),Math.abs(e.scaleY))}getTotalObjectScaling(){const e=this.getObjectScaling();if(this.canvas){const t=this.canvas.getZoom(),r=this.getCanvasRetinaScaling();return e.scalarMultiply(t*r)}return e}getObjectOpacity(){let e=this.opacity;return this.group&&(e*=this.group.getObjectOpacity()),e}_constrainScale(e){return Math.abs(e)<this.minScaleLimit?e<0?-this.minScaleLimit:this.minScaleLimit:e===0?1e-4:e}_set(e,t){e!==Vn&&e!==vr||(t=this._constrainScale(t)),e===Vn&&t<0?(this.flipX=!this.flipX,t*=-1):e==="scaleY"&&t<0?(this.flipY=!this.flipY,t*=-1):e!=="shadow"||!t||t instanceof ti||(t=new ti(t));const r=this[e]!==t;return this[e]=t,r&&this.constructor.cacheProperties.includes(e)&&(this.dirty=!0),this.parent&&(this.dirty||r&&this.constructor.stateProperties.includes(e))&&this.parent._set("dirty",!0),this}isNotVisible(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible}render(e){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(e.save(),this._setupCompositeOperation(e),this.drawSelectionBackground(e),this.transform(e),this._setOpacity(e),this._setShadow(e),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(e)):(this._removeCacheCanvas(),this.drawObject(e,!1,{}),this.dirty=!1),e.restore())}drawSelectionBackground(e){}renderCache(e){if(e=e||{},this._cacheCanvas&&this._cacheContext||this._createCacheCanvas(),this.isCacheDirty()&&this._cacheContext){const{zoomX:t,zoomY:r,cacheTranslationX:s,cacheTranslationY:i}=this,{width:o,height:a}=this._cacheCanvas;this.drawObject(this._cacheContext,e.forClipping,{zoomX:t,zoomY:r,cacheTranslationX:s,cacheTranslationY:i,width:o,height:a,parentClipPaths:[]}),this.dirty=!1}}_removeCacheCanvas(){this._cacheCanvas=void 0,this._cacheContext=null}hasStroke(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0}hasFill(){return this.fill&&this.fill!=="transparent"}needsItsOwnCache(){return!!(this.paintFirst===Fn&&this.hasFill()&&this.hasStroke()&&this.shadow)||!!this.clipPath}shouldCache(){return this.ownCaching=this.objectCaching&&(!this.parent||!this.parent.isOnACache())||this.needsItsOwnCache(),this.ownCaching}willDrawShadow(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)}drawClipPathOnCache(e,t,r){e.save(),t.inverted?e.globalCompositeOperation="destination-out":e.globalCompositeOperation="destination-in",e.setTransform(1,0,0,1,0,0),e.drawImage(r,0,0),e.restore()}drawObject(e,t,r){const s=this.fill,i=this.stroke;t?(this.fill="black",this.stroke="",this._setClippingProperties(e)):this._renderBackground(e),this._render(e),this._drawClipPath(e,this.clipPath,r),this.fill=s,this.stroke=i}createClipPathLayer(e,t){const r=wr(t),s=r.getContext("2d");if(s.translate(t.cacheTranslationX,t.cacheTranslationY),s.scale(t.zoomX,t.zoomY),e._cacheCanvas=r,t.parentClipPaths.forEach(i=>{i.transform(s)}),t.parentClipPaths.push(e),e.absolutePositioned){const i=Br(this.calcTransformMatrix());s.transform(i[0],i[1],i[2],i[3],i[4],i[5])}return e.transform(s),e.drawObject(s,!0,t),r}_drawClipPath(e,t,r){if(!t)return;t._transformDone=!0;const s=this.createClipPathLayer(t,r);this.drawClipPathOnCache(e,t,s)}drawCacheOnCanvas(e){e.scale(1/this.zoomX,1/this.zoomY),e.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)}isCacheDirty(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(this.isNotVisible())return!1;const t=this._cacheCanvas,r=this._cacheContext;return!(!t||!r||e||!this._updateCacheCanvas())||!!(this.dirty||this.clipPath&&this.clipPath.absolutePositioned)&&(t&&r&&!e&&(r.save(),r.setTransform(1,0,0,1,0,0),r.clearRect(0,0,t.width,t.height),r.restore()),!0)}_renderBackground(e){if(!this.backgroundColor)return;const t=this._getNonTransformedDimensions();e.fillStyle=this.backgroundColor,e.fillRect(-t.x/2,-t.y/2,t.x,t.y),this._removeShadow(e)}_setOpacity(e){this.group&&!this.group._transformDone?e.globalAlpha=this.getObjectOpacity():e.globalAlpha*=this.opacity}_setStrokeStyles(e,t){const r=t.stroke;r&&(e.lineWidth=t.strokeWidth,e.lineCap=t.strokeLineCap,e.lineDashOffset=t.strokeDashOffset,e.lineJoin=t.strokeLineJoin,e.miterLimit=t.strokeMiterLimit,dr(r)?r.gradientUnits==="percentage"||r.gradientTransform||r.patternTransform?this._applyPatternForTransformedGradient(e,r):(e.strokeStyle=r.toLive(e),this._applyPatternGradientTransform(e,r)):e.strokeStyle=t.stroke)}_setFillStyles(e,t){let{fill:r}=t;r&&(dr(r)?(e.fillStyle=r.toLive(e),this._applyPatternGradientTransform(e,r)):e.fillStyle=r)}_setClippingProperties(e){e.globalAlpha=1,e.strokeStyle="transparent",e.fillStyle="#000000"}_setLineDash(e,t){t&&t.length!==0&&e.setLineDash(t)}_setShadow(e){if(!this.shadow)return;const t=this.shadow,r=this.canvas,s=this.getCanvasRetinaScaling(),[i,,,o]=(r==null?void 0:r.viewportTransform)||bn,a=i*s,l=o*s,c=t.nonScaling?new $(1,1):this.getObjectScaling();e.shadowColor=t.color,e.shadowBlur=t.blur*Le.browserShadowBlurConstant*(a+l)*(c.x+c.y)/4,e.shadowOffsetX=t.offsetX*a*c.x,e.shadowOffsetY=t.offsetY*l*c.y}_removeShadow(e){this.shadow&&(e.shadowColor="",e.shadowBlur=e.shadowOffsetX=e.shadowOffsetY=0)}_applyPatternGradientTransform(e,t){if(!dr(t))return{offsetX:0,offsetY:0};const r=t.gradientTransform||t.patternTransform,s=-this.width/2+t.offsetX||0,i=-this.height/2+t.offsetY||0;return t.gradientUnits==="percentage"?e.transform(this.width,0,0,this.height,s,i):e.transform(1,0,0,1,s,i),r&&e.transform(r[0],r[1],r[2],r[3],r[4],r[5]),{offsetX:s,offsetY:i}}_renderPaintInOrder(e){this.paintFirst===Fn?(this._renderStroke(e),this._renderFill(e)):(this._renderFill(e),this._renderStroke(e))}_render(e){}_renderFill(e){this.fill&&(e.save(),this._setFillStyles(e,this),this.fillRule==="evenodd"?e.fill("evenodd"):e.fill(),e.restore())}_renderStroke(e){if(this.stroke&&this.strokeWidth!==0){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this.strokeUniform){const t=this.getObjectScaling();e.scale(1/t.x,1/t.y)}this._setLineDash(e,this.strokeDashArray),this._setStrokeStyles(e,this),e.stroke(),e.restore()}}_applyPatternForTransformedGradient(e,t){var r;const s=this._limitCacheSize(this._getCacheCanvasDimensions()),i=this.getCanvasRetinaScaling(),o=s.x/this.scaleX/i,a=s.y/this.scaleY/i,l=wr({width:Math.ceil(o),height:Math.ceil(a)}),c=l.getContext("2d");c&&(c.beginPath(),c.moveTo(0,0),c.lineTo(o,0),c.lineTo(o,a),c.lineTo(0,a),c.closePath(),c.translate(o/2,a/2),c.scale(s.zoomX/this.scaleX/i,s.zoomY/this.scaleY/i),this._applyPatternGradientTransform(c,t),c.fillStyle=t.toLive(e),c.fill(),e.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),e.scale(i*this.scaleX/s.zoomX,i*this.scaleY/s.zoomY),e.strokeStyle=(r=c.createPattern(l,"no-repeat"))!==null&&r!==void 0?r:"")}_findCenterFromElement(){return new $(this.left+this.width/2,this.top+this.height/2)}clone(e){const t=this.toObject(e);return this.constructor.fromObject(t)}cloneAsImage(e){const t=this.toCanvasElement(e);return new(re.getClass("image"))(t)}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=hD(this),r=this.group,s=this.shadow,i=Math.abs,o=e.enableRetinaScaling?Yj():1,a=(e.multiplier||1)*o,l=e.canvasProvider||(_=>new Md(_,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1}));delete this.group,e.withoutTransform&&QK(this),e.withoutShadow&&(this.shadow=null),e.viewportTransform&&ZK(this,this.getViewportTransform()),this.setCoords();const c=pi(),u=this.getBoundingRect(),h=this.shadow,f=new $;if(h){const _=h.blur,x=h.nonScaling?new $(1,1):this.getObjectScaling();f.x=2*Math.round(i(h.offsetX)+_)*i(x.x),f.y=2*Math.round(i(h.offsetY)+_)*i(x.y)}const p=u.width+f.x,y=u.height+f.y;c.width=Math.ceil(p),c.height=Math.ceil(y);const m=l(c);e.format==="jpeg"&&(m.backgroundColor="#fff"),this.setPositionByOrigin(new $(m.width/2,m.height/2),Te,Te);const v=this.canvas;m._objects=[this],this.set("canvas",m),this.setCoords();const w=m.toCanvasElement(a||1,e);return this.set("canvas",v),this.shadow=s,r&&(this.group=r),this.set(t),this.setCoords(),m._objects=[],m.destroy(),w}toDataURL(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return tD(this.toCanvasElement(e),e.format||"png",e.quality||1)}toBlob(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return nD(this.toCanvasElement(e),e.format||"png",e.quality||1)}isType(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.includes(this.constructor.type)||t.includes(this.type)}complexity(){return 1}toJSON(){return this.toObject()}rotate(e){const{centeredRotation:t,originX:r,originY:s}=this;if(t){const{x:i,y:o}=this.getRelativeCenterPoint();this.originX=Te,this.originY=Te,this.left=i,this.top=o}if(this.set("angle",e),t){const{x:i,y:o}=this.translateToOriginPoint(this.getRelativeCenterPoint(),r,s);this.left=i,this.top=o,this.originX=r,this.originY=s}}setOnGroup(){}_setupCompositeOperation(e){this.globalCompositeOperation&&(e.globalCompositeOperation=this.globalCompositeOperation)}dispose(){Qg.cancelByTarget(this),this.off(),this._set("canvas",void 0),this._cacheCanvas&&As().dispose(this._cacheCanvas),this._cacheCanvas=void 0,this._cacheContext=null}animate(e,t){return Object.entries(e).reduce((r,s)=>{let[i,o]=s;return r[i]=this._animate(i,o,t),r},{})}_animate(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=e.split("."),i=this.constructor.colorProperties.includes(s[s.length-1]),{abort:o,startValue:a,onChange:l,onComplete:c}=r,u=L(L({},r),{},{target:this,startValue:a??s.reduce((h,f)=>h[f],this),endValue:t,abort:o==null?void 0:o.bind(this),onChange:(h,f,p)=>{s.reduce((y,m,v)=>(v===s.length-1&&(y[m]=h),y[m]),this),l&&l(h,f,p)},onComplete:(h,f,p)=>{this.setCoords(),c&&c(h,f,p)}});return i?xY(u):ED(u)}isDescendantOf(e){const{parent:t,group:r}=this;return t===e||r===e||!!t&&t.isDescendantOf(e)||!!r&&r!==t&&r.isDescendantOf(e)}getAncestors(){const e=[];let t=this;do t=t.parent,t&&e.push(t);while(t);return e}findCommonAncestors(e){if(this===e)return{fork:[],otherFork:[],common:[this,...this.getAncestors()]};const t=this.getAncestors(),r=e.getAncestors();if(t.length===0&&r.length>0&&this===r[r.length-1])return{fork:[],otherFork:[e,...r.slice(0,r.length-1)],common:[this]};for(let s,i=0;i<t.length;i++){if(s=t[i],s===e)return{fork:[this,...t.slice(0,i)],otherFork:[],common:t.slice(i)};for(let o=0;o<r.length;o++){if(this===r[o])return{fork:[],otherFork:[e,...r.slice(0,o)],common:[this,...t]};if(s===r[o])return{fork:[this,...t.slice(0,i)],otherFork:[e,...r.slice(0,o)],common:t.slice(i)}}}return{fork:[this,...t],otherFork:[e,...r],common:[]}}hasCommonAncestors(e){const t=this.findCommonAncestors(e);return t&&!!t.common.length}isInFrontOf(e){if(this===e)return;const t=this.findCommonAncestors(e);if(t.fork.includes(e))return!0;if(t.otherFork.includes(this))return!1;const r=t.common[0]||this.canvas;if(!r)return;const s=t.fork.pop(),i=t.otherFork.pop(),o=r._objects.indexOf(s),a=r._objects.indexOf(i);return o>-1&&o>a}toObject(){const e=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).concat(Bp.customProperties,this.constructor.customProperties||[]);let t;const r=Le.NUM_FRACTION_DIGITS,{clipPath:s,fill:i,stroke:o,shadow:a,strokeDashArray:l,left:c,top:u,originX:h,originY:f,width:p,height:y,strokeWidth:m,strokeLineCap:v,strokeDashOffset:w,strokeLineJoin:_,strokeUniform:x,strokeMiterLimit:A,scaleX:j,scaleY:N,angle:S,flipX:T,flipY:P,opacity:R,visible:D,backgroundColor:I,fillRule:k,paintFirst:F,globalCompositeOperation:K,skewX:G,skewY:Y}=this;s&&!s.excludeFromExport&&(t=s.toObject(e.concat("inverted","absolutePositioned")));const V=Q=>Qe(Q,r),z=L(L({},ru(this,e)),{},{type:this.constructor.type,version:u_,originX:h,originY:f,left:V(c),top:V(u),width:V(p),height:V(y),fill:ok(i)?i.toObject():i,stroke:ok(o)?o.toObject():o,strokeWidth:V(m),strokeDashArray:l&&l.concat(),strokeLineCap:v,strokeDashOffset:w,strokeLineJoin:_,strokeUniform:x,strokeMiterLimit:V(A),scaleX:V(j),scaleY:V(N),angle:V(S),flipX:T,flipY:P,opacity:V(R),shadow:a&&a.toObject(),visible:D,backgroundColor:I,fillRule:k,paintFirst:F,globalCompositeOperation:K,skewX:V(G),skewY:V(Y)},t?{clipPath:t}:null);return this.includeDefaultValues?z:this._removeDefaultValues(z)}toDatalessObject(e){return this.toObject(e)}_removeDefaultValues(e){const t=this.constructor.getDefaults(),r=Object.keys(t).length>0?t:Object.getPrototypeOf(this);return n1(e,(s,i)=>{if(i===$e||i===Mn||i==="type")return!0;const o=r[i];return s!==o&&!(Array.isArray(s)&&Array.isArray(o)&&s.length===0&&o.length===0)})}toString(){return"#<".concat(this.constructor.type,">")}static _fromObject(e){let t=st(e,SY),r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{extraParam:s}=r,i=st(r,EY);return py(t,i).then(o=>s?(delete o[s],new this(t[s],o)):new this(o))}static fromObject(e,t){return this._fromObject(e,t)}};M(Ls,"stateProperties",uY),M(Ls,"cacheProperties",wi),M(Ls,"ownDefaults",hY),M(Ls,"type","FabricObject"),M(Ls,"colorProperties",[Mt,Fn,"backgroundColor"]),M(Ls,"customProperties",[]),re.setClass(Ls),re.setClass(Ls,"object");const su=(n,e,t)=>(r,s,i,o)=>{const a=e(r,s,i,o);return a&&dD(n,L(L({},pD(r,s,i,o)),t)),a};function iu(n){return(e,t,r,s)=>{const{target:i,originX:o,originY:a}=t,l=i.getRelativeCenterPoint(),c=i.translateToOriginPoint(l,o,a),u=n(e,t,r,s);return i.setPositionByOrigin(c,t.originX,t.originY),u}}const bk=su(Zh,iu((n,e,t,r)=>{const s=s1(e,e.originX,e.originY,t,r);if(Tt(e.originX)===Tt(Te)||Tt(e.originX)===Tt(vt)&&s.x<0||Tt(e.originX)===Tt($e)&&s.x>0){const{target:i}=e,o=i.strokeWidth/(i.strokeUniform?i.scaleX:1),a=fD(e)?2:1,l=i.width,c=Math.abs(s.x*a/i.scaleX)-o;return i.set("width",Math.max(c,1)),l!==i.width}return!1}));function TY(n,e,t,r,s){r=r||{};const i=this.sizeX||r.cornerSize||s.cornerSize,o=this.sizeY||r.cornerSize||s.cornerSize,a=r.transparentCorners!==void 0?r.transparentCorners:s.transparentCorners,l=a?Fn:Mt,c=!a&&(r.cornerStrokeColor||s.cornerStrokeColor);let u,h=e,f=t;n.save(),n.fillStyle=r.cornerColor||s.cornerColor||"",n.strokeStyle=r.cornerStrokeColor||s.cornerStrokeColor||"",i>o?(u=i,n.scale(1,o/i),f=t*i/o):o>i?(u=o,n.scale(i/o,1),h=e*o/i):u=i,n.beginPath(),n.arc(h,f,u/2,0,Kg,!1),n[l](),c&&n.stroke(),n.restore()}function CY(n,e,t,r,s){r=r||{};const i=this.sizeX||r.cornerSize||s.cornerSize,o=this.sizeY||r.cornerSize||s.cornerSize,a=r.transparentCorners!==void 0?r.transparentCorners:s.transparentCorners,l=a?Fn:Mt,c=!a&&(r.cornerStrokeColor||s.cornerStrokeColor),u=i/2,h=o/2;n.save(),n.fillStyle=r.cornerColor||s.cornerColor||"",n.strokeStyle=r.cornerStrokeColor||s.cornerStrokeColor||"",n.translate(e,t);const f=s.getTotalAngle();n.rotate(xt(f)),n["".concat(l,"Rect")](-u,-h,i,o),c&&n.strokeRect(-u,-h,i,o),n.restore()}class Ar{constructor(e){M(this,"visible",!0),M(this,"actionName",dy),M(this,"angle",0),M(this,"x",0),M(this,"y",0),M(this,"offsetX",0),M(this,"offsetY",0),M(this,"sizeX",0),M(this,"sizeY",0),M(this,"touchSizeX",0),M(this,"touchSizeY",0),M(this,"cursorStyle","crosshair"),M(this,"withConnection",!1),Object.assign(this,e)}shouldActivate(e,t,r,s){var i;let{tl:o,tr:a,br:l,bl:c}=s;return((i=t.canvas)===null||i===void 0?void 0:i.getActiveObject())===t&&t.isControlVisible(e)&&lt.isPointInPolygon(r,[o,a,l,c])}getActionHandler(e,t,r){return this.actionHandler}getMouseDownHandler(e,t,r){return this.mouseDownHandler}getMouseUpHandler(e,t,r){return this.mouseUpHandler}cursorStyleHandler(e,t,r){return t.cursorStyle}getActionName(e,t,r){return t.actionName}getVisibility(e,t){var r,s;return(r=(s=e._controlsVisibility)===null||s===void 0?void 0:s[t])!==null&&r!==void 0?r:this.visible}setVisibility(e,t,r){this.visible=e}positionHandler(e,t,r,s){return new $(this.x*e.x+this.offsetX,this.y*e.y+this.offsetY).transform(t)}calcCornerCoords(e,t,r,s,i,o){const a=e1([Dd(r,s),nu({angle:e}),t1((i?this.touchSizeX:this.sizeX)||t,(i?this.touchSizeY:this.sizeY)||t)]);return{tl:new $(-.5,-.5).transform(a),tr:new $(.5,-.5).transform(a),br:new $(.5,.5).transform(a),bl:new $(-.5,.5).transform(a)}}render(e,t,r,s,i){((s=s||{}).cornerStyle||i.cornerStyle)==="circle"?TY.call(this,e,t,r,s,i):CY.call(this,e,t,r,s,i)}}const kY=(n,e,t)=>t.lockRotation?em:e.cursorStyle,AY=su(Qj,iu((n,e,t,r)=>{let{target:s,ex:i,ey:o,theta:a,originX:l,originY:c}=e;const u=s.translateToOriginPoint(s.getRelativeCenterPoint(),l,c);if(qr(s,"lockRotation"))return!1;const h=Math.atan2(o-u.y,i-u.x),f=Math.atan2(r-u.y,t-u.x);let p=gi(f-h+a);if(s.snapAngle&&s.snapAngle>0){const m=s.snapAngle,v=s.snapThreshold||m,w=Math.ceil(p/m)*m,_=Math.floor(p/m)*m;Math.abs(p-_)<v?p=_:Math.abs(p-w)<v&&(p=w)}p<0&&(p=360+p),p%=360;const y=s.angle!==p;return s.angle=p,y}));function TD(n,e){const t=e.canvas,r=n[t.uniScaleKey];return t.uniformScaling&&!r||!t.uniformScaling&&r}function CD(n,e,t){const r=qr(n,"lockScalingX"),s=qr(n,"lockScalingY");if(r&&s||!e&&(r||s)&&t||r&&e==="x"||s&&e==="y")return!0;const{width:i,height:o,strokeWidth:a}=n;return i===0&&a===0&&e!=="y"||o===0&&a===0&&e!=="x"}const PY=["e","se","s","sw","w","nw","n","ne","e"],Wu=(n,e,t)=>{const r=TD(n,t);if(CD(t,e.x!==0&&e.y===0?"x":e.x===0&&e.y!==0?"y":"",r))return em;const s=gD(t,e);return"".concat(PY[s],"-resize")};function a1(n,e,t,r){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};const i=e.target,o=s.by,a=TD(n,i);let l,c,u,h,f,p;if(CD(i,o,a))return!1;if(e.gestureScale)c=e.scaleX*e.gestureScale,u=e.scaleY*e.gestureScale;else{if(l=s1(e,e.originX,e.originY,t,r),f=o!=="y"?Math.sign(l.x||e.signX||1):1,p=o!=="x"?Math.sign(l.y||e.signY||1):1,e.signX||(e.signX=f),e.signY||(e.signY=p),qr(i,"lockScalingFlip")&&(e.signX!==f||e.signY!==p))return!1;if(h=i._getTransformedDimensions(),a&&!o){const v=Math.abs(l.x)+Math.abs(l.y),{original:w}=e,_=v/(Math.abs(h.x*w.scaleX/i.scaleX)+Math.abs(h.y*w.scaleY/i.scaleY));c=w.scaleX*_,u=w.scaleY*_}else c=Math.abs(l.x*i.scaleX/h.x),u=Math.abs(l.y*i.scaleY/h.y);fD(e)&&(c*=2,u*=2),e.signX!==f&&o!=="y"&&(e.originX=uk(e.originX),c*=-1,e.signX=f),e.signY!==p&&o!=="x"&&(e.originY=uk(e.originY),u*=-1,e.signY=p)}const y=i.scaleX,m=i.scaleY;return o?(o==="x"&&i.set(Vn,c),o==="y"&&i.set(vr,u)):(!qr(i,"lockScalingX")&&i.set(Vn,c),!qr(i,"lockScalingY")&&i.set(vr,u)),y!==i.scaleX||m!==i.scaleY}const Uf=su(hy,iu((n,e,t,r)=>a1(n,e,t,r))),IY=su(hy,iu((n,e,t,r)=>a1(n,e,t,r,{by:"x"}))),RY=su(hy,iu((n,e,t,r)=>a1(n,e,t,r,{by:"y"}))),OY=["target","ex","ey","skewingSide"],Jv={x:{counterAxis:"y",scale:Vn,skew:eu,lockSkewing:"lockSkewingX",origin:"originX",flip:"flipX"},y:{counterAxis:"x",scale:vr,skew:tu,lockSkewing:"lockSkewingY",origin:"originY",flip:"flipY"}},NY=["ns","nesw","ew","nwse"],jY=(n,e,t)=>{if(e.x!==0&&qr(t,"lockSkewingY")||e.y!==0&&qr(t,"lockSkewingX"))return em;const r=gD(t,e)%4;return"".concat(NY[r],"-resize")};function kD(n,e,t,r,s){const{target:i}=t,{counterAxis:o,origin:a,lockSkewing:l,skew:c,flip:u}=Jv[n];if(qr(i,l))return!1;const{origin:h,flip:f}=Jv[o],p=Tt(t[h])*(i[f]?-1:1),y=-Math.sign(p)*(i[u]?-1:1),m=.5*-((i[c]===0&&s1(t,Te,Te,r,s)[n]>0||i[c]>0?1:-1)*y)+.5;return su(Jj,iu((w,_,x,A)=>function(j,N,S){let{target:T,ex:P,ey:R,skewingSide:D}=N,I=st(N,OY);const{skew:k}=Jv[j],F=S.subtract(new $(P,R)).divide(new $(T.scaleX,T.scaleY))[j],K=T[k],G=I[k],Y=Math.tan(xt(G)),V=j==="y"?T._getTransformedDimensions({scaleX:1,scaleY:1,skewX:0}).x:T._getTransformedDimensions({scaleX:1,scaleY:1}).y,z=2*F*D/Math.max(V,1)+Y,Q=gi(Math.atan(z));T.set(k,Q);const ue=K!==T[k];if(ue&&j==="y"){const{skewX:oe,scaleX:fe}=T,ce=T._getTransformedDimensions({skewY:K}),Ne=T._getTransformedDimensions(),je=oe!==0?ce.x/Ne.x:1;je!==1&&T.set(Vn,je*fe)}return ue}(n,_,new $(x,A))))(e,L(L({},t),{},{[a]:m,skewingSide:y}),r,s)}const DY=(n,e,t,r)=>kD("x",n,e,t,r),MY=(n,e,t,r)=>kD("y",n,e,t,r);function yy(n,e){return n[e.canvas.altActionKey]}const $f=(n,e,t)=>{const r=yy(n,t);return e.x===0?r?eu:vr:e.y===0?r?tu:Vn:""},Ml=(n,e,t)=>yy(n,t)?jY(0,e,t):Wu(n,e,t),Sk=(n,e,t,r)=>yy(n,e.target)?MY(n,e,t,r):IY(n,e,t,r),Ek=(n,e,t,r)=>yy(n,e.target)?DY(n,e,t,r):RY(n,e,t,r),AD=()=>({ml:new Ar({x:-.5,y:0,cursorStyleHandler:Ml,actionHandler:Sk,getActionName:$f}),mr:new Ar({x:.5,y:0,cursorStyleHandler:Ml,actionHandler:Sk,getActionName:$f}),mb:new Ar({x:0,y:.5,cursorStyleHandler:Ml,actionHandler:Ek,getActionName:$f}),mt:new Ar({x:0,y:-.5,cursorStyleHandler:Ml,actionHandler:Ek,getActionName:$f}),tl:new Ar({x:-.5,y:-.5,cursorStyleHandler:Wu,actionHandler:Uf}),tr:new Ar({x:.5,y:-.5,cursorStyleHandler:Wu,actionHandler:Uf}),bl:new Ar({x:-.5,y:.5,cursorStyleHandler:Wu,actionHandler:Uf}),br:new Ar({x:.5,y:.5,cursorStyleHandler:Wu,actionHandler:Uf}),mtr:new Ar({x:0,y:-.5,actionHandler:AY,cursorStyleHandler:kY,offsetY:-40,withConnection:!0,actionName:Jb})}),LY=()=>({mr:new Ar({x:.5,y:0,actionHandler:bk,cursorStyleHandler:Ml,actionName:Zh}),ml:new Ar({x:-.5,y:0,actionHandler:bk,cursorStyleHandler:Ml,actionName:Zh})}),FY=()=>L(L({},AD()),LY());class rd extends Ls{static getDefaults(){return L(L({},super.getDefaults()),rd.ownDefaults)}constructor(e){super(),Object.assign(this,this.constructor.createControls(),rd.ownDefaults),this.setOptions(e)}static createControls(){return{controls:AD()}}_updateCacheCanvas(){const e=this.canvas;if(this.noScaleCache&&e&&e._currentTransform){const t=e._currentTransform,r=t.target,s=t.action;if(this===r&&s&&s.startsWith(dy))return!1}return super._updateCacheCanvas()}getActiveControl(){const e=this.__corner;return e?{key:e,control:this.controls[e],coord:this.oCoords[e]}:void 0}findControl(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!this.hasControls||!this.canvas)return;this.__corner=void 0;const r=Object.entries(this.oCoords);for(let s=r.length-1;s>=0;s--){const[i,o]=r[s],a=this.controls[i];if(a.shouldActivate(i,this,e,t?o.touchCorner:o.corner))return this.__corner=i,{key:i,control:a,coord:this.oCoords[i]}}}calcOCoords(){const e=this.getViewportTransform(),t=this.getCenterPoint(),r=Dd(t.x,t.y),s=nu({angle:this.getTotalAngle()-(this.group&&this.flipX?180:0)}),i=Yt(r,s),o=Yt(e,i),a=Yt(o,[1/e[0],0,0,1/e[3],0,0]),l=this.group?Jg(this.calcTransformMatrix()):void 0;l&&(l.scaleX=Math.abs(l.scaleX),l.scaleY=Math.abs(l.scaleY));const c=this._calculateCurrentDimensions(l),u={};return this.forEachControl((h,f)=>{const p=h.positionHandler(c,a,this,h);u[f]=Object.assign(p,this._calcCornerCoords(h,p))}),u}_calcCornerCoords(e,t){const r=this.getTotalAngle();return{corner:e.calcCornerCoords(r,this.cornerSize,t.x,t.y,!1,this),touchCorner:e.calcCornerCoords(r,this.touchCornerSize,t.x,t.y,!0,this)}}setCoords(){super.setCoords(),this.canvas&&(this.oCoords=this.calcOCoords())}forEachControl(e){for(const t in this.controls)e(this.controls[t],t,this)}drawSelectionBackground(e){if(!this.selectionBackgroundColor||this.canvas&&this.canvas._activeObject!==this)return;e.save();const t=this.getRelativeCenterPoint(),r=this._calculateCurrentDimensions(),s=this.getViewportTransform();e.translate(t.x,t.y),e.scale(1/s[0],1/s[3]),e.rotate(xt(this.angle)),e.fillStyle=this.selectionBackgroundColor,e.fillRect(-r.x/2,-r.y/2,r.x,r.y),e.restore()}strokeBorders(e,t){e.strokeRect(-t.x/2,-t.y/2,t.x,t.y)}_drawBorders(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=L({hasControls:this.hasControls,borderColor:this.borderColor,borderDashArray:this.borderDashArray},r);e.save(),e.strokeStyle=s.borderColor,this._setLineDash(e,s.borderDashArray),this.strokeBorders(e,t),s.hasControls&&this.drawControlsConnectingLines(e,t),e.restore()}_renderControls(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{hasBorders:r,hasControls:s}=this,i=L({hasBorders:r,hasControls:s},t),o=this.getViewportTransform(),a=i.hasBorders,l=i.hasControls,c=Yt(o,this.calcTransformMatrix()),u=Jg(c);e.save(),e.translate(u.translateX,u.translateY),e.lineWidth=this.borderScaleFactor,this.group===this.parent&&(e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(u.angle-=180),e.rotate(xt(this.group?u.angle:this.angle)),a&&this.drawBorders(e,u,t),l&&this.drawControls(e,t),e.restore()}drawBorders(e,t,r){let s;if(r&&r.forActiveSelection||this.group){const i=r1(this.width,this.height,fy(t)),o=this.isStrokeAccountedForInDimensions()?Zb:(this.strokeUniform?new $().scalarAdd(this.canvas?this.canvas.getZoom():1):new $(t.scaleX,t.scaleY)).scalarMultiply(this.strokeWidth);s=i.add(o).scalarAdd(this.borderScaleFactor).scalarAdd(2*this.padding)}else s=this._calculateCurrentDimensions().scalarAdd(this.borderScaleFactor);this._drawBorders(e,s,r)}drawControlsConnectingLines(e,t){let r=!1;e.beginPath(),this.forEachControl((s,i)=>{s.withConnection&&s.getVisibility(this,i)&&(r=!0,e.moveTo(s.x*t.x,s.y*t.y),e.lineTo(s.x*t.x+s.offsetX,s.y*t.y+s.offsetY))}),r&&e.stroke()}drawControls(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e.save();const r=this.getCanvasRetinaScaling(),{cornerStrokeColor:s,cornerDashArray:i,cornerColor:o}=this,a=L({cornerStrokeColor:s,cornerDashArray:i,cornerColor:o},t);e.setTransform(r,0,0,r,0,0),e.strokeStyle=e.fillStyle=a.cornerColor,this.transparentCorners||(e.strokeStyle=a.cornerStrokeColor),this._setLineDash(e,a.cornerDashArray),this.forEachControl((l,c)=>{if(l.getVisibility(this,c)){const u=this.oCoords[c];l.render(e,u.x,u.y,a,this)}}),e.restore()}isControlVisible(e){return this.controls[e]&&this.controls[e].getVisibility(this,e)}setControlVisible(e,t){this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[e]=t}setControlsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.entries(e).forEach(t=>{let[r,s]=t;return this.setControlVisible(r,s)})}clearContextTop(e){if(!this.canvas)return;const t=this.canvas.contextTop;if(!t)return;const r=this.canvas.viewportTransform;t.save(),t.transform(r[0],r[1],r[2],r[3],r[4],r[5]),this.transform(t);const s=this.width+4,i=this.height+4;return t.clearRect(-s/2,-i/2,s,i),e||t.restore(),t}onDeselect(e){return!1}onSelect(e){return!1}shouldStartDragging(e){return!1}onDragStart(e){return!1}canDrop(e){return!1}renderDragSourceEffect(e){}renderDropTargetEffect(e){}}function PD(n,e){return e.forEach(t=>{Object.getOwnPropertyNames(t.prototype).forEach(r=>{r!=="constructor"&&Object.defineProperty(n.prototype,r,Object.getOwnPropertyDescriptor(t.prototype,r)||Object.create(null))})}),n}M(rd,"ownDefaults",{noScaleCache:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,cornerSize:13,touchCornerSize:24,transparentCorners:!0,cornerColor:"rgb(178,204,255)",cornerStrokeColor:"",cornerStyle:"rect",cornerDashArray:null,hasControls:!0,borderColor:"rgb(178,204,255)",borderDashArray:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,hasBorders:!0,selectionBackgroundColor:"",selectable:!0,evented:!0,perPixelTargetFind:!1,activeOn:"down",hoverCursor:null,moveCursor:null});class cn extends rd{}PD(cn,[mD]),re.setClass(cn),re.setClass(cn,"object");const VY=(n,e,t,r)=>{const s=2*(r=Math.round(r))+1,{data:i}=n.getImageData(e-r,t-r,s,s);for(let o=3;o<i.length;o+=4)if(i[o]>0)return!1;return!0};class ID{constructor(e){this.options=e,this.strokeProjectionMagnitude=this.options.strokeWidth/2,this.scale=new $(this.options.scaleX,this.options.scaleY),this.strokeUniformScalar=this.options.strokeUniform?new $(1/this.options.scaleX,1/this.options.scaleY):new $(1,1)}createSideVector(e,t){const r=p_(e,t);return this.options.strokeUniform?r.multiply(this.scale):r}projectOrthogonally(e,t,r){return this.applySkew(e.add(this.calcOrthogonalProjection(e,t,r)))}isSkewed(){return this.options.skewX!==0||this.options.skewY!==0}applySkew(e){const t=new $(e);return t.y+=t.x*Math.tan(xt(this.options.skewY)),t.x+=t.y*Math.tan(xt(this.options.skewX)),t}scaleUnitVector(e,t){return e.multiply(this.strokeUniformScalar).scalarMultiply(t)}}const UY=new $;class nc extends ID{static getOrthogonalRotationFactor(e,t){const r=t?m_(e,t):lY(e);return Math.abs(r)<jd?-1:1}constructor(e,t,r,s){super(s),M(this,"AB",void 0),M(this,"AC",void 0),M(this,"alpha",void 0),M(this,"bisector",void 0),this.A=new $(e),this.B=new $(t),this.C=new $(r),this.AB=this.createSideVector(this.A,this.B),this.AC=this.createSideVector(this.A,this.C),this.alpha=m_(this.AB,this.AC),this.bisector=i1(bD(this.AB.eq(UY)?this.AC:this.AB,this.alpha/2))}calcOrthogonalProjection(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude;const s=this.createSideVector(e,t),i=SD(s),o=nc.getOrthogonalRotationFactor(i,this.bisector);return this.scaleUnitVector(i,r*o)}projectBevel(){const e=[];return(this.alpha%Kg==0?[this.B]:[this.B,this.C]).forEach(t=>{e.push(this.projectOrthogonally(this.A,t)),e.push(this.projectOrthogonally(this.A,t,-this.strokeProjectionMagnitude))}),e}projectMiter(){const e=[],t=Math.abs(this.alpha),r=1/Math.sin(t/2),s=this.scaleUnitVector(this.bisector,-this.strokeProjectionMagnitude*r),i=this.options.strokeUniform?g_(this.scaleUnitVector(this.bisector,this.options.strokeMiterLimit)):this.options.strokeMiterLimit;return g_(s)/this.strokeProjectionMagnitude<=i&&e.push(this.applySkew(this.A.add(s))),e.push(...this.projectBevel()),e}projectRoundNoSkew(e,t){const r=[],s=new $(nc.getOrthogonalRotationFactor(this.bisector),nc.getOrthogonalRotationFactor(new $(this.bisector.y,this.bisector.x)));return[new $(1,0).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(s),new $(0,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(s)].forEach(i=>{wk(i,e,t)&&r.push(this.A.add(i))}),r}projectRoundWithSkew(e,t){const r=[],{skewX:s,skewY:i,scaleX:o,scaleY:a,strokeUniform:l}=this.options,c=new $(Math.tan(xt(s)),Math.tan(xt(i))),u=this.strokeProjectionMagnitude,h=l?u/a/Math.sqrt(1/a**2+1/o**2*c.y**2):u/Math.sqrt(1+c.y**2),f=new $(Math.sqrt(Math.max(u**2-h**2,0)),h),p=l?u/Math.sqrt(1+c.x**2*(1/a)**2/(1/o+1/o*c.x*c.y)**2):u/Math.sqrt(1+c.x**2/(1+c.x*c.y)**2),y=new $(p,Math.sqrt(Math.max(u**2-p**2,0)));return[y,y.scalarMultiply(-1),f,f.scalarMultiply(-1)].map(m=>this.applySkew(l?m.multiply(this.strokeUniformScalar):m)).forEach(m=>{wk(m,e,t)&&r.push(this.applySkew(this.A).add(m))}),r}projectRound(){const e=[];e.push(...this.projectBevel());const t=this.alpha%Kg==0,r=this.applySkew(this.A),s=e[t?0:2].subtract(r),i=e[t?1:0].subtract(r),o=t?this.applySkew(this.AB.scalarMultiply(-1)):this.applySkew(this.bisector.multiply(this.strokeUniformScalar).scalarMultiply(-1)),a=fh(s,o)>0,l=a?s:i,c=a?i:s;return this.isSkewed()?e.push(...this.projectRoundWithSkew(l,c)):e.push(...this.projectRoundNoSkew(l,c)),e}projectPoints(){switch(this.options.strokeLineJoin){case"miter":return this.projectMiter();case"round":return this.projectRound();default:return this.projectBevel()}}project(){return this.projectPoints().map(e=>({originPoint:this.A,projectedPoint:e,angle:this.alpha,bisector:this.bisector}))}}class Tk extends ID{constructor(e,t,r){super(r),this.A=new $(e),this.T=new $(t)}calcOrthogonalProjection(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude;const s=this.createSideVector(e,t);return this.scaleUnitVector(SD(s),r)}projectButt(){return[this.projectOrthogonally(this.A,this.T,this.strokeProjectionMagnitude),this.projectOrthogonally(this.A,this.T,-this.strokeProjectionMagnitude)]}projectRound(){const e=[];if(!this.isSkewed()&&this.A.eq(this.T)){const t=new $(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);e.push(this.applySkew(this.A.add(t)),this.applySkew(this.A.subtract(t)))}else e.push(...new nc(this.A,this.T,this.T,this.options).projectRound());return e}projectSquare(){const e=[];if(this.A.eq(this.T)){const t=new $(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);e.push(this.A.add(t),this.A.subtract(t))}else{const t=this.calcOrthogonalProjection(this.A,this.T,this.strokeProjectionMagnitude),r=this.scaleUnitVector(i1(this.createSideVector(this.A,this.T)),-this.strokeProjectionMagnitude),s=this.A.add(r);e.push(s.add(t),s.subtract(t))}return e.map(t=>this.applySkew(t))}projectPoints(){switch(this.options.strokeLineCap){case"round":return this.projectRound();case"square":return this.projectSquare();default:return this.projectButt()}}project(){return this.projectPoints().map(e=>({originPoint:this.A,projectedPoint:e}))}}const $Y=function(n,e){let t=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const r=[];if(n.length===0)return r;const s=n.reduce((i,o)=>(i[i.length-1].eq(o)||i.push(new $(o)),i),[new $(n[0])]);if(s.length===1)t=!0;else if(!t){const i=s[0],o=((a,l)=>{for(let c=a.length-1;c>=0;c--)if(l(a[c],c,a))return c;return-1})(s,a=>!a.eq(i));s.splice(o+1)}return s.forEach((i,o,a)=>{let l,c;o===0?(c=a[1],l=t?i:a[a.length-1]):o===a.length-1?(l=a[o-1],c=t?i:a[0]):(l=a[o-1],c=a[o+1]),t&&a.length===1?r.push(...new Tk(i,i,e).project()):!t||o!==0&&o!==a.length-1?r.push(...new nc(i,l,c,e).project()):r.push(...new Tk(i,o===0?c:l,e).project())}),r},l1=n=>{const e={};return Object.keys(n).forEach(t=>{e[t]={},Object.keys(n[t]).forEach(r=>{e[t][r]=L({},n[t][r])})}),e},BY=n=>n.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;");let Ru;const c1=n=>{if(Ru||Ru||(Ru="Intl"in uy()&&"Segmenter"in Intl&&new Intl.Segmenter(void 0,{granularity:"grapheme"})),Ru){const e=Ru.segment(n);return Array.from(e).map(t=>{let{segment:r}=t;return r})}return zY(n)},zY=n=>{const e=[];for(let t,r=0;r<n.length;r++)(t=WY(n,r))!==!1&&e.push(t);return e},WY=(n,e)=>{const t=n.charCodeAt(e);if(isNaN(t))return"";if(t<55296||t>57343)return n.charAt(e);if(55296<=t&&t<=56319){if(n.length<=e+1)throw"High surrogate without following low surrogate";const s=n.charCodeAt(e+1);if(56320>s||s>57343)throw"High surrogate without following low surrogate";return n.charAt(e)+n.charAt(e+1)}if(e===0)throw"Low surrogate without preceding high surrogate";const r=n.charCodeAt(e-1);if(55296>r||r>56319)throw"Low surrogate without preceding high surrogate";return!1},u1=function(n,e){let t=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return n.fill!==e.fill||n.stroke!==e.stroke||n.strokeWidth!==e.strokeWidth||n.fontSize!==e.fontSize||n.fontFamily!==e.fontFamily||n.fontWeight!==e.fontWeight||n.fontStyle!==e.fontStyle||n.textDecorationThickness!==e.textDecorationThickness||n.textBackgroundColor!==e.textBackgroundColor||n.deltaY!==e.deltaY||t&&(n.overline!==e.overline||n.underline!==e.underline||n.linethrough!==e.linethrough)},HY=(n,e)=>{const t=e.split(`
`),r=[];let s=-1,i={};n=l1(n);for(let o=0;o<t.length;o++){const a=c1(t[o]);if(n[o])for(let l=0;l<a.length;l++){s++;const c=n[o][l];c&&Object.keys(c).length>0&&(u1(i,c,!0)?r.push({start:s,end:s+1,style:c}):r[r.length-1].end++),i=c||{}}else s+=a.length,i={}}return r},qY=(n,e)=>{if(!Array.isArray(n))return l1(n);const t=e.split(Qb),r={};let s=-1,i=0;for(let o=0;o<t.length;o++){const a=c1(t[o]);for(let l=0;l<a.length;l++)s++,n[i]&&n[i].start<=s&&s<n[i].end&&(r[o]=r[o]||{},r[o][l]=L({},n[i].style),s===n[i].end-1&&i++)}return r},$o=["display","transform",Mt,"fill-opacity","fill-rule","opacity",Fn,"stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"];function Ck(n,e){const t=n.nodeName,r=n.getAttribute("class"),s=n.getAttribute("id"),i="(?![a-zA-Z\\-]+)";let o;if(o=new RegExp("^"+t,"i"),e=e.replace(o,""),s&&e.length&&(o=new RegExp("#"+s+i,"i"),e=e.replace(o,"")),r&&e.length){const a=r.split(" ");for(let l=a.length;l--;)o=new RegExp("\\."+a[l]+i,"i"),e=e.replace(o,"")}return e.length===0}function GY(n,e){let t=!0;const r=Ck(n,e.pop());return r&&e.length&&(t=function(s,i){let o,a=!0;for(;s.parentElement&&s.parentElement.nodeType===1&&i.length;)a&&(o=i.pop()),a=Ck(s=s.parentElement,o);return i.length===0}(n,e)),r&&t&&e.length===0}const KY=n=>{var e;return(e=oY[n])!==null&&e!==void 0?e:n},YY=new RegExp("(".concat(zr,")"),"gi"),XY=n=>tm(n.replace(YY," $1 ").replace(/,/gi," "));var kk,Ak,Pk,Ik,Rk,Ok,Nk;const wn="(".concat(zr,")"),QY=String.raw(kk||(kk=Rs(["(skewX)(",")"],["(skewX)\\(","\\)"])),wn),JY=String.raw(Ak||(Ak=Rs(["(skewY)(",")"],["(skewY)\\(","\\)"])),wn),ZY=String.raw(Pk||(Pk=Rs(["(rotate)(","(?: "," ",")?)"],["(rotate)\\(","(?: "," ",")?\\)"])),wn,wn,wn),eX=String.raw(Ik||(Ik=Rs(["(scale)(","(?: ",")?)"],["(scale)\\(","(?: ",")?\\)"])),wn,wn),tX=String.raw(Rk||(Rk=Rs(["(translate)(","(?: ",")?)"],["(translate)\\(","(?: ",")?\\)"])),wn,wn),nX=String.raw(Ok||(Ok=Rs(["(matrix)("," "," "," "," "," ",")"],["(matrix)\\("," "," "," "," "," ","\\)"])),wn,wn,wn,wn,wn,wn),h1="(?:".concat(nX,"|").concat(tX,"|").concat(ZY,"|").concat(eX,"|").concat(QY,"|").concat(JY,")"),rX="(?:".concat(h1,"*)"),sX=String.raw(Nk||(Nk=Rs(["^s*(?:","?)s*$"],["^\\s*(?:","?)\\s*$"])),rX),iX=new RegExp(sX),oX=new RegExp(h1),aX=new RegExp(h1,"g");function y_(n){const e=[];if(!(n=XY(n).replace(/\s*([()])\s*/gi,"$1"))||n&&!iX.test(n))return[...bn];for(const t of n.matchAll(aX)){const r=oX.exec(t[0]);if(!r)continue;let s=bn;const i=r.filter(y=>!!y),[,o,...a]=i,[l,c,u,h,f,p]=a.map(y=>parseFloat(y));switch(o){case"translate":s=Dd(l,c);break;case Jb:s=nu({angle:l},{x:c,y:u});break;case dy:s=t1(l,c);break;case eu:s=iD(l);break;case tu:s=oD(l);break;case"matrix":s=[l,c,u,h,f,p]}e.push(s)}return e1(e)}function lX(n,e,t,r){const s=Array.isArray(e);let i,o=e;if(n!==Mt&&n!==Fn||e!==Ln){if(n==="strokeUniform")return e==="non-scaling-stroke";if(n==="strokeDashArray")o=e===Ln?null:e.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(n==="transformMatrix")o=t&&t.transformMatrix?Yt(t.transformMatrix,y_(e)):y_(e);else if(n==="visible")o=e!==Ln&&e!=="hidden",t&&t.visible===!1&&(o=!1);else if(n==="opacity")o=parseFloat(e),t&&t.opacity!==void 0&&(o*=t.opacity);else if(n==="textAnchor")o=e==="start"?$e:e==="end"?vt:Te;else if(n==="charSpacing"||n===$a)i=tc(e,r)/r*1e3;else if(n==="paintFirst"){const a=e.indexOf(Mt),l=e.indexOf(Fn);o=Mt,(a>-1&&l>-1&&l<a||a===-1&&l>-1)&&(o=Fn)}else{if(n==="href"||n==="xlink:href"||n==="font"||n==="id")return e;if(n==="imageSmoothing")return e==="optimizeQuality";i=s?e.map(tc):tc(e,r)}}else o="";return!s&&isNaN(i)?o:i}function cX(n,e){const t=n.match(iY);if(!t)return;const r=t[1],s=t[3],i=t[4],o=t[5],a=t[6];r&&(e.fontStyle=r),s&&(e.fontWeight=isNaN(parseFloat(s))?s:parseFloat(s)),i&&(e.fontSize=tc(i)),a&&(e.fontFamily=a),o&&(e.lineHeight=o==="normal"?1:o)}function uX(n,e){n.replace(/;\s*$/,"").split(";").forEach(t=>{if(!t)return;const[r,s]=t.split(":");e[r.trim().toLowerCase()]=s.trim()})}function hX(n){const e={},t=n.getAttribute("style");return t&&(typeof t=="string"?uX(t,e):function(r,s){Object.entries(r).forEach(i=>{let[o,a]=i;a!==void 0&&(s[o.toLowerCase()]=a)})}(t,e)),e}const dX={stroke:"strokeOpacity",fill:"fillOpacity"};function _i(n,e,t){if(!n)return{};let r,s={},i=Xb;n.parentNode&&vk.test(n.parentNode.nodeName)&&(s=_i(n.parentElement,e,t),s.fontSize&&(r=i=tc(s.fontSize)));const o=L(L(L({},e.reduce((c,u)=>{const h=n.getAttribute(u);return h&&(c[u]=h),c},{})),function(c){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},h={};for(const f in u)GY(c,f.split(" "))&&(h=L(L({},h),u[f]));return h}(n,t)),hX(n));o[Xv]&&n.setAttribute(Xv,o[Xv]),o[Yv]&&(r=tc(o[Yv],i),o[Yv]="".concat(r));const a={};for(const c in o){const u=KY(c),h=lX(u,o[c],s,r);a[u]=h}a&&a.font&&cX(a.font,a);const l=L(L({},s),a);return vk.test(n.nodeName)?l:function(c){const u=cn.getDefaults();return Object.entries(dX).forEach(h=>{let[f,p]=h;if(c[p]===void 0||c[f]==="")return;if(c[f]===void 0){if(!u[f])return;c[f]=u[f]}if(c[f].indexOf("url(")===0)return;const y=new We(c[f]);c[f]=y.setAlpha(Qe(y.getAlpha()*c[p],2)).toRgba()}),c}(l)}const fX=["left","top","width","height","visible"],RD=["rx","ry"];class Vr extends cn{static getDefaults(){return L(L({},super.getDefaults()),Vr.ownDefaults)}constructor(e){super(),Object.assign(this,Vr.ownDefaults),this.setOptions(e),this._initRxRy()}_initRxRy(){const{rx:e,ry:t}=this;e&&!t?this.ry=e:t&&!e&&(this.rx=t)}_render(e){const{width:t,height:r}=this,s=-t/2,i=-r/2,o=this.rx?Math.min(this.rx,t/2):0,a=this.ry?Math.min(this.ry,r/2):0,l=o!==0||a!==0;e.beginPath(),e.moveTo(s+o,i),e.lineTo(s+t-o,i),l&&e.bezierCurveTo(s+t-ji*o,i,s+t,i+ji*a,s+t,i+a),e.lineTo(s+t,i+r-a),l&&e.bezierCurveTo(s+t,i+r-ji*a,s+t-ji*o,i+r,s+t-o,i+r),e.lineTo(s+o,i+r),l&&e.bezierCurveTo(s+ji*o,i+r,s,i+r-ji*a,s,i+r-a),e.lineTo(s,i+a),l&&e.bezierCurveTo(s,i+ji*a,s+ji*o,i,s+o,i),e.closePath(),this._renderPaintInOrder(e)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...RD,...e])}_toSVG(){const{width:e,height:t,rx:r,ry:s}=this;return["<rect ","COMMON_PARTS",'x="'.concat(-e/2,'" y="').concat(-t/2,'" rx="').concat(r,'" ry="').concat(s,'" width="').concat(e,'" height="').concat(t,`" />
`)]}static async fromElement(e,t,r){const s=_i(e,this.ATTRIBUTE_NAMES,r),{left:i=0,top:o=0,width:a=0,height:l=0,visible:c=!0}=s,u=st(s,fX);return new this(L(L(L({},t),u),{},{left:i,top:o,width:a,height:l,visible:!!(c&&a&&l)}))}}M(Vr,"type","Rect"),M(Vr,"cacheProperties",[...wi,...RD]),M(Vr,"ownDefaults",{rx:0,ry:0}),M(Vr,"ATTRIBUTE_NAMES",[...$o,"x","y","rx","ry","width","height"]),re.setClass(Vr),re.setSVGClass(Vr);const Ys="initialization",rm="added",d1="removed",sm="imperative",OD=(n,e)=>{const{strokeUniform:t,strokeWidth:r,width:s,height:i,group:o}=e,a=o&&o!==n?gy(o.calcTransformMatrix(),n.calcTransformMatrix()):null,l=a?e.getRelativeCenterPoint().transform(a):e.getRelativeCenterPoint(),c=!e.isStrokeAccountedForInDimensions(),u=t&&c?JK(new $(r,r),void 0,n.calcTransformMatrix()):Zb,h=!t&&c?r:0,f=r1(s+h,i+h,e1([a,e.calcOwnMatrix()],!0)).add(u).scalarDivide(2);return[l.subtract(f),l.add(f)]};class vy{calcLayoutResult(e,t){if(this.shouldPerformLayout(e))return this.calcBoundingBox(t,e)}shouldPerformLayout(e){let{type:t,prevStrategy:r,strategy:s}=e;return t===Ys||t===sm||!!r&&s!==r}shouldLayoutClipPath(e){let{type:t,target:{clipPath:r}}=e;return t!==Ys&&r&&!r.absolutePositioned}getInitialSize(e,t){return t.size}calcBoundingBox(e,t){const{type:r,target:s}=t;if(r===sm&&t.overrides)return t.overrides;if(e.length===0)return;const{left:i,top:o,width:a,height:l}=ei(e.map(h=>OD(s,h)).reduce((h,f)=>h.concat(f),[])),c=new $(a,l),u=new $(i,o).add(c.scalarDivide(2));if(r===Ys){const h=this.getInitialSize(t,{size:c,center:u});return{center:u,relativeCorrection:new $(0,0),size:h}}return{center:u.transform(s.calcOwnMatrix()),size:c}}}M(vy,"type","strategy");class v_ extends vy{shouldPerformLayout(e){return!0}}M(v_,"type","fit-content"),re.setClass(v_);const pX=["strategy"],gX=["target","strategy","bubbles","prevStrategy"],ND="layoutManager";class sd{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new v_;M(this,"strategy",void 0),this.strategy=e,this._subscriptions=new Map}performLayout(e){const t=L(L({bubbles:!0,strategy:this.strategy},e),{},{prevStrategy:this._prevLayoutStrategy,stopPropagation(){this.bubbles=!1}});this.onBeforeLayout(t);const r=this.getLayoutResult(t);r&&this.commitLayout(t,r),this.onAfterLayout(t,r),this._prevLayoutStrategy=t.strategy}attachHandlers(e,t){const{target:r}=t;return[Xg,Xj,Zh,Qj,hy,Jj,Yg,LK,FK].map(s=>e.on(s,i=>this.performLayout(s===Xg?{type:"object_modified",trigger:s,e:i,target:r}:{type:"object_modifying",trigger:s,e:i,target:r})))}subscribe(e,t){this.unsubscribe(e,t);const r=this.attachHandlers(e,t);this._subscriptions.set(e,r)}unsubscribe(e,t){(this._subscriptions.get(e)||[]).forEach(r=>r()),this._subscriptions.delete(e)}unsubscribeTargets(e){e.targets.forEach(t=>this.unsubscribe(t,e))}subscribeTargets(e){e.targets.forEach(t=>this.subscribe(t,e))}onBeforeLayout(e){const{target:t,type:r}=e,{canvas:s}=t;if(r===Ys||r===rm?this.subscribeTargets(e):r===d1&&this.unsubscribeTargets(e),t.fire("layout:before",{context:e}),s&&s.fire("object:layout:before",{target:t,context:e}),r===sm&&e.deep){const i=st(e,pX);t.forEachObject(o=>o.layoutManager&&o.layoutManager.performLayout(L(L({},i),{},{bubbles:!1,target:o})))}}getLayoutResult(e){const{target:t,strategy:r,type:s}=e,i=r.calcLayoutResult(e,t.getObjects());if(!i)return;const o=s===Ys?new $:t.getRelativeCenterPoint(),{center:a,correction:l=new $,relativeCorrection:c=new $}=i,u=o.subtract(a).add(l).transform(s===Ys?bn:Br(t.calcOwnMatrix()),!0).add(c);return{result:i,prevCenter:o,nextCenter:a,offset:u}}commitLayout(e,t){const{target:r}=e,{result:{size:s},nextCenter:i}=t;var o,a;r.set({width:s.x,height:s.y}),this.layoutObjects(e,t),e.type===Ys?r.set({left:(o=e.x)!==null&&o!==void 0?o:i.x+s.x*Tt(r.originX),top:(a=e.y)!==null&&a!==void 0?a:i.y+s.y*Tt(r.originY)}):(r.setPositionByOrigin(i,Te,Te),r.setCoords(),r.set("dirty",!0))}layoutObjects(e,t){const{target:r}=e;r.forEachObject(s=>{s.group===r&&this.layoutObject(e,t,s)}),e.strategy.shouldLayoutClipPath(e)&&this.layoutObject(e,t,r.clipPath)}layoutObject(e,t,r){let{offset:s}=t;r.set({left:r.left+s.x,top:r.top+s.y})}onAfterLayout(e,t){const{target:r,strategy:s,bubbles:i,prevStrategy:o}=e,a=st(e,gX),{canvas:l}=r;r.fire("layout:after",{context:e,result:t}),l&&l.fire("object:layout:after",{context:e,result:t,target:r});const c=r.parent;i&&c!=null&&c.layoutManager&&((a.path||(a.path=[])).push(r),c.layoutManager.performLayout(L(L({},a),{},{target:c}))),r.set("dirty",!0)}dispose(){const{_subscriptions:e}=this;e.forEach(t=>t.forEach(r=>r())),e.clear()}toObject(){return{type:ND,strategy:this.strategy.constructor.type}}toJSON(){return this.toObject()}}re.setClass(sd,ND);const mX=["type","objects","layoutManager"];class yX extends sd{performLayout(){}}class ka extends Zj(cn){static getDefaults(){return L(L({},super.getDefaults()),ka.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),M(this,"_activeObjects",[]),M(this,"__objectSelectionTracker",void 0),M(this,"__objectSelectionDisposer",void 0),Object.assign(this,ka.ownDefaults),this.setOptions(t),this.groupInit(e,t)}groupInit(e,t){var r;this._objects=[...e],this.__objectSelectionTracker=this.__objectSelectionMonitor.bind(this,!0),this.__objectSelectionDisposer=this.__objectSelectionMonitor.bind(this,!1),this.forEachObject(s=>{this.enterGroup(s,!1)}),this.layoutManager=(r=t.layoutManager)!==null&&r!==void 0?r:new sd,this.layoutManager.performLayout({type:Ys,target:this,targets:[...e],x:t.left,y:t.top})}canEnterGroup(e){return e===this||this.isDescendantOf(e)?(Po("error","Group: circular object trees are not supported, this call has no effect"),!1):this._objects.indexOf(e)===-1||(Po("error","Group: duplicate objects are not supported inside group, this call has no effect"),!1)}_filterObjectsBeforeEnteringGroup(e){return e.filter((t,r,s)=>this.canEnterGroup(t)&&s.indexOf(t)===r)}add(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const s=this._filterObjectsBeforeEnteringGroup(t),i=super.add(...s);return this._onAfterObjectsChange(rm,s),i}insertAt(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),s=1;s<t;s++)r[s-1]=arguments[s];const i=this._filterObjectsBeforeEnteringGroup(r),o=super.insertAt(e,...i);return this._onAfterObjectsChange(rm,i),o}remove(){const e=super.remove(...arguments);return this._onAfterObjectsChange(d1,e),e}_onObjectAdded(e){this.enterGroup(e,!0),this.fire("object:added",{target:e}),e.fire("added",{target:this})}_onObjectRemoved(e,t){this.exitGroup(e,t),this.fire("object:removed",{target:e}),e.fire("removed",{target:this})}_onAfterObjectsChange(e,t){this.layoutManager.performLayout({type:e,targets:t,target:this})}_onStackOrderChanged(){this._set("dirty",!0)}_set(e,t){const r=this[e];return super._set(e,t),e==="canvas"&&r!==t&&(this._objects||[]).forEach(s=>{s._set(e,t)}),this}_shouldSetNestedCoords(){return this.subTargetCheck}removeAll(){return this._activeObjects=[],this.remove(...this._objects)}__objectSelectionMonitor(e,t){let{target:r}=t;const s=this._activeObjects;if(e)s.push(r),this._set("dirty",!0);else if(s.length>0){const i=s.indexOf(r);i>-1&&(s.splice(i,1),this._set("dirty",!0))}}_watchObject(e,t){e&&this._watchObject(!1,t),e?(t.on("selected",this.__objectSelectionTracker),t.on("deselected",this.__objectSelectionDisposer)):(t.off("selected",this.__objectSelectionTracker),t.off("deselected",this.__objectSelectionDisposer))}enterGroup(e,t){e.group&&e.group.remove(e),e._set("parent",this),this._enterGroup(e,t)}_enterGroup(e,t){t&&Zg(e,Yt(Br(this.calcTransformMatrix()),e.calcTransformMatrix())),this._shouldSetNestedCoords()&&e.setCoords(),e._set("group",this),e._set("canvas",this.canvas),this._watchObject(!0,e);const r=this.canvas&&this.canvas.getActiveObject&&this.canvas.getActiveObject();r&&(r===e||e.isDescendantOf(r))&&this._activeObjects.push(e)}exitGroup(e,t){this._exitGroup(e,t),e._set("parent",void 0),e._set("canvas",void 0)}_exitGroup(e,t){e._set("group",void 0),t||(Zg(e,Yt(this.calcTransformMatrix(),e.calcTransformMatrix())),e.setCoords()),this._watchObject(!1,e);const r=this._activeObjects.length>0?this._activeObjects.indexOf(e):-1;r>-1&&this._activeObjects.splice(r,1)}shouldCache(){const e=cn.prototype.shouldCache.call(this);if(e){for(let t=0;t<this._objects.length;t++)if(this._objects[t].willDrawShadow())return this.ownCaching=!1,!1}return e}willDrawShadow(){if(super.willDrawShadow())return!0;for(let e=0;e<this._objects.length;e++)if(this._objects[e].willDrawShadow())return!0;return!1}isOnACache(){return this.ownCaching||!!this.parent&&this.parent.isOnACache()}drawObject(e,t,r){this._renderBackground(e);for(let i=0;i<this._objects.length;i++){var s;const o=this._objects[i];(s=this.canvas)!==null&&s!==void 0&&s.preserveObjectStacking&&o.group!==this?(e.save(),e.transform(...Br(this.calcTransformMatrix())),o.render(e),e.restore()):o.group===this&&o.render(e)}this._drawClipPath(e,this.clipPath,r)}setCoords(){super.setCoords(),this._shouldSetNestedCoords()&&this.forEachObject(e=>e.setCoords())}triggerLayout(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.layoutManager.performLayout(L({target:this,type:sm},e))}render(e){this._transformDone=!0,super.render(e),this._transformDone=!1}__serializeObjects(e,t){const r=this.includeDefaultValues;return this._objects.filter(function(s){return!s.excludeFromExport}).map(function(s){const i=s.includeDefaultValues;s.includeDefaultValues=r;const o=s[e||"toObject"](t);return s.includeDefaultValues=i,o})}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const t=this.layoutManager.toObject();return L(L(L({},super.toObject(["subTargetCheck","interactive",...e])),t.strategy!=="fit-content"||this.includeDefaultValues?{layoutManager:t}:{}),{},{objects:this.__serializeObjects("toObject",e)})}toString(){return"#<Group: (".concat(this.complexity(),")>")}dispose(){this.layoutManager.unsubscribeTargets({targets:this.getObjects(),target:this}),this._activeObjects=[],this.forEachObject(e=>{this._watchObject(!1,e),e.dispose()}),super.dispose()}_createSVGBgRect(e){if(!this.backgroundColor)return"";const t=Vr.prototype._toSVG.call(this),r=t.indexOf("COMMON_PARTS");t[r]='for="group" ';const s=t.join("");return e?e(s):s}_toSVG(e){const t=["<g ","COMMON_PARTS",` >
`],r=this._createSVGBgRect(e);r&&t.push("		",r);for(let s=0;s<this._objects.length;s++)t.push("		",this._objects[s].toSVG(e));return t.push(`</g>
`),t}getSvgStyles(){const e=this.opacity!==void 0&&this.opacity!==1?"opacity: ".concat(this.opacity,";"):"",t=this.visible?"":" visibility: hidden;";return[e,this.getSvgFilter(),t].join("")}toClipPathSVG(e){const t=[],r=this._createSVGBgRect(e);r&&t.push("	",r);for(let s=0;s<this._objects.length;s++)t.push("	",this._objects[s].toClipPathSVG(e));return this._createBaseClipPathSVGMarkup(t,{reviver:e})}static fromObject(e,t){let{type:r,objects:s=[],layoutManager:i}=e,o=st(e,mX);return Promise.all([ed(s,t),py(o,t)]).then(a=>{let[l,c]=a;const u=new this(l,L(L(L({},o),c),{},{layoutManager:new yX}));if(i){const h=re.getClass(i.type),f=re.getClass(i.strategy);u.layoutManager=new h(new f)}else u.layoutManager=new sd;return u.layoutManager.subscribeTargets({type:Ys,target:u,targets:u.getObjects()}),u.setCoords(),u})}}M(ka,"type","Group"),M(ka,"ownDefaults",{strokeWidth:0,subTargetCheck:!1,interactive:!1}),re.setClass(ka);const vX=(n,e)=>Math.min(e.width/n.width,e.height/n.height),wX=(n,e)=>Math.max(e.width/n.width,e.height/n.height),w_="\\s*,?\\s*",Ou="".concat(w_,"(").concat(zr,")"),_X="".concat(Ou).concat(Ou).concat(Ou).concat(w_,"([01])").concat(w_,"([01])").concat(Ou).concat(Ou),xX={m:"l",M:"L"},bX=(n,e,t,r,s,i,o,a,l,c,u)=>{const h=di(n),f=fi(n),p=di(e),y=fi(e),m=t*s*p-r*i*y+o,v=r*s*p+t*i*y+a;return["C",c+l*(-t*s*f-r*i*h),u+l*(-r*s*f+t*i*h),m+l*(t*s*y+r*i*p),v+l*(r*s*y-t*i*p),m,v]},jk=(n,e,t,r)=>{const s=Math.atan2(e,n),i=Math.atan2(r,t);return i>=s?i-s:2*Math.PI-(s-i)};function Dk(n,e,t,r,s,i,o,a){let l;if(Le.cachesBoundsOfCurve&&(l=[...arguments].join(),uh.boundsOfCurveCache[l]))return uh.boundsOfCurveCache[l];const c=Math.sqrt,u=Math.abs,h=[],f=[[0,0],[0,0]];let p=6*n-12*t+6*s,y=-3*n+9*t-9*s+3*o,m=3*t-3*n;for(let A=0;A<2;++A){if(A>0&&(p=6*e-12*r+6*i,y=-3*e+9*r-9*i+3*a,m=3*r-3*e),u(y)<1e-12){if(u(p)<1e-12)continue;const P=-m/p;0<P&&P<1&&h.push(P);continue}const j=p*p-4*m*y;if(j<0)continue;const N=c(j),S=(-p+N)/(2*y);0<S&&S<1&&h.push(S);const T=(-p-N)/(2*y);0<T&&T<1&&h.push(T)}let v=h.length;const w=v,_=jD(n,e,t,r,s,i,o,a);for(;v--;){const{x:A,y:j}=_(h[v]);f[0][v]=A,f[1][v]=j}f[0][w]=n,f[1][w]=e,f[0][w+1]=o,f[1][w+1]=a;const x=[new $(Math.min(...f[0]),Math.min(...f[1])),new $(Math.max(...f[0]),Math.max(...f[1]))];return Le.cachesBoundsOfCurve&&(uh.boundsOfCurveCache[l]=x),x}const SX=(n,e,t)=>{let[r,s,i,o,a,l,c,u]=t;const h=((f,p,y,m,v,w,_)=>{if(y===0||m===0)return[];let x=0,A=0,j=0;const N=Math.PI,S=_*Yb,T=fi(S),P=di(S),R=.5*(-P*f-T*p),D=.5*(-P*p+T*f),I=y**2,k=m**2,F=D**2,K=R**2,G=I*k-I*F-k*K;let Y=Math.abs(y),V=Math.abs(m);if(G<0){const xe=Math.sqrt(1-G/(I*k));Y*=xe,V*=xe}else j=(v===w?-1:1)*Math.sqrt(G/(I*F+k*K));const z=j*Y*D/V,Q=-j*V*R/Y,ue=P*z-T*Q+.5*f,oe=T*z+P*Q+.5*p;let fe=jk(1,0,(R-z)/Y,(D-Q)/V),ce=jk((R-z)/Y,(D-Q)/V,(-R-z)/Y,(-D-Q)/V);w===0&&ce>0?ce-=2*N:w===1&&ce<0&&(ce+=2*N);const Ne=Math.ceil(Math.abs(ce/N*2)),je=[],Z=ce/Ne,Re=8/3*Math.sin(Z/4)*Math.sin(Z/4)/Math.sin(Z/2);let ze=fe+Z;for(let xe=0;xe<Ne;xe++)je[xe]=bX(fe,ze,P,T,Y,V,ue,oe,Re,x,A),x=je[xe][5],A=je[xe][6],fe=ze,ze+=Z;return je})(c-n,u-e,s,i,a,l,o);for(let f=0,p=h.length;f<p;f++)h[f][1]+=n,h[f][2]+=e,h[f][3]+=n,h[f][4]+=e,h[f][5]+=n,h[f][6]+=e;return h},EX=n=>{let e=0,t=0,r=0,s=0;const i=[];let o,a=0,l=0;for(const c of n){const u=[...c];let h;switch(u[0]){case"l":u[1]+=e,u[2]+=t;case"L":e=u[1],t=u[2],h=["L",e,t];break;case"h":u[1]+=e;case"H":e=u[1],h=["L",e,t];break;case"v":u[1]+=t;case"V":t=u[1],h=["L",e,t];break;case"m":u[1]+=e,u[2]+=t;case"M":e=u[1],t=u[2],r=u[1],s=u[2],h=["M",e,t];break;case"c":u[1]+=e,u[2]+=t,u[3]+=e,u[4]+=t,u[5]+=e,u[6]+=t;case"C":a=u[3],l=u[4],e=u[5],t=u[6],h=["C",u[1],u[2],a,l,e,t];break;case"s":u[1]+=e,u[2]+=t,u[3]+=e,u[4]+=t;case"S":o==="C"?(a=2*e-a,l=2*t-l):(a=e,l=t),e=u[3],t=u[4],h=["C",a,l,u[1],u[2],e,t],a=h[3],l=h[4];break;case"q":u[1]+=e,u[2]+=t,u[3]+=e,u[4]+=t;case"Q":a=u[1],l=u[2],e=u[3],t=u[4],h=["Q",a,l,e,t];break;case"t":u[1]+=e,u[2]+=t;case"T":o==="Q"?(a=2*e-a,l=2*t-l):(a=e,l=t),e=u[1],t=u[2],h=["Q",a,l,e,t];break;case"a":u[6]+=e,u[7]+=t;case"A":SX(e,t,u).forEach(f=>i.push(f)),e=u[6],t=u[7];break;case"z":case"Z":e=r,t=s,h=["Z"]}h?(i.push(h),o=h[0]):o=""}return i},im=(n,e,t,r)=>Math.sqrt((t-n)**2+(r-e)**2),jD=(n,e,t,r,s,i,o,a)=>l=>{const c=l**3,u=(p=>3*p**2*(1-p))(l),h=(p=>3*p*(1-p)**2)(l),f=(p=>(1-p)**3)(l);return new $(o*c+s*u+t*h+n*f,a*c+i*u+r*h+e*f)},DD=n=>n**2,MD=n=>2*n*(1-n),LD=n=>(1-n)**2,TX=(n,e,t,r,s,i,o,a)=>l=>{const c=DD(l),u=MD(l),h=LD(l),f=3*(h*(t-n)+u*(s-t)+c*(o-s)),p=3*(h*(r-e)+u*(i-r)+c*(a-i));return Math.atan2(p,f)},CX=(n,e,t,r,s,i)=>o=>{const a=DD(o),l=MD(o),c=LD(o);return new $(s*a+t*l+n*c,i*a+r*l+e*c)},kX=(n,e,t,r,s,i)=>o=>{const a=1-o,l=2*(a*(t-n)+o*(s-t)),c=2*(a*(r-e)+o*(i-r));return Math.atan2(c,l)},Mk=(n,e,t)=>{let r=new $(e,t),s=0;for(let i=1;i<=100;i+=1){const o=n(i/100);s+=im(r.x,r.y,o.x,o.y),r=o}return s},AX=(n,e)=>{let t,r=0,s=0,i={x:n.x,y:n.y},o=L({},i),a=.01,l=0;const c=n.iterator,u=n.angleFinder;for(;s<e&&a>1e-4;)o=c(r),l=r,t=im(i.x,i.y,o.x,o.y),t+s>e?(r-=a,a/=2):(i=o,r+=a,s+=t);return L(L({},o),{},{angle:u(l)})},FD=n=>{let e,t,r=0,s=0,i=0,o=0,a=0;const l=[];for(const c of n){const u={x:s,y:i,command:c[0],length:0};switch(c[0]){case"M":t=u,t.x=o=s=c[1],t.y=a=i=c[2];break;case"L":t=u,t.length=im(s,i,c[1],c[2]),s=c[1],i=c[2];break;case"C":e=jD(s,i,c[1],c[2],c[3],c[4],c[5],c[6]),t=u,t.iterator=e,t.angleFinder=TX(s,i,c[1],c[2],c[3],c[4],c[5],c[6]),t.length=Mk(e,s,i),s=c[5],i=c[6];break;case"Q":e=CX(s,i,c[1],c[2],c[3],c[4]),t=u,t.iterator=e,t.angleFinder=kX(s,i,c[1],c[2],c[3],c[4]),t.length=Mk(e,s,i),s=c[3],i=c[4];break;case"Z":t=u,t.destX=o,t.destY=a,t.length=im(s,i,o,a),s=o,i=a}r+=t.length,l.push(t)}return l.push({length:r,x:s,y:i}),l},PX=function(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:FD(n),r=0;for(;e-t[r].length>0&&r<t.length-2;)e-=t[r].length,r++;const s=t[r],i=e/s.length,o=n[r];switch(s.command){case"M":return{x:s.x,y:s.y,angle:0};case"Z":return L(L({},new $(s.x,s.y).lerp(new $(s.destX,s.destY),i)),{},{angle:Math.atan2(s.destY-s.y,s.destX-s.x)});case"L":return L(L({},new $(s.x,s.y).lerp(new $(o[1],o[2]),i)),{},{angle:Math.atan2(o[2]-s.y,o[1]-s.x)});case"C":case"Q":return AX(s,e)}},IX=new RegExp("[mzlhvcsqta][^mzlhvcsqta]*","gi"),Lk=new RegExp(_X,"g"),RX=new RegExp(zr,"gi"),OX={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},NX=n=>{var e;const t=[],r=(e=n.match(IX))!==null&&e!==void 0?e:[];for(const s of r){const i=s[0];if(i==="z"||i==="Z"){t.push([i]);continue}const o=OX[i.toLowerCase()];let a=[];if(i==="a"||i==="A"){Lk.lastIndex=0;for(let l=null;l=Lk.exec(s);)a.push(...l.slice(1))}else a=s.match(RX)||[];for(let l=0;l<a.length;l+=o){const c=new Array(o),u=xX[i];c[0]=l>0&&u?u:i;for(let h=0;h<o;h++)c[h+1]=parseFloat(a[l+h]);t.push(c)}}return t},jX=(n,e)=>n.map(t=>t.map((r,s)=>s===0||e===void 0?r:Qe(r,e)).join(" ")).join(" ");function __(n,e){const t=n.style;t&&e&&(typeof e=="string"?t.cssText+=";"+e:Object.entries(e).forEach(r=>{let[s,i]=r;return t.setProperty(s,i)}))}class DX extends uD{constructor(e){let{allowTouchScrolling:t=!1,containerClass:r=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e),M(this,"upper",void 0),M(this,"container",void 0);const{el:s}=this.lower,i=this.createUpperCanvas();this.upper={el:i,ctx:i.getContext("2d")},this.applyCanvasStyle(s,{allowTouchScrolling:t}),this.applyCanvasStyle(i,{allowTouchScrolling:t,styles:{position:"absolute",left:"0",top:"0"}});const o=this.createContainerElement();o.classList.add(r),s.parentNode&&s.parentNode.replaceChild(o,s),o.append(s,i),this.container=o}createUpperCanvas(){const{el:e}=this.lower,t=pi();return t.className=e.className,t.classList.remove("lower-canvas"),t.classList.add("upper-canvas"),t.setAttribute("data-fabric","top"),t.style.cssText=e.style.cssText,t.setAttribute("draggable","true"),t}createContainerElement(){const e=Zc().createElement("div");return e.setAttribute("data-fabric","wrapper"),__(e,{position:"relative"}),lk(e),e}applyCanvasStyle(e,t){const{styles:r,allowTouchScrolling:s}=t;__(e,L(L({},r),{},{"touch-action":s?"manipulation":Ln})),lk(e)}setDimensions(e,t){super.setDimensions(e,t);const{el:r,ctx:s}=this.upper;cD(r,s,e,t)}setCSSDimensions(e){super.setCSSDimensions(e),d_(this.upper.el,e),d_(this.container,e)}cleanupDOM(e){const t=this.container,{el:r}=this.lower,{el:s}=this.upper;super.cleanupDOM(e),t.removeChild(s),t.removeChild(r),t.parentNode&&t.parentNode.replaceChild(r,t)}dispose(){super.dispose(),As().dispose(this.upper.el),delete this.upper,delete this.container}}class wy extends Md{constructor(){super(...arguments),M(this,"targets",[]),M(this,"_hoveredTargets",[]),M(this,"_currentTransform",null),M(this,"_groupSelector",null),M(this,"contextTopDirty",!1)}static getDefaults(){return L(L({},super.getDefaults()),wy.ownDefaults)}get upperCanvasEl(){var e;return(e=this.elements.upper)===null||e===void 0?void 0:e.el}get contextTop(){var e;return(e=this.elements.upper)===null||e===void 0?void 0:e.ctx}get wrapperEl(){return this.elements.container}initElements(e){this.elements=new DX(e,{allowTouchScrolling:this.allowTouchScrolling,containerClass:this.containerClass}),this._createCacheCanvas()}_onObjectAdded(e){this._objectsToRender=void 0,super._onObjectAdded(e)}_onObjectRemoved(e){this._objectsToRender=void 0,e===this._activeObject&&(this.fire("before:selection:cleared",{deselected:[e]}),this._discardActiveObject(),this.fire("selection:cleared",{deselected:[e]}),e.fire("deselected",{target:e})),e===this._hoveredTarget&&(this._hoveredTarget=void 0,this._hoveredTargets=[]),super._onObjectRemoved(e)}_onStackOrderChanged(){this._objectsToRender=void 0,super._onStackOrderChanged()}_chooseObjectsToRender(){const e=this._activeObject;return!this.preserveObjectStacking&&e?this._objects.filter(t=>!t.group&&t!==e).concat(e):this._objects}renderAll(){this.cancelRequestedRender(),this.destroyed||(!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1),!this._objectsToRender&&(this._objectsToRender=this._chooseObjectsToRender()),this.renderCanvas(this.getContext(),this._objectsToRender))}renderTopLayer(e){e.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(e),this.contextTopDirty=!0),e.restore()}renderTop(){const e=this.contextTop;this.clearContext(e),this.renderTopLayer(e),this.fire("after:render",{ctx:e})}setTargetFindTolerance(e){e=Math.round(e),this.targetFindTolerance=e;const t=this.getRetinaScaling(),r=Math.ceil((2*e+1)*t);this.pixelFindCanvasEl.width=this.pixelFindCanvasEl.height=r,this.pixelFindContext.scale(t,t)}isTargetTransparent(e,t,r){const s=this.targetFindTolerance,i=this.pixelFindContext;this.clearContext(i),i.save(),i.translate(-t+s,-r+s),i.transform(...this.viewportTransform);const o=e.selectionBackgroundColor;e.selectionBackgroundColor="",e.render(i),e.selectionBackgroundColor=o,i.restore();const a=Math.round(s*this.getRetinaScaling());return VY(i,a,a,a)}_isSelectionKeyPressed(e){const t=this.selectionKey;return!!t&&(Array.isArray(t)?!!t.find(r=>!!r&&e[r]===!0):e[t])}_shouldClearSelection(e,t){const r=this.getActiveObjects(),s=this._activeObject;return!!(!t||t&&s&&r.length>1&&r.indexOf(t)===-1&&s!==t&&!this._isSelectionKeyPressed(e)||t&&!t.evented||t&&!t.selectable&&s&&s!==t)}_shouldCenterTransform(e,t,r){if(!e)return;let s;return t===dy||t===Vn||t===vr||t===Zh?s=this.centeredScaling||e.centeredScaling:t===Jb&&(s=this.centeredRotation||e.centeredRotation),s?!r:r}_getOriginFromCorner(e,t){const r={x:e.originX,y:e.originY};return t&&(["ml","tl","bl"].includes(t)?r.x=vt:["mr","tr","br"].includes(t)&&(r.x=$e),["tl","mt","tr"].includes(t)?r.y=h_:["bl","mb","br"].includes(t)&&(r.y=Mn)),r}_setupCurrentTransform(e,t,r){var s;const i=t.group?ec(this.getScenePoint(e),void 0,t.group.calcTransformMatrix()):this.getScenePoint(e),{key:o="",control:a}=t.getActiveControl()||{},l=r&&a?(s=a.getActionHandler(e,t,a))===null||s===void 0?void 0:s.bind(a):tY,c=((p,y,m,v)=>{if(!y||!p)return"drag";const w=v.controls[y];return w.getActionName(m,w,v)})(r,o,e,t),u=e[this.centeredKey],h=this._shouldCenterTransform(t,c,u)?{x:Te,y:Te}:this._getOriginFromCorner(t,o),f={target:t,action:c,actionHandler:l,actionPerformed:!1,corner:o,scaleX:t.scaleX,scaleY:t.scaleY,skewX:t.skewX,skewY:t.skewY,offsetX:i.x-t.left,offsetY:i.y-t.top,originX:h.x,originY:h.y,ex:i.x,ey:i.y,lastX:i.x,lastY:i.y,theta:xt(t.angle),width:t.width,height:t.height,shiftKey:e.shiftKey,altKey:u,original:L(L({},hD(t)),{},{originX:h.x,originY:h.y})};this._currentTransform=f,this.fire("before:transform",{e,transform:f})}setCursor(e){this.upperCanvasEl.style.cursor=e}_drawSelection(e){const{x:t,y:r,deltaX:s,deltaY:i}=this._groupSelector,o=new $(t,r).transform(this.viewportTransform),a=new $(t+s,r+i).transform(this.viewportTransform),l=this.selectionLineWidth/2;let c=Math.min(o.x,a.x),u=Math.min(o.y,a.y),h=Math.max(o.x,a.x),f=Math.max(o.y,a.y);this.selectionColor&&(e.fillStyle=this.selectionColor,e.fillRect(c,u,h-c,f-u)),this.selectionLineWidth&&this.selectionBorderColor&&(e.lineWidth=this.selectionLineWidth,e.strokeStyle=this.selectionBorderColor,c+=l,u+=l,h-=l,f-=l,cn.prototype._setLineDash.call(this,e,this.selectionDashArray),e.strokeRect(c,u,h-c,f-u))}findTarget(e){if(this.skipTargetFind)return;const t=this.getViewportPoint(e),r=this._activeObject,s=this.getActiveObjects();if(this.targets=[],r&&s.length>=1){if(r.findControl(t,f_(e))||s.length>1&&this.searchPossibleTargets([r],t))return r;if(r===this.searchPossibleTargets([r],t)){if(this.preserveObjectStacking){const i=this.targets;this.targets=[];const o=this.searchPossibleTargets(this._objects,t);return e[this.altSelectionKey]&&o&&o!==r?(this.targets=i,r):o}return r}}return this.searchPossibleTargets(this._objects,t)}_pointIsInObjectSelectionArea(e,t){let r=e.getCoords();const s=this.getZoom(),i=e.padding/s;if(i){const[o,a,l,c]=r,u=Math.atan2(a.y-o.y,a.x-o.x),h=di(u)*i,f=fi(u)*i,p=h+f,y=h-f;r=[new $(o.x-y,o.y-p),new $(a.x+p,a.y-y),new $(l.x+y,l.y+p),new $(c.x-p,c.y+y)]}return lt.isPointInPolygon(t,r)}_checkTarget(e,t){return!!(e&&e.visible&&e.evented&&this._pointIsInObjectSelectionArea(e,ec(t,void 0,this.viewportTransform))&&(!this.perPixelTargetFind&&!e.perPixelTargetFind||e.isEditing||!this.isTargetTransparent(e,t.x,t.y)))}_searchPossibleTargets(e,t){let r=e.length;for(;r--;){const s=e[r];if(this._checkTarget(s,t)){if(Vp(s)&&s.subTargetCheck){const i=this._searchPossibleTargets(s._objects,t);i&&this.targets.push(i)}return s}}}searchPossibleTargets(e,t){const r=this._searchPossibleTargets(e,t);if(r&&Vp(r)&&r.interactive&&this.targets[0]){const s=this.targets;for(let i=s.length-1;i>0;i--){const o=s[i];if(!Vp(o)||!o.interactive)return o}return s[0]}return r}getViewportPoint(e){return this._pointer?this._pointer:this.getPointer(e,!0)}getScenePoint(e){return this._absolutePointer?this._absolutePointer:this.getPointer(e)}getPointer(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const r=this.upperCanvasEl,s=r.getBoundingClientRect();let i=KK(e),o=s.width||0,a=s.height||0;o&&a||(Mn in s&&h_ in s&&(a=Math.abs(s.top-s.bottom)),vt in s&&$e in s&&(o=Math.abs(s.right-s.left))),this.calcOffset(),i.x=i.x-this._offset.left,i.y=i.y-this._offset.top,t||(i=ec(i,void 0,this.viewportTransform));const l=this.getRetinaScaling();l!==1&&(i.x/=l,i.y/=l);const c=o===0||a===0?new $(1,1):new $(r.width/o,r.height/a);return i.multiply(c)}_setDimensionsImpl(e,t){this._resetTransformEventData(),super._setDimensionsImpl(e,t),this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop)}_createCacheCanvas(){this.pixelFindCanvasEl=pi(),this.pixelFindContext=this.pixelFindCanvasEl.getContext("2d",{willReadFrequently:!0}),this.setTargetFindTolerance(this.targetFindTolerance)}getTopContext(){return this.elements.upper.ctx}getSelectionContext(){return this.elements.upper.ctx}getSelectionElement(){return this.elements.upper.el}getActiveObject(){return this._activeObject}getActiveObjects(){const e=this._activeObject;return oa(e)?e.getObjects():e?[e]:[]}_fireSelectionEvents(e,t){let r=!1,s=!1;const i=this.getActiveObjects(),o=[],a=[];e.forEach(l=>{i.includes(l)||(r=!0,l.fire("deselected",{e:t,target:l}),a.push(l))}),i.forEach(l=>{e.includes(l)||(r=!0,l.fire("selected",{e:t,target:l}),o.push(l))}),e.length>0&&i.length>0?(s=!0,r&&this.fire("selection:updated",{e:t,selected:o,deselected:a})):i.length>0?(s=!0,this.fire("selection:created",{e:t,selected:o})):e.length>0&&(s=!0,this.fire("selection:cleared",{e:t,deselected:a})),s&&(this._objectsToRender=void 0)}setActiveObject(e,t){const r=this.getActiveObjects(),s=this._setActiveObject(e,t);return this._fireSelectionEvents(r,t),s}_setActiveObject(e,t){const r=this._activeObject;return r!==e&&!(!this._discardActiveObject(t,e)&&this._activeObject)&&!e.onSelect({e:t})&&(this._activeObject=e,oa(e)&&r!==e&&e.set("canvas",this),e.setCoords(),!0)}_discardActiveObject(e,t){const r=this._activeObject;return!!r&&!r.onDeselect({e,object:t})&&(this._currentTransform&&this._currentTransform.target===r&&this.endCurrentTransform(e),oa(r)&&r===this._hoveredTarget&&(this._hoveredTarget=void 0),this._activeObject=void 0,!0)}discardActiveObject(e){const t=this.getActiveObjects(),r=this.getActiveObject();t.length&&this.fire("before:selection:cleared",{e,deselected:[r]});const s=this._discardActiveObject(e);return this._fireSelectionEvents(t,e),s}endCurrentTransform(e){const t=this._currentTransform;this._finalizeCurrentTransform(e),t&&t.target&&(t.target.isMoving=!1),this._currentTransform=null}_finalizeCurrentTransform(e){const t=this._currentTransform,r=t.target,s={e,target:r,transform:t,action:t.action};r._scaling&&(r._scaling=!1),r.setCoords(),t.actionPerformed&&(this.fire("object:modified",s),r.fire(Xg,s))}setViewportTransform(e){super.setViewportTransform(e);const t=this._activeObject;t&&t.setCoords()}destroy(){const e=this._activeObject;oa(e)&&(e.removeAll(),e.dispose()),delete this._activeObject,super.destroy(),this.pixelFindContext=null,this.pixelFindCanvasEl=void 0}clear(){this.discardActiveObject(),this._activeObject=void 0,this.clearContext(this.contextTop),super.clear()}drawControls(e){const t=this._activeObject;t&&t._renderControls(e)}_toObject(e,t,r){const s=this._realizeGroupTransformOnObject(e),i=super._toObject(e,t,r);return e.set(s),i}_realizeGroupTransformOnObject(e){const{group:t}=e;if(t&&oa(t)&&this._activeObject===t){const r=ru(e,["angle","flipX","flipY",$e,Vn,vr,eu,tu,Mn]);return XK(e,t.calcOwnMatrix()),r}return{}}_setSVGObject(e,t,r){const s=this._realizeGroupTransformOnObject(t);super._setSVGObject(e,t,r),t.set(s)}}M(wy,"ownDefaults",{uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",selection:!0,selectionKey:"shiftKey",selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,enablePointerEvents:!1,containerClass:"canvas-container",preserveObjectStacking:!1});class MX{constructor(e){M(this,"targets",[]),M(this,"__disposer",void 0);const t=()=>{const{hiddenTextarea:s}=e.getActiveObject()||{};s&&s.focus()},r=e.upperCanvasEl;r.addEventListener("click",t),this.__disposer=()=>r.removeEventListener("click",t)}exitTextEditing(){this.target=void 0,this.targets.forEach(e=>{e.isEditing&&e.exitEditing()})}add(e){this.targets.push(e)}remove(e){this.unregister(e),bl(this.targets,e)}register(e){this.target=e}unregister(e){e===this.target&&(this.target=void 0)}onMouseMove(e){var t;!((t=this.target)===null||t===void 0)&&t.isEditing&&this.target.updateSelectionOnMouseMove(e)}clear(){this.targets=[],this.target=void 0}dispose(){this.clear(),this.__disposer(),delete this.__disposer}}const LX=["target","oldTarget","fireCanvas","e"],Bn={passive:!1},dl=(n,e)=>{const t=n.getViewportPoint(e),r=n.getScenePoint(e);return{viewportPoint:t,scenePoint:r,pointer:t,absolutePointer:r}},Di=function(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];return n.addEventListener(...t)},ir=function(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];return n.removeEventListener(...t)},FX={mouse:{in:"over",out:"out",targetIn:"mouseover",targetOut:"mouseout",canvasIn:"mouse:over",canvasOut:"mouse:out"},drag:{in:"enter",out:"leave",targetIn:"dragenter",targetOut:"dragleave",canvasIn:"drag:enter",canvasOut:"drag:leave"}};class x_ extends wy{constructor(e){super(e,arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}),M(this,"_isClick",void 0),M(this,"textEditingManager",new MX(this)),["_onMouseDown","_onTouchStart","_onMouseMove","_onMouseUp","_onTouchEnd","_onResize","_onMouseWheel","_onMouseOut","_onMouseEnter","_onContextMenu","_onClick","_onDragStart","_onDragEnd","_onDragProgress","_onDragOver","_onDragEnter","_onDragLeave","_onDrop"].forEach(t=>{this[t]=this[t].bind(this)}),this.addOrRemove(Di,"add")}_getEventPrefix(){return this.enablePointerEvents?"pointer":"mouse"}addOrRemove(e,t){const r=this.upperCanvasEl,s=this._getEventPrefix();e(lD(r),"resize",this._onResize),e(r,s+"down",this._onMouseDown),e(r,"".concat(s,"move"),this._onMouseMove,Bn),e(r,"".concat(s,"out"),this._onMouseOut),e(r,"".concat(s,"enter"),this._onMouseEnter),e(r,"wheel",this._onMouseWheel,{passive:!1}),e(r,"contextmenu",this._onContextMenu),e(r,"click",this._onClick),e(r,"dblclick",this._onClick),e(r,"dragstart",this._onDragStart),e(r,"dragend",this._onDragEnd),e(r,"dragover",this._onDragOver),e(r,"dragenter",this._onDragEnter),e(r,"dragleave",this._onDragLeave),e(r,"drop",this._onDrop),this.enablePointerEvents||e(r,"touchstart",this._onTouchStart,Bn)}removeListeners(){this.addOrRemove(ir,"remove");const e=this._getEventPrefix(),t=Ur(this.upperCanvasEl);ir(t,"".concat(e,"up"),this._onMouseUp),ir(t,"touchend",this._onTouchEnd,Bn),ir(t,"".concat(e,"move"),this._onMouseMove,Bn),ir(t,"touchmove",this._onMouseMove,Bn),clearTimeout(this._willAddMouseDown)}_onMouseWheel(e){this.__onMouseWheel(e)}_onMouseOut(e){const t=this._hoveredTarget,r=L({e},dl(this,e));this.fire("mouse:out",L(L({},r),{},{target:t})),this._hoveredTarget=void 0,t&&t.fire("mouseout",L({},r)),this._hoveredTargets.forEach(s=>{this.fire("mouse:out",L(L({},r),{},{target:s})),s&&s.fire("mouseout",L({},r))}),this._hoveredTargets=[]}_onMouseEnter(e){this._currentTransform||this.findTarget(e)||(this.fire("mouse:over",L({e},dl(this,e))),this._hoveredTarget=void 0,this._hoveredTargets=[])}_onDragStart(e){this._isClick=!1;const t=this.getActiveObject();if(t&&t.onDragStart(e)){this._dragSource=t;const r={e,target:t};return this.fire("dragstart",r),t.fire("dragstart",r),void Di(this.upperCanvasEl,"drag",this._onDragProgress)}ck(e)}_renderDragEffects(e,t,r){let s=!1;const i=this._dropTarget;i&&i!==t&&i!==r&&(i.clearContextTop(),s=!0),t==null||t.clearContextTop(),r!==t&&(r==null||r.clearContextTop());const o=this.contextTop;o.save(),o.transform(...this.viewportTransform),t&&(o.save(),t.transform(o),t.renderDragSourceEffect(e),o.restore(),s=!0),r&&(o.save(),r.transform(o),r.renderDropTargetEffect(e),o.restore(),s=!0),o.restore(),s&&(this.contextTopDirty=!0)}_onDragEnd(e){const t=!!e.dataTransfer&&e.dataTransfer.dropEffect!==Ln,r=t?this._activeObject:void 0,s={e,target:this._dragSource,subTargets:this.targets,dragSource:this._dragSource,didDrop:t,dropTarget:r};ir(this.upperCanvasEl,"drag",this._onDragProgress),this.fire("dragend",s),this._dragSource&&this._dragSource.fire("dragend",s),delete this._dragSource,this._onMouseUp(e)}_onDragProgress(e){const t={e,target:this._dragSource,dragSource:this._dragSource,dropTarget:this._draggedoverTarget};this.fire("drag",t),this._dragSource&&this._dragSource.fire("drag",t)}findDragTargets(e){return this.targets=[],{target:this._searchPossibleTargets(this._objects,this.getViewportPoint(e)),targets:[...this.targets]}}_onDragOver(e){const t="dragover",{target:r,targets:s}=this.findDragTargets(e),i=this._dragSource,o={e,target:r,subTargets:s,dragSource:i,canDrop:!1,dropTarget:void 0};let a;this.fire(t,o),this._fireEnterLeaveEvents(r,o),r&&(r.canDrop(e)&&(a=r),r.fire(t,o));for(let l=0;l<s.length;l++){const c=s[l];c.canDrop(e)&&(a=c),c.fire(t,o)}this._renderDragEffects(e,i,a),this._dropTarget=a}_onDragEnter(e){const{target:t,targets:r}=this.findDragTargets(e),s={e,target:t,subTargets:r,dragSource:this._dragSource};this.fire("dragenter",s),this._fireEnterLeaveEvents(t,s)}_onDragLeave(e){const t={e,target:this._draggedoverTarget,subTargets:this.targets,dragSource:this._dragSource};this.fire("dragleave",t),this._fireEnterLeaveEvents(void 0,t),this._renderDragEffects(e,this._dragSource),this._dropTarget=void 0,this.targets=[],this._hoveredTargets=[]}_onDrop(e){const{target:t,targets:r}=this.findDragTargets(e),s=this._basicEventHandler("drop:before",L({e,target:t,subTargets:r,dragSource:this._dragSource},dl(this,e)));s.didDrop=!1,s.dropTarget=void 0,this._basicEventHandler("drop",s),this.fire("drop:after",s)}_onContextMenu(e){const t=this.findTarget(e),r=this.targets||[],s=this._basicEventHandler("contextmenu:before",{e,target:t,subTargets:r});return this.stopContextMenu&&ck(e),this._basicEventHandler("contextmenu",s),!1}_onClick(e){const t=e.detail;t>3||t<2||(this._cacheTransformEventData(e),t==2&&e.type==="dblclick"&&this._handleEvent(e,"dblclick"),t==3&&this._handleEvent(e,"tripleclick"),this._resetTransformEventData())}getPointerId(e){const t=e.changedTouches;return t?t[0]&&t[0].identifier:this.enablePointerEvents?e.pointerId:-1}_isMainEvent(e){return e.isPrimary===!0||e.isPrimary!==!1&&(e.type==="touchend"&&e.touches.length===0||!e.changedTouches||e.changedTouches[0].identifier===this.mainTouchId)}_onTouchStart(e){let t=!this.allowTouchScrolling;const r=this._activeObject;this.mainTouchId===void 0&&(this.mainTouchId=this.getPointerId(e)),this.__onMouseDown(e),(this.isDrawingMode||r&&this._target===r)&&(t=!0),t&&e.preventDefault(),this._resetTransformEventData();const s=this.upperCanvasEl,i=this._getEventPrefix(),o=Ur(s);Di(o,"touchend",this._onTouchEnd,Bn),t&&Di(o,"touchmove",this._onMouseMove,Bn),ir(s,"".concat(i,"down"),this._onMouseDown)}_onMouseDown(e){this.__onMouseDown(e),this._resetTransformEventData();const t=this.upperCanvasEl,r=this._getEventPrefix();ir(t,"".concat(r,"move"),this._onMouseMove,Bn);const s=Ur(t);Di(s,"".concat(r,"up"),this._onMouseUp),Di(s,"".concat(r,"move"),this._onMouseMove,Bn)}_onTouchEnd(e){if(e.touches.length>0)return;this.__onMouseUp(e),this._resetTransformEventData(),delete this.mainTouchId;const t=this._getEventPrefix(),r=Ur(this.upperCanvasEl);ir(r,"touchend",this._onTouchEnd,Bn),ir(r,"touchmove",this._onMouseMove,Bn),this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(()=>{Di(this.upperCanvasEl,"".concat(t,"down"),this._onMouseDown),this._willAddMouseDown=0},400)}_onMouseUp(e){this.__onMouseUp(e),this._resetTransformEventData();const t=this.upperCanvasEl,r=this._getEventPrefix();if(this._isMainEvent(e)){const s=Ur(this.upperCanvasEl);ir(s,"".concat(r,"up"),this._onMouseUp),ir(s,"".concat(r,"move"),this._onMouseMove,Bn),Di(t,"".concat(r,"move"),this._onMouseMove,Bn)}}_onMouseMove(e){const t=this.getActiveObject();!this.allowTouchScrolling&&(!t||!t.shouldStartDragging(e))&&e.preventDefault&&e.preventDefault(),this.__onMouseMove(e)}_onResize(){this.calcOffset(),this._resetTransformEventData()}_shouldRender(e){const t=this.getActiveObject();return!!t!=!!e||t&&e&&t!==e}__onMouseUp(e){var t;this._cacheTransformEventData(e),this._handleEvent(e,"up:before");const r=this._currentTransform,s=this._isClick,i=this._target,{button:o}=e;if(o)return(this.fireMiddleClick&&o===1||this.fireRightClick&&o===2)&&this._handleEvent(e,"up"),void this._resetTransformEventData();if(this.isDrawingMode&&this._isCurrentlyDrawing)return void this._onMouseUpInDrawingMode(e);if(!this._isMainEvent(e))return;let a,l,c=!1;if(r&&(this._finalizeCurrentTransform(e),c=r.actionPerformed),!s){const u=i===this._activeObject;this.handleSelection(e),c||(c=this._shouldRender(i)||!u&&i===this._activeObject)}if(i){const u=i.findControl(this.getViewportPoint(e),f_(e)),{key:h,control:f}=u||{};if(l=h,i.selectable&&i!==this._activeObject&&i.activeOn==="up")this.setActiveObject(i,e),c=!0;else if(f){const p=f.getMouseUpHandler(e,i,f);p&&(a=this.getScenePoint(e),p.call(f,e,r,a.x,a.y))}i.isMoving=!1}if(r&&(r.target!==i||r.corner!==l)){const u=r.target&&r.target.controls[r.corner],h=u&&u.getMouseUpHandler(e,r.target,u);a=a||this.getScenePoint(e),h&&h.call(u,e,r,a.x,a.y)}this._setCursorFromEvent(e,i),this._handleEvent(e,"up"),this._groupSelector=null,this._currentTransform=null,i&&(i.__corner=void 0),c?this.requestRenderAll():s||(t=this._activeObject)!==null&&t!==void 0&&t.isEditing||this.renderTop()}_basicEventHandler(e,t){const{target:r,subTargets:s=[]}=t;this.fire(e,t),r&&r.fire(e,t);for(let i=0;i<s.length;i++)s[i]!==r&&s[i].fire(e,t);return t}_handleEvent(e,t,r){const s=this._target,i=this.targets||[],o=L(L(L({e,target:s,subTargets:i},dl(this,e)),{},{transform:this._currentTransform},t==="up:before"||t==="up"?{isClick:this._isClick,currentTarget:this.findTarget(e),currentSubTargets:this.targets}:{}),t==="down:before"||t==="down"?r:{});this.fire("mouse:".concat(t),o),s&&s.fire("mouse".concat(t),o);for(let a=0;a<i.length;a++)i[a]!==s&&i[a].fire("mouse".concat(t),o)}_onMouseDownInDrawingMode(e){this._isCurrentlyDrawing=!0,this.getActiveObject()&&(this.discardActiveObject(e),this.requestRenderAll());const t=this.getScenePoint(e);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseDown(t,{e,pointer:t}),this._handleEvent(e,"down",{alreadySelected:!1})}_onMouseMoveInDrawingMode(e){if(this._isCurrentlyDrawing){const t=this.getScenePoint(e);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseMove(t,{e,pointer:t})}this.setCursor(this.freeDrawingCursor),this._handleEvent(e,"move")}_onMouseUpInDrawingMode(e){const t=this.getScenePoint(e);this.freeDrawingBrush?this._isCurrentlyDrawing=!!this.freeDrawingBrush.onMouseUp({e,pointer:t}):this._isCurrentlyDrawing=!1,this._handleEvent(e,"up")}__onMouseDown(e){this._isClick=!0,this._cacheTransformEventData(e),this._handleEvent(e,"down:before");let t=this._target,r=!!t&&t===this._activeObject;const{button:s}=e;if(s)return(this.fireMiddleClick&&s===1||this.fireRightClick&&s===2)&&this._handleEvent(e,"down",{alreadySelected:r}),void this._resetTransformEventData();if(this.isDrawingMode)return void this._onMouseDownInDrawingMode(e);if(!this._isMainEvent(e)||this._currentTransform)return;let i=this._shouldRender(t),o=!1;if(this.handleMultiSelection(e,t)?(t=this._activeObject,o=!0,i=!0):this._shouldClearSelection(e,t)&&this.discardActiveObject(e),this.selection&&(!t||!t.selectable&&!t.isEditing&&t!==this._activeObject)){const a=this.getScenePoint(e);this._groupSelector={x:a.x,y:a.y,deltaY:0,deltaX:0}}if(r=!!t&&t===this._activeObject,t){t.selectable&&t.activeOn==="down"&&this.setActiveObject(t,e);const a=t.findControl(this.getViewportPoint(e),f_(e));if(t===this._activeObject&&(a||!o)){this._setupCurrentTransform(e,t,r);const l=a?a.control:void 0,c=this.getScenePoint(e),u=l&&l.getMouseDownHandler(e,t,l);u&&u.call(l,e,this._currentTransform,c.x,c.y)}}i&&(this._objectsToRender=void 0),this._handleEvent(e,"down",{alreadySelected:r}),i&&this.requestRenderAll()}_resetTransformEventData(){this._target=this._pointer=this._absolutePointer=void 0}_cacheTransformEventData(e){this._resetTransformEventData(),this._pointer=this.getViewportPoint(e),this._absolutePointer=ec(this._pointer,void 0,this.viewportTransform),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(e)}__onMouseMove(e){if(this._isClick=!1,this._cacheTransformEventData(e),this._handleEvent(e,"move:before"),this.isDrawingMode)return void this._onMouseMoveInDrawingMode(e);if(!this._isMainEvent(e))return;const t=this._groupSelector;if(t){const r=this.getScenePoint(e);t.deltaX=r.x-t.x,t.deltaY=r.y-t.y,this.renderTop()}else if(this._currentTransform)this._transformObject(e);else{const r=this.findTarget(e);this._setCursorFromEvent(e,r),this._fireOverOutEvents(e,r)}this.textEditingManager.onMouseMove(e),this._handleEvent(e,"move"),this._resetTransformEventData()}_fireOverOutEvents(e,t){const r=this._hoveredTarget,s=this._hoveredTargets,i=this.targets,o=Math.max(s.length,i.length);this.fireSyntheticInOutEvents("mouse",{e,target:t,oldTarget:r,fireCanvas:!0});for(let a=0;a<o;a++)i[a]===t||s[a]&&s[a]===r||this.fireSyntheticInOutEvents("mouse",{e,target:i[a],oldTarget:s[a]});this._hoveredTarget=t,this._hoveredTargets=this.targets.concat()}_fireEnterLeaveEvents(e,t){const r=this._draggedoverTarget,s=this._hoveredTargets,i=this.targets,o=Math.max(s.length,i.length);this.fireSyntheticInOutEvents("drag",L(L({},t),{},{target:e,oldTarget:r,fireCanvas:!0}));for(let a=0;a<o;a++)this.fireSyntheticInOutEvents("drag",L(L({},t),{},{target:i[a],oldTarget:s[a]}));this._draggedoverTarget=e}fireSyntheticInOutEvents(e,t){let{target:r,oldTarget:s,fireCanvas:i,e:o}=t,a=st(t,LX);const{targetIn:l,targetOut:c,canvasIn:u,canvasOut:h}=FX[e],f=s!==r;if(s&&f){const p=L(L({},a),{},{e:o,target:s,nextTarget:r},dl(this,o));i&&this.fire(h,p),s.fire(c,p)}if(r&&f){const p=L(L({},a),{},{e:o,target:r,previousTarget:s},dl(this,o));i&&this.fire(u,p),r.fire(l,p)}}__onMouseWheel(e){this._cacheTransformEventData(e),this._handleEvent(e,"wheel"),this._resetTransformEventData()}_transformObject(e){const t=this.getScenePoint(e),r=this._currentTransform,s=r.target,i=s.group?ec(t,void 0,s.group.calcTransformMatrix()):t;r.shiftKey=e.shiftKey,r.altKey=!!this.centeredKey&&e[this.centeredKey],this._performTransformAction(e,r,i),r.actionPerformed&&this.requestRenderAll()}_performTransformAction(e,t,r){const{action:s,actionHandler:i,target:o}=t,a=!!i&&i(e,t,r.x,r.y);a&&o.setCoords(),s==="drag"&&a&&(t.target.isMoving=!0,this.setCursor(t.target.moveCursor||this.moveCursor)),t.actionPerformed=t.actionPerformed||a}_setCursorFromEvent(e,t){if(!t)return void this.setCursor(this.defaultCursor);let r=t.hoverCursor||this.hoverCursor;const s=oa(this._activeObject)?this._activeObject:null,i=(!s||t.group!==s)&&t.findControl(this.getViewportPoint(e));if(i){const o=i.control;this.setCursor(o.cursorStyleHandler(e,o,t))}else t.subTargetCheck&&this.targets.concat().reverse().map(o=>{r=o.hoverCursor||r}),this.setCursor(r)}handleMultiSelection(e,t){const r=this._activeObject,s=oa(r);if(r&&this._isSelectionKeyPressed(e)&&this.selection&&t&&t.selectable&&(r!==t||s)&&(s||!t.isDescendantOf(r)&&!r.isDescendantOf(t))&&!t.onSelect({e})&&!r.getActiveControl()){if(s){const i=r.getObjects();if(t===r){const o=this.getViewportPoint(e);if(!(t=this.searchPossibleTargets(i,o)||this.searchPossibleTargets(this._objects,o))||!t.selectable)return!1}t.group===r?(r.remove(t),this._hoveredTarget=t,this._hoveredTargets=[...this.targets],r.size()===1&&this._setActiveObject(r.item(0),e)):(r.multiSelectAdd(t),this._hoveredTarget=r,this._hoveredTargets=[...this.targets]),this._fireSelectionEvents(i,e)}else{r.isEditing&&r.exitEditing();const i=new(re.getClass("ActiveSelection"))([],{canvas:this});i.multiSelectAdd(r,t),this._hoveredTarget=i,this._setActiveObject(i,e),this._fireSelectionEvents([r],e)}return!0}return!1}handleSelection(e){if(!this.selection||!this._groupSelector)return!1;const{x:t,y:r,deltaX:s,deltaY:i}=this._groupSelector,o=new $(t,r),a=o.add(new $(s,i)),l=o.min(a),c=o.max(a).subtract(l),u=this.collectObjects({left:l.x,top:l.y,width:c.x,height:c.y},{includeIntersecting:!this.selectionFullyContained}),h=o.eq(a)?u[0]?[u[0]]:[]:u.length>1?u.filter(f=>!f.onSelect({e})).reverse():u;if(h.length===1)this.setActiveObject(h[0],e);else if(h.length>1){const f=re.getClass("ActiveSelection");this.setActiveObject(new f(h,{canvas:this}),e)}return this._groupSelector=null,!0}clear(){this.textEditingManager.clear(),super.clear()}destroy(){this.removeListeners(),this.textEditingManager.dispose(),super.destroy()}}const VD={x1:0,y1:0,x2:0,y2:0},VX=L(L({},VD),{},{r1:0,r2:0}),Ll=(n,e)=>isNaN(n)&&typeof e=="number"?e:n;function UD(n){return n&&/%$/.test(n)&&Number.isFinite(parseFloat(n))}function $D(n,e){const t=typeof n=="number"?n:typeof n=="string"?parseFloat(n)/(UD(n)?100:1):NaN;return Oc(0,Ll(t,e),1)}const UX=/\s*;\s*/,$X=/\s*:\s*/;function BX(n,e){let t,r;const s=n.getAttribute("style");if(s){const o=s.split(UX);o[o.length-1]===""&&o.pop();for(let a=o.length;a--;){const[l,c]=o[a].split($X).map(u=>u.trim());l==="stop-color"?t=c:l==="stop-opacity"&&(r=c)}}const i=new We(t||n.getAttribute("stop-color")||"rgb(0,0,0)");return{offset:$D(n.getAttribute("offset"),0),color:i.toRgb(),opacity:Ll(parseFloat(r||n.getAttribute("stop-opacity")||""),1)*i.getAlpha()*e}}function zX(n,e){const t=[],r=n.getElementsByTagName("stop"),s=$D(e,1);for(let i=r.length;i--;)t.push(BX(r[i],s));return t}function BD(n){return n.nodeName==="linearGradient"||n.nodeName==="LINEARGRADIENT"?"linear":"radial"}function zD(n){return n.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage"}function Tr(n,e){return n.getAttribute(e)}function WX(n,e){return function(t,r){let s,{width:i,height:o,gradientUnits:a}=r;return Object.entries(t).reduce((l,c)=>{let[u,h]=c;if(h==="Infinity")s=1;else if(h==="-Infinity")s=0;else{const f=typeof h=="string";s=f?parseFloat(h):h,f&&UD(h)&&(s*=.01,a==="pixels"&&(u!=="x1"&&u!=="x2"&&u!=="r2"||(s*=i),u!=="y1"&&u!=="y2"||(s*=o)))}return l[u]=s,l},{})}(BD(n)==="linear"?function(t){return{x1:Tr(t,"x1")||0,y1:Tr(t,"y1")||0,x2:Tr(t,"x2")||"100%",y2:Tr(t,"y2")||0}}(n):function(t){return{x1:Tr(t,"fx")||Tr(t,"cx")||"50%",y1:Tr(t,"fy")||Tr(t,"cy")||"50%",r1:0,x2:Tr(t,"cx")||"50%",y2:Tr(t,"cy")||"50%",r2:Tr(t,"r")||"50%"}}(n),L(L({},e),{},{gradientUnits:zD(n)}))}class Bf{constructor(e){const{type:t="linear",gradientUnits:r="pixels",coords:s={},colorStops:i=[],offsetX:o=0,offsetY:a=0,gradientTransform:l,id:c}=e||{};Object.assign(this,{type:t,gradientUnits:r,coords:L(L({},t==="radial"?VX:VD),s),colorStops:i,offsetX:o,offsetY:a,gradientTransform:l,id:c?"".concat(c,"_").concat(Io()):Io()})}addColorStop(e){for(const t in e){const r=new We(e[t]);this.colorStops.push({offset:parseFloat(t),color:r.toRgb(),opacity:r.getAlpha()})}return this}toObject(e){return L(L({},ru(this,e)),{},{type:this.type,coords:L({},this.coords),colorStops:this.colorStops.map(t=>L({},t)),offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?[...this.gradientTransform]:void 0})}toSVG(e){let{additionalTransform:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=[],s=this.gradientTransform?this.gradientTransform.concat():bn.concat(),i=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox",o=this.colorStops.map(h=>L({},h)).sort((h,f)=>h.offset-f.offset);let a=-this.offsetX,l=-this.offsetY;var c;i==="objectBoundingBox"?(a/=e.width,l/=e.height):(a+=e.width/2,l+=e.height/2),(c=e)&&typeof c._renderPathCommands=="function"&&this.gradientUnits!=="percentage"&&(a-=e.pathOffset.x,l-=e.pathOffset.y),s[4]-=a,s[5]-=l;const u=['id="SVGID_'.concat(this.id,'"'),'gradientUnits="'.concat(i,'"'),'gradientTransform="'.concat(t?t+" ":"").concat(td(s),'"'),""].join(" ");if(this.type==="linear"){const{x1:h,y1:f,x2:p,y2:y}=this.coords;r.push("<linearGradient ",u,' x1="',h,'" y1="',f,'" x2="',p,'" y2="',y,`">
`)}else if(this.type==="radial"){const{x1:h,y1:f,x2:p,y2:y,r1:m,r2:v}=this.coords,w=m>v;r.push("<radialGradient ",u,' cx="',w?h:p,'" cy="',w?f:y,'" r="',w?m:v,'" fx="',w?p:h,'" fy="',w?y:f,`">
`),w&&(o.reverse(),o.forEach(x=>{x.offset=1-x.offset}));const _=Math.min(m,v);if(_>0){const x=_/Math.max(m,v);o.forEach(A=>{A.offset+=x*(1-A.offset)})}}return o.forEach(h=>{let{color:f,offset:p,opacity:y}=h;r.push("<stop ",'offset="',100*p+"%",'" style="stop-color:',f,y!==void 0?";stop-opacity: "+y:";",`"/>
`)}),r.push(this.type==="linear"?"</linearGradient>":"</radialGradient>",`
`),r.join("")}toLive(e){const{x1:t,y1:r,x2:s,y2:i,r1:o,r2:a}=this.coords,l=this.type==="linear"?e.createLinearGradient(t,r,s,i):e.createRadialGradient(t,r,o,s,i,a);return this.colorStops.forEach(c=>{let{color:u,opacity:h,offset:f}=c;l.addColorStop(f,h!==void 0?new We(u).setAlpha(h).toRgba():u)}),l}static async fromObject(e){const{colorStops:t,gradientTransform:r}=e;return new this(L(L({},e),{},{colorStops:t?t.map(s=>L({},s)):void 0,gradientTransform:r?[...r]:void 0}))}static fromElement(e,t,r){const s=zD(e),i=t._findCenterFromElement();return new this(L({id:e.getAttribute("id")||void 0,type:BD(e),coords:WX(e,{width:r.viewBoxWidth||r.width,height:r.viewBoxHeight||r.height}),colorStops:zX(e,r.opacity),gradientUnits:s,gradientTransform:y_(e.getAttribute("gradientTransform")||"")},s==="pixels"?{offsetX:t.width/2-i.x,offsetY:t.height/2-i.y}:{offsetX:0,offsetY:0}))}}M(Bf,"type","Gradient"),re.setClass(Bf,"gradient"),re.setClass(Bf,"linear"),re.setClass(Bf,"radial");const HX=["type","source","patternTransform"];class Zv{get type(){return"pattern"}set type(e){Po("warn","Setting type has no effect",e)}constructor(e){M(this,"repeat","repeat"),M(this,"offsetX",0),M(this,"offsetY",0),M(this,"crossOrigin",""),this.id=Io(),Object.assign(this,e)}isImageSource(){return!!this.source&&typeof this.source.src=="string"}isCanvasSource(){return!!this.source&&!!this.source.toDataURL}sourceToString(){return this.isImageSource()?this.source.src:this.isCanvasSource()?this.source.toDataURL():""}toLive(e){return this.source&&(!this.isImageSource()||this.source.complete&&this.source.naturalWidth!==0&&this.source.naturalHeight!==0)?e.createPattern(this.source,this.repeat):null}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const{repeat:t,crossOrigin:r}=this;return L(L({},ru(this,e)),{},{type:"pattern",source:this.sourceToString(),repeat:t,crossOrigin:r,offsetX:Qe(this.offsetX,Le.NUM_FRACTION_DIGITS),offsetY:Qe(this.offsetY,Le.NUM_FRACTION_DIGITS),patternTransform:this.patternTransform?[...this.patternTransform]:null})}toSVG(e){let{width:t,height:r}=e;const{source:s,repeat:i,id:o}=this,a=Ll(this.offsetX/t,0),l=Ll(this.offsetY/r,0),c=i==="repeat-y"||i==="no-repeat"?1+Math.abs(a||0):Ll(s.width/t,0),u=i==="repeat-x"||i==="no-repeat"?1+Math.abs(l||0):Ll(s.height/r,0);return['<pattern id="SVGID_'.concat(o,'" x="').concat(a,'" y="').concat(l,'" width="').concat(c,'" height="').concat(u,'">'),'<image x="0" y="0" width="'.concat(s.width,'" height="').concat(s.height,'" xlink:href="').concat(this.sourceToString(),'"></image>'),"</pattern>",""].join(`
`)}static async fromObject(e,t){let{type:r,source:s,patternTransform:i}=e,o=st(e,HX);const a=await $p(s,L(L({},t),{},{crossOrigin:o.crossOrigin}));return new this(L(L({},o),{},{patternTransform:i&&i.slice(0),source:a}))}}M(Zv,"type","Pattern"),re.setClass(Zv),re.setClass(Zv,"pattern");const qX=["path","left","top"],GX=["d"];class aa extends cn{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{path:r,left:s,top:i}=t,o=st(t,qX);super(),Object.assign(this,aa.ownDefaults),this.setOptions(o),this._setPath(e||[],!0),typeof s=="number"&&this.set($e,s),typeof i=="number"&&this.set(Mn,i)}_setPath(e,t){this.path=EX(Array.isArray(e)?e:NX(e)),this.setBoundingBox(t)}_findCenterFromElement(){const e=this._calcBoundsFromPath();return new $(e.left+e.width/2,e.top+e.height/2)}_renderPathCommands(e){const t=-this.pathOffset.x,r=-this.pathOffset.y;e.beginPath();for(const s of this.path)switch(s[0]){case"L":e.lineTo(s[1]+t,s[2]+r);break;case"M":e.moveTo(s[1]+t,s[2]+r);break;case"C":e.bezierCurveTo(s[1]+t,s[2]+r,s[3]+t,s[4]+r,s[5]+t,s[6]+r);break;case"Q":e.quadraticCurveTo(s[1]+t,s[2]+r,s[3]+t,s[4]+r);break;case"Z":e.closePath()}}_render(e){this._renderPathCommands(e),this._renderPaintInOrder(e)}toString(){return"#<Path (".concat(this.complexity(),'): { "top": ').concat(this.top,', "left": ').concat(this.left," }>")}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return L(L({},super.toObject(e)),{},{path:this.path.map(t=>t.slice())})}toDatalessObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const t=this.toObject(e);return this.sourcePath&&(delete t.path,t.sourcePath=this.sourcePath),t}_toSVG(){const e=jX(this.path,Le.NUM_FRACTION_DIGITS);return["<path ","COMMON_PARTS",'d="'.concat(e,`" stroke-linecap="round" />
`)]}_getOffsetTransform(){const e=Le.NUM_FRACTION_DIGITS;return" translate(".concat(Qe(-this.pathOffset.x,e),", ").concat(Qe(-this.pathOffset.y,e),")")}toClipPathSVG(e){const t=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:t})}toSVG(e){const t=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:t})}complexity(){return this.path.length}setDimensions(){this.setBoundingBox()}setBoundingBox(e){const{width:t,height:r,pathOffset:s}=this._calcDimensions();this.set({width:t,height:r,pathOffset:s}),e&&this.setPositionByOrigin(s,Te,Te)}_calcBoundsFromPath(){const e=[];let t=0,r=0,s=0,i=0;for(const o of this.path)switch(o[0]){case"L":s=o[1],i=o[2],e.push({x:t,y:r},{x:s,y:i});break;case"M":s=o[1],i=o[2],t=s,r=i;break;case"C":e.push(...Dk(s,i,o[1],o[2],o[3],o[4],o[5],o[6])),s=o[5],i=o[6];break;case"Q":e.push(...Dk(s,i,o[1],o[2],o[1],o[2],o[3],o[4])),s=o[3],i=o[4];break;case"Z":s=t,i=r}return ei(e)}_calcDimensions(){const e=this._calcBoundsFromPath();return L(L({},e),{},{pathOffset:new $(e.left+e.width/2,e.top+e.height/2)})}static fromObject(e){return this._fromObject(e,{extraParam:"path"})}static async fromElement(e,t,r){const s=_i(e,this.ATTRIBUTE_NAMES,r),{d:i}=s;return new this(i,L(L(L({},st(s,GX)),t),{},{left:void 0,top:void 0}))}}M(aa,"type","Path"),M(aa,"cacheProperties",[...wi,"path","fillRule"]),M(aa,"ATTRIBUTE_NAMES",[...$o,"d"]),re.setClass(aa),re.setSVGClass(aa);const KX=["left","top","radius"],WD=["radius","startAngle","endAngle","counterClockwise"];class ds extends cn{static getDefaults(){return L(L({},super.getDefaults()),ds.ownDefaults)}constructor(e){super(),Object.assign(this,ds.ownDefaults),this.setOptions(e)}_set(e,t){return super._set(e,t),e==="radius"&&this.setRadius(t),this}_render(e){e.beginPath(),e.arc(0,0,this.radius,xt(this.startAngle),xt(this.endAngle),this.counterClockwise),this._renderPaintInOrder(e)}getRadiusX(){return this.get("radius")*this.get(Vn)}getRadiusY(){return this.get("radius")*this.get(vr)}setRadius(e){this.radius=e,this.set({width:2*e,height:2*e})}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...WD,...e])}_toSVG(){const e=(this.endAngle-this.startAngle)%360;if(e===0)return["<circle ","COMMON_PARTS",'cx="0" cy="0" ','r="',"".concat(this.radius),`" />
`];{const{radius:t}=this,r=xt(this.startAngle),s=xt(this.endAngle),i=di(r)*t,o=fi(r)*t,a=di(s)*t,l=fi(s)*t,c=e>180?1:0,u=this.counterClockwise?0:1;return['<path d="M '.concat(i," ").concat(o," A ").concat(t," ").concat(t," 0 ").concat(c," ").concat(u," ").concat(a," ").concat(l,'" '),"COMMON_PARTS",` />
`]}}static async fromElement(e,t,r){const s=_i(e,this.ATTRIBUTE_NAMES,r),{left:i=0,top:o=0,radius:a=0}=s;return new this(L(L({},st(s,KX)),{},{radius:a,left:i-a,top:o-a}))}static fromObject(e){return super._fromObject(e)}}M(ds,"type","Circle"),M(ds,"cacheProperties",[...wi,...WD]),M(ds,"ownDefaults",{radius:0,startAngle:0,endAngle:360,counterClockwise:!1}),M(ds,"ATTRIBUTE_NAMES",["cx","cy","r",...$o]),re.setClass(ds),re.setSVGClass(ds);const YX=["x1","y1","x2","y2"],XX=["x1","y1","x2","y2"],b_=["x1","x2","y1","y2"];class Ki extends cn{constructor(){let[e,t,r,s]=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,0,0],i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,Ki.ownDefaults),this.setOptions(i),this.x1=e,this.x2=r,this.y1=t,this.y2=s,this._setWidthHeight();const{left:o,top:a}=i;typeof o=="number"&&this.set($e,o),typeof a=="number"&&this.set(Mn,a)}_setWidthHeight(){const{x1:e,y1:t,x2:r,y2:s}=this;this.width=Math.abs(r-e),this.height=Math.abs(s-t);const{left:i,top:o,width:a,height:l}=ei([{x:e,y:t},{x:r,y:s}]),c=new $(i+a/2,o+l/2);this.setPositionByOrigin(c,Te,Te)}_set(e,t){return super._set(e,t),b_.includes(e)&&this._setWidthHeight(),this}_render(e){e.beginPath();const t=this.calcLinePoints();e.moveTo(t.x1,t.y1),e.lineTo(t.x2,t.y2),e.lineWidth=this.strokeWidth;const r=e.strokeStyle;var s;dr(this.stroke)?e.strokeStyle=this.stroke.toLive(e):e.strokeStyle=(s=this.stroke)!==null&&s!==void 0?s:e.fillStyle,this.stroke&&this._renderStroke(e),e.strokeStyle=r}_findCenterFromElement(){return new $((this.x1+this.x2)/2,(this.y1+this.y2)/2)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return L(L({},super.toObject(e)),this.calcLinePoints())}_getNonTransformedDimensions(){const e=super._getNonTransformedDimensions();return this.strokeLineCap==="butt"&&(this.width===0&&(e.y-=this.strokeWidth),this.height===0&&(e.x-=this.strokeWidth)),e}calcLinePoints(){const{x1:e,x2:t,y1:r,y2:s,width:i,height:o}=this,a=e<=t?-1:1,l=r<=s?-1:1;return{x1:a*i/2,x2:a*-i/2,y1:l*o/2,y2:l*-o/2}}_toSVG(){const{x1:e,x2:t,y1:r,y2:s}=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="'.concat(e,'" y1="').concat(r,'" x2="').concat(t,'" y2="').concat(s,`" />
`)]}static async fromElement(e,t,r){const s=_i(e,this.ATTRIBUTE_NAMES,r),{x1:i=0,y1:o=0,x2:a=0,y2:l=0}=s;return new this([i,o,a,l],st(s,YX))}static fromObject(e){let{x1:t,y1:r,x2:s,y2:i}=e,o=st(e,XX);return this._fromObject(L(L({},o),{},{points:[t,r,s,i]}),{extraParam:"points"})}}M(Ki,"type","Line"),M(Ki,"cacheProperties",[...wi,...b_]),M(Ki,"ATTRIBUTE_NAMES",$o.concat(b_)),re.setClass(Ki),re.setSVGClass(Ki);class so extends cn{static getDefaults(){return L(L({},super.getDefaults()),so.ownDefaults)}constructor(e){super(),Object.assign(this,so.ownDefaults),this.setOptions(e)}_render(e){const t=this.width/2,r=this.height/2;e.beginPath(),e.moveTo(-t,r),e.lineTo(0,-r),e.lineTo(t,r),e.closePath(),this._renderPaintInOrder(e)}_toSVG(){const e=this.width/2,t=this.height/2;return["<polygon ","COMMON_PARTS",'points="',"".concat(-e," ").concat(t,",0 ").concat(-t,",").concat(e," ").concat(t),'" />']}}M(so,"type","Triangle"),M(so,"ownDefaults",{width:100,height:100}),re.setClass(so),re.setSVGClass(so);const HD=["rx","ry"];class $s extends cn{static getDefaults(){return L(L({},super.getDefaults()),$s.ownDefaults)}constructor(e){super(),Object.assign(this,$s.ownDefaults),this.setOptions(e)}_set(e,t){switch(super._set(e,t),e){case"rx":this.rx=t,this.set("width",2*t);break;case"ry":this.ry=t,this.set("height",2*t)}return this}getRx(){return this.get("rx")*this.get(Vn)}getRy(){return this.get("ry")*this.get(vr)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...HD,...e])}_toSVG(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" rx="'.concat(this.rx,'" ry="').concat(this.ry,`" />
`)]}_render(e){e.beginPath(),e.save(),e.transform(1,0,0,this.ry/this.rx,0,0),e.arc(0,0,this.rx,0,Kg,!1),e.restore(),this._renderPaintInOrder(e)}static async fromElement(e,t,r){const s=_i(e,this.ATTRIBUTE_NAMES,r);return s.left=(s.left||0)-s.rx,s.top=(s.top||0)-s.ry,new this(s)}}function QX(n){if(!n)return[];const e=n.replace(/,/g," ").trim().split(/\s+/),t=[];for(let r=0;r<e.length;r+=2)t.push({x:parseFloat(e[r]),y:parseFloat(e[r+1])});return t}M($s,"type","Ellipse"),M($s,"cacheProperties",[...wi,...HD]),M($s,"ownDefaults",{rx:0,ry:0}),M($s,"ATTRIBUTE_NAMES",[...$o,"cx","cy","rx","ry"]),re.setClass($s),re.setSVGClass($s);const JX=["left","top"],qD={exactBoundingBox:!1};class Lr extends cn{static getDefaults(){return L(L({},super.getDefaults()),Lr.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),M(this,"strokeDiff",void 0),Object.assign(this,Lr.ownDefaults),this.setOptions(t),this.points=e;const{left:r,top:s}=t;this.initialized=!0,this.setBoundingBox(!0),typeof r=="number"&&this.set($e,r),typeof s=="number"&&this.set(Mn,s)}isOpen(){return!0}_projectStrokeOnPoints(e){return $Y(this.points,e,this.isOpen())}_calcDimensions(e){e=L({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:this.strokeMiterLimit,strokeUniform:this.strokeUniform,strokeWidth:this.strokeWidth},e||{});const t=this.exactBoundingBox?this._projectStrokeOnPoints(e).map(c=>c.projectedPoint):this.points;if(t.length===0)return{left:0,top:0,width:0,height:0,pathOffset:new $,strokeOffset:new $,strokeDiff:new $};const r=ei(t),s=fy(L(L({},e),{},{scaleX:1,scaleY:1})),i=ei(this.points.map(c=>Pn(c,s,!0))),o=new $(this.scaleX,this.scaleY);let a=r.left+r.width/2,l=r.top+r.height/2;return this.exactBoundingBox&&(a-=l*Math.tan(xt(this.skewX)),l-=a*Math.tan(xt(this.skewY))),L(L({},r),{},{pathOffset:new $(a,l),strokeOffset:new $(i.left,i.top).subtract(new $(r.left,r.top)).multiply(o),strokeDiff:new $(r.width,r.height).subtract(new $(i.width,i.height)).multiply(o)})}_findCenterFromElement(){const e=ei(this.points);return new $(e.left+e.width/2,e.top+e.height/2)}setDimensions(){this.setBoundingBox()}setBoundingBox(e){const{left:t,top:r,width:s,height:i,pathOffset:o,strokeOffset:a,strokeDiff:l}=this._calcDimensions();this.set({width:s,height:i,pathOffset:o,strokeOffset:a,strokeDiff:l}),e&&this.setPositionByOrigin(new $(t+s/2,r+i/2),Te,Te)}isStrokeAccountedForInDimensions(){return this.exactBoundingBox}_getNonTransformedDimensions(){return this.exactBoundingBox?new $(this.width,this.height):super._getNonTransformedDimensions()}_getTransformedDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this.exactBoundingBox){let o;if(Object.keys(e).some(a=>this.strokeUniform||this.constructor.layoutProperties.includes(a))){var t,r;const{width:a,height:l}=this._calcDimensions(e);o=new $((t=e.width)!==null&&t!==void 0?t:a,(r=e.height)!==null&&r!==void 0?r:l)}else{var s,i;o=new $((s=e.width)!==null&&s!==void 0?s:this.width,(i=e.height)!==null&&i!==void 0?i:this.height)}return o.multiply(new $(e.scaleX||this.scaleX,e.scaleY||this.scaleY))}return super._getTransformedDimensions(e)}_set(e,t){const r=this.initialized&&this[e]!==t,s=super._set(e,t);return this.exactBoundingBox&&r&&((e===Vn||e===vr)&&this.strokeUniform&&this.constructor.layoutProperties.includes("strokeUniform")||this.constructor.layoutProperties.includes(e))&&this.setDimensions(),s}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return L(L({},super.toObject(e)),{},{points:this.points.map(t=>{let{x:r,y:s}=t;return{x:r,y:s}})})}_toSVG(){const e=[],t=this.pathOffset.x,r=this.pathOffset.y,s=Le.NUM_FRACTION_DIGITS;for(let i=0,o=this.points.length;i<o;i++)e.push(Qe(this.points[i].x-t,s),",",Qe(this.points[i].y-r,s)," ");return["<".concat(this.constructor.type.toLowerCase()," "),"COMMON_PARTS",'points="'.concat(e.join(""),`" />
`)]}_render(e){const t=this.points.length,r=this.pathOffset.x,s=this.pathOffset.y;if(t&&!isNaN(this.points[t-1].y)){e.beginPath(),e.moveTo(this.points[0].x-r,this.points[0].y-s);for(let i=0;i<t;i++){const o=this.points[i];e.lineTo(o.x-r,o.y-s)}!this.isOpen()&&e.closePath(),this._renderPaintInOrder(e)}}complexity(){return this.points.length}static async fromElement(e,t,r){return new this(QX(e.getAttribute("points")),L(L({},st(_i(e,this.ATTRIBUTE_NAMES,r),JX)),t))}static fromObject(e){return this._fromObject(e,{extraParam:"points"})}}M(Lr,"ownDefaults",qD),M(Lr,"type","Polyline"),M(Lr,"layoutProperties",[eu,tu,"strokeLineCap","strokeLineJoin","strokeMiterLimit","strokeWidth","strokeUniform","points"]),M(Lr,"cacheProperties",[...wi,"points"]),M(Lr,"ATTRIBUTE_NAMES",[...$o]),re.setClass(Lr),re.setSVGClass(Lr);class Fl extends Lr{isOpen(){return!1}}M(Fl,"ownDefaults",qD),M(Fl,"type","Polygon"),re.setClass(Fl),re.setSVGClass(Fl);class GD extends cn{isEmptyStyles(e){if(!this.styles||e!==void 0&&!this.styles[e])return!0;const t=e===void 0?this.styles:{line:this.styles[e]};for(const r in t)for(const s in t[r])for(const i in t[r][s])return!1;return!0}styleHas(e,t){if(!this.styles||t!==void 0&&!this.styles[t])return!1;const r=t===void 0?this.styles:{0:this.styles[t]};for(const s in r)for(const i in r[s])if(r[s][i][e]!==void 0)return!0;return!1}cleanStyle(e){if(!this.styles)return!1;const t=this.styles;let r,s,i=0,o=!0,a=0;for(const l in t){r=0;for(const c in t[l]){const u=t[l][c]||{};i++,u[e]!==void 0?(s?u[e]!==s&&(o=!1):s=u[e],u[e]===this[e]&&delete u[e]):o=!1,Object.keys(u).length!==0?r++:delete t[l][c]}r===0&&delete t[l]}for(let l=0;l<this._textLines.length;l++)a+=this._textLines[l].length;o&&i===a&&(this[e]=s,this.removeStyle(e))}removeStyle(e){if(!this.styles)return;const t=this.styles;let r,s,i;for(s in t){for(i in r=t[s],r)delete r[i][e],Object.keys(r[i]).length===0&&delete r[i];Object.keys(r).length===0&&delete t[s]}}_extendStyles(e,t){const{lineIndex:r,charIndex:s}=this.get2DCursorLocation(e);this._getLineStyle(r)||this._setLineStyle(r);const i=n1(L(L({},this._getStyleDeclaration(r,s)),t),o=>o!==void 0);this._setStyleDeclaration(r,s,i)}getSelectionStyles(e,t,r){const s=[];for(let i=e;i<(t||e);i++)s.push(this.getStyleAtPosition(i,r));return s}getStyleAtPosition(e,t){const{lineIndex:r,charIndex:s}=this.get2DCursorLocation(e);return t?this.getCompleteStyleDeclaration(r,s):this._getStyleDeclaration(r,s)}setSelectionStyles(e,t,r){for(let s=t;s<(r||t);s++)this._extendStyles(s,e);this._forceClearCache=!0}_getStyleDeclaration(e,t){var r;const s=this.styles&&this.styles[e];return s&&(r=s[t])!==null&&r!==void 0?r:{}}getCompleteStyleDeclaration(e,t){return L(L({},ru(this,this.constructor._styleProperties)),this._getStyleDeclaration(e,t))}_setStyleDeclaration(e,t,r){this.styles[e][t]=r}_deleteStyleDeclaration(e,t){delete this.styles[e][t]}_getLineStyle(e){return!!this.styles[e]}_setLineStyle(e){this.styles[e]={}}_deleteLineStyle(e){delete this.styles[e]}}M(GD,"_styleProperties",rY);const ZX=/  +/g,eQ=/"/g;function e0(n,e,t,r,s){return"		".concat(function(i,o){let{left:a,top:l,width:c,height:u}=o,h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Le.NUM_FRACTION_DIGITS;const f=nd(Mt,i,!1),[p,y,m,v]=[a,l,c,u].map(w=>Qe(w,h));return"<rect ".concat(f,' x="').concat(p,'" y="').concat(y,'" width="').concat(m,'" height="').concat(v,'"></rect>')}(n,{left:e,top:t,width:r,height:s}),`
`)}const tQ=["textAnchor","textDecoration","dx","dy","top","left","fontSize","strokeWidth"];let t0;class mn extends GD{static getDefaults(){return L(L({},super.getDefaults()),mn.ownDefaults)}constructor(e,t){super(),M(this,"__charBounds",[]),Object.assign(this,mn.ownDefaults),this.setOptions(t),this.styles||(this.styles={}),this.text=e,this.initialized=!0,this.path&&this.setPathInfo(),this.initDimensions(),this.setCoords()}setPathInfo(){const e=this.path;e&&(e.segmentsInfo=FD(e.path))}_splitText(){const e=this._splitTextIntoLines(this.text);return this.textLines=e.lines,this._textLines=e.graphemeLines,this._unwrappedTextLines=e._unwrappedLines,this._text=e.graphemeText,e}initDimensions(){this._splitText(),this._clearCache(),this.dirty=!0,this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.includes(ps)&&this.enlargeSpaces()}enlargeSpaces(){let e,t,r,s,i,o,a;for(let l=0,c=this._textLines.length;l<c;l++)if((this.textAlign===ps||l!==c-1&&!this.isEndOfWrapping(l))&&(s=0,i=this._textLines[l],t=this.getLineWidth(l),t<this.width&&(a=this.textLines[l].match(this._reSpacesAndTabs)))){r=a.length,e=(this.width-t)/r;for(let u=0;u<=i.length;u++)o=this.__charBounds[l][u],this._reSpaceAndTab.test(i[u])?(o.width+=e,o.kernedWidth+=e,o.left+=s,s+=e):o.left+=s}}isEndOfWrapping(e){return e===this._textLines.length-1}missingNewlineOffset(e){return 1}get2DCursorLocation(e,t){const r=t?this._unwrappedTextLines:this._textLines;let s;for(s=0;s<r.length;s++){if(e<=r[s].length)return{lineIndex:s,charIndex:e};e-=r[s].length+this.missingNewlineOffset(s,t)}return{lineIndex:s-1,charIndex:r[s-1].length<e?r[s-1].length:e}}toString(){return"#<Text (".concat(this.complexity(),'): { "text": "').concat(this.text,'", "fontFamily": "').concat(this.fontFamily,'" }>')}_getCacheCanvasDimensions(){const e=super._getCacheCanvasDimensions(),t=this.fontSize;return e.width+=t*e.zoomX,e.height+=t*e.zoomY,e}_render(e){const t=this.path;t&&!t.isNotVisible()&&t._render(e),this._setTextStyles(e),this._renderTextLinesBackground(e),this._renderTextDecoration(e,"underline"),this._renderText(e),this._renderTextDecoration(e,"overline"),this._renderTextDecoration(e,"linethrough")}_renderText(e){this.paintFirst===Fn?(this._renderTextStroke(e),this._renderTextFill(e)):(this._renderTextFill(e),this._renderTextStroke(e))}_setTextStyles(e,t,r){if(e.textBaseline="alphabetic",this.path)switch(this.pathAlign){case Te:e.textBaseline="middle";break;case"ascender":e.textBaseline=Mn;break;case"descender":e.textBaseline=h_}e.font=this._getFontDeclaration(t,r)}calcTextWidth(){let e=this.getLineWidth(0);for(let t=1,r=this._textLines.length;t<r;t++){const s=this.getLineWidth(t);s>e&&(e=s)}return e}_renderTextLine(e,t,r,s,i,o){this._renderChars(e,t,r,s,i,o)}_renderTextLinesBackground(e){if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))return;const t=e.fillStyle,r=this._getLeftOffset();let s=this._getTopOffset();for(let i=0,o=this._textLines.length;i<o;i++){const a=this.getHeightOfLine(i);if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",i)){s+=a;continue}const l=this._textLines[i].length,c=this._getLineLeftOffset(i);let u,h,f=0,p=0,y=this.getValueOfPropertyAt(i,0,"textBackgroundColor");const m=this.getHeightOfLineImpl(i);for(let v=0;v<l;v++){const w=this.__charBounds[i][v];h=this.getValueOfPropertyAt(i,v,"textBackgroundColor"),this.path?(e.save(),e.translate(w.renderLeft,w.renderTop),e.rotate(w.angle),e.fillStyle=h,h&&e.fillRect(-w.width/2,-m*(1-this._fontSizeFraction),w.width,m),e.restore()):h!==y?(u=r+c+p,this.direction==="rtl"&&(u=this.width-u-f),e.fillStyle=y,y&&e.fillRect(u,s,f,m),p=w.left,f=w.width,y=h):f+=w.kernedWidth}h&&!this.path&&(u=r+c+p,this.direction==="rtl"&&(u=this.width-u-f),e.fillStyle=h,e.fillRect(u,s,f,m)),s+=a}e.fillStyle=t,this._removeShadow(e)}_measureChar(e,t,r,s){const i=uh.getFontCache(t),o=this._getFontDeclaration(t),a=r+e,l=r&&o===this._getFontDeclaration(s),c=t.fontSize/this.CACHE_FONT_SIZE;let u,h,f,p;if(r&&i.has(r)&&(f=i.get(r)),i.has(e)&&(p=u=i.get(e)),l&&i.has(a)&&(h=i.get(a),p=h-f),u===void 0||f===void 0||h===void 0){const y=function(){return t0||(t0=wr({width:0,height:0}).getContext("2d")),t0}();this._setTextStyles(y,t,!0),u===void 0&&(p=u=y.measureText(e).width,i.set(e,u)),f===void 0&&l&&r&&(f=y.measureText(r).width,i.set(r,f)),l&&h===void 0&&(h=y.measureText(a).width,i.set(a,h),p=h-f)}return{width:u*c,kernedWidth:p*c}}getHeightOfChar(e,t){return this.getValueOfPropertyAt(e,t,"fontSize")}measureLine(e){const t=this._measureLine(e);return this.charSpacing!==0&&(t.width-=this._getWidthOfCharSpacing()),t.width<0&&(t.width=0),t}_measureLine(e){let t,r,s=0;const i=this.pathSide===vt,o=this.path,a=this._textLines[e],l=a.length,c=new Array(l);this.__charBounds[e]=c;for(let u=0;u<l;u++){const h=a[u];r=this._getGraphemeBox(h,e,u,t),c[u]=r,s+=r.kernedWidth,t=h}if(c[l]={left:r?r.left+r.width:0,width:0,kernedWidth:0,height:this.fontSize,deltaY:0},o&&o.segmentsInfo){let u=0;const h=o.segmentsInfo[o.segmentsInfo.length-1].length;switch(this.textAlign){case $e:u=i?h-s:0;break;case Te:u=(h-s)/2;break;case vt:u=i?0:h-s}u+=this.pathStartOffset*(i?-1:1);for(let f=i?l-1:0;i?f>=0:f<l;i?f--:f++)r=c[f],u>h?u%=h:u<0&&(u+=h),this._setGraphemeOnPath(u,r),u+=r.kernedWidth}return{width:s,numOfSpaces:0}}_setGraphemeOnPath(e,t){const r=e+t.kernedWidth/2,s=this.path,i=PX(s.path,r,s.segmentsInfo);t.renderLeft=i.x-s.pathOffset.x,t.renderTop=i.y-s.pathOffset.y,t.angle=i.angle+(this.pathSide===vt?Math.PI:0)}_getGraphemeBox(e,t,r,s,i){const o=this.getCompleteStyleDeclaration(t,r),a=s?this.getCompleteStyleDeclaration(t,r-1):{},l=this._measureChar(e,o,s,a);let c,u=l.kernedWidth,h=l.width;this.charSpacing!==0&&(c=this._getWidthOfCharSpacing(),h+=c,u+=c);const f={width:h,left:0,height:o.fontSize,kernedWidth:u,deltaY:o.deltaY};if(r>0&&!i){const p=this.__charBounds[t][r-1];f.left=p.left+p.width+l.kernedWidth-l.width}return f}getHeightOfLineImpl(e){const t=this.__lineHeights;if(t[e])return t[e];let r=this.getHeightOfChar(e,0);for(let s=1,i=this._textLines[e].length;s<i;s++)r=Math.max(this.getHeightOfChar(e,s),r);return t[e]=r*this._fontSizeMult}getHeightOfLine(e){return this.getHeightOfLineImpl(e)*this.lineHeight}calcTextHeight(){let e=0;for(let t=0,r=this._textLines.length;t<r;t++)e+=t===r-1?this.getHeightOfLineImpl(t):this.getHeightOfLine(t);return e}_getLeftOffset(){return this.direction==="ltr"?-this.width/2:this.width/2}_getTopOffset(){return-this.height/2}_renderTextCommon(e,t){e.save();let r=0;const s=this._getLeftOffset(),i=this._getTopOffset();for(let o=0,a=this._textLines.length;o<a;o++)this._renderTextLine(t,e,this._textLines[o],s+this._getLineLeftOffset(o),i+r+this.getHeightOfLineImpl(o),o),r+=this.getHeightOfLine(o);e.restore()}_renderTextFill(e){(this.fill||this.styleHas(Mt))&&this._renderTextCommon(e,"fillText")}_renderTextStroke(e){(this.stroke&&this.strokeWidth!==0||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this._setLineDash(e,this.strokeDashArray),e.beginPath(),this._renderTextCommon(e,"strokeText"),e.closePath(),e.restore())}_renderChars(e,t,r,s,i,o){const a=this.textAlign.includes(ps),l=this.path,c=!a&&this.charSpacing===0&&this.isEmptyStyles(o)&&!l,u=this.direction==="ltr",h=this.direction==="ltr"?1:-1,f=t.direction;let p,y,m,v,w,_="",x=0;if(t.save(),f!==this.direction&&(t.canvas.setAttribute("dir",u?"ltr":"rtl"),t.direction=u?"ltr":"rtl",t.textAlign=u?$e:vt),i-=this.getHeightOfLineImpl(o)*this._fontSizeFraction,c)return this._renderChar(e,t,o,0,r.join(""),s,i),void t.restore();for(let A=0,j=r.length-1;A<=j;A++)v=A===j||this.charSpacing||l,_+=r[A],m=this.__charBounds[o][A],x===0?(s+=h*(m.kernedWidth-m.width),x+=m.width):x+=m.kernedWidth,a&&!v&&this._reSpaceAndTab.test(r[A])&&(v=!0),v||(p=p||this.getCompleteStyleDeclaration(o,A),y=this.getCompleteStyleDeclaration(o,A+1),v=u1(p,y,!1)),v&&(l?(t.save(),t.translate(m.renderLeft,m.renderTop),t.rotate(m.angle),this._renderChar(e,t,o,A,_,-x/2,0),t.restore()):(w=s,this._renderChar(e,t,o,A,_,w,i)),_="",p=y,s+=h*x,x=0);t.restore()}_applyPatternGradientTransformText(e){const t=this.width+this.strokeWidth,r=this.height+this.strokeWidth,s=wr({width:t,height:r}),i=s.getContext("2d");return s.width=t,s.height=r,i.beginPath(),i.moveTo(0,0),i.lineTo(t,0),i.lineTo(t,r),i.lineTo(0,r),i.closePath(),i.translate(t/2,r/2),i.fillStyle=e.toLive(i),this._applyPatternGradientTransform(i,e),i.fill(),i.createPattern(s,"no-repeat")}handleFiller(e,t,r){let s,i;return dr(r)?r.gradientUnits==="percentage"||r.gradientTransform||r.patternTransform?(s=-this.width/2,i=-this.height/2,e.translate(s,i),e[t]=this._applyPatternGradientTransformText(r),{offsetX:s,offsetY:i}):(e[t]=r.toLive(e),this._applyPatternGradientTransform(e,r)):(e[t]=r,{offsetX:0,offsetY:0})}_setStrokeStyles(e,t){let{stroke:r,strokeWidth:s}=t;return e.lineWidth=s,e.lineCap=this.strokeLineCap,e.lineDashOffset=this.strokeDashOffset,e.lineJoin=this.strokeLineJoin,e.miterLimit=this.strokeMiterLimit,this.handleFiller(e,"strokeStyle",r)}_setFillStyles(e,t){let{fill:r}=t;return this.handleFiller(e,"fillStyle",r)}_renderChar(e,t,r,s,i,o,a){const l=this._getStyleDeclaration(r,s),c=this.getCompleteStyleDeclaration(r,s),u=e==="fillText"&&c.fill,h=e==="strokeText"&&c.stroke&&c.strokeWidth;if(h||u){if(t.save(),t.font=this._getFontDeclaration(c),l.textBackgroundColor&&this._removeShadow(t),l.deltaY&&(a+=l.deltaY),u){const f=this._setFillStyles(t,c);t.fillText(i,o-f.offsetX,a-f.offsetY)}if(h){const f=this._setStrokeStyles(t,c);t.strokeText(i,o-f.offsetX,a-f.offsetY)}t.restore()}}setSuperscript(e,t){this._setScript(e,t,this.superscript)}setSubscript(e,t){this._setScript(e,t,this.subscript)}_setScript(e,t,r){const s=this.get2DCursorLocation(e,!0),i=this.getValueOfPropertyAt(s.lineIndex,s.charIndex,"fontSize"),o=this.getValueOfPropertyAt(s.lineIndex,s.charIndex,"deltaY"),a={fontSize:i*r.size,deltaY:o+i*r.baseline};this.setSelectionStyles(a,e,t)}_getLineLeftOffset(e){const t=this.getLineWidth(e),r=this.width-t,s=this.textAlign,i=this.direction,o=this.isEndOfWrapping(e);let a=0;return s===ps||s===dh&&!o||s===hh&&!o||s===nm&&!o?0:(s===Te&&(a=r/2),s===vt&&(a=r),s===dh&&(a=r/2),s===hh&&(a=r),i==="rtl"&&(s===vt||s===ps||s===hh?a=0:s===$e||s===nm?a=-r:s!==Te&&s!==dh||(a=-r/2)),a)}_clearCache(){this._forceClearCache=!1,this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]}getLineWidth(e){if(this.__lineWidths[e]!==void 0)return this.__lineWidths[e];const{width:t}=this.measureLine(e);return this.__lineWidths[e]=t,t}_getWidthOfCharSpacing(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0}getValueOfPropertyAt(e,t,r){var s;return(s=this._getStyleDeclaration(e,t)[r])!==null&&s!==void 0?s:this[r]}_renderTextDecoration(e,t){if(!this[t]&&!this.styleHas(t))return;let r=this._getTopOffset();const s=this._getLeftOffset(),i=this.path,o=this._getWidthOfCharSpacing(),a=t==="linethrough"?.5:t==="overline"?1:0,l=this.offsets[t];for(let c=0,u=this._textLines.length;c<u;c++){const h=this.getHeightOfLine(c);if(!this[t]&&!this.styleHas(t,c)){r+=h;continue}const f=this._textLines[c],p=h/this.lineHeight,y=this._getLineLeftOffset(c);let m=0,v=0,w=this.getValueOfPropertyAt(c,0,t),_=this.getValueOfPropertyAt(c,0,Mt),x=this.getValueOfPropertyAt(c,0,$a),A=w,j=_,N=x;const S=r+p*(1-this._fontSizeFraction);let T=this.getHeightOfChar(c,0),P=this.getValueOfPropertyAt(c,0,"deltaY");for(let I=0,k=f.length;I<k;I++){const F=this.__charBounds[c][I];A=this.getValueOfPropertyAt(c,I,t),j=this.getValueOfPropertyAt(c,I,Mt),N=this.getValueOfPropertyAt(c,I,$a);const K=this.getHeightOfChar(c,I),G=this.getValueOfPropertyAt(c,I,"deltaY");if(i&&A&&j){const Y=this.fontSize*N/1e3;e.save(),e.fillStyle=_,e.translate(F.renderLeft,F.renderTop),e.rotate(F.angle),e.fillRect(-F.kernedWidth/2,l*K+G-a*Y,F.kernedWidth,Y),e.restore()}else if((A!==w||j!==_||K!==T||N!==x||G!==P)&&v>0){const Y=this.fontSize*x/1e3;let V=s+y+m;this.direction==="rtl"&&(V=this.width-V-v),w&&_&&x&&(e.fillStyle=_,e.fillRect(V,S+l*T+P-a*Y,v,Y)),m=F.left,v=F.width,w=A,x=N,_=j,T=K,P=G}else v+=F.kernedWidth}let R=s+y+m;this.direction==="rtl"&&(R=this.width-R-v),e.fillStyle=j;const D=this.fontSize*N/1e3;A&&j&&N&&e.fillRect(R,S+l*T+P-a*D,v-o,D),r+=h}this._removeShadow(e)}_getFontDeclaration(){let{fontFamily:e=this.fontFamily,fontStyle:t=this.fontStyle,fontWeight:r=this.fontWeight,fontSize:s=this.fontSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0;const o=e.includes("'")||e.includes('"')||e.includes(",")||mn.genericFonts.includes(e.toLowerCase())?e:'"'.concat(e,'"');return[t,r,"".concat(i?this.CACHE_FONT_SIZE:s,"px"),o].join(" ")}render(e){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._forceClearCache&&this.initDimensions(),super.render(e)))}graphemeSplit(e){return c1(e)}_splitTextIntoLines(e){const t=e.split(this._reNewline),r=new Array(t.length),s=[`
`];let i=[];for(let o=0;o<t.length;o++)r[o]=this.graphemeSplit(t[o]),i=i.concat(r[o],s);return i.pop(),{_unwrappedLines:r,lines:t,graphemeText:i,graphemeLines:r}}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return L(L({},super.toObject([..._D,...e])),{},{styles:HY(this.styles,this.text)},this.path?{path:this.path.toObject()}:{})}set(e,t){const{textLayoutProperties:r}=this.constructor;super.set(e,t);let s=!1,i=!1;if(typeof e=="object")for(const o in e)o==="path"&&this.setPathInfo(),s=s||r.includes(o),i=i||o==="path";else s=r.includes(e),i=e==="path";return i&&this.setPathInfo(),s&&this.initialized&&(this.initDimensions(),this.setCoords()),this}complexity(){return 1}static async fromElement(e,t,r){const s=_i(e,mn.ATTRIBUTE_NAMES,r),i=L(L({},t),s),{textAnchor:o=$e,textDecoration:a="",dx:l=0,dy:c=0,top:u=0,left:h=0,fontSize:f=Xb,strokeWidth:p=1}=i,y=st(i,tQ),m=new this(tm(e.textContent||"").trim(),L({left:h+l,top:u+c,underline:a.includes("underline"),overline:a.includes("overline"),linethrough:a.includes("line-through"),strokeWidth:0,fontSize:f},y)),v=m.getScaledHeight()/m.height,w=((m.height+m.strokeWidth)*m.lineHeight-m.height)*v,_=m.getScaledHeight()+w;let x=0;return o===Te&&(x=m.getScaledWidth()/2),o===vt&&(x=m.getScaledWidth()),m.set({left:m.left-x,top:m.top-(_-m.fontSize*(.07+m._fontSizeFraction))/m.lineHeight,strokeWidth:p}),m}static fromObject(e){return this._fromObject(L(L({},e),{},{styles:qY(e.styles||{},e.text)}),{extraParam:"text"})}}M(mn,"textLayoutProperties",wD),M(mn,"cacheProperties",[...wi,..._D]),M(mn,"ownDefaults",sY),M(mn,"type","Text"),M(mn,"genericFonts",["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","math","emoji","fangsong"]),M(mn,"ATTRIBUTE_NAMES",$o.concat("x","y","dx","dy","font-family","font-style","font-weight","font-size","letter-spacing","text-decoration","text-anchor")),PD(mn,[class extends mD{_toSVG(){const n=this._getSVGLeftTopOffsets(),e=this._getSVGTextAndBg(n.textTop,n.textLeft);return this._wrapSVGTextAndBg(e)}toSVG(n){const e=this._createBaseSVGMarkup(this._toSVG(),{reviver:n,noStyle:!0,withShadow:!0}),t=this.path;return t?e+t._createBaseSVGMarkup(t._toSVG(),{reviver:n,withShadow:!0,additionalTransform:td(this.calcOwnMatrix())}):e}_getSVGLeftTopOffsets(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}}_wrapSVGTextAndBg(n){let{textBgRects:e,textSpans:t}=n;const r=this.getSvgTextDecoration(this);return[e.join(""),'		<text xml:space="preserve" ','font-family="'.concat(this.fontFamily.replace(eQ,"'"),'" '),'font-size="'.concat(this.fontSize,'" '),this.fontStyle?'font-style="'.concat(this.fontStyle,'" '):"",this.fontWeight?'font-weight="'.concat(this.fontWeight,'" '):"",r?'text-decoration="'.concat(r,'" '):"",this.direction==="rtl"?'direction="'.concat(this.direction,'" '):"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",t.join(""),`</text>
`]}_getSVGTextAndBg(n,e){const t=[],r=[];let s,i=n;this.backgroundColor&&r.push(...e0(this.backgroundColor,-this.width/2,-this.height/2,this.width,this.height));for(let o=0,a=this._textLines.length;o<a;o++)s=this._getLineLeftOffset(o),this.direction==="rtl"&&(s+=this.width),(this.textBackgroundColor||this.styleHas("textBackgroundColor",o))&&this._setSVGTextLineBg(r,o,e+s,i),this._setSVGTextLineText(t,o,e+s,i),i+=this.getHeightOfLine(o);return{textSpans:t,textBgRects:r}}_createTextCharSpan(n,e,t,r,s){const i=Le.NUM_FRACTION_DIGITS,o=this.getSvgSpanStyles(e,n!==n.trim()||!!n.match(ZX)),a=o?'style="'.concat(o,'"'):"",l=e.deltaY,c=l?' dy="'.concat(Qe(l,i),'" '):"",{angle:u,renderLeft:h,renderTop:f,width:p}=s;let y="";if(h!==void 0){const m=p/2;u&&(y=' rotate="'.concat(Qe(gi(u),i),'"'));const v=nu({angle:gi(u)});v[4]=h,v[5]=f;const w=new $(-m,0).transform(v);t=w.x,r=w.y}return'<tspan x="'.concat(Qe(t,i),'" y="').concat(Qe(r,i),'" ').concat(c).concat(y).concat(a,">").concat(BY(n),"</tspan>")}_setSVGTextLineText(n,e,t,r){const s=this.getHeightOfLine(e),i=this.textAlign.includes(ps),o=this._textLines[e];let a,l,c,u,h,f="",p=0;r+=s*(1-this._fontSizeFraction)/this.lineHeight;for(let y=0,m=o.length-1;y<=m;y++)h=y===m||this.charSpacing||this.path,f+=o[y],c=this.__charBounds[e][y],p===0?(t+=c.kernedWidth-c.width,p+=c.width):p+=c.kernedWidth,i&&!h&&this._reSpaceAndTab.test(o[y])&&(h=!0),h||(a=a||this.getCompleteStyleDeclaration(e,y),l=this.getCompleteStyleDeclaration(e,y+1),h=u1(a,l,!0)),h&&(u=this._getStyleDeclaration(e,y),n.push(this._createTextCharSpan(f,u,t,r,c)),f="",a=l,this.direction==="rtl"?t-=p:t+=p,p=0)}_setSVGTextLineBg(n,e,t,r){const s=this._textLines[e],i=this.getHeightOfLine(e)/this.lineHeight;let o,a=0,l=0,c=this.getValueOfPropertyAt(e,0,"textBackgroundColor");for(let u=0;u<s.length;u++){const{left:h,width:f,kernedWidth:p}=this.__charBounds[e][u];o=this.getValueOfPropertyAt(e,u,"textBackgroundColor"),o!==c?(c&&n.push(...e0(c,t+l,r,a,i)),l=h,a=f,c=o):a+=p}o&&n.push(...e0(c,t+l,r,a,i))}_getSVGLineTopOffset(n){let e,t=0;for(e=0;e<n;e++)t+=this.getHeightOfLine(e);const r=this.getHeightOfLine(e);return{lineTop:t,offset:(this._fontSizeMult-this._fontSizeFraction)*r/(this.lineHeight*this._fontSizeMult)}}getSvgStyles(n){return"".concat(super.getSvgStyles(n)," text-decoration-thickness: ").concat(Qe(this.textDecorationThickness*this.getObjectScaling().y/10,Le.NUM_FRACTION_DIGITS),"%; white-space: pre;")}getSvgSpanStyles(n,e){const{fontFamily:t,strokeWidth:r,stroke:s,fill:i,fontSize:o,fontStyle:a,fontWeight:l,deltaY:c,textDecorationThickness:u,linethrough:h,overline:f,underline:p}=n,y=this.getSvgTextDecoration({underline:p??this.underline,overline:f??this.overline,linethrough:h??this.linethrough}),m=u||this.textDecorationThickness;return[s?nd(Fn,s):"",r?"stroke-width: ".concat(r,"; "):"",t?"font-family: ".concat(t.includes("'")||t.includes('"')?t:"'".concat(t,"'"),"; "):"",o?"font-size: ".concat(o,"px; "):"",a?"font-style: ".concat(a,"; "):"",l?"font-weight: ".concat(l,"; "):"",y?"text-decoration: ".concat(y,"; text-decoration-thickness: ").concat(Qe(m*this.getObjectScaling().y/10,Le.NUM_FRACTION_DIGITS),"%; "):"",i?nd(Mt,i):"",c?"baseline-shift: ".concat(-c,"; "):"",e?"white-space: pre; ":""].join("")}getSvgTextDecoration(n){return["overline","underline","line-through"].filter(e=>n[e.replace("-","")]).join(" ")}}]),re.setClass(mn),re.setSVGClass(mn);class nQ{constructor(e){M(this,"target",void 0),M(this,"__mouseDownInPlace",!1),M(this,"__dragStartFired",!1),M(this,"__isDraggingOver",!1),M(this,"__dragStartSelection",void 0),M(this,"__dragImageDisposer",void 0),M(this,"_dispose",void 0),this.target=e;const t=[this.target.on("dragenter",this.dragEnterHandler.bind(this)),this.target.on("dragover",this.dragOverHandler.bind(this)),this.target.on("dragleave",this.dragLeaveHandler.bind(this)),this.target.on("dragend",this.dragEndHandler.bind(this)),this.target.on("drop",this.dropHandler.bind(this))];this._dispose=()=>{t.forEach(r=>r()),this._dispose=void 0}}isPointerOverSelection(e){const t=this.target,r=t.getSelectionStartFromPointer(e);return t.isEditing&&r>=t.selectionStart&&r<=t.selectionEnd&&t.selectionStart<t.selectionEnd}start(e){return this.__mouseDownInPlace=this.isPointerOverSelection(e)}isActive(){return this.__mouseDownInPlace}end(e){const t=this.isActive();return t&&!this.__dragStartFired&&(this.target.setCursorByClick(e),this.target.initDelayedCursor(!0)),this.__mouseDownInPlace=!1,this.__dragStartFired=!1,this.__isDraggingOver=!1,t}getDragStartSelection(){return this.__dragStartSelection}setDragImage(e,t){var r;let{selectionStart:s,selectionEnd:i}=t;const o=this.target,a=o.canvas,l=new $(o.flipX?-1:1,o.flipY?-1:1),c=o._getCursorBoundaries(s),u=new $(c.left+c.leftOffset,c.top+c.topOffset).multiply(l).transform(o.calcTransformMatrix()),h=a.getScenePoint(e).subtract(u),f=o.getCanvasRetinaScaling(),p=o.getBoundingRect(),y=u.subtract(new $(p.left,p.top)),m=a.viewportTransform,v=y.add(h).transform(m,!0),w=o.backgroundColor,_=l1(o.styles);o.backgroundColor="";const x={stroke:"transparent",fill:"transparent",textBackgroundColor:"transparent"};o.setSelectionStyles(x,0,s),o.setSelectionStyles(x,i,o.text.length),o.dirty=!0;const A=o.toCanvasElement({enableRetinaScaling:a.enableRetinaScaling,viewportTransform:!0});o.backgroundColor=w,o.styles=_,o.dirty=!0,__(A,{position:"fixed",left:"".concat(-A.width,"px"),border:Ln,width:"".concat(A.width/f,"px"),height:"".concat(A.height/f,"px")}),this.__dragImageDisposer&&this.__dragImageDisposer(),this.__dragImageDisposer=()=>{A.remove()},Ur(e.target||this.target.hiddenTextarea).body.appendChild(A),(r=e.dataTransfer)===null||r===void 0||r.setDragImage(A,v.x,v.y)}onDragStart(e){this.__dragStartFired=!0;const t=this.target,r=this.isActive();if(r&&e.dataTransfer){const s=this.__dragStartSelection={selectionStart:t.selectionStart,selectionEnd:t.selectionEnd},i=t._text.slice(s.selectionStart,s.selectionEnd).join(""),o=L({text:t.text,value:i},s);e.dataTransfer.setData("text/plain",i),e.dataTransfer.setData("application/fabric",JSON.stringify({value:i,styles:t.getSelectionStyles(s.selectionStart,s.selectionEnd,!0)})),e.dataTransfer.effectAllowed="copyMove",this.setDragImage(e,o)}return t.abortCursorAnimation(),r}canDrop(e){if(this.target.editable&&!this.target.getActiveControl()&&!e.defaultPrevented){if(this.isActive()&&this.__dragStartSelection){const t=this.target.getSelectionStartFromPointer(e),r=this.__dragStartSelection;return t<r.selectionStart||t>r.selectionEnd}return!0}return!1}targetCanDrop(e){return this.target.canDrop(e)}dragEnterHandler(e){let{e:t}=e;const r=this.targetCanDrop(t);!this.__isDraggingOver&&r&&(this.__isDraggingOver=!0)}dragOverHandler(e){const{e:t}=e,r=this.targetCanDrop(t);!this.__isDraggingOver&&r?this.__isDraggingOver=!0:this.__isDraggingOver&&!r&&(this.__isDraggingOver=!1),this.__isDraggingOver&&(t.preventDefault(),e.canDrop=!0,e.dropTarget=this.target)}dragLeaveHandler(){(this.__isDraggingOver||this.isActive())&&(this.__isDraggingOver=!1)}dropHandler(e){var t;const{e:r}=e,s=r.defaultPrevented;this.__isDraggingOver=!1,r.preventDefault();let i=(t=r.dataTransfer)===null||t===void 0?void 0:t.getData("text/plain");if(i&&!s){const o=this.target,a=o.canvas;let l=o.getSelectionStartFromPointer(r);const{styles:c}=r.dataTransfer.types.includes("application/fabric")?JSON.parse(r.dataTransfer.getData("application/fabric")):{},u=i[Math.max(0,i.length-1)],h=0;if(this.__dragStartSelection){const f=this.__dragStartSelection.selectionStart,p=this.__dragStartSelection.selectionEnd;l>f&&l<=p?l=f:l>p&&(l-=p-f),o.removeChars(f,p),delete this.__dragStartSelection}o._reNewline.test(u)&&(o._reNewline.test(o._text[l])||l===o._text.length)&&(i=i.trimEnd()),e.didDrop=!0,e.dropTarget=o,o.insertChars(i,c,l),a.setActiveObject(o),o.enterEditing(r),o.selectionStart=Math.min(l+h,o._text.length),o.selectionEnd=Math.min(o.selectionStart+i.length,o._text.length),o.hiddenTextarea.value=o.text,o._updateTextarea(),o.hiddenTextarea.focus(),o.fire(Yg,{index:l+h,action:"drop"}),a.fire("text:changed",{target:o}),a.contextTopDirty=!0,a.requestRenderAll()}}dragEndHandler(e){let{e:t}=e;if(this.isActive()&&this.__dragStartFired&&this.__dragStartSelection){var r;const s=this.target,i=this.target.canvas,{selectionStart:o,selectionEnd:a}=this.__dragStartSelection,l=((r=t.dataTransfer)===null||r===void 0?void 0:r.dropEffect)||Ln;l===Ln?(s.selectionStart=o,s.selectionEnd=a,s._updateTextarea(),s.hiddenTextarea.focus()):(s.clearContextTop(),l==="move"&&(s.removeChars(o,a),s.selectionStart=s.selectionEnd=o,s.hiddenTextarea&&(s.hiddenTextarea.value=s.text),s._updateTextarea(),s.fire(Yg,{index:o,action:"dragend"}),i.fire("text:changed",{target:s}),i.requestRenderAll()),s.exitEditing())}this.__dragImageDisposer&&this.__dragImageDisposer(),delete this.__dragImageDisposer,delete this.__dragStartSelection,this.__isDraggingOver=!1}dispose(){this._dispose&&this._dispose()}}const Fk=/[ \n\.,;!\?\-]/;class rQ extends mn{constructor(){super(...arguments),M(this,"_currentCursorOpacity",1)}initBehavior(){this._tick=this._tick.bind(this),this._onTickComplete=this._onTickComplete.bind(this),this.updateSelectionOnMouseMove=this.updateSelectionOnMouseMove.bind(this)}onDeselect(e){return this.isEditing&&this.exitEditing(),this.selected=!1,super.onDeselect(e)}_animateCursor(e){let{toValue:t,duration:r,delay:s,onComplete:i}=e;return ED({startValue:this._currentCursorOpacity,endValue:t,duration:r,delay:s,onComplete:i,abort:()=>!this.canvas||this.selectionStart!==this.selectionEnd,onChange:o=>{this._currentCursorOpacity=o,this.renderCursorOrSelection()}})}_tick(e){this._currentTickState=this._animateCursor({toValue:0,duration:this.cursorDuration/2,delay:Math.max(e||0,100),onComplete:this._onTickComplete})}_onTickComplete(){var e;(e=this._currentTickCompleteState)===null||e===void 0||e.abort(),this._currentTickCompleteState=this._animateCursor({toValue:1,duration:this.cursorDuration,onComplete:this._tick})}initDelayedCursor(e){this.abortCursorAnimation(),this._tick(e?0:this.cursorDelay)}abortCursorAnimation(){let e=!1;[this._currentTickState,this._currentTickCompleteState].forEach(t=>{t&&!t.isDone()&&(e=!0,t.abort())}),this._currentCursorOpacity=1,e&&this.clearContextTop()}restartCursorIfNeeded(){[this._currentTickState,this._currentTickCompleteState].some(e=>!e||e.isDone())&&this.initDelayedCursor()}selectAll(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this}cmdAll(){this.selectAll(),this.renderCursorOrSelection()}getSelectedText(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")}findWordBoundaryLeft(e){let t=0,r=e-1;if(this._reSpace.test(this._text[r]))for(;this._reSpace.test(this._text[r]);)t++,r--;for(;/\S/.test(this._text[r])&&r>-1;)t++,r--;return e-t}findWordBoundaryRight(e){let t=0,r=e;if(this._reSpace.test(this._text[r]))for(;this._reSpace.test(this._text[r]);)t++,r++;for(;/\S/.test(this._text[r])&&r<this._text.length;)t++,r++;return e+t}findLineBoundaryLeft(e){let t=0,r=e-1;for(;!/\n/.test(this._text[r])&&r>-1;)t++,r--;return e-t}findLineBoundaryRight(e){let t=0,r=e;for(;!/\n/.test(this._text[r])&&r<this._text.length;)t++,r++;return e+t}searchWordBoundary(e,t){const r=this._text;let s=e>0&&this._reSpace.test(r[e])&&(t===-1||!Qb.test(r[e-1]))?e-1:e,i=r[s];for(;s>0&&s<r.length&&!Fk.test(i);)s+=t,i=r[s];return t===-1&&Fk.test(i)&&s++,s}selectWord(e){var t;e=(t=e)!==null&&t!==void 0?t:this.selectionStart;const r=this.searchWordBoundary(e,-1),s=Math.max(r,this.searchWordBoundary(e,1));this.selectionStart=r,this.selectionEnd=s,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()}selectLine(e){var t;e=(t=e)!==null&&t!==void 0?t:this.selectionStart;const r=this.findLineBoundaryLeft(e),s=this.findLineBoundaryRight(e);this.selectionStart=r,this.selectionEnd=s,this._fireSelectionChanged(),this._updateTextarea()}enterEditing(e){!this.isEditing&&this.editable&&(this.enterEditingImpl(),this.fire("editing:entered",e?{e}:void 0),this._fireSelectionChanged(),this.canvas&&(this.canvas.fire("text:editing:entered",{target:this,e}),this.canvas.requestRenderAll()))}enterEditingImpl(){this.canvas&&(this.canvas.calcOffset(),this.canvas.textEditingManager.exitTextEditing()),this.isEditing=!0,this.initHiddenTextarea(),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick()}updateSelectionOnMouseMove(e){if(this.getActiveControl())return;const t=this.hiddenTextarea;Ur(t).activeElement!==t&&t.focus();const r=this.getSelectionStartFromPointer(e),s=this.selectionStart,i=this.selectionEnd;(r===this.__selectionStartOnMouseDown&&s!==i||s!==r&&i!==r)&&(r>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=r):(this.selectionStart=r,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===s&&this.selectionEnd===i||(this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}_setEditingProps(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0}fromStringToGraphemeSelection(e,t,r){const s=r.slice(0,e),i=this.graphemeSplit(s).length;if(e===t)return{selectionStart:i,selectionEnd:i};const o=r.slice(e,t);return{selectionStart:i,selectionEnd:i+this.graphemeSplit(o).length}}fromGraphemeToStringSelection(e,t,r){const s=r.slice(0,e).join("").length;return e===t?{selectionStart:s,selectionEnd:s}:{selectionStart:s,selectionEnd:s+r.slice(e,t).join("").length}}_updateTextarea(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){const e=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=e.selectionStart,this.hiddenTextarea.selectionEnd=e.selectionEnd}this.updateTextareaPosition()}}updateFromTextArea(){if(!this.hiddenTextarea)return;this.cursorOffsetCache={};const e=this.hiddenTextarea;this.text=e.value,this.set("dirty",!0),this.initDimensions(),this.setCoords();const t=this.fromStringToGraphemeSelection(e.selectionStart,e.selectionEnd,e.value);this.selectionEnd=this.selectionStart=t.selectionEnd,this.inCompositionMode||(this.selectionStart=t.selectionStart),this.updateTextareaPosition()}updateTextareaPosition(){if(this.selectionStart===this.selectionEnd){const e=this._calcTextareaPosition();this.hiddenTextarea.style.left=e.left,this.hiddenTextarea.style.top=e.top}}_calcTextareaPosition(){if(!this.canvas)return{left:"1px",top:"1px"};const e=this.inCompositionMode?this.compositionStart:this.selectionStart,t=this._getCursorBoundaries(e),r=this.get2DCursorLocation(e),s=r.lineIndex,i=r.charIndex,o=this.getValueOfPropertyAt(s,i,"fontSize")*this.lineHeight,a=t.leftOffset,l=this.getCanvasRetinaScaling(),c=this.canvas.upperCanvasEl,u=c.width/l,h=c.height/l,f=u-o,p=h-o,y=new $(t.left+a,t.top+t.topOffset+o).transform(this.calcTransformMatrix()).transform(this.canvas.viewportTransform).multiply(new $(c.clientWidth/u,c.clientHeight/h));return y.x<0&&(y.x=0),y.x>f&&(y.x=f),y.y<0&&(y.y=0),y.y>p&&(y.y=p),y.x+=this.canvas._offset.left,y.y+=this.canvas._offset.top,{left:"".concat(y.x,"px"),top:"".concat(y.y,"px"),fontSize:"".concat(o,"px"),charHeight:o}}_saveEditingProps(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}}_restoreEditingProps(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor||this.canvas.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor||this.canvas.moveCursor),delete this._savedProps)}_exitEditing(){const e=this.hiddenTextarea;this.selected=!1,this.isEditing=!1,e&&(e.blur&&e.blur(),e.parentNode&&e.parentNode.removeChild(e)),this.hiddenTextarea=null,this.abortCursorAnimation(),this.selectionStart!==this.selectionEnd&&this.clearContextTop()}exitEditingImpl(){this._exitEditing(),this.selectionEnd=this.selectionStart,this._restoreEditingProps(),this._forceClearCache&&(this.initDimensions(),this.setCoords())}exitEditing(){const e=this._textBeforeEdit!==this.text;return this.exitEditingImpl(),this.fire("editing:exited"),e&&this.fire(Xg),this.canvas&&(this.canvas.fire("text:editing:exited",{target:this}),e&&this.canvas.fire("object:modified",{target:this})),this}_removeExtraneousStyles(){for(const e in this.styles)this._textLines[e]||delete this.styles[e]}removeStyleFromTo(e,t){const{lineIndex:r,charIndex:s}=this.get2DCursorLocation(e,!0),{lineIndex:i,charIndex:o}=this.get2DCursorLocation(t,!0);if(r!==i){if(this.styles[r])for(let a=s;a<this._unwrappedTextLines[r].length;a++)delete this.styles[r][a];if(this.styles[i])for(let a=o;a<this._unwrappedTextLines[i].length;a++){const l=this.styles[i][a];l&&(this.styles[r]||(this.styles[r]={}),this.styles[r][s+a-o]=l)}for(let a=r+1;a<=i;a++)delete this.styles[a];this.shiftLineStyles(i,r-i)}else if(this.styles[r]){const a=this.styles[r],l=o-s;for(let c=s;c<o;c++)delete a[c];for(const c in this.styles[r]){const u=parseInt(c,10);u>=o&&(a[u-l]=a[c],delete a[c])}}}shiftLineStyles(e,t){const r=Object.assign({},this.styles);for(const s in this.styles){const i=parseInt(s,10);i>e&&(this.styles[i+t]=r[i],r[i-t]||delete this.styles[i])}}insertNewlineStyleObject(e,t,r,s){const i={},o=this._unwrappedTextLines[e].length,a=o===t;let l=!1;r||(r=1),this.shiftLineStyles(e,r);const c=this.styles[e]?this.styles[e][t===0?t:t-1]:void 0;for(const h in this.styles[e]){const f=parseInt(h,10);f>=t&&(l=!0,i[f-t]=this.styles[e][h],a&&t===0||delete this.styles[e][h])}let u=!1;for(l&&!a&&(this.styles[e+r]=i,u=!0),(u||o>t)&&r--;r>0;)s&&s[r-1]?this.styles[e+r]={0:L({},s[r-1])}:c?this.styles[e+r]={0:L({},c)}:delete this.styles[e+r],r--;this._forceClearCache=!0}insertCharStyleObject(e,t,r,s){this.styles||(this.styles={});const i=this.styles[e],o=i?L({},i):{};r||(r=1);for(const l in o){const c=parseInt(l,10);c>=t&&(i[c+r]=o[c],o[c-r]||delete i[c])}if(this._forceClearCache=!0,s){for(;r--;)Object.keys(s[r]).length&&(this.styles[e]||(this.styles[e]={}),this.styles[e][t+r]=L({},s[r]));return}if(!i)return;const a=i[t?t-1:1];for(;a&&r--;)this.styles[e][t+r]=L({},a)}insertNewStyleBlock(e,t,r){const s=this.get2DCursorLocation(t,!0),i=[0];let o,a=0;for(let l=0;l<e.length;l++)e[l]===`
`?(a++,i[a]=0):i[a]++;for(i[0]>0&&(this.insertCharStyleObject(s.lineIndex,s.charIndex,i[0],r),r=r&&r.slice(i[0]+1)),a&&this.insertNewlineStyleObject(s.lineIndex,s.charIndex+i[0],a),o=1;o<a;o++)i[o]>0?this.insertCharStyleObject(s.lineIndex+o,0,i[o],r):r&&this.styles[s.lineIndex+o]&&r[0]&&(this.styles[s.lineIndex+o][0]=r[0]),r=r&&r.slice(i[o]+1);i[o]>0&&this.insertCharStyleObject(s.lineIndex+o,0,i[o],r)}removeChars(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e+1;this.removeStyleFromTo(e,t),this._text.splice(e,t-e),this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}insertChars(e,t,r){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:r;s>r&&this.removeStyleFromTo(r,s);const i=this.graphemeSplit(e);this.insertNewStyleBlock(i,r,t),this._text=[...this._text.slice(0,r),...i,...this._text.slice(s)],this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}setSelectionStartEndWithShift(e,t,r){r<=e?(t===e?this._selectionDirection=$e:this._selectionDirection===vt&&(this._selectionDirection=$e,this.selectionEnd=e),this.selectionStart=r):r>e&&r<t?this._selectionDirection===vt?this.selectionEnd=r:this.selectionStart=r:(t===e?this._selectionDirection=vt:this._selectionDirection===$e&&(this._selectionDirection=vt,this.selectionStart=t),this.selectionEnd=r)}}class sQ extends rQ{initHiddenTextarea(){const e=this.canvas&&Ur(this.canvas.getElement())||Zc(),t=e.createElement("textarea");Object.entries({autocapitalize:"off",autocorrect:"off",autocomplete:"off",spellcheck:"false","data-fabric":"textarea",wrap:"off",name:"fabricTextarea"}).map(o=>{let[a,l]=o;return t.setAttribute(a,l)});const{top:r,left:s,fontSize:i}=this._calcTextareaPosition();t.style.cssText="position: absolute; top: ".concat(r,"; left: ").concat(s,"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: ").concat(i,";"),(this.hiddenTextareaContainer||e.body).appendChild(t),Object.entries({blur:"blur",keydown:"onKeyDown",keyup:"onKeyUp",input:"onInput",copy:"copy",cut:"copy",paste:"paste",compositionstart:"onCompositionStart",compositionupdate:"onCompositionUpdate",compositionend:"onCompositionEnd"}).map(o=>{let[a,l]=o;return t.addEventListener(a,this[l].bind(this))}),this.hiddenTextarea=t}blur(){this.abortCursorAnimation()}onKeyDown(e){if(!this.isEditing)return;const t=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(e.keyCode in t)this[t[e.keyCode]](e);else{if(!(e.keyCode in this.ctrlKeysMapDown)||!e.ctrlKey&&!e.metaKey)return;this[this.ctrlKeysMapDown[e.keyCode]](e)}e.stopImmediatePropagation(),e.preventDefault(),e.keyCode>=33&&e.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}onKeyUp(e){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:e.keyCode in this.ctrlKeysMapUp&&(e.ctrlKey||e.metaKey)&&(this[this.ctrlKeysMapUp[e.keyCode]](e),e.stopImmediatePropagation(),e.preventDefault(),this.canvas&&this.canvas.requestRenderAll())}onInput(e){const t=this.fromPaste,{value:r,selectionStart:s,selectionEnd:i}=this.hiddenTextarea;if(this.fromPaste=!1,e&&e.stopPropagation(),!this.isEditing)return;const o=()=>{this.updateFromTextArea(),this.fire(Yg),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())};if(this.hiddenTextarea.value==="")return this.styles={},void o();const a=this._splitTextIntoLines(r).graphemeText,l=this._text.length,c=a.length,u=this.selectionStart,h=this.selectionEnd,f=u!==h;let p,y,m,v,w=c-l;const _=this.fromStringToGraphemeSelection(s,i,r),x=u>_.selectionStart;f?(y=this._text.slice(u,h),w+=h-u):c<l&&(y=x?this._text.slice(h+w,h):this._text.slice(u,u-w));const A=a.slice(_.selectionEnd-w,_.selectionEnd);if(y&&y.length&&(A.length&&(p=this.getSelectionStyles(u,u+1,!1),p=A.map(()=>p[0])),f?(m=u,v=h):x?(m=h-y.length,v=h):(m=h,v=h+y.length),this.removeStyleFromTo(m,v)),A.length){const{copyPasteData:j}=As();t&&A.join("")===j.copiedText&&!Le.disableStyleCopyPaste&&(p=j.copiedTextStyle),this.insertNewStyleBlock(A,u,p)}o()}onCompositionStart(){this.inCompositionMode=!0}onCompositionEnd(){this.inCompositionMode=!1}onCompositionUpdate(e){let{target:t}=e;const{selectionStart:r,selectionEnd:s}=t;this.compositionStart=r,this.compositionEnd=s,this.updateTextareaPosition()}copy(){if(this.selectionStart===this.selectionEnd)return;const{copyPasteData:e}=As();e.copiedText=this.getSelectedText(),Le.disableStyleCopyPaste?e.copiedTextStyle=void 0:e.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0}paste(){this.fromPaste=!0}_getWidthBeforeCursor(e,t){let r,s=this._getLineLeftOffset(e);return t>0&&(r=this.__charBounds[e][t-1],s+=r.left+r.width),s}getDownCursorOffset(e,t){const r=this._getSelectionForOffset(e,t),s=this.get2DCursorLocation(r),i=s.lineIndex;if(i===this._textLines.length-1||e.metaKey||e.keyCode===34)return this._text.length-r;const o=s.charIndex,a=this._getWidthBeforeCursor(i,o),l=this._getIndexOnLine(i+1,a);return this._textLines[i].slice(o).length+l+1+this.missingNewlineOffset(i)}_getSelectionForOffset(e,t){return e.shiftKey&&this.selectionStart!==this.selectionEnd&&t?this.selectionEnd:this.selectionStart}getUpCursorOffset(e,t){const r=this._getSelectionForOffset(e,t),s=this.get2DCursorLocation(r),i=s.lineIndex;if(i===0||e.metaKey||e.keyCode===33)return-r;const o=s.charIndex,a=this._getWidthBeforeCursor(i,o),l=this._getIndexOnLine(i-1,a),c=this._textLines[i].slice(0,o),u=this.missingNewlineOffset(i-1);return-this._textLines[i-1].length+l-c.length+(1-u)}_getIndexOnLine(e,t){const r=this._textLines[e];let s,i,o=this._getLineLeftOffset(e),a=0;for(let l=0,c=r.length;l<c;l++)if(s=this.__charBounds[e][l].width,o+=s,o>t){i=!0;const u=o-s,h=o,f=Math.abs(u-t);a=Math.abs(h-t)<f?l:l-1;break}return i||(a=r.length-1),a}moveCursorDown(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",e)}moveCursorUp(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",e)}_moveCursorUpOrDown(e,t){const r=this["get".concat(e,"CursorOffset")](t,this._selectionDirection===vt);if(t.shiftKey?this.moveCursorWithShift(r):this.moveCursorWithoutShift(r),r!==0){const s=this.text.length;this.selectionStart=Oc(0,this.selectionStart,s),this.selectionEnd=Oc(0,this.selectionEnd,s),this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea()}}moveCursorWithShift(e){const t=this._selectionDirection===$e?this.selectionStart+e:this.selectionEnd+e;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,t),e!==0}moveCursorWithoutShift(e){return e<0?(this.selectionStart+=e,this.selectionEnd=this.selectionStart):(this.selectionEnd+=e,this.selectionStart=this.selectionEnd),e!==0}moveCursorLeft(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",e)}_move(e,t,r){let s;if(e.altKey)s=this["findWordBoundary".concat(r)](this[t]);else{if(!e.metaKey&&e.keyCode!==35&&e.keyCode!==36)return this[t]+=r==="Left"?-1:1,!0;s=this["findLineBoundary".concat(r)](this[t])}return s!==void 0&&this[t]!==s&&(this[t]=s,!0)}_moveLeft(e,t){return this._move(e,t,"Left")}_moveRight(e,t){return this._move(e,t,"Right")}moveCursorLeftWithoutShift(e){let t=!0;return this._selectionDirection=$e,this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(t=this._moveLeft(e,"selectionStart")),this.selectionEnd=this.selectionStart,t}moveCursorLeftWithShift(e){return this._selectionDirection===vt&&this.selectionStart!==this.selectionEnd?this._moveLeft(e,"selectionEnd"):this.selectionStart!==0?(this._selectionDirection=$e,this._moveLeft(e,"selectionStart")):void 0}moveCursorRight(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",e)}_moveCursorLeftOrRight(e,t){const r="moveCursor".concat(e).concat(t.shiftKey?"WithShift":"WithoutShift");this._currentCursorOpacity=1,this[r](t)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())}moveCursorRightWithShift(e){return this._selectionDirection===$e&&this.selectionStart!==this.selectionEnd?this._moveRight(e,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection=vt,this._moveRight(e,"selectionEnd")):void 0}moveCursorRightWithoutShift(e){let t=!0;return this._selectionDirection=vt,this.selectionStart===this.selectionEnd?(t=this._moveRight(e,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,t}}const Vk=n=>!!n.button;class iQ extends sQ{constructor(){super(...arguments),M(this,"draggableTextDelegate",void 0)}initBehavior(){this.on("mousedown",this._mouseDownHandler),this.on("mouseup",this.mouseUpHandler),this.on("mousedblclick",this.doubleClickHandler),this.on("mousetripleclick",this.tripleClickHandler),this.draggableTextDelegate=new nQ(this),super.initBehavior()}shouldStartDragging(){return this.draggableTextDelegate.isActive()}onDragStart(e){return this.draggableTextDelegate.onDragStart(e)}canDrop(e){return this.draggableTextDelegate.canDrop(e)}doubleClickHandler(e){this.isEditing&&(this.selectWord(this.getSelectionStartFromPointer(e.e)),this.renderCursorOrSelection())}tripleClickHandler(e){this.isEditing&&(this.selectLine(this.getSelectionStartFromPointer(e.e)),this.renderCursorOrSelection())}_mouseDownHandler(e){let{e:t,alreadySelected:r}=e;this.canvas&&this.editable&&!Vk(t)&&!this.getActiveControl()&&(this.draggableTextDelegate.start(t)||(this.canvas.textEditingManager.register(this),r&&(this.inCompositionMode=!1,this.setCursorByClick(t)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()),this.selected||(this.selected=r||this.isEditing)))}mouseUpHandler(e){let{e:t,transform:r}=e;const s=this.draggableTextDelegate.end(t);if(this.canvas){this.canvas.textEditingManager.unregister(this);const i=this.canvas._activeObject;if(i&&i!==this)return}!this.editable||this.group&&!this.group.interactive||r&&r.actionPerformed||Vk(t)||s||this.selected&&!this.getActiveControl()&&(this.enterEditing(t),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection())}setCursorByClick(e){const t=this.getSelectionStartFromPointer(e),r=this.selectionStart,s=this.selectionEnd;e.shiftKey?this.setSelectionStartEndWithShift(r,s,t):(this.selectionStart=t,this.selectionEnd=t),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())}getSelectionStartFromPointer(e){const t=this.canvas.getScenePoint(e).transform(Br(this.calcTransformMatrix())).add(new $(-this._getLeftOffset(),-this._getTopOffset()));let r=0,s=0,i=0;for(let c=0;c<this._textLines.length&&r<=t.y;c++)r+=this.getHeightOfLine(c),i=c,c>0&&(s+=this._textLines[c-1].length+this.missingNewlineOffset(c-1));let o=Math.abs(this._getLineLeftOffset(i));const a=this._textLines[i].length,l=this.__charBounds[i];for(let c=0;c<a;c++){const u=o+l[c].kernedWidth;if(t.x<=u){Math.abs(t.x-u)<=Math.abs(t.x-o)&&s++;break}o=u,s++}return Math.min(this.flipX?a-s:s,this._text.length)}}const zf="moveCursorUp",Wf="moveCursorDown",Hf="moveCursorLeft",qf="moveCursorRight",Gf="exitEditing",Uk=(n,e)=>{const t=e.getRetinaScaling();n.setTransform(t,0,0,t,0,0);const r=e.viewportTransform;n.transform(r[0],r[1],r[2],r[3],r[4],r[5])},oQ=L({selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,keysMap:{9:Gf,27:Gf,33:zf,34:Wf,35:qf,36:Hf,37:Hf,38:zf,39:qf,40:Wf},keysMapRtl:{9:Gf,27:Gf,33:zf,34:Wf,35:Hf,36:qf,37:qf,38:zf,39:Hf,40:Wf},ctrlKeysMapDown:{65:"cmdAll"},ctrlKeysMapUp:{67:"copy",88:"cut"}},{_selectionDirection:null,_reSpace:/\s|\r?\n/,inCompositionMode:!1});class Xs extends iQ{static getDefaults(){return L(L({},super.getDefaults()),Xs.ownDefaults)}get type(){const e=super.type;return e==="itext"?"i-text":e}constructor(e,t){super(e,L(L({},Xs.ownDefaults),t)),this.initBehavior()}_set(e,t){return this.isEditing&&this._savedProps&&e in this._savedProps?(this._savedProps[e]=t,this):(e==="canvas"&&(this.canvas instanceof x_&&this.canvas.textEditingManager.remove(this),t instanceof x_&&t.textEditingManager.add(this)),super._set(e,t))}setSelectionStart(e){e=Math.max(e,0),this._updateAndFire("selectionStart",e)}setSelectionEnd(e){e=Math.min(e,this.text.length),this._updateAndFire("selectionEnd",e)}_updateAndFire(e,t){this[e]!==t&&(this._fireSelectionChanged(),this[e]=t),this._updateTextarea()}_fireSelectionChanged(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})}initDimensions(){this.isEditing&&this.initDelayedCursor(),super.initDimensions()}getSelectionStyles(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart||0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionEnd,r=arguments.length>2?arguments[2]:void 0;return super.getSelectionStyles(e,t,r)}setSelectionStyles(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionStart||0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.selectionEnd;return super.setSelectionStyles(e,t,r)}get2DCursorLocation(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1?arguments[1]:void 0;return super.get2DCursorLocation(e,t)}render(e){super.render(e),this.cursorOffsetCache={},this.renderCursorOrSelection()}toCanvasElement(e){const t=this.isEditing;this.isEditing=!1;const r=super.toCanvasElement(e);return this.isEditing=t,r}renderCursorOrSelection(){if(!this.isEditing||!this.canvas)return;const e=this.clearContextTop(!0);if(!e)return;const t=this._getCursorBoundaries(),r=this.findAncestorsWithClipPath(),s=r.length>0;let i,o=e;if(s){i=wr(e.canvas),o=i.getContext("2d"),Uk(o,this.canvas);const a=this.calcTransformMatrix();o.transform(a[0],a[1],a[2],a[3],a[4],a[5])}if(this.selectionStart!==this.selectionEnd||this.inCompositionMode?this.renderSelection(o,t):this.renderCursor(o,t),s)for(const a of r){const l=a.clipPath,c=wr(e.canvas),u=c.getContext("2d");if(Uk(u,this.canvas),!l.absolutePositioned){const h=a.calcTransformMatrix();u.transform(h[0],h[1],h[2],h[3],h[4],h[5])}l.transform(u),l.drawObject(u,!0,{}),this.drawClipPathOnCache(o,l,c)}s&&(e.setTransform(1,0,0,1,0,0),e.drawImage(i,0,0)),this.canvas.contextTopDirty=!0,e.restore()}findAncestorsWithClipPath(){const e=[];let t=this;for(;t;)t.clipPath&&e.push(t),t=t.parent;return e}_getCursorBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1?arguments[1]:void 0;const r=this._getLeftOffset(),s=this._getTopOffset(),i=this._getCursorBoundariesOffsets(e,t);return{left:r,top:s,leftOffset:i.left,topOffset:i.top}}_getCursorBoundariesOffsets(e,t){return t?this.__getCursorBoundariesOffsets(e):this.cursorOffsetCache&&"top"in this.cursorOffsetCache?this.cursorOffsetCache:this.cursorOffsetCache=this.__getCursorBoundariesOffsets(e)}__getCursorBoundariesOffsets(e){let t=0,r=0;const{charIndex:s,lineIndex:i}=this.get2DCursorLocation(e);for(let c=0;c<i;c++)t+=this.getHeightOfLine(c);const o=this._getLineLeftOffset(i),a=this.__charBounds[i][s];a&&(r=a.left),this.charSpacing!==0&&s===this._textLines[i].length&&(r-=this._getWidthOfCharSpacing());const l={top:t,left:o+(r>0?r:0)};return this.direction==="rtl"&&(this.textAlign===vt||this.textAlign===ps||this.textAlign===hh?l.left*=-1:this.textAlign===$e||this.textAlign===nm?l.left=o-(r>0?r:0):this.textAlign!==Te&&this.textAlign!==dh||(l.left=o-(r>0?r:0))),l}renderCursorAt(e){this._renderCursor(this.canvas.contextTop,this._getCursorBoundaries(e,!0),e)}renderCursor(e,t){this._renderCursor(e,t,this.selectionStart)}getCursorRenderingData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this._getCursorBoundaries(e);const r=this.get2DCursorLocation(e),s=r.lineIndex,i=r.charIndex>0?r.charIndex-1:0,o=this.getValueOfPropertyAt(s,i,"fontSize"),a=this.getObjectScaling().x*this.canvas.getZoom(),l=this.cursorWidth/a,c=this.getValueOfPropertyAt(s,i,"deltaY"),u=t.topOffset+(1-this._fontSizeFraction)*this.getHeightOfLine(s)/this.lineHeight-o*(1-this._fontSizeFraction);return{color:this.cursorColor||this.getValueOfPropertyAt(s,i,"fill"),opacity:this._currentCursorOpacity,left:t.left+t.leftOffset-l/2,top:u+t.top+c,width:l,height:o}}_renderCursor(e,t,r){const{color:s,opacity:i,left:o,top:a,width:l,height:c}=this.getCursorRenderingData(r,t);e.fillStyle=s,e.globalAlpha=i,e.fillRect(o,a,l,c)}renderSelection(e,t){const r={selectionStart:this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,selectionEnd:this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd};this._renderSelection(e,r,t)}renderDragSourceEffect(){const e=this.draggableTextDelegate.getDragStartSelection();this._renderSelection(this.canvas.contextTop,e,this._getCursorBoundaries(e.selectionStart,!0))}renderDropTargetEffect(e){const t=this.getSelectionStartFromPointer(e);this.renderCursorAt(t)}_renderSelection(e,t,r){const s=t.selectionStart,i=t.selectionEnd,o=this.textAlign.includes(ps),a=this.get2DCursorLocation(s),l=this.get2DCursorLocation(i),c=a.lineIndex,u=l.lineIndex,h=a.charIndex<0?0:a.charIndex,f=l.charIndex<0?0:l.charIndex;for(let p=c;p<=u;p++){const y=this._getLineLeftOffset(p)||0;let m=this.getHeightOfLine(p),v=0,w=0,_=0;if(p===c&&(w=this.__charBounds[c][h].left),p>=c&&p<u)_=o&&!this.isEndOfWrapping(p)?this.width:this.getLineWidth(p)||5;else if(p===u)if(f===0)_=this.__charBounds[u][f].left;else{const S=this._getWidthOfCharSpacing();_=this.__charBounds[u][f-1].left+this.__charBounds[u][f-1].width-S}v=m,(this.lineHeight<1||p===u&&this.lineHeight>1)&&(m/=this.lineHeight);let x=r.left+y+w,A=m,j=0;const N=_-w;this.inCompositionMode?(e.fillStyle=this.compositionColor||"black",A=1,j=m):e.fillStyle=this.selectionColor,this.direction==="rtl"&&(this.textAlign===vt||this.textAlign===ps||this.textAlign===hh?x=this.width-x-N:this.textAlign===$e||this.textAlign===nm?x=r.left+y-_:this.textAlign!==Te&&this.textAlign!==dh||(x=r.left+y-_)),e.fillRect(x,r.top+r.topOffset+j,N,A),r.topOffset+=v}}getCurrentCharFontSize(){const e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,"fontSize")}getCurrentCharColor(){const e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,Mt)}_getCurrentCharIndex(){const e=this.get2DCursorLocation(this.selectionStart,!0),t=e.charIndex>0?e.charIndex-1:0;return{l:e.lineIndex,c:t}}dispose(){this.exitEditingImpl(),this.draggableTextDelegate.dispose(),super.dispose()}}M(Xs,"ownDefaults",oQ),M(Xs,"type","IText"),re.setClass(Xs),re.setClass(Xs,"i-text");class fa extends Xs{static getDefaults(){return L(L({},super.getDefaults()),fa.ownDefaults)}constructor(e,t){super(e,L(L({},fa.ownDefaults),t))}static createControls(){return{controls:FY()}}initDimensions(){this.initialized&&(this.isEditing&&this.initDelayedCursor(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.includes(ps)&&this.enlargeSpaces(),this.height=this.calcTextHeight())}_generateStyleMap(e){let t=0,r=0,s=0;const i={};for(let o=0;o<e.graphemeLines.length;o++)e.graphemeText[s]===`
`&&o>0?(r=0,s++,t++):!this.splitByGrapheme&&this._reSpaceAndTab.test(e.graphemeText[s])&&o>0&&(r++,s++),i[o]={line:t,offset:r},s+=e.graphemeLines[o].length,r+=e.graphemeLines[o].length;return i}styleHas(e,t){if(this._styleMap&&!this.isWrapping){const r=this._styleMap[t];r&&(t=r.line)}return super.styleHas(e,t)}isEmptyStyles(e){if(!this.styles)return!0;let t,r=0,s=e+1,i=!1;const o=this._styleMap[e],a=this._styleMap[e+1];o&&(e=o.line,r=o.offset),a&&(s=a.line,i=s===e,t=a.offset);const l=e===void 0?this.styles:{line:this.styles[e]};for(const c in l)for(const u in l[c]){const h=parseInt(u,10);if(h>=r&&(!i||h<t))for(const f in l[c][u])return!1}return!0}_getStyleDeclaration(e,t){if(this._styleMap&&!this.isWrapping){const r=this._styleMap[e];if(!r)return{};e=r.line,t=r.offset+t}return super._getStyleDeclaration(e,t)}_setStyleDeclaration(e,t,r){const s=this._styleMap[e];super._setStyleDeclaration(s.line,s.offset+t,r)}_deleteStyleDeclaration(e,t){const r=this._styleMap[e];super._deleteStyleDeclaration(r.line,r.offset+t)}_getLineStyle(e){const t=this._styleMap[e];return!!this.styles[t.line]}_setLineStyle(e){const t=this._styleMap[e];super._setLineStyle(t.line)}_wrapText(e,t){this.isWrapping=!0;const r=this.getGraphemeDataForRender(e),s=[];for(let i=0;i<r.wordsData.length;i++)s.push(...this._wrapLine(i,t,r));return this.isWrapping=!1,s}getGraphemeDataForRender(e){const t=this.splitByGrapheme,r=t?"":" ";let s=0;return{wordsData:e.map((i,o)=>{let a=0;const l=t?this.graphemeSplit(i):this.wordSplit(i);return l.length===0?[{word:[],width:0}]:l.map(c=>{const u=t?[c]:this.graphemeSplit(c),h=this._measureWord(u,o,a);return s=Math.max(h,s),a+=u.length+r.length,{word:u,width:h}})}),largestWordWidth:s}}_measureWord(e,t){let r,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=0;for(let o=0,a=e.length;o<a;o++)i+=this._getGraphemeBox(e[o],t,o+s,r,!0).kernedWidth,r=e[o];return i}wordSplit(e){return e.split(this._wordJoiners)}_wrapLine(e,t,r){let{largestWordWidth:s,wordsData:i}=r,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const a=this._getWidthOfCharSpacing(),l=this.splitByGrapheme,c=[],u=l?"":" ";let h=0,f=[],p=0,y=0,m=!0;t-=o;const v=Math.max(t,s,this.dynamicMinWidth),w=i[e];let _;for(p=0,_=0;_<w.length;_++){const{word:x,width:A}=w[_];p+=x.length,h+=y+A-a,h>v&&!m?(c.push(f),f=[],h=A,m=!0):h+=a,m||l||f.push(u),f=f.concat(x),y=l?0:this._measureWord([u],e,p),p++,m=!1}return _&&c.push(f),s+o>this.dynamicMinWidth&&(this.dynamicMinWidth=s-a+o),c}isEndOfWrapping(e){return!this._styleMap[e+1]||this._styleMap[e+1].line!==this._styleMap[e].line}missingNewlineOffset(e,t){return this.splitByGrapheme&&!t?this.isEndOfWrapping(e)?1:0:1}_splitTextIntoLines(e){const t=super._splitTextIntoLines(e),r=this._wrapText(t.lines,this.width),s=new Array(r.length);for(let i=0;i<r.length;i++)s[i]=r[i].join("");return t.lines=s,t.graphemeLines=r,t}getMinWidth(){return Math.max(this.minWidth,this.dynamicMinWidth)}_removeExtraneousStyles(){const e=new Map;for(const t in this._styleMap){const r=parseInt(t,10);if(this._textLines[r]){const s=this._styleMap[t].line;e.set("".concat(s),!0)}}for(const t in this.styles)e.has(t)||delete this.styles[t]}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject(["minWidth","splitByGrapheme",...e])}}M(fa,"type","Textbox"),M(fa,"textLayoutProperties",[...Xs.textLayoutProperties,"width"]),M(fa,"ownDefaults",{minWidth:20,dynamicMinWidth:2,lockScalingFlip:!0,noScaleCache:!1,_wordJoiners:/[ \t\r]/,splitByGrapheme:!1}),re.setClass(fa);class $k extends vy{shouldPerformLayout(e){return!!e.target.clipPath&&super.shouldPerformLayout(e)}shouldLayoutClipPath(){return!1}calcLayoutResult(e,t){const{target:r}=e,{clipPath:s,group:i}=r;if(!s||!this.shouldPerformLayout(e))return;const{width:o,height:a}=ei(OD(r,s)),l=new $(o,a);if(s.absolutePositioned)return{center:ec(s.getRelativeCenterPoint(),void 0,i?i.calcTransformMatrix():void 0),size:l};{const c=s.getRelativeCenterPoint().transform(r.calcOwnMatrix(),!0);if(this.shouldPerformLayout(e)){const{center:u=new $,correction:h=new $}=this.calcBoundingBox(t,e)||{};return{center:u.add(c),correction:h.subtract(c),size:l}}return{center:r.getRelativeCenterPoint().add(c),size:l}}}}M($k,"type","clip-path"),re.setClass($k);class Bk extends vy{getInitialSize(e,t){let{target:r}=e,{size:s}=t;return new $(r.width||s.x,r.height||s.y)}}M(Bk,"type","fixed"),re.setClass(Bk);class aQ extends sd{subscribeTargets(e){const t=e.target;e.targets.reduce((r,s)=>(s.parent&&r.add(s.parent),r),new Set).forEach(r=>{r.layoutManager.subscribeTargets({target:r,targets:[t]})})}unsubscribeTargets(e){const t=e.target,r=t.getObjects();e.targets.reduce((s,i)=>(i.parent&&s.add(i.parent),s),new Set).forEach(s=>{!r.some(i=>i.parent===s)&&s.layoutManager.unsubscribeTargets({target:s,targets:[t]})})}}class pa extends ka{static getDefaults(){return L(L({},super.getDefaults()),pa.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,pa.ownDefaults),this.setOptions(t);const{left:r,top:s,layoutManager:i}=t;this.groupInit(e,{left:r,top:s,layoutManager:i??new aQ})}_shouldSetNestedCoords(){return!0}__objectSelectionMonitor(){}multiSelectAdd(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.multiSelectionStacking==="selection-order"?this.add(...t):t.forEach(s=>{const i=this._objects.findIndex(a=>a.isInFrontOf(s)),o=i===-1?this.size():i;this.insertAt(o,s)})}canEnterGroup(e){return this.getObjects().some(t=>t.isDescendantOf(e)||e.isDescendantOf(t))?(Po("error","ActiveSelection: circular object trees are not supported, this call has no effect"),!1):super.canEnterGroup(e)}enterGroup(e,t){e.parent&&e.parent===e.group?e.parent._exitGroup(e):e.group&&e.parent!==e.group&&e.group.remove(e),this._enterGroup(e,t)}exitGroup(e,t){this._exitGroup(e,t),e.parent&&e.parent._enterGroup(e,!0)}_onAfterObjectsChange(e,t){super._onAfterObjectsChange(e,t);const r=new Set;t.forEach(s=>{const{parent:i}=s;i&&r.add(i)}),e===d1?r.forEach(s=>{s._onAfterObjectsChange(rm,t)}):r.forEach(s=>{s._set("dirty",!0)})}onDeselect(){return this.removeAll(),!1}toString(){return"#<ActiveSelection: (".concat(this.complexity(),")>")}shouldCache(){return!1}isOnACache(){return!1}_renderControls(e,t,r){e.save(),e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1;const s=L(L({hasControls:!1},r),{},{forActiveSelection:!0});for(let i=0;i<this._objects.length;i++)this._objects[i]._renderControls(e,s);super._renderControls(e,t),e.restore()}}M(pa,"type","ActiveSelection"),M(pa,"ownDefaults",{multiSelectionStacking:"canvas-stacking"}),re.setClass(pa),re.setClass(pa,"activeSelection");class lQ{constructor(){M(this,"resources",{})}applyFilters(e,t,r,s,i){const o=i.getContext("2d");if(!o)return;o.drawImage(t,0,0,r,s);const a={sourceWidth:r,sourceHeight:s,imageData:o.getImageData(0,0,r,s),originalEl:t,originalImageData:o.getImageData(0,0,r,s),canvasEl:i,ctx:o,filterBackend:this};e.forEach(c=>{c.applyTo(a)});const{imageData:l}=a;return l.width===r&&l.height===s||(i.width=l.width,i.height=l.height),o.putImageData(l,0,0),a}}class KD{constructor(){let{tileSize:e=Le.textureSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};M(this,"aPosition",new Float32Array([0,0,0,1,1,0,1,1])),M(this,"resources",{}),this.tileSize=e,this.setupGLContext(e,e),this.captureGPUInfo()}setupGLContext(e,t){this.dispose(),this.createWebGLCanvas(e,t)}createWebGLCanvas(e,t){const r=wr({width:e,height:t}),s=r.getContext("webgl",{alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1});s&&(s.clearColor(0,0,0,0),this.canvas=r,this.gl=s)}applyFilters(e,t,r,s,i,o){const a=this.gl,l=i.getContext("2d");if(!a||!l)return;let c;o&&(c=this.getCachedTexture(o,t));const u={originalWidth:t.width||t.naturalWidth||0,originalHeight:t.height||t.naturalHeight||0,sourceWidth:r,sourceHeight:s,destinationWidth:r,destinationHeight:s,context:a,sourceTexture:this.createTexture(a,r,s,c?void 0:t),targetTexture:this.createTexture(a,r,s),originalTexture:c||this.createTexture(a,r,s,c?void 0:t),passes:e.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:i},h=a.createFramebuffer();return a.bindFramebuffer(a.FRAMEBUFFER,h),e.forEach(f=>{f&&f.applyTo(u)}),function(f){const p=f.targetCanvas,y=p.width,m=p.height,v=f.destinationWidth,w=f.destinationHeight;y===v&&m===w||(p.width=v,p.height=w)}(u),this.copyGLTo2D(a,u),a.bindTexture(a.TEXTURE_2D,null),a.deleteTexture(u.sourceTexture),a.deleteTexture(u.targetTexture),a.deleteFramebuffer(h),l.setTransform(1,0,0,1,0,0),u}dispose(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()}clearWebGLCaches(){this.programCache={},this.textureCache={}}createTexture(e,t,r,s,i){const{NEAREST:o,TEXTURE_2D:a,RGBA:l,UNSIGNED_BYTE:c,CLAMP_TO_EDGE:u,TEXTURE_MAG_FILTER:h,TEXTURE_MIN_FILTER:f,TEXTURE_WRAP_S:p,TEXTURE_WRAP_T:y}=e,m=e.createTexture();return e.bindTexture(a,m),e.texParameteri(a,h,i||o),e.texParameteri(a,f,i||o),e.texParameteri(a,p,u),e.texParameteri(a,y,u),s?e.texImage2D(a,0,l,l,c,s):e.texImage2D(a,0,l,t,r,0,l,c,null),m}getCachedTexture(e,t,r){const{textureCache:s}=this;if(s[e])return s[e];{const i=this.createTexture(this.gl,t.width,t.height,t,r);return i&&(s[e]=i),i}}evictCachesForKey(e){this.textureCache[e]&&(this.gl.deleteTexture(this.textureCache[e]),delete this.textureCache[e])}copyGLTo2D(e,t){const r=e.canvas,s=t.targetCanvas,i=s.getContext("2d");if(!i)return;i.translate(0,s.height),i.scale(1,-1);const o=r.height-s.height;i.drawImage(r,0,o,s.width,s.height,0,0,s.width,s.height)}copyGLTo2DPutImageData(e,t){const r=t.targetCanvas.getContext("2d"),s=t.destinationWidth,i=t.destinationHeight,o=s*i*4;if(!r)return;const a=new Uint8Array(this.imageBuffer,0,o),l=new Uint8ClampedArray(this.imageBuffer,0,o);e.readPixels(0,0,s,i,e.RGBA,e.UNSIGNED_BYTE,a);const c=new ImageData(l,s,i);r.putImageData(c,0,0)}captureGPUInfo(){if(this.gpuInfo)return this.gpuInfo;const e=this.gl,t={renderer:"",vendor:""};if(!e)return t;const r=e.getExtension("WEBGL_debug_renderer_info");if(r){const s=e.getParameter(r.UNMASKED_RENDERER_WEBGL),i=e.getParameter(r.UNMASKED_VENDOR_WEBGL);s&&(t.renderer=s.toLowerCase()),i&&(t.vendor=i.toLowerCase())}return this.gpuInfo=t,t}}let n0;function cQ(){const{WebGLProbe:n}=As();return n.queryWebGL(pi()),Le.enableGLFiltering&&n.isSupported(Le.textureSize)?new KD({tileSize:Le.textureSize}):new lQ}function r0(){return!n0&&(!(arguments.length>0&&arguments[0]!==void 0)||arguments[0])&&(n0=cQ()),n0}const uQ=["filters","resizeFilter","src","crossOrigin","type"],YD=["cropX","cropY"];class Hn extends cn{static getDefaults(){return L(L({},super.getDefaults()),Hn.ownDefaults)}constructor(e,t){super(),M(this,"_lastScaleX",1),M(this,"_lastScaleY",1),M(this,"_filterScalingX",1),M(this,"_filterScalingY",1),this.filters=[],Object.assign(this,Hn.ownDefaults),this.setOptions(t),this.cacheKey="texture".concat(Io()),this.setElement(typeof e=="string"?(this.canvas&&Ur(this.canvas.getElement())||Zc()).getElementById(e):e,t)}getElement(){return this._element}setElement(e){var t;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._element=e,this._originalElement=e,this._setWidthHeight(r),(t=e.classList)===null||t===void 0||t.add(Hn.CSS_CANVAS),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters()}removeTexture(e){const t=r0(!1);t instanceof KD&&t.evictCachesForKey(e)}dispose(){super.dispose(),this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._cacheContext=null,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(e=>{const t=this[e];t&&As().dispose(t),this[e]=void 0})}getCrossOrigin(){return this._originalElement&&(this._originalElement.crossOrigin||null)}getOriginalSize(){const e=this.getElement();return e?{width:e.naturalWidth||e.width,height:e.naturalHeight||e.height}:{width:0,height:0}}_stroke(e){if(!this.stroke||this.strokeWidth===0)return;const t=this.width/2,r=this.height/2;e.beginPath(),e.moveTo(-t,-r),e.lineTo(t,-r),e.lineTo(t,r),e.lineTo(-t,r),e.lineTo(-t,-r),e.closePath()}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const t=[];return this.filters.forEach(r=>{r&&t.push(r.toObject())}),L(L({},super.toObject([...YD,...e])),{},{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:t},this.resizeFilter?{resizeFilter:this.resizeFilter.toObject()}:{})}hasCrop(){return!!this.cropX||!!this.cropY||this.width<this._element.width||this.height<this._element.height}_toSVG(){const e=[],t=this._element,r=-this.width/2,s=-this.height/2;let i=[],o=[],a="",l="";if(!t)return[];if(this.hasCrop()){const c=Io();i.push('<clipPath id="imageCrop_'+c+`">
`,'	<rect x="'+r+'" y="'+s+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),a=' clip-path="url(#imageCrop_'+c+')" '}if(this.imageSmoothing||(l=' image-rendering="optimizeSpeed"'),e.push("	<image ","COMMON_PARTS",'xlink:href="'.concat(this.getSvgSrc(!0),'" x="').concat(r-this.cropX,'" y="').concat(s-this.cropY,'" width="').concat(t.width||t.naturalWidth,'" height="').concat(t.height||t.naturalHeight,'"').concat(l).concat(a,`></image>
`)),this.stroke||this.strokeDashArray){const c=this.fill;this.fill=null,o=['	<rect x="'.concat(r,'" y="').concat(s,'" width="').concat(this.width,'" height="').concat(this.height,'" style="').concat(this.getSvgStyles(),`" />
`)],this.fill=c}return i=this.paintFirst!==Mt?i.concat(o,e):i.concat(e,o),i}getSrc(e){const t=e?this._element:this._originalElement;return t?t.toDataURL?t.toDataURL():this.srcFromAttribute?t.getAttribute("src")||"":t.src:this.src||""}getSvgSrc(e){return this.getSrc(e)}setSrc(e){let{crossOrigin:t,signal:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return $p(e,{crossOrigin:t,signal:r}).then(s=>{t!==void 0&&this.set({crossOrigin:t}),this.setElement(s)})}toString(){return'#<Image: { src: "'.concat(this.getSrc(),'" }>')}applyResizeFilters(){const e=this.resizeFilter,t=this.minimumScaleTrigger,r=this.getTotalObjectScaling(),s=r.x,i=r.y,o=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!e||s>t&&i>t)return this._element=o,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=s,void(this._lastScaleY=i);const a=wr(o),{width:l,height:c}=o;this._element=a,this._lastScaleX=e.scaleX=s,this._lastScaleY=e.scaleY=i,r0().applyFilters([e],o,l,c,this._element),this._filterScalingX=a.width/this._originalElement.width,this._filterScalingY=a.height/this._originalElement.height}applyFilters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.filters||[];if(e=e.filter(i=>i&&!i.isNeutralState()),this.set("dirty",!0),this.removeTexture("".concat(this.cacheKey,"_filtered")),e.length===0)return this._element=this._originalElement,this._filteredEl=void 0,this._filterScalingX=1,void(this._filterScalingY=1);const t=this._originalElement,r=t.naturalWidth||t.width,s=t.naturalHeight||t.height;if(this._element===this._originalElement){const i=wr({width:r,height:s});this._element=i,this._filteredEl=i}else this._filteredEl&&(this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,r,s),this._lastScaleX=1,this._lastScaleY=1);r0().applyFilters(e,this._originalElement,r,s,this._element,this.cacheKey),this._originalElement.width===this._element.width&&this._originalElement.height===this._element.height||(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height)}_render(e){e.imageSmoothingEnabled=this.imageSmoothing,this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(e),this._renderPaintInOrder(e)}drawCacheOnCanvas(e){e.imageSmoothingEnabled=this.imageSmoothing,super.drawCacheOnCanvas(e)}shouldCache(){return this.needsItsOwnCache()}_renderFill(e){const t=this._element;if(!t)return;const r=this._filterScalingX,s=this._filterScalingY,i=this.width,o=this.height,a=Math.max(this.cropX,0),l=Math.max(this.cropY,0),c=t.naturalWidth||t.width,u=t.naturalHeight||t.height,h=a*r,f=l*s,p=Math.min(i*r,c-h),y=Math.min(o*s,u-f),m=-i/2,v=-o/2,w=Math.min(i,c/r-a),_=Math.min(o,u/s-l);t&&e.drawImage(t,h,f,p,y,m,v,w,_)}_needsResize(){const e=this.getTotalObjectScaling();return e.x!==this._lastScaleX||e.y!==this._lastScaleY}_resetWidthHeight(){this.set(this.getOriginalSize())}_setWidthHeight(){let{width:e,height:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=this.getOriginalSize();this.width=e||r.width,this.height=t||r.height}parsePreserveAspectRatioAttribute(){const e=nY(this.preserveAspectRatio||""),t=this.width,r=this.height,s={width:t,height:r};let i,o=this._element.width,a=this._element.height,l=1,c=1,u=0,h=0,f=0,p=0;return!e||e.alignX===Ln&&e.alignY===Ln?(l=t/o,c=r/a):(e.meetOrSlice==="meet"&&(l=c=vX(this._element,s),i=(t-o*l)/2,e.alignX==="Min"&&(u=-i),e.alignX==="Max"&&(u=i),i=(r-a*c)/2,e.alignY==="Min"&&(h=-i),e.alignY==="Max"&&(h=i)),e.meetOrSlice==="slice"&&(l=c=wX(this._element,s),i=o-t/l,e.alignX==="Mid"&&(f=i/2),e.alignX==="Max"&&(f=i),i=a-r/c,e.alignY==="Mid"&&(p=i/2),e.alignY==="Max"&&(p=i),o=t/l,a=r/c)),{width:o,height:a,scaleX:l,scaleY:c,offsetLeft:u,offsetTop:h,cropX:f,cropY:p}}static fromObject(e,t){let{filters:r,resizeFilter:s,src:i,crossOrigin:o,type:a}=e,l=st(e,uQ);return Promise.all([$p(i,L(L({},t),{},{crossOrigin:o})),r&&ed(r,t),s&&ed([s],t),py(l,t)]).then(c=>{let[u,h=[],[f]=[],p={}]=c;return new this(u,L(L({},l),{},{src:i,filters:h,resizeFilter:f},p))})}static fromURL(e){let{crossOrigin:t=null,signal:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0;return $p(e,{crossOrigin:t,signal:r}).then(i=>new this(i,s))}static async fromElement(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;const s=_i(e,this.ATTRIBUTE_NAMES,r);return this.fromURL(s["xlink:href"]||s.href,t,s).catch(i=>(Po("log","Unable to parse Image",i),null))}}M(Hn,"type","Image"),M(Hn,"cacheProperties",[...wi,...YD]),M(Hn,"ownDefaults",{strokeWidth:0,srcFromAttribute:!1,minimumScaleTrigger:.5,cropX:0,cropY:0,imageSmoothing:!0}),M(Hn,"CSS_CANVAS","canvas-img"),M(Hn,"ATTRIBUTE_NAMES",[...$o,"x","y","width","height","preserveAspectRatio","xlink:href","href","crossOrigin","image-rendering"]),re.setClass(Hn),re.setSVGClass(Hn);my(["pattern","defs","symbol","metadata","clipPath","mask","desc"]);const _y=n=>n.webgl!==void 0,f1="precision highp float",hQ=`
    `.concat(f1,`;
    varying vec2 vTexCoord;
    uniform sampler2D uTexture;
    void main() {
      gl_FragColor = texture2D(uTexture, vTexCoord);
    }`),dQ=["type"],fQ=["type"],pQ=new RegExp(f1,"g");class Lt{get type(){return this.constructor.type}constructor(){let e=st(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},dQ);Object.assign(this,this.constructor.defaults,e)}getFragmentSource(){return hQ}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    void main() {
      vTexCoord = aPosition;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }`}createProgram(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getFragmentSource(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getVertexSource();const{WebGLProbe:{GLPrecision:s="highp"}}=As();s!=="highp"&&(t=t.replace(pQ,f1.replace("highp",s)));const i=e.createShader(e.VERTEX_SHADER),o=e.createShader(e.FRAGMENT_SHADER),a=e.createProgram();if(!i||!o||!a)throw new ms("Vertex, fragment shader or program creation error");if(e.shaderSource(i,r),e.compileShader(i),!e.getShaderParameter(i,e.COMPILE_STATUS))throw new ms("Vertex shader compile error for ".concat(this.type,": ").concat(e.getShaderInfoLog(i)));if(e.shaderSource(o,t),e.compileShader(o),!e.getShaderParameter(o,e.COMPILE_STATUS))throw new ms("Fragment shader compile error for ".concat(this.type,": ").concat(e.getShaderInfoLog(o)));if(e.attachShader(a,i),e.attachShader(a,o),e.linkProgram(a),!e.getProgramParameter(a,e.LINK_STATUS))throw new ms('Shader link error for "'.concat(this.type,'" ').concat(e.getProgramInfoLog(a)));const l=this.getUniformLocations(e,a)||{};return l.uStepW=e.getUniformLocation(a,"uStepW"),l.uStepH=e.getUniformLocation(a,"uStepH"),{program:a,attributeLocations:this.getAttributeLocations(e,a),uniformLocations:l}}getAttributeLocations(e,t){return{aPosition:e.getAttribLocation(t,"aPosition")}}getUniformLocations(e,t){const r=this.constructor.uniformLocations,s={};for(let i=0;i<r.length;i++)s[r[i]]=e.getUniformLocation(t,r[i]);return s}sendAttributeData(e,t,r){const s=t.aPosition,i=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,i),e.enableVertexAttribArray(s),e.vertexAttribPointer(s,2,e.FLOAT,!1,0,0),e.bufferData(e.ARRAY_BUFFER,r,e.STATIC_DRAW)}_setupFrameBuffer(e){const t=e.context;if(e.passes>1){const r=e.destinationWidth,s=e.destinationHeight;e.sourceWidth===r&&e.sourceHeight===s||(t.deleteTexture(e.targetTexture),e.targetTexture=e.filterBackend.createTexture(t,r,s)),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e.targetTexture,0)}else t.bindFramebuffer(t.FRAMEBUFFER,null),t.finish()}_swapTextures(e){e.passes--,e.pass++;const t=e.targetTexture;e.targetTexture=e.sourceTexture,e.sourceTexture=t}isNeutralState(e){return!1}applyTo(e){_y(e)?(this._setupFrameBuffer(e),this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)}applyTo2d(e){}getCacheKey(){return this.type}retrieveShader(e){const t=this.getCacheKey();return e.programCache[t]||(e.programCache[t]=this.createProgram(e.context)),e.programCache[t]}applyToWebGL(e){const t=e.context,r=this.retrieveShader(e);e.pass===0&&e.originalTexture?t.bindTexture(t.TEXTURE_2D,e.originalTexture):t.bindTexture(t.TEXTURE_2D,e.sourceTexture),t.useProgram(r.program),this.sendAttributeData(t,r.attributeLocations,e.aPosition),t.uniform1f(r.uniformLocations.uStepW,1/e.sourceWidth),t.uniform1f(r.uniformLocations.uStepH,1/e.sourceHeight),this.sendUniformData(t,r.uniformLocations),t.viewport(0,0,e.destinationWidth,e.destinationHeight),t.drawArrays(t.TRIANGLE_STRIP,0,4)}bindAdditionalTexture(e,t,r){e.activeTexture(r),e.bindTexture(e.TEXTURE_2D,t),e.activeTexture(e.TEXTURE0)}unbindAdditionalTexture(e,t){e.activeTexture(t),e.bindTexture(e.TEXTURE_2D,null),e.activeTexture(e.TEXTURE0)}sendUniformData(e,t){}createHelpLayer(e){if(!e.helpLayer){const{sourceWidth:t,sourceHeight:r}=e,s=wr({width:t,height:r});e.helpLayer=s}}toObject(){const e=Object.keys(this.constructor.defaults||{});return L({type:this.type},e.reduce((t,r)=>(t[r]=this[r],t),{}))}toJSON(){return this.toObject()}static async fromObject(e,t){return new this(st(e,fQ))}}M(Lt,"type","BaseFilter"),M(Lt,"uniformLocations",[]);const gQ={multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,difference:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`
    if (uColor.r < 0.5) {
      gl_FragColor.r *= 2.0 * uColor.r;
    } else {
      gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
    }
    if (uColor.g < 0.5) {
      gl_FragColor.g *= 2.0 * uColor.g;
    } else {
      gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
    }
    if (uColor.b < 0.5) {
      gl_FragColor.b *= 2.0 * uColor.b;
    } else {
      gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
    }
    `,tint:`
    gl_FragColor.rgb *= (1.0 - uColor.a);
    gl_FragColor.rgb += uColor.rgb;
    `};class Kf extends Lt{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec4 uColor;
      varying vec2 vTexCoord;
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        gl_FragColor = color;
        if (color.a > 0.0) {
          `.concat(gQ[this.mode],`
        }
      }
      `)}applyTo2d(e){let{imageData:{data:t}}=e;const r=new We(this.color).getSource(),s=this.alpha,i=r[0]*s,o=r[1]*s,a=r[2]*s,l=1-s;for(let c=0;c<t.length;c+=4){const u=t[c],h=t[c+1],f=t[c+2];let p,y,m;switch(this.mode){case"multiply":p=u*i/255,y=h*o/255,m=f*a/255;break;case"screen":p=255-(255-u)*(255-i)/255,y=255-(255-h)*(255-o)/255,m=255-(255-f)*(255-a)/255;break;case"add":p=u+i,y=h+o,m=f+a;break;case"difference":p=Math.abs(u-i),y=Math.abs(h-o),m=Math.abs(f-a);break;case"subtract":p=u-i,y=h-o,m=f-a;break;case"darken":p=Math.min(u,i),y=Math.min(h,o),m=Math.min(f,a);break;case"lighten":p=Math.max(u,i),y=Math.max(h,o),m=Math.max(f,a);break;case"overlay":p=i<128?2*u*i/255:255-2*(255-u)*(255-i)/255,y=o<128?2*h*o/255:255-2*(255-h)*(255-o)/255,m=a<128?2*f*a/255:255-2*(255-f)*(255-a)/255;break;case"exclusion":p=i+u-2*i*u/255,y=o+h-2*o*h/255,m=a+f-2*a*f/255;break;case"tint":p=i+u*l,y=o+h*l,m=a+f*l}t[c]=p,t[c+1]=y,t[c+2]=m}}sendUniformData(e,t){const r=new We(this.color).getSource();r[0]=this.alpha*r[0]/255,r[1]=this.alpha*r[1]/255,r[2]=this.alpha*r[2]/255,r[3]=this.alpha,e.uniform4fv(t.uColor,r)}}M(Kf,"defaults",{color:"#F95C63",mode:"multiply",alpha:1}),M(Kf,"type","BlendColor"),M(Kf,"uniformLocations",["uColor"]),re.setClass(Kf);const mQ={multiply:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.rgba *= color2.rgba;
      gl_FragColor = color;
    }
    `,mask:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.a = color2.a;
      gl_FragColor = color;
    }
    `},yQ=["type","image"];class Yf extends Lt{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return mQ[this.mode]}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    uniform mat3 uTransformMatrix;
    void main() {
      vTexCoord = aPosition;
      vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }
    `}applyToWebGL(e){const t=e.context,r=this.createTexture(e.filterBackend,this.image);this.bindAdditionalTexture(t,r,t.TEXTURE1),super.applyToWebGL(e),this.unbindAdditionalTexture(t,t.TEXTURE1)}createTexture(e,t){return e.getCachedTexture(t.cacheKey,t.getElement())}calculateMatrix(){const e=this.image,{width:t,height:r}=e.getElement();return[1/e.scaleX,0,0,0,1/e.scaleY,0,-e.left/t,-e.top/r,1]}applyTo2d(e){let{imageData:{data:t,width:r,height:s},filterBackend:{resources:i}}=e;const o=this.image;i.blendImage||(i.blendImage=pi());const a=i.blendImage,l=a.getContext("2d");a.width!==r||a.height!==s?(a.width=r,a.height=s):l.clearRect(0,0,r,s),l.setTransform(o.scaleX,0,0,o.scaleY,o.left,o.top),l.drawImage(o.getElement(),0,0,r,s);const c=l.getImageData(0,0,r,s).data;for(let u=0;u<t.length;u+=4){const h=t[u],f=t[u+1],p=t[u+2],y=t[u+3],m=c[u],v=c[u+1],w=c[u+2],_=c[u+3];switch(this.mode){case"multiply":t[u]=h*m/255,t[u+1]=f*v/255,t[u+2]=p*w/255,t[u+3]=y*_/255;break;case"mask":t[u+3]=_}}}sendUniformData(e,t){const r=this.calculateMatrix();e.uniform1i(t.uImage,1),e.uniformMatrix3fv(t.uTransformMatrix,!1,r)}toObject(){return L(L({},super.toObject()),{},{image:this.image&&this.image.toObject()})}static async fromObject(e,t){let{type:r,image:s}=e,i=st(e,yQ);return Hn.fromObject(s,t).then(o=>new this(L(L({},i),{},{image:o})))}}M(Yf,"type","BlendImage"),M(Yf,"defaults",{mode:"multiply",alpha:1}),M(Yf,"uniformLocations",["uTransformMatrix","uImage"]),re.setClass(Yf);class Xf extends Lt{getFragmentSource(){return`
    precision highp float;
    uniform sampler2D uTexture;
    uniform vec2 uDelta;
    varying vec2 vTexCoord;
    const float nSamples = 15.0;
    vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
    float random(vec3 scale) {
      /* use the fragment position for a different seed per-pixel */
      return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
    }
    void main() {
      vec4 color = vec4(0.0);
      float totalC = 0.0;
      float totalA = 0.0;
      float offset = random(v3offset);
      for (float t = -nSamples; t <= nSamples; t++) {
        float percent = (t + offset - 0.5) / nSamples;
        vec4 sample = texture2D(uTexture, vTexCoord + uDelta * percent);
        float weight = 1.0 - abs(percent);
        float alpha = weight * sample.a;
        color.rgb += sample.rgb * alpha;
        color.a += alpha;
        totalA += weight;
        totalC += alpha;
      }
      gl_FragColor.rgb = color.rgb / totalC;
      gl_FragColor.a = color.a / totalA;
    }
  `}applyTo(e){_y(e)?(this.aspectRatio=e.sourceWidth/e.sourceHeight,e.passes++,this._setupFrameBuffer(e),this.horizontal=!0,this.applyToWebGL(e),this._swapTextures(e),this._setupFrameBuffer(e),this.horizontal=!1,this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)}applyTo2d(e){let{imageData:{data:t,width:r,height:s}}=e;this.aspectRatio=r/s,this.horizontal=!0;let i=this.getBlurValue()*r;const o=new Uint8ClampedArray(t),a=15,l=4*r;for(let c=0;c<t.length;c+=4){let u=0,h=0,f=0,p=0,y=0;const m=c-c%l,v=m+l;for(let w=-14;w<a;w++){const _=w/a,x=4*Math.floor(i*_),A=1-Math.abs(_);let j=c+x;j<m?j=m:j>v&&(j=v);const N=t[j+3]*A;u+=t[j]*N,h+=t[j+1]*N,f+=t[j+2]*N,p+=N,y+=A}o[c]=u/p,o[c+1]=h/p,o[c+2]=f/p,o[c+3]=p/y}this.horizontal=!1,i=this.getBlurValue()*s;for(let c=0;c<o.length;c+=4){let u=0,h=0,f=0,p=0,y=0;const m=c%l,v=o.length-l+m;for(let w=-14;w<a;w++){const _=w/a,x=Math.floor(i*_)*l,A=1-Math.abs(_);let j=c+x;j<m?j=m:j>v&&(j=v);const N=o[j+3]*A;u+=o[j]*N,h+=o[j+1]*N,f+=o[j+2]*N,p+=N,y+=A}t[c]=u/p,t[c+1]=h/p,t[c+2]=f/p,t[c+3]=p/y}}sendUniformData(e,t){const r=this.chooseRightDelta();e.uniform2fv(t.uDelta,r)}isNeutralState(){return this.blur===0}getBlurValue(){let e=1;const{horizontal:t,aspectRatio:r}=this;return t?r>1&&(e=1/r):r<1&&(e=r),e*this.blur*.12}chooseRightDelta(){const e=this.getBlurValue();return this.horizontal?[e,0]:[0,e]}}M(Xf,"type","Blur"),M(Xf,"defaults",{blur:0}),M(Xf,"uniformLocations",["uDelta"]),re.setClass(Xf);class Qf extends Lt{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBrightness;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += uBrightness;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const r=Math.round(255*this.brightness);for(let s=0;s<t.length;s+=4)t[s]+=r,t[s+1]+=r,t[s+2]+=r}isNeutralState(){return this.brightness===0}sendUniformData(e,t){e.uniform1f(t.uBrightness,this.brightness)}}M(Qf,"type","Brightness"),M(Qf,"defaults",{brightness:0}),M(Qf,"uniformLocations",["uBrightness"]),re.setClass(Qf);const XD={matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],colorsOnly:!0};class Vl extends Lt{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  varying vec2 vTexCoord;
  uniform mat4 uColorMatrix;
  uniform vec4 uConstants;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color *= uColorMatrix;
    color += uConstants;
    gl_FragColor = color;
  }`}applyTo2d(e){const t=e.imageData.data,r=this.matrix,s=this.colorsOnly;for(let i=0;i<t.length;i+=4){const o=t[i],a=t[i+1],l=t[i+2];if(t[i]=o*r[0]+a*r[1]+l*r[2]+255*r[4],t[i+1]=o*r[5]+a*r[6]+l*r[7]+255*r[9],t[i+2]=o*r[10]+a*r[11]+l*r[12]+255*r[14],!s){const c=t[i+3];t[i]+=c*r[3],t[i+1]+=c*r[8],t[i+2]+=c*r[13],t[i+3]=o*r[15]+a*r[16]+l*r[17]+c*r[18]+255*r[19]}}}sendUniformData(e,t){const r=this.matrix,s=[r[0],r[1],r[2],r[3],r[5],r[6],r[7],r[8],r[10],r[11],r[12],r[13],r[15],r[16],r[17],r[18]],i=[r[4],r[9],r[14],r[19]];e.uniformMatrix4fv(t.uColorMatrix,!1,s),e.uniform4fv(t.uConstants,i)}toObject(){return L(L({},super.toObject()),{},{matrix:[...this.matrix]})}}function Ja(n,e){var t;const r=(M(t=class extends Vl{toObject(){return{type:this.type,colorsOnly:this.colorsOnly}}},"type",n),M(t,"defaults",{colorsOnly:!1,matrix:e}),t);return re.setClass(r,n),r}M(Vl,"type","ColorMatrix"),M(Vl,"defaults",XD),M(Vl,"uniformLocations",["uColorMatrix","uConstants"]),re.setClass(Vl);Ja("Brownie",[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0]);Ja("Vintage",[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0]);Ja("Kodachrome",[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0]);Ja("Technicolor",[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0]);Ja("Polaroid",[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0]);Ja("Sepia",[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0]);Ja("BlackWhite",[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]);class zk extends Lt{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(e),this.subFilters=e.subFilters||[]}applyTo(e){_y(e)&&(e.passes+=this.subFilters.length-1),this.subFilters.forEach(t=>{t.applyTo(e)})}toObject(){return{type:this.type,subFilters:this.subFilters.map(e=>e.toObject())}}isNeutralState(){return!this.subFilters.some(e=>!e.isNeutralState())}static fromObject(e,t){return Promise.all((e.subFilters||[]).map(r=>re.getClass(r.type).fromObject(r,t))).then(r=>new this({subFilters:r}))}}M(zk,"type","Composed"),re.setClass(zk);class Jf extends Lt{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uContrast;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
    color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
    gl_FragColor = color;
  }`}isNeutralState(){return this.contrast===0}applyTo2d(e){let{imageData:{data:t}}=e;const r=Math.floor(255*this.contrast),s=259*(r+255)/(255*(259-r));for(let i=0;i<t.length;i+=4)t[i]=s*(t[i]-128)+128,t[i+1]=s*(t[i+1]-128)+128,t[i+2]=s*(t[i+2]-128)+128}sendUniformData(e,t){e.uniform1f(t.uContrast,this.contrast)}}M(Jf,"type","Contrast"),M(Jf,"defaults",{contrast:0}),M(Jf,"uniformLocations",["uContrast"]),re.setClass(Jf);const vQ={Convolute_3_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_3_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_5_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_5_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_7_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_7_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_9_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_9_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `};class Zf extends Lt{getCacheKey(){return"".concat(this.type,"_").concat(Math.sqrt(this.matrix.length),"_").concat(this.opaque?1:0)}getFragmentSource(){return vQ[this.getCacheKey()]}applyTo2d(e){const t=e.imageData,r=t.data,s=this.matrix,i=Math.round(Math.sqrt(s.length)),o=Math.floor(i/2),a=t.width,l=t.height,c=e.ctx.createImageData(a,l),u=c.data,h=this.opaque?1:0;let f,p,y,m,v,w,_,x,A,j,N,S,T;for(N=0;N<l;N++)for(j=0;j<a;j++){for(v=4*(N*a+j),f=0,p=0,y=0,m=0,T=0;T<i;T++)for(S=0;S<i;S++)_=N+T-o,w=j+S-o,_<0||_>=l||w<0||w>=a||(x=4*(_*a+w),A=s[T*i+S],f+=r[x]*A,p+=r[x+1]*A,y+=r[x+2]*A,h||(m+=r[x+3]*A));u[v]=f,u[v+1]=p,u[v+2]=y,u[v+3]=h?r[v+3]:m}e.imageData=c}sendUniformData(e,t){e.uniform1fv(t.uMatrix,this.matrix)}toObject(){return L(L({},super.toObject()),{},{opaque:this.opaque,matrix:[...this.matrix]})}}M(Zf,"type","Convolute"),M(Zf,"defaults",{opaque:!1,matrix:[0,0,0,0,1,0,0,0,0]}),M(Zf,"uniformLocations",["uMatrix","uOpaque","uHalfSize","uSize"]),re.setClass(Zf);const QD="Gamma";class ep extends Lt{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform vec3 uGamma;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    vec3 correction = (1.0 / uGamma);
    color.r = pow(color.r, correction.r);
    color.g = pow(color.g, correction.g);
    color.b = pow(color.b, correction.b);
    gl_FragColor = color;
    gl_FragColor.rgb *= color.a;
  }
`}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(e),this.gamma=e.gamma||this.constructor.defaults.gamma.concat()}applyTo2d(e){let{imageData:{data:t}}=e;const r=this.gamma,s=1/r[0],i=1/r[1],o=1/r[2];this.rgbValues||(this.rgbValues={r:new Uint8Array(256),g:new Uint8Array(256),b:new Uint8Array(256)});const a=this.rgbValues;for(let l=0;l<256;l++)a.r[l]=255*Math.pow(l/255,s),a.g[l]=255*Math.pow(l/255,i),a.b[l]=255*Math.pow(l/255,o);for(let l=0;l<t.length;l+=4)t[l]=a.r[t[l]],t[l+1]=a.g[t[l+1]],t[l+2]=a.b[t[l+2]]}sendUniformData(e,t){e.uniform3fv(t.uGamma,this.gamma)}isNeutralState(){const{gamma:e}=this;return e[0]===1&&e[1]===1&&e[2]===1}toObject(){return{type:QD,gamma:this.gamma.concat()}}}M(ep,"type",QD),M(ep,"defaults",{gamma:[1,1,1]}),M(ep,"uniformLocations",["uGamma"]),re.setClass(ep);const wQ={average:`
    precision highp float;
    uniform sampler2D uTexture;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      float average = (color.r + color.b + color.g) / 3.0;
      gl_FragColor = vec4(average, average, average, color.a);
    }
    `,lightness:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `,luminosity:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `};class tp extends Lt{applyTo2d(e){let{imageData:{data:t}}=e;for(let r,s=0;s<t.length;s+=4){const i=t[s],o=t[s+1],a=t[s+2];switch(this.mode){case"average":r=(i+o+a)/3;break;case"lightness":r=(Math.min(i,o,a)+Math.max(i,o,a))/2;break;case"luminosity":r=.21*i+.72*o+.07*a}t[s+2]=t[s+1]=t[s]=r}}getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return wQ[this.mode]}sendUniformData(e,t){e.uniform1i(t.uMode,1)}isNeutralState(){return!1}}M(tp,"type","Grayscale"),M(tp,"defaults",{mode:"average"}),M(tp,"uniformLocations",["uMode"]),re.setClass(tp);const _Q=L(L({},XD),{},{rotation:0});class s0 extends Vl{calculateMatrix(){const e=this.rotation*Math.PI,t=di(e),r=fi(e),s=1/3,i=Math.sqrt(s)*r,o=1-t;this.matrix=[t+o/3,s*o-i,s*o+i,0,0,s*o+i,t+s*o,s*o-i,0,0,s*o-i,s*o+i,t+s*o,0,0,0,0,0,1,0]}isNeutralState(){return this.rotation===0}applyTo(e){this.calculateMatrix(),super.applyTo(e)}toObject(){return{type:this.type,rotation:this.rotation}}}M(s0,"type","HueRotation"),M(s0,"defaults",_Q),re.setClass(s0);class np extends Lt{applyTo2d(e){let{imageData:{data:t}}=e;for(let r=0;r<t.length;r+=4)t[r]=255-t[r],t[r+1]=255-t[r+1],t[r+2]=255-t[r+2],this.alpha&&(t[r+3]=255-t[r+3])}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform int uInvert;
  uniform int uAlpha;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    if (uInvert == 1) {
      if (uAlpha == 1) {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,1.0 -color.a);
      } else {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
      }
    } else {
      gl_FragColor = color;
    }
  }
`}isNeutralState(){return!this.invert}sendUniformData(e,t){e.uniform1i(t.uInvert,Number(this.invert)),e.uniform1i(t.uAlpha,Number(this.alpha))}}M(np,"type","Invert"),M(np,"defaults",{alpha:!1,invert:!0}),M(np,"uniformLocations",["uInvert","uAlpha"]),re.setClass(np);class rp extends Lt{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uStepH;
  uniform float uNoise;
  uniform float uSeed;
  varying vec2 vTexCoord;
  float rand(vec2 co, float seed, float vScale) {
    return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
  }
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const r=this.noise;for(let s=0;s<t.length;s+=4){const i=(.5-Math.random())*r;t[s]+=i,t[s+1]+=i,t[s+2]+=i}}sendUniformData(e,t){e.uniform1f(t.uNoise,this.noise/255),e.uniform1f(t.uSeed,Math.random())}isNeutralState(){return this.noise===0}}M(rp,"type","Noise"),M(rp,"defaults",{noise:0}),M(rp,"uniformLocations",["uNoise","uSeed"]),re.setClass(rp);class sp extends Lt{applyTo2d(e){let{imageData:{data:t,width:r,height:s}}=e;for(let i=0;i<s;i+=this.blocksize)for(let o=0;o<r;o+=this.blocksize){const a=4*i*r+4*o,l=t[a],c=t[a+1],u=t[a+2],h=t[a+3];for(let f=i;f<Math.min(i+this.blocksize,s);f++)for(let p=o;p<Math.min(o+this.blocksize,r);p++){const y=4*f*r+4*p;t[y]=l,t[y+1]=c,t[y+2]=u,t[y+3]=h}}}isNeutralState(){return this.blocksize===1}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBlocksize;
  uniform float uStepW;
  uniform float uStepH;
  varying vec2 vTexCoord;
  void main() {
    float blockW = uBlocksize * uStepW;
    float blockH = uBlocksize * uStepH;
    int posX = int(vTexCoord.x / blockW);
    int posY = int(vTexCoord.y / blockH);
    float fposX = float(posX);
    float fposY = float(posY);
    vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
    vec4 color = texture2D(uTexture, squareCoords);
    gl_FragColor = color;
  }
`}sendUniformData(e,t){e.uniform1f(t.uBlocksize,this.blocksize)}}M(sp,"type","Pixelate"),M(sp,"defaults",{blocksize:4}),M(sp,"uniformLocations",["uBlocksize"]),re.setClass(sp);class ip extends Lt{getFragmentSource(){return`
precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
  gl_FragColor = texture2D(uTexture, vTexCoord);
  if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
    gl_FragColor.a = 0.0;
  }
}
`}applyTo2d(e){let{imageData:{data:t}}=e;const r=255*this.distance,s=new We(this.color).getSource(),i=[s[0]-r,s[1]-r,s[2]-r],o=[s[0]+r,s[1]+r,s[2]+r];for(let a=0;a<t.length;a+=4){const l=t[a],c=t[a+1],u=t[a+2];l>i[0]&&c>i[1]&&u>i[2]&&l<o[0]&&c<o[1]&&u<o[2]&&(t[a+3]=0)}}sendUniformData(e,t){const r=new We(this.color).getSource(),s=this.distance,i=[0+r[0]/255-s,0+r[1]/255-s,0+r[2]/255-s,1],o=[r[0]/255+s,r[1]/255+s,r[2]/255+s,1];e.uniform4fv(t.uLow,i),e.uniform4fv(t.uHigh,o)}}M(ip,"type","RemoveColor"),M(ip,"defaults",{color:"#FFFFFF",distance:.02,useAlpha:!1}),M(ip,"uniformLocations",["uLow","uHigh"]),re.setClass(ip);class op extends Lt{sendUniformData(e,t){e.uniform2fv(t.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),e.uniform1fv(t.uTaps,this.taps)}getFilterWindow(){const e=this.tempScale;return Math.ceil(this.lanczosLobes/e)}getCacheKey(){const e=this.getFilterWindow();return"".concat(this.type,"_").concat(e)}getFragmentSource(){const e=this.getFilterWindow();return this.generateShader(e)}getTaps(){const e=this.lanczosCreate(this.lanczosLobes),t=this.tempScale,r=this.getFilterWindow(),s=new Array(r);for(let i=1;i<=r;i++)s[i-1]=e(i*t);return s}generateShader(e){const t=new Array(e);for(let r=1;r<=e;r++)t[r-1]="".concat(r,".0 * uDelta");return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec2 uDelta;
      varying vec2 vTexCoord;
      uniform float uTaps[`.concat(e,`];
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        float sum = 1.0;
        `).concat(t.map((r,s)=>`
              color += texture2D(uTexture, vTexCoord + `.concat(r,") * uTaps[").concat(s,"] + texture2D(uTexture, vTexCoord - ").concat(r,") * uTaps[").concat(s,`];
              sum += 2.0 * uTaps[`).concat(s,`];
            `)).join(`
`),`
        gl_FragColor = color / sum;
      }
    `)}applyToForWebgl(e){e.passes++,this.width=e.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=e.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),e.destinationWidth=this.dW,super.applyTo(e),e.sourceWidth=e.destinationWidth,this.height=e.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),e.destinationHeight=this.dH,super.applyTo(e),e.sourceHeight=e.destinationHeight}applyTo(e){_y(e)?this.applyToForWebgl(e):this.applyTo2d(e)}isNeutralState(){return this.scaleX===1&&this.scaleY===1}lanczosCreate(e){return t=>{if(t>=e||t<=-e)return 0;if(t<11920929e-14&&t>-11920929e-14)return 1;const r=(t*=Math.PI)/e;return Math.sin(t)/t*Math.sin(r)/r}}applyTo2d(e){const t=e.imageData,r=this.scaleX,s=this.scaleY;this.rcpScaleX=1/r,this.rcpScaleY=1/s;const i=t.width,o=t.height,a=Math.round(i*r),l=Math.round(o*s);let c;c=this.resizeType==="sliceHack"?this.sliceByTwo(e,i,o,a,l):this.resizeType==="hermite"?this.hermiteFastResize(e,i,o,a,l):this.resizeType==="bilinear"?this.bilinearFiltering(e,i,o,a,l):this.resizeType==="lanczos"?this.lanczosResize(e,i,o,a,l):new ImageData(a,l),e.imageData=c}sliceByTwo(e,t,r,s,i){const o=e.imageData,a=.5;let l=!1,c=!1,u=t*a,h=r*a;const f=e.filterBackend.resources;let p=0,y=0;const m=t;let v=0;f.sliceByTwo||(f.sliceByTwo=pi());const w=f.sliceByTwo;(w.width<1.5*t||w.height<r)&&(w.width=1.5*t,w.height=r);const _=w.getContext("2d");for(_.clearRect(0,0,1.5*t,r),_.putImageData(o,0,0),s=Math.floor(s),i=Math.floor(i);!l||!c;)t=u,r=h,s<Math.floor(u*a)?u=Math.floor(u*a):(u=s,l=!0),i<Math.floor(h*a)?h=Math.floor(h*a):(h=i,c=!0),_.drawImage(w,p,y,t,r,m,v,u,h),p=m,y=v,v+=h;return _.getImageData(p,y,s,i)}lanczosResize(e,t,r,s,i){const o=e.imageData.data,a=e.ctx.createImageData(s,i),l=a.data,c=this.lanczosCreate(this.lanczosLobes),u=this.rcpScaleX,h=this.rcpScaleY,f=2/this.rcpScaleX,p=2/this.rcpScaleY,y=Math.ceil(u*this.lanczosLobes/2),m=Math.ceil(h*this.lanczosLobes/2),v={},w={x:0,y:0},_={x:0,y:0};return function x(A){let j,N,S,T,P,R,D,I,k,F,K;for(w.x=(A+.5)*u,_.x=Math.floor(w.x),j=0;j<i;j++){for(w.y=(j+.5)*h,_.y=Math.floor(w.y),P=0,R=0,D=0,I=0,k=0,N=_.x-y;N<=_.x+y;N++)if(!(N<0||N>=t)){F=Math.floor(1e3*Math.abs(N-w.x)),v[F]||(v[F]={});for(let G=_.y-m;G<=_.y+m;G++)G<0||G>=r||(K=Math.floor(1e3*Math.abs(G-w.y)),v[F][K]||(v[F][K]=c(Math.sqrt(Math.pow(F*f,2)+Math.pow(K*p,2))/1e3)),S=v[F][K],S>0&&(T=4*(G*t+N),P+=S,R+=S*o[T],D+=S*o[T+1],I+=S*o[T+2],k+=S*o[T+3]))}T=4*(j*s+A),l[T]=R/P,l[T+1]=D/P,l[T+2]=I/P,l[T+3]=k/P}return++A<s?x(A):a}(0)}bilinearFiltering(e,t,r,s,i){let o,a,l,c,u,h,f,p,y,m,v,w,_,x=0;const A=this.rcpScaleX,j=this.rcpScaleY,N=4*(t-1),S=e.imageData.data,T=e.ctx.createImageData(s,i),P=T.data;for(f=0;f<i;f++)for(p=0;p<s;p++)for(u=Math.floor(A*p),h=Math.floor(j*f),y=A*p-u,m=j*f-h,_=4*(h*t+u),v=0;v<4;v++)o=S[_+v],a=S[_+4+v],l=S[_+N+v],c=S[_+N+4+v],w=o*(1-y)*(1-m)+a*y*(1-m)+l*m*(1-y)+c*y*m,P[x++]=w;return T}hermiteFastResize(e,t,r,s,i){const o=this.rcpScaleX,a=this.rcpScaleY,l=Math.ceil(o/2),c=Math.ceil(a/2),u=e.imageData.data,h=e.ctx.createImageData(s,i),f=h.data;for(let p=0;p<i;p++)for(let y=0;y<s;y++){const m=4*(y+p*s);let v=0,w=0,_=0,x=0,A=0,j=0,N=0;const S=(p+.5)*a;for(let T=Math.floor(p*a);T<(p+1)*a;T++){const P=Math.abs(S-(T+.5))/c,R=(y+.5)*o,D=P*P;for(let I=Math.floor(y*o);I<(y+1)*o;I++){let k=Math.abs(R-(I+.5))/l;const F=Math.sqrt(D+k*k);F>1&&F<-1||(v=2*F*F*F-3*F*F+1,v>0&&(k=4*(I+T*t),N+=v*u[k+3],_+=v,u[k+3]<255&&(v=v*u[k+3]/250),x+=v*u[k],A+=v*u[k+1],j+=v*u[k+2],w+=v))}}f[m]=x/w,f[m+1]=A/w,f[m+2]=j/w,f[m+3]=N/_}return h}}M(op,"type","Resize"),M(op,"defaults",{resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3}),M(op,"uniformLocations",["uDelta","uTaps"]),re.setClass(op);class ap extends Lt{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uSaturation;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float rgMax = max(color.r, color.g);
    float rgbMax = max(rgMax, color.b);
    color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
    color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
    color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const r=-this.saturation;for(let s=0;s<t.length;s+=4){const i=t[s],o=t[s+1],a=t[s+2],l=Math.max(i,o,a);t[s]+=l!==i?(l-i)*r:0,t[s+1]+=l!==o?(l-o)*r:0,t[s+2]+=l!==a?(l-a)*r:0}}sendUniformData(e,t){e.uniform1f(t.uSaturation,-this.saturation)}isNeutralState(){return this.saturation===0}}M(ap,"type","Saturation"),M(ap,"defaults",{saturation:0}),M(ap,"uniformLocations",["uSaturation"]),re.setClass(ap);class lp extends Lt{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uVibrance;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float max = max(color.r, max(color.g, color.b));
    float avg = (color.r + color.g + color.b) / 3.0;
    float amt = (abs(max - avg) * 2.0) * uVibrance;
    color.r += max != color.r ? (max - color.r) * amt : 0.00;
    color.g += max != color.g ? (max - color.g) * amt : 0.00;
    color.b += max != color.b ? (max - color.b) * amt : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const r=-this.vibrance;for(let s=0;s<t.length;s+=4){const i=t[s],o=t[s+1],a=t[s+2],l=Math.max(i,o,a),c=(i+o+a)/3,u=2*Math.abs(l-c)/255*r;t[s]+=l!==i?(l-i)*u:0,t[s+1]+=l!==o?(l-o)*u:0,t[s+2]+=l!==a?(l-a)*u:0}}sendUniformData(e,t){e.uniform1f(t.uVibrance,-this.vibrance)}isNeutralState(){return this.vibrance===0}}M(lp,"type","Vibrance"),M(lp,"defaults",{vibrance:0}),M(lp,"uniformLocations",["uVibrance"]),re.setClass(lp);var i0=0;function JD(){C.useEffect(()=>{const n=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",n[0]??Wk()),document.body.insertAdjacentElement("beforeend",n[1]??Wk()),i0++,()=>{i0===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),i0--}},[])}function Wk(){const n=document.createElement("span");return n.setAttribute("data-radix-focus-guard",""),n.tabIndex=0,n.style.outline="none",n.style.opacity="0",n.style.position="fixed",n.style.pointerEvents="none",n}var o0="focusScope.autoFocusOnMount",a0="focusScope.autoFocusOnUnmount",Hk={bubbles:!1,cancelable:!0},xQ="FocusScope",p1=C.forwardRef((n,e)=>{const{loop:t=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...o}=n,[a,l]=C.useState(null),c=Kr(s),u=Kr(i),h=C.useRef(null),f=ot(e,m=>l(m)),p=C.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;C.useEffect(()=>{if(r){let m=function(x){if(p.paused||!a)return;const A=x.target;a.contains(A)?h.current=A:Li(h.current,{select:!0})},v=function(x){if(p.paused||!a)return;const A=x.relatedTarget;A!==null&&(a.contains(A)||Li(h.current,{select:!0}))},w=function(x){if(document.activeElement===document.body)for(const j of x)j.removedNodes.length>0&&Li(a)};document.addEventListener("focusin",m),document.addEventListener("focusout",v);const _=new MutationObserver(w);return a&&_.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",m),document.removeEventListener("focusout",v),_.disconnect()}}},[r,a,p.paused]),C.useEffect(()=>{if(a){Gk.add(p);const m=document.activeElement;if(!a.contains(m)){const w=new CustomEvent(o0,Hk);a.addEventListener(o0,c),a.dispatchEvent(w),w.defaultPrevented||(bQ(kQ(ZD(a)),{select:!0}),document.activeElement===m&&Li(a))}return()=>{a.removeEventListener(o0,c),setTimeout(()=>{const w=new CustomEvent(a0,Hk);a.addEventListener(a0,u),a.dispatchEvent(w),w.defaultPrevented||Li(m??document.body,{select:!0}),a.removeEventListener(a0,u),Gk.remove(p)},0)}}},[a,c,u,p]);const y=C.useCallback(m=>{if(!t&&!r||p.paused)return;const v=m.key==="Tab"&&!m.altKey&&!m.ctrlKey&&!m.metaKey,w=document.activeElement;if(v&&w){const _=m.currentTarget,[x,A]=SQ(_);x&&A?!m.shiftKey&&w===A?(m.preventDefault(),t&&Li(x,{select:!0})):m.shiftKey&&w===x&&(m.preventDefault(),t&&Li(A,{select:!0})):w===_&&m.preventDefault()}},[t,r,p.paused]);return g.jsx(Ve.div,{tabIndex:-1,...o,ref:f,onKeyDown:y})});p1.displayName=xQ;function bQ(n,{select:e=!1}={}){const t=document.activeElement;for(const r of n)if(Li(r,{select:e}),document.activeElement!==t)return}function SQ(n){const e=ZD(n),t=qk(e,n),r=qk(e.reverse(),n);return[t,r]}function ZD(n){const e=[],t=document.createTreeWalker(n,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;t.nextNode();)e.push(t.currentNode);return e}function qk(n,e){for(const t of n)if(!EQ(t,{upTo:e}))return t}function EQ(n,{upTo:e}){if(getComputedStyle(n).visibility==="hidden")return!0;for(;n;){if(e!==void 0&&n===e)return!1;if(getComputedStyle(n).display==="none")return!0;n=n.parentElement}return!1}function TQ(n){return n instanceof HTMLInputElement&&"select"in n}function Li(n,{select:e=!1}={}){if(n&&n.focus){const t=document.activeElement;n.focus({preventScroll:!0}),n!==t&&TQ(n)&&e&&n.select()}}var Gk=CQ();function CQ(){let n=[];return{add(e){const t=n[0];e!==t&&(t==null||t.pause()),n=Kk(n,e),n.unshift(e)},remove(e){var t;n=Kk(n,e),(t=n[0])==null||t.resume()}}}function Kk(n,e){const t=[...n],r=t.indexOf(e);return r!==-1&&t.splice(r,1),t}function kQ(n){return n.filter(e=>e.tagName!=="A")}var AQ=function(n){if(typeof document>"u")return null;var e=Array.isArray(n)?n[0]:n;return e.ownerDocument.body},fl=new WeakMap,cp=new WeakMap,up={},l0=0,eM=function(n){return n&&(n.host||eM(n.parentNode))},PQ=function(n,e){return e.map(function(t){if(n.contains(t))return t;var r=eM(t);return r&&n.contains(r)?r:(console.error("aria-hidden",t,"in not contained inside",n,". Doing nothing"),null)}).filter(function(t){return!!t})},IQ=function(n,e,t,r){var s=PQ(e,Array.isArray(n)?n:[n]);up[t]||(up[t]=new WeakMap);var i=up[t],o=[],a=new Set,l=new Set(s),c=function(h){!h||a.has(h)||(a.add(h),c(h.parentNode))};s.forEach(c);var u=function(h){!h||l.has(h)||Array.prototype.forEach.call(h.children,function(f){if(a.has(f))u(f);else try{var p=f.getAttribute(r),y=p!==null&&p!=="false",m=(fl.get(f)||0)+1,v=(i.get(f)||0)+1;fl.set(f,m),i.set(f,v),o.push(f),m===1&&y&&cp.set(f,!0),v===1&&f.setAttribute(t,"true"),y||f.setAttribute(r,"true")}catch(w){console.error("aria-hidden: cannot operate on ",f,w)}})};return u(e),a.clear(),l0++,function(){o.forEach(function(h){var f=fl.get(h)-1,p=i.get(h)-1;fl.set(h,f),i.set(h,p),f||(cp.has(h)||h.removeAttribute(r),cp.delete(h)),p||h.removeAttribute(t)}),l0--,l0||(fl=new WeakMap,fl=new WeakMap,cp=new WeakMap,up={})}},tM=function(n,e,t){t===void 0&&(t="data-aria-hidden");var r=Array.from(Array.isArray(n)?n:[n]),s=AQ(n);return s?(r.push.apply(r,Array.from(s.querySelectorAll("[aria-live]"))),IQ(r,s,t,"aria-hidden")):function(){return null}},zp="right-scroll-bar-position",Wp="width-before-scroll-bar",RQ="with-scroll-bars-hidden",OQ="--removed-body-scroll-bar-size";function c0(n,e){return typeof n=="function"?n(e):n&&(n.current=e),n}function NQ(n,e){var t=C.useState(function(){return{value:n,callback:e,facade:{get current(){return t.value},set current(r){var s=t.value;s!==r&&(t.value=r,t.callback(r,s))}}}})[0];return t.callback=e,t.facade}var jQ=typeof window<"u"?C.useLayoutEffect:C.useEffect,Yk=new WeakMap;function DQ(n,e){var t=NQ(null,function(r){return n.forEach(function(s){return c0(s,r)})});return jQ(function(){var r=Yk.get(t);if(r){var s=new Set(r),i=new Set(n),o=t.current;s.forEach(function(a){i.has(a)||c0(a,null)}),i.forEach(function(a){s.has(a)||c0(a,o)})}Yk.set(t,n)},[n]),t}function MQ(n){return n}function LQ(n,e){e===void 0&&(e=MQ);var t=[],r=!1,s={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return t.length?t[t.length-1]:n},useMedium:function(i){var o=e(i,r);return t.push(o),function(){t=t.filter(function(a){return a!==o})}},assignSyncMedium:function(i){for(r=!0;t.length;){var o=t;t=[],o.forEach(i)}t={push:function(a){return i(a)},filter:function(){return t}}},assignMedium:function(i){r=!0;var o=[];if(t.length){var a=t;t=[],a.forEach(i),o=t}var l=function(){var u=o;o=[],u.forEach(i)},c=function(){return Promise.resolve().then(l)};c(),t={push:function(u){o.push(u),c()},filter:function(u){return o=o.filter(u),t}}}};return s}function FQ(n){n===void 0&&(n={});var e=LQ(null);return e.options=hr({async:!0,ssr:!1},n),e}var nM=function(n){var e=n.sideCar,t=Vo(n,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=e.read();if(!r)throw new Error("Sidecar medium not found");return C.createElement(r,hr({},t))};nM.isSideCarExport=!0;function VQ(n,e){return n.useMedium(e),nM}var rM=FQ(),u0=function(){},xy=C.forwardRef(function(n,e){var t=C.useRef(null),r=C.useState({onScrollCapture:u0,onWheelCapture:u0,onTouchMoveCapture:u0}),s=r[0],i=r[1],o=n.forwardProps,a=n.children,l=n.className,c=n.removeScrollBar,u=n.enabled,h=n.shards,f=n.sideCar,p=n.noRelative,y=n.noIsolation,m=n.inert,v=n.allowPinchZoom,w=n.as,_=w===void 0?"div":w,x=n.gapMode,A=Vo(n,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),j=f,N=DQ([t,e]),S=hr(hr({},A),s);return C.createElement(C.Fragment,null,u&&C.createElement(j,{sideCar:rM,removeScrollBar:c,shards:h,noRelative:p,noIsolation:y,inert:m,setCallbacks:i,allowPinchZoom:!!v,lockRef:t,gapMode:x}),o?C.cloneElement(C.Children.only(a),hr(hr({},S),{ref:N})):C.createElement(_,hr({},S,{className:l,ref:N}),a))});xy.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};xy.classNames={fullWidth:Wp,zeroRight:zp};var UQ=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function $Q(){if(!document)return null;var n=document.createElement("style");n.type="text/css";var e=UQ();return e&&n.setAttribute("nonce",e),n}function BQ(n,e){n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}function zQ(n){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(n)}var WQ=function(){var n=0,e=null;return{add:function(t){n==0&&(e=$Q())&&(BQ(e,t),zQ(e)),n++},remove:function(){n--,!n&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},HQ=function(){var n=WQ();return function(e,t){C.useEffect(function(){return n.add(e),function(){n.remove()}},[e&&t])}},sM=function(){var n=HQ(),e=function(t){var r=t.styles,s=t.dynamic;return n(r,s),null};return e},qQ={left:0,top:0,right:0,gap:0},h0=function(n){return parseInt(n||"",10)||0},GQ=function(n){var e=window.getComputedStyle(document.body),t=e[n==="padding"?"paddingLeft":"marginLeft"],r=e[n==="padding"?"paddingTop":"marginTop"],s=e[n==="padding"?"paddingRight":"marginRight"];return[h0(t),h0(r),h0(s)]},KQ=function(n){if(n===void 0&&(n="margin"),typeof window>"u")return qQ;var e=GQ(n),t=document.documentElement.clientWidth,r=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,r-t+e[2]-e[0])}},YQ=sM(),rc="data-scroll-locked",XQ=function(n,e,t,r){var s=n.left,i=n.top,o=n.right,a=n.gap;return t===void 0&&(t="margin"),`
  .`.concat(RQ,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(a,"px ").concat(r,`;
  }
  body[`).concat(rc,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(r,";"),t==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(r,`;
    `),t==="padding"&&"padding-right: ".concat(a,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(zp,` {
    right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(Wp,` {
    margin-right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(zp," .").concat(zp,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(Wp," .").concat(Wp,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(rc,`] {
    `).concat(OQ,": ").concat(a,`px;
  }
`)},Xk=function(){var n=parseInt(document.body.getAttribute(rc)||"0",10);return isFinite(n)?n:0},QQ=function(){C.useEffect(function(){return document.body.setAttribute(rc,(Xk()+1).toString()),function(){var n=Xk()-1;n<=0?document.body.removeAttribute(rc):document.body.setAttribute(rc,n.toString())}},[])},JQ=function(n){var e=n.noRelative,t=n.noImportant,r=n.gapMode,s=r===void 0?"margin":r;QQ();var i=C.useMemo(function(){return KQ(s)},[s]);return C.createElement(YQ,{styles:XQ(i,!e,s,t?"":"!important")})},S_=!1;if(typeof window<"u")try{var hp=Object.defineProperty({},"passive",{get:function(){return S_=!0,!0}});window.addEventListener("test",hp,hp),window.removeEventListener("test",hp,hp)}catch{S_=!1}var pl=S_?{passive:!1}:!1,ZQ=function(n){return n.tagName==="TEXTAREA"},iM=function(n,e){if(!(n instanceof Element))return!1;var t=window.getComputedStyle(n);return t[e]!=="hidden"&&!(t.overflowY===t.overflowX&&!ZQ(n)&&t[e]==="visible")},eJ=function(n){return iM(n,"overflowY")},tJ=function(n){return iM(n,"overflowX")},Qk=function(n,e){var t=e.ownerDocument,r=e;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var s=oM(n,r);if(s){var i=aM(n,r),o=i[1],a=i[2];if(o>a)return!0}r=r.parentNode}while(r&&r!==t.body);return!1},nJ=function(n){var e=n.scrollTop,t=n.scrollHeight,r=n.clientHeight;return[e,t,r]},rJ=function(n){var e=n.scrollLeft,t=n.scrollWidth,r=n.clientWidth;return[e,t,r]},oM=function(n,e){return n==="v"?eJ(e):tJ(e)},aM=function(n,e){return n==="v"?nJ(e):rJ(e)},sJ=function(n,e){return n==="h"&&e==="rtl"?-1:1},iJ=function(n,e,t,r,s){var i=sJ(n,window.getComputedStyle(e).direction),o=i*r,a=t.target,l=e.contains(a),c=!1,u=o>0,h=0,f=0;do{if(!a)break;var p=aM(n,a),y=p[0],m=p[1],v=p[2],w=m-v-i*y;(y||w)&&oM(n,a)&&(h+=w,f+=y);var _=a.parentNode;a=_&&_.nodeType===Node.DOCUMENT_FRAGMENT_NODE?_.host:_}while(!l&&a!==document.body||l&&(e.contains(a)||e===a));return(u&&(Math.abs(h)<1||!s)||!u&&(Math.abs(f)<1||!s))&&(c=!0),c},dp=function(n){return"changedTouches"in n?[n.changedTouches[0].clientX,n.changedTouches[0].clientY]:[0,0]},Jk=function(n){return[n.deltaX,n.deltaY]},Zk=function(n){return n&&"current"in n?n.current:n},oJ=function(n,e){return n[0]===e[0]&&n[1]===e[1]},aJ=function(n){return`
  .block-interactivity-`.concat(n,` {pointer-events: none;}
  .allow-interactivity-`).concat(n,` {pointer-events: all;}
`)},lJ=0,gl=[];function cJ(n){var e=C.useRef([]),t=C.useRef([0,0]),r=C.useRef(),s=C.useState(lJ++)[0],i=C.useState(sM)[0],o=C.useRef(n);C.useEffect(function(){o.current=n},[n]),C.useEffect(function(){if(n.inert){document.body.classList.add("block-interactivity-".concat(s));var m=$b([n.lockRef.current],(n.shards||[]).map(Zk),!0).filter(Boolean);return m.forEach(function(v){return v.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),m.forEach(function(v){return v.classList.remove("allow-interactivity-".concat(s))})}}},[n.inert,n.lockRef.current,n.shards]);var a=C.useCallback(function(m,v){if("touches"in m&&m.touches.length===2||m.type==="wheel"&&m.ctrlKey)return!o.current.allowPinchZoom;var w=dp(m),_=t.current,x="deltaX"in m?m.deltaX:_[0]-w[0],A="deltaY"in m?m.deltaY:_[1]-w[1],j,N=m.target,S=Math.abs(x)>Math.abs(A)?"h":"v";if("touches"in m&&S==="h"&&N.type==="range")return!1;var T=Qk(S,N);if(!T)return!0;if(T?j=S:(j=S==="v"?"h":"v",T=Qk(S,N)),!T)return!1;if(!r.current&&"changedTouches"in m&&(x||A)&&(r.current=j),!j)return!0;var P=r.current||j;return iJ(P,v,m,P==="h"?x:A,!0)},[]),l=C.useCallback(function(m){var v=m;if(!(!gl.length||gl[gl.length-1]!==i)){var w="deltaY"in v?Jk(v):dp(v),_=e.current.filter(function(j){return j.name===v.type&&(j.target===v.target||v.target===j.shadowParent)&&oJ(j.delta,w)})[0];if(_&&_.should){v.cancelable&&v.preventDefault();return}if(!_){var x=(o.current.shards||[]).map(Zk).filter(Boolean).filter(function(j){return j.contains(v.target)}),A=x.length>0?a(v,x[0]):!o.current.noIsolation;A&&v.cancelable&&v.preventDefault()}}},[]),c=C.useCallback(function(m,v,w,_){var x={name:m,delta:v,target:w,should:_,shadowParent:uJ(w)};e.current.push(x),setTimeout(function(){e.current=e.current.filter(function(A){return A!==x})},1)},[]),u=C.useCallback(function(m){t.current=dp(m),r.current=void 0},[]),h=C.useCallback(function(m){c(m.type,Jk(m),m.target,a(m,n.lockRef.current))},[]),f=C.useCallback(function(m){c(m.type,dp(m),m.target,a(m,n.lockRef.current))},[]);C.useEffect(function(){return gl.push(i),n.setCallbacks({onScrollCapture:h,onWheelCapture:h,onTouchMoveCapture:f}),document.addEventListener("wheel",l,pl),document.addEventListener("touchmove",l,pl),document.addEventListener("touchstart",u,pl),function(){gl=gl.filter(function(m){return m!==i}),document.removeEventListener("wheel",l,pl),document.removeEventListener("touchmove",l,pl),document.removeEventListener("touchstart",u,pl)}},[]);var p=n.removeScrollBar,y=n.inert;return C.createElement(C.Fragment,null,y?C.createElement(i,{styles:aJ(s)}):null,p?C.createElement(JQ,{noRelative:n.noRelative,gapMode:n.gapMode}):null)}function uJ(n){for(var e=null;n!==null;)n instanceof ShadowRoot&&(e=n.host,n=n.host),n=n.parentNode;return e}const hJ=VQ(rM,cJ);var g1=C.forwardRef(function(n,e){return C.createElement(xy,hr({},n,{ref:e,sideCar:hJ}))});g1.classNames=xy.classNames;var by="Popover",[lM,NZ]=Lc(by,[$c]),Ld=$c(),[dJ,Bo]=lM(by),cM=n=>{const{__scopePopover:e,children:t,open:r,defaultOpen:s,onOpenChange:i,modal:o=!1}=n,a=Ld(e),l=C.useRef(null),[c,u]=C.useState(!1),[h,f]=gg({prop:r,defaultProp:s??!1,onChange:i,caller:by});return g.jsx(UR,{...a,children:g.jsx(dJ,{scope:e,contentId:km(),triggerRef:l,open:h,onOpenChange:f,onOpenToggle:C.useCallback(()=>f(p=>!p),[f]),hasCustomAnchor:c,onCustomAnchorAdd:C.useCallback(()=>u(!0),[]),onCustomAnchorRemove:C.useCallback(()=>u(!1),[]),modal:o,children:t})})};cM.displayName=by;var uM="PopoverAnchor",fJ=C.forwardRef((n,e)=>{const{__scopePopover:t,...r}=n,s=Bo(uM,t),i=Ld(t),{onCustomAnchorAdd:o,onCustomAnchorRemove:a}=s;return C.useEffect(()=>(o(),()=>a()),[o,a]),g.jsx(Rm,{...i,...r,ref:e})});fJ.displayName=uM;var hM="PopoverTrigger",dM=C.forwardRef((n,e)=>{const{__scopePopover:t,...r}=n,s=Bo(hM,t),i=Ld(t),o=ot(e,s.triggerRef),a=g.jsx(Ve.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":yM(s.open),...r,ref:o,onClick:Se(n.onClick,s.onOpenToggle)});return s.hasCustomAnchor?a:g.jsx(Rm,{asChild:!0,...i,children:a})});dM.displayName=hM;var m1="PopoverPortal",[pJ,gJ]=lM(m1,{forceMount:void 0}),fM=n=>{const{__scopePopover:e,forceMount:t,children:r,container:s}=n,i=Bo(m1,e);return g.jsx(pJ,{scope:e,forceMount:t,children:g.jsx(fd,{present:t||i.open,children:g.jsx(Sm,{asChild:!0,container:s,children:r})})})};fM.displayName=m1;var Nc="PopoverContent",pM=C.forwardRef((n,e)=>{const t=gJ(Nc,n.__scopePopover),{forceMount:r=t.forceMount,...s}=n,i=Bo(Nc,n.__scopePopover);return g.jsx(fd,{present:r||i.open,children:i.modal?g.jsx(yJ,{...s,ref:e}):g.jsx(vJ,{...s,ref:e})})});pM.displayName=Nc;var mJ=wc("PopoverContent.RemoveScroll"),yJ=C.forwardRef((n,e)=>{const t=Bo(Nc,n.__scopePopover),r=C.useRef(null),s=ot(e,r),i=C.useRef(!1);return C.useEffect(()=>{const o=r.current;if(o)return tM(o)},[]),g.jsx(g1,{as:mJ,allowPinchZoom:!0,children:g.jsx(gM,{...n,ref:s,trapFocus:t.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Se(n.onCloseAutoFocus,o=>{var a;o.preventDefault(),i.current||(a=t.triggerRef.current)==null||a.focus()}),onPointerDownOutside:Se(n.onPointerDownOutside,o=>{const a=o.detail.originalEvent,l=a.button===0&&a.ctrlKey===!0,c=a.button===2||l;i.current=c},{checkForDefaultPrevented:!1}),onFocusOutside:Se(n.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1})})})}),vJ=C.forwardRef((n,e)=>{const t=Bo(Nc,n.__scopePopover),r=C.useRef(!1),s=C.useRef(!1);return g.jsx(gM,{...n,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,a;(o=n.onCloseAutoFocus)==null||o.call(n,i),i.defaultPrevented||(r.current||(a=t.triggerRef.current)==null||a.focus(),i.preventDefault()),r.current=!1,s.current=!1},onInteractOutside:i=>{var l,c;(l=n.onInteractOutside)==null||l.call(n,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const o=i.target;((c=t.triggerRef.current)==null?void 0:c.contains(o))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),gM=C.forwardRef((n,e)=>{const{__scopePopover:t,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:i,disableOutsidePointerEvents:o,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:c,onInteractOutside:u,...h}=n,f=Bo(Nc,t),p=Ld(t);return JD(),g.jsx(p1,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:i,children:g.jsx(dd,{asChild:!0,disableOutsidePointerEvents:o,onInteractOutside:u,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:c,onDismiss:()=>f.onOpenChange(!1),children:g.jsx(Bx,{"data-state":yM(f.open),role:"dialog",id:f.contentId,...p,...h,ref:e,style:{...h.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),mM="PopoverClose",wJ=C.forwardRef((n,e)=>{const{__scopePopover:t,...r}=n,s=Bo(mM,t);return g.jsx(Ve.button,{type:"button",...r,ref:e,onClick:Se(n.onClick,()=>s.onOpenChange(!1))})});wJ.displayName=mM;var _J="PopoverArrow",xJ=C.forwardRef((n,e)=>{const{__scopePopover:t,...r}=n,s=Ld(t);return g.jsx(zx,{...s,...r,ref:e})});xJ.displayName=_J;function yM(n){return n?"open":"closed"}var bJ=cM,SJ=dM,EJ=fM,vM=pM;const eA=bJ,tA=SJ,E_=C.forwardRef(({className:n,align:e="center",sideOffset:t=4,...r},s)=>g.jsx(EJ,{children:g.jsx(vM,{ref:s,align:e,sideOffset:t,className:Ge("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n),...r})}));E_.displayName=vM.displayName;const nA=["#000000","#FFFFFF","#FF0000","#00FF00","#0000FF","#FFFF00","#FF00FF","#00FFFF","#FFA500","#800080","#008000","#800000","#008080","#000080","#808080"],TJ=({isOpen:n,onClose:e,onSave:t})=>{const r=C.useRef(null),s=C.useRef(null),i=C.useRef(null),[o,a]=C.useState(null),[l,c]=C.useState("#000000"),[u,h]=C.useState("transparent"),f=C.useCallback(async I=>{if(o)try{const k=await Hn.fromURL(I),G=Math.min(300/k.width,200/k.height,1);k.scale(G),k.set({left:100,top:100}),o.add(k),o.setActiveObject(k),o.requestRenderAll()}catch(k){console.error("Error adding image:",k)}},[o]),p=C.useCallback(I=>{var F;if(!o||!n)return;const k=(F=I.clipboardData)==null?void 0:F.items;if(k){for(const K of k)if(K.type.startsWith("image/")){const G=K.getAsFile();if(G){const Y=new FileReader;Y.onload=V=>{var Q;const z=(Q=V.target)==null?void 0:Q.result;f(z)},Y.readAsDataURL(G)}break}}},[o,n,f]),y=I=>{var F;const k=(F=I.target.files)==null?void 0:F[0];if(k&&k.type.startsWith("image/")){const K=new FileReader;K.onload=G=>{var V;const Y=(V=G.target)==null?void 0:V.result;f(Y)},K.readAsDataURL(k)}i.current&&(i.current.value="")};C.useEffect(()=>{if(!r.current||!n)return;const I=new x_(r.current,{width:700,height:400,backgroundColor:"#ffffff",selection:!0});return a(I),()=>{I.dispose()}},[n]),C.useEffect(()=>{if(n)return document.addEventListener("paste",p),()=>{document.removeEventListener("paste",p)}},[n,p]);const m=()=>{if(!o)return;const I=new Vr({left:100,top:100,fill:u==="transparent"?"#3b82f6":u,stroke:l,strokeWidth:2,width:100,height:80});o.add(I),o.setActiveObject(I),o.requestRenderAll()},v=()=>{if(!o)return;const I=new ds({left:100,top:100,fill:u==="transparent"?"#22c55e":u,stroke:l,strokeWidth:2,radius:50});o.add(I),o.setActiveObject(I),o.requestRenderAll()},w=()=>{if(!o)return;const I=new so({left:100,top:100,fill:u==="transparent"?"#eab308":u,stroke:l,strokeWidth:2,width:100,height:87});o.add(I),o.setActiveObject(I),o.requestRenderAll()},_=()=>{if(!o)return;const I=new Ki([50,100,200,100],{stroke:l,strokeWidth:4});o.add(I),o.setActiveObject(I),o.requestRenderAll()},x=()=>{if(!o)return;const I=new Fl([{x:0,y:20},{x:100,y:20},{x:100,y:0},{x:140,y:30},{x:100,y:60},{x:100,y:40},{x:0,y:40}],{left:100,top:100,fill:u==="transparent"?"#ef4444":u,stroke:l,strokeWidth:1});o.add(I),o.setActiveObject(I),o.requestRenderAll()},A=()=>{if(!o)return;const I=[],k=50,F=25;for(let G=0;G<10;G++){const Y=G%2===0?k:F,V=Math.PI/5*G-Math.PI/2;I.push({x:Y*Math.cos(V),y:Y*Math.sin(V)})}const K=new Fl(I,{left:100,top:100,fill:u==="transparent"?"#f59e0b":u,stroke:l,strokeWidth:2});o.add(K),o.setActiveObject(K),o.requestRenderAll()},j=()=>{if(!o)return;o.getActiveObjects().forEach(k=>o.remove(k)),o.discardActiveObject(),o.requestRenderAll()},N=I=>{if(!o)return;const k=o.getActiveObject();k&&(k.rotate((k.angle||0)+I),o.requestRenderAll())},S=()=>{if(!o)return;const I=o.getActiveObject();I&&o.bringObjectForward(I)},T=()=>{if(!o)return;const I=o.getActiveObject();I&&o.sendObjectBackwards(I)},P=(I,k)=>{if(!o)return;const F=o.getActiveObject();F&&(k==="stroke"?F.set("stroke",I):F.set("fill",I),o.requestRenderAll()),k==="stroke"?c(I):h(I)},R=()=>{o&&(o.clear(),o.backgroundColor="#ffffff",o.requestRenderAll())},D=()=>{if(!o)return;const I=o.toDataURL({format:"png",quality:1,multiplier:2});t(I),e()};return n?g.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center",dir:"rtl",children:g.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 overflow-hidden",children:[g.jsxs("div",{className:"bg-primary text-primary-foreground p-3 flex items-center justify-between",children:[g.jsx("h2",{className:"font-bold",children:" "}),g.jsx(ae,{variant:"ghost",size:"icon",onClick:e,className:"text-primary-foreground hover:bg-primary/80",children:g.jsx(lR,{className:"h-5 w-5"})})]}),g.jsxs("div",{className:"p-3 border-b flex flex-wrap gap-2 items-center bg-muted",children:[g.jsxs("div",{className:"flex gap-1 border-l pl-2 ml-2",children:[g.jsx(ae,{variant:"outline",size:"icon",onClick:m,title:"",children:g.jsx(y5,{className:"h-4 w-4"})}),g.jsx(ae,{variant:"outline",size:"icon",onClick:v,title:"",children:g.jsx(e5,{className:"h-4 w-4"})}),g.jsx(ae,{variant:"outline",size:"icon",onClick:w,title:"",children:g.jsx(_5,{className:"h-4 w-4"})}),g.jsx(ae,{variant:"outline",size:"icon",onClick:_,title:"",children:g.jsx(o5,{className:"h-4 w-4"})}),g.jsx(ae,{variant:"outline",size:"icon",onClick:x,title:"",children:g.jsx("span",{className:"text-lg",children:""})}),g.jsx(ae,{variant:"outline",size:"icon",onClick:A,title:"",children:g.jsx(v5,{className:"h-4 w-4"})}),g.jsx(ae,{variant:"outline",size:"icon",onClick:()=>{var I;return(I=i.current)==null?void 0:I.click()},title:" ",children:g.jsx(n5,{className:"h-4 w-4"})}),g.jsx("input",{ref:i,type:"file",accept:"image/*",onChange:y,className:"hidden"})]}),g.jsxs("div",{className:"flex gap-1 border-l pl-2 ml-2",children:[g.jsxs(eA,{children:[g.jsx(tA,{asChild:!0,children:g.jsx(ae,{variant:"outline",size:"icon",title:" ",children:g.jsx("div",{className:"w-4 h-4 rounded border",style:{backgroundColor:l}})})}),g.jsxs(E_,{className:"w-auto p-2",children:[g.jsx("p",{className:"text-sm mb-2 font-medium",children:" "}),g.jsx("div",{className:"grid grid-cols-5 gap-1",children:nA.map(I=>g.jsx("button",{className:"w-6 h-6 rounded border border-gray-300 hover:scale-110 transition-transform",style:{backgroundColor:I},onClick:()=>P(I,"stroke")},I))})]})]}),g.jsxs(eA,{children:[g.jsx(tA,{asChild:!0,children:g.jsx(ae,{variant:"outline",size:"icon",title:" ",children:g.jsx(c5,{className:"h-4 w-4"})})}),g.jsxs(E_,{className:"w-auto p-2",children:[g.jsx("p",{className:"text-sm mb-2 font-medium",children:" "}),g.jsxs("div",{className:"grid grid-cols-5 gap-1",children:[g.jsx("button",{className:"w-6 h-6 rounded border border-gray-300 hover:scale-110 transition-transform bg-white relative",onClick:()=>P("transparent","fill"),children:g.jsx("span",{className:"absolute inset-0 flex items-center justify-center text-red-500 text-xs",children:""})}),nA.map(I=>g.jsx("button",{className:"w-6 h-6 rounded border border-gray-300 hover:scale-110 transition-transform",style:{backgroundColor:I},onClick:()=>P(I,"fill")},I))]})]})]})]}),g.jsxs("div",{className:"flex gap-1 border-l pl-2 ml-2",children:[g.jsx(ae,{variant:"outline",size:"icon",onClick:()=>N(-15),title:" ",children:g.jsx(d5,{className:"h-4 w-4"})}),g.jsx(ae,{variant:"outline",size:"icon",onClick:()=>N(15),title:" ",children:g.jsx(f5,{className:"h-4 w-4"})}),g.jsx(ae,{variant:"outline",size:"icon",onClick:S,title:"",children:g.jsx(l5,{className:"h-4 w-4"})}),g.jsx(ae,{variant:"outline",size:"icon",onClick:T,title:"",children:g.jsx(a5,{className:"h-4 w-4"})})]}),g.jsxs("div",{className:"flex gap-1",children:[g.jsx(ae,{variant:"destructive",size:"icon",onClick:j,title:"",children:g.jsx(Rh,{className:"h-4 w-4"})}),g.jsx(ae,{variant:"outline",size:"sm",onClick:R,children:" "})]})]}),g.jsxs("div",{ref:s,className:"p-4 bg-gray-100 flex flex-col items-center overflow-auto",children:[g.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"   (Ctrl+V)    "}),g.jsx("div",{className:"border border-gray-300 shadow-md",children:g.jsx("canvas",{ref:r})})]}),g.jsxs("div",{className:"p-3 border-t flex justify-end gap-2 bg-muted",children:[g.jsx(ae,{variant:"outline",onClick:e,children:""}),g.jsx(ae,{onClick:D,children:"  "})]})]})}):null};function rA(n,[e,t]){return Math.min(t,Math.max(e,n))}var CJ=C.createContext(void 0);function kJ(n){const e=C.useContext(CJ);return n||e||"ltr"}function AJ(n){const e=C.useRef({value:n,previous:n});return C.useMemo(()=>(e.current.value!==n&&(e.current.previous=e.current.value,e.current.value=n),e.current.previous),[n])}var PJ=[" ","Enter","ArrowUp","ArrowDown"],IJ=[" ","Enter"],Ba="Select",[Sy,Ey,RJ]=OI(Ba),[ou,jZ]=Lc(Ba,[RJ,$c]),Ty=$c(),[OJ,zo]=ou(Ba),[NJ,jJ]=ou(Ba),wM=n=>{const{__scopeSelect:e,children:t,open:r,defaultOpen:s,onOpenChange:i,value:o,defaultValue:a,onValueChange:l,dir:c,name:u,autoComplete:h,disabled:f,required:p,form:y}=n,m=Ty(e),[v,w]=C.useState(null),[_,x]=C.useState(null),[A,j]=C.useState(!1),N=kJ(c),[S,T]=gg({prop:r,defaultProp:s??!1,onChange:i,caller:Ba}),[P,R]=gg({prop:o,defaultProp:a,onChange:l,caller:Ba}),D=C.useRef(null),I=v?y||!!v.closest("form"):!0,[k,F]=C.useState(new Set),K=Array.from(k).map(G=>G.props.value).join(";");return g.jsx(UR,{...m,children:g.jsxs(OJ,{required:p,scope:e,trigger:v,onTriggerChange:w,valueNode:_,onValueNodeChange:x,valueNodeHasChildren:A,onValueNodeHasChildrenChange:j,contentId:km(),value:P,onValueChange:R,open:S,onOpenChange:T,dir:N,triggerPointerDownPosRef:D,disabled:f,children:[g.jsx(Sy.Provider,{scope:e,children:g.jsx(NJ,{scope:n.__scopeSelect,onNativeOptionAdd:C.useCallback(G=>{F(Y=>new Set(Y).add(G))},[]),onNativeOptionRemove:C.useCallback(G=>{F(Y=>{const V=new Set(Y);return V.delete(G),V})},[]),children:t})}),I?g.jsxs(zM,{"aria-hidden":!0,required:p,tabIndex:-1,name:u,autoComplete:h,value:P,onChange:G=>R(G.target.value),disabled:f,form:y,children:[P===void 0?g.jsx("option",{value:""}):null,Array.from(k)]},K):null]})})};wM.displayName=Ba;var _M="SelectTrigger",xM=C.forwardRef((n,e)=>{const{__scopeSelect:t,disabled:r=!1,...s}=n,i=Ty(t),o=zo(_M,t),a=o.disabled||r,l=ot(e,o.onTriggerChange),c=Ey(t),u=C.useRef("touch"),[h,f,p]=HM(m=>{const v=c().filter(x=>!x.disabled),w=v.find(x=>x.value===o.value),_=qM(v,m,w);_!==void 0&&o.onValueChange(_.value)}),y=m=>{a||(o.onOpenChange(!0),p()),m&&(o.triggerPointerDownPosRef.current={x:Math.round(m.pageX),y:Math.round(m.pageY)})};return g.jsx(Rm,{asChild:!0,...i,children:g.jsx(Ve.button,{type:"button",role:"combobox","aria-controls":o.contentId,"aria-expanded":o.open,"aria-required":o.required,"aria-autocomplete":"none",dir:o.dir,"data-state":o.open?"open":"closed",disabled:a,"data-disabled":a?"":void 0,"data-placeholder":WM(o.value)?"":void 0,...s,ref:l,onClick:Se(s.onClick,m=>{m.currentTarget.focus(),u.current!=="mouse"&&y(m)}),onPointerDown:Se(s.onPointerDown,m=>{u.current=m.pointerType;const v=m.target;v.hasPointerCapture(m.pointerId)&&v.releasePointerCapture(m.pointerId),m.button===0&&m.ctrlKey===!1&&m.pointerType==="mouse"&&(y(m),m.preventDefault())}),onKeyDown:Se(s.onKeyDown,m=>{const v=h.current!=="";!(m.ctrlKey||m.altKey||m.metaKey)&&m.key.length===1&&f(m.key),!(v&&m.key===" ")&&PJ.includes(m.key)&&(y(),m.preventDefault())})})})});xM.displayName=_M;var bM="SelectValue",SM=C.forwardRef((n,e)=>{const{__scopeSelect:t,className:r,style:s,children:i,placeholder:o="",...a}=n,l=zo(bM,t),{onValueNodeHasChildrenChange:c}=l,u=i!==void 0,h=ot(e,l.onValueNodeChange);return Jt(()=>{c(u)},[c,u]),g.jsx(Ve.span,{...a,ref:h,style:{pointerEvents:"none"},children:WM(l.value)?g.jsx(g.Fragment,{children:o}):i})});SM.displayName=bM;var DJ="SelectIcon",EM=C.forwardRef((n,e)=>{const{__scopeSelect:t,children:r,...s}=n;return g.jsx(Ve.span,{"aria-hidden":!0,...s,ref:e,children:r||""})});EM.displayName=DJ;var MJ="SelectPortal",TM=n=>g.jsx(Sm,{asChild:!0,...n});TM.displayName=MJ;var za="SelectContent",CM=C.forwardRef((n,e)=>{const t=zo(za,n.__scopeSelect),[r,s]=C.useState();if(Jt(()=>{s(new DocumentFragment)},[]),!t.open){const i=r;return i?qa.createPortal(g.jsx(kM,{scope:n.__scopeSelect,children:g.jsx(Sy.Slot,{scope:n.__scopeSelect,children:g.jsx("div",{children:n.children})})}),i):null}return g.jsx(AM,{...n,ref:e})});CM.displayName=za;var Pr=10,[kM,Wo]=ou(za),LJ="SelectContentImpl",FJ=wc("SelectContent.RemoveScroll"),AM=C.forwardRef((n,e)=>{const{__scopeSelect:t,position:r="item-aligned",onCloseAutoFocus:s,onEscapeKeyDown:i,onPointerDownOutside:o,side:a,sideOffset:l,align:c,alignOffset:u,arrowPadding:h,collisionBoundary:f,collisionPadding:p,sticky:y,hideWhenDetached:m,avoidCollisions:v,...w}=n,_=zo(za,t),[x,A]=C.useState(null),[j,N]=C.useState(null),S=ot(e,Z=>A(Z)),[T,P]=C.useState(null),[R,D]=C.useState(null),I=Ey(t),[k,F]=C.useState(!1),K=C.useRef(!1);C.useEffect(()=>{if(x)return tM(x)},[x]),JD();const G=C.useCallback(Z=>{const[Re,...ze]=I().map(Oe=>Oe.ref.current),[xe]=ze.slice(-1),ke=document.activeElement;for(const Oe of Z)if(Oe===ke||(Oe==null||Oe.scrollIntoView({block:"nearest"}),Oe===Re&&j&&(j.scrollTop=0),Oe===xe&&j&&(j.scrollTop=j.scrollHeight),Oe==null||Oe.focus(),document.activeElement!==ke))return},[I,j]),Y=C.useCallback(()=>G([T,x]),[G,T,x]);C.useEffect(()=>{k&&Y()},[k,Y]);const{onOpenChange:V,triggerPointerDownPosRef:z}=_;C.useEffect(()=>{if(x){let Z={x:0,y:0};const Re=xe=>{var ke,Oe;Z={x:Math.abs(Math.round(xe.pageX)-(((ke=z.current)==null?void 0:ke.x)??0)),y:Math.abs(Math.round(xe.pageY)-(((Oe=z.current)==null?void 0:Oe.y)??0))}},ze=xe=>{Z.x<=10&&Z.y<=10?xe.preventDefault():x.contains(xe.target)||V(!1),document.removeEventListener("pointermove",Re),z.current=null};return z.current!==null&&(document.addEventListener("pointermove",Re),document.addEventListener("pointerup",ze,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",Re),document.removeEventListener("pointerup",ze,{capture:!0})}}},[x,V,z]),C.useEffect(()=>{const Z=()=>V(!1);return window.addEventListener("blur",Z),window.addEventListener("resize",Z),()=>{window.removeEventListener("blur",Z),window.removeEventListener("resize",Z)}},[V]);const[Q,ue]=HM(Z=>{const Re=I().filter(ke=>!ke.disabled),ze=Re.find(ke=>ke.ref.current===document.activeElement),xe=qM(Re,Z,ze);xe&&setTimeout(()=>xe.ref.current.focus())}),oe=C.useCallback((Z,Re,ze)=>{const xe=!K.current&&!ze;(_.value!==void 0&&_.value===Re||xe)&&(P(Z),xe&&(K.current=!0))},[_.value]),fe=C.useCallback(()=>x==null?void 0:x.focus(),[x]),ce=C.useCallback((Z,Re,ze)=>{const xe=!K.current&&!ze;(_.value!==void 0&&_.value===Re||xe)&&D(Z)},[_.value]),Ne=r==="popper"?T_:PM,je=Ne===T_?{side:a,sideOffset:l,align:c,alignOffset:u,arrowPadding:h,collisionBoundary:f,collisionPadding:p,sticky:y,hideWhenDetached:m,avoidCollisions:v}:{};return g.jsx(kM,{scope:t,content:x,viewport:j,onViewportChange:N,itemRefCallback:oe,selectedItem:T,onItemLeave:fe,itemTextRefCallback:ce,focusSelectedItem:Y,selectedItemText:R,position:r,isPositioned:k,searchRef:Q,children:g.jsx(g1,{as:FJ,allowPinchZoom:!0,children:g.jsx(p1,{asChild:!0,trapped:_.open,onMountAutoFocus:Z=>{Z.preventDefault()},onUnmountAutoFocus:Se(s,Z=>{var Re;(Re=_.trigger)==null||Re.focus({preventScroll:!0}),Z.preventDefault()}),children:g.jsx(dd,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:Z=>Z.preventDefault(),onDismiss:()=>_.onOpenChange(!1),children:g.jsx(Ne,{role:"listbox",id:_.contentId,"data-state":_.open?"open":"closed",dir:_.dir,onContextMenu:Z=>Z.preventDefault(),...w,...je,onPlaced:()=>F(!0),ref:S,style:{display:"flex",flexDirection:"column",outline:"none",...w.style},onKeyDown:Se(w.onKeyDown,Z=>{const Re=Z.ctrlKey||Z.altKey||Z.metaKey;if(Z.key==="Tab"&&Z.preventDefault(),!Re&&Z.key.length===1&&ue(Z.key),["ArrowUp","ArrowDown","Home","End"].includes(Z.key)){let xe=I().filter(ke=>!ke.disabled).map(ke=>ke.ref.current);if(["ArrowUp","End"].includes(Z.key)&&(xe=xe.slice().reverse()),["ArrowUp","ArrowDown"].includes(Z.key)){const ke=Z.target,Oe=xe.indexOf(ke);xe=xe.slice(Oe+1)}setTimeout(()=>G(xe)),Z.preventDefault()}})})})})})})});AM.displayName=LJ;var VJ="SelectItemAlignedPosition",PM=C.forwardRef((n,e)=>{const{__scopeSelect:t,onPlaced:r,...s}=n,i=zo(za,t),o=Wo(za,t),[a,l]=C.useState(null),[c,u]=C.useState(null),h=ot(e,S=>u(S)),f=Ey(t),p=C.useRef(!1),y=C.useRef(!0),{viewport:m,selectedItem:v,selectedItemText:w,focusSelectedItem:_}=o,x=C.useCallback(()=>{if(i.trigger&&i.valueNode&&a&&c&&m&&v&&w){const S=i.trigger.getBoundingClientRect(),T=c.getBoundingClientRect(),P=i.valueNode.getBoundingClientRect(),R=w.getBoundingClientRect();if(i.dir!=="rtl"){const ke=R.left-T.left,Oe=P.left-ke,bt=S.left-Oe,dn=S.width+bt,Os=Math.max(dn,T.width),rr=window.innerWidth-Pr,_r=rA(Oe,[Pr,Math.max(Pr,rr-Os)]);a.style.minWidth=dn+"px",a.style.left=_r+"px"}else{const ke=T.right-R.right,Oe=window.innerWidth-P.right-ke,bt=window.innerWidth-S.right-Oe,dn=S.width+bt,Os=Math.max(dn,T.width),rr=window.innerWidth-Pr,_r=rA(Oe,[Pr,Math.max(Pr,rr-Os)]);a.style.minWidth=dn+"px",a.style.right=_r+"px"}const D=f(),I=window.innerHeight-Pr*2,k=m.scrollHeight,F=window.getComputedStyle(c),K=parseInt(F.borderTopWidth,10),G=parseInt(F.paddingTop,10),Y=parseInt(F.borderBottomWidth,10),V=parseInt(F.paddingBottom,10),z=K+G+k+V+Y,Q=Math.min(v.offsetHeight*5,z),ue=window.getComputedStyle(m),oe=parseInt(ue.paddingTop,10),fe=parseInt(ue.paddingBottom,10),ce=S.top+S.height/2-Pr,Ne=I-ce,je=v.offsetHeight/2,Z=v.offsetTop+je,Re=K+G+Z,ze=z-Re;if(Re<=ce){const ke=D.length>0&&v===D[D.length-1].ref.current;a.style.bottom="0px";const Oe=c.clientHeight-m.offsetTop-m.offsetHeight,bt=Math.max(Ne,je+(ke?fe:0)+Oe+Y),dn=Re+bt;a.style.height=dn+"px"}else{const ke=D.length>0&&v===D[0].ref.current;a.style.top="0px";const bt=Math.max(ce,K+m.offsetTop+(ke?oe:0)+je)+ze;a.style.height=bt+"px",m.scrollTop=Re-ce+m.offsetTop}a.style.margin=`${Pr}px 0`,a.style.minHeight=Q+"px",a.style.maxHeight=I+"px",r==null||r(),requestAnimationFrame(()=>p.current=!0)}},[f,i.trigger,i.valueNode,a,c,m,v,w,i.dir,r]);Jt(()=>x(),[x]);const[A,j]=C.useState();Jt(()=>{c&&j(window.getComputedStyle(c).zIndex)},[c]);const N=C.useCallback(S=>{S&&y.current===!0&&(x(),_==null||_(),y.current=!1)},[x,_]);return g.jsx($J,{scope:t,contentWrapper:a,shouldExpandOnScrollRef:p,onScrollButtonChange:N,children:g.jsx("div",{ref:l,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:A},children:g.jsx(Ve.div,{...s,ref:h,style:{boxSizing:"border-box",maxHeight:"100%",...s.style}})})})});PM.displayName=VJ;var UJ="SelectPopperPosition",T_=C.forwardRef((n,e)=>{const{__scopeSelect:t,align:r="start",collisionPadding:s=Pr,...i}=n,o=Ty(t);return g.jsx(Bx,{...o,...i,ref:e,align:r,collisionPadding:s,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});T_.displayName=UJ;var[$J,y1]=ou(za,{}),C_="SelectViewport",IM=C.forwardRef((n,e)=>{const{__scopeSelect:t,nonce:r,...s}=n,i=Wo(C_,t),o=y1(C_,t),a=ot(e,i.onViewportChange),l=C.useRef(0);return g.jsxs(g.Fragment,{children:[g.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),g.jsx(Sy.Slot,{scope:t,children:g.jsx(Ve.div,{"data-radix-select-viewport":"",role:"presentation",...s,ref:a,style:{position:"relative",flex:1,overflow:"hidden auto",...s.style},onScroll:Se(s.onScroll,c=>{const u=c.currentTarget,{contentWrapper:h,shouldExpandOnScrollRef:f}=o;if(f!=null&&f.current&&h){const p=Math.abs(l.current-u.scrollTop);if(p>0){const y=window.innerHeight-Pr*2,m=parseFloat(h.style.minHeight),v=parseFloat(h.style.height),w=Math.max(m,v);if(w<y){const _=w+p,x=Math.min(y,_),A=_-x;h.style.height=x+"px",h.style.bottom==="0px"&&(u.scrollTop=A>0?A:0,h.style.justifyContent="flex-end")}}}l.current=u.scrollTop})})})]})});IM.displayName=C_;var RM="SelectGroup",[BJ,zJ]=ou(RM),WJ=C.forwardRef((n,e)=>{const{__scopeSelect:t,...r}=n,s=km();return g.jsx(BJ,{scope:t,id:s,children:g.jsx(Ve.div,{role:"group","aria-labelledby":s,...r,ref:e})})});WJ.displayName=RM;var OM="SelectLabel",NM=C.forwardRef((n,e)=>{const{__scopeSelect:t,...r}=n,s=zJ(OM,t);return g.jsx(Ve.div,{id:s.id,...r,ref:e})});NM.displayName=OM;var om="SelectItem",[HJ,jM]=ou(om),DM=C.forwardRef((n,e)=>{const{__scopeSelect:t,value:r,disabled:s=!1,textValue:i,...o}=n,a=zo(om,t),l=Wo(om,t),c=a.value===r,[u,h]=C.useState(i??""),[f,p]=C.useState(!1),y=ot(e,_=>{var x;return(x=l.itemRefCallback)==null?void 0:x.call(l,_,r,s)}),m=km(),v=C.useRef("touch"),w=()=>{s||(a.onValueChange(r),a.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return g.jsx(HJ,{scope:t,value:r,disabled:s,textId:m,isSelected:c,onItemTextChange:C.useCallback(_=>{h(x=>x||((_==null?void 0:_.textContent)??"").trim())},[]),children:g.jsx(Sy.ItemSlot,{scope:t,value:r,disabled:s,textValue:u,children:g.jsx(Ve.div,{role:"option","aria-labelledby":m,"data-highlighted":f?"":void 0,"aria-selected":c&&f,"data-state":c?"checked":"unchecked","aria-disabled":s||void 0,"data-disabled":s?"":void 0,tabIndex:s?void 0:-1,...o,ref:y,onFocus:Se(o.onFocus,()=>p(!0)),onBlur:Se(o.onBlur,()=>p(!1)),onClick:Se(o.onClick,()=>{v.current!=="mouse"&&w()}),onPointerUp:Se(o.onPointerUp,()=>{v.current==="mouse"&&w()}),onPointerDown:Se(o.onPointerDown,_=>{v.current=_.pointerType}),onPointerMove:Se(o.onPointerMove,_=>{var x;v.current=_.pointerType,s?(x=l.onItemLeave)==null||x.call(l):v.current==="mouse"&&_.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Se(o.onPointerLeave,_=>{var x;_.currentTarget===document.activeElement&&((x=l.onItemLeave)==null||x.call(l))}),onKeyDown:Se(o.onKeyDown,_=>{var A;((A=l.searchRef)==null?void 0:A.current)!==""&&_.key===" "||(IJ.includes(_.key)&&w(),_.key===" "&&_.preventDefault())})})})})});DM.displayName=om;var Hu="SelectItemText",MM=C.forwardRef((n,e)=>{const{__scopeSelect:t,className:r,style:s,...i}=n,o=zo(Hu,t),a=Wo(Hu,t),l=jM(Hu,t),c=jJ(Hu,t),[u,h]=C.useState(null),f=ot(e,w=>h(w),l.onItemTextChange,w=>{var _;return(_=a.itemTextRefCallback)==null?void 0:_.call(a,w,l.value,l.disabled)}),p=u==null?void 0:u.textContent,y=C.useMemo(()=>g.jsx("option",{value:l.value,disabled:l.disabled,children:p},l.value),[l.disabled,l.value,p]),{onNativeOptionAdd:m,onNativeOptionRemove:v}=c;return Jt(()=>(m(y),()=>v(y)),[m,v,y]),g.jsxs(g.Fragment,{children:[g.jsx(Ve.span,{id:l.textId,...i,ref:f}),l.isSelected&&o.valueNode&&!o.valueNodeHasChildren?qa.createPortal(i.children,o.valueNode):null]})});MM.displayName=Hu;var LM="SelectItemIndicator",FM=C.forwardRef((n,e)=>{const{__scopeSelect:t,...r}=n;return jM(LM,t).isSelected?g.jsx(Ve.span,{"aria-hidden":!0,...r,ref:e}):null});FM.displayName=LM;var k_="SelectScrollUpButton",VM=C.forwardRef((n,e)=>{const t=Wo(k_,n.__scopeSelect),r=y1(k_,n.__scopeSelect),[s,i]=C.useState(!1),o=ot(e,r.onScrollButtonChange);return Jt(()=>{if(t.viewport&&t.isPositioned){let a=function(){const c=l.scrollTop>0;i(c)};const l=t.viewport;return a(),l.addEventListener("scroll",a),()=>l.removeEventListener("scroll",a)}},[t.viewport,t.isPositioned]),s?g.jsx($M,{...n,ref:o,onAutoScroll:()=>{const{viewport:a,selectedItem:l}=t;a&&l&&(a.scrollTop=a.scrollTop-l.offsetHeight)}}):null});VM.displayName=k_;var A_="SelectScrollDownButton",UM=C.forwardRef((n,e)=>{const t=Wo(A_,n.__scopeSelect),r=y1(A_,n.__scopeSelect),[s,i]=C.useState(!1),o=ot(e,r.onScrollButtonChange);return Jt(()=>{if(t.viewport&&t.isPositioned){let a=function(){const c=l.scrollHeight-l.clientHeight,u=Math.ceil(l.scrollTop)<c;i(u)};const l=t.viewport;return a(),l.addEventListener("scroll",a),()=>l.removeEventListener("scroll",a)}},[t.viewport,t.isPositioned]),s?g.jsx($M,{...n,ref:o,onAutoScroll:()=>{const{viewport:a,selectedItem:l}=t;a&&l&&(a.scrollTop=a.scrollTop+l.offsetHeight)}}):null});UM.displayName=A_;var $M=C.forwardRef((n,e)=>{const{__scopeSelect:t,onAutoScroll:r,...s}=n,i=Wo("SelectScrollButton",t),o=C.useRef(null),a=Ey(t),l=C.useCallback(()=>{o.current!==null&&(window.clearInterval(o.current),o.current=null)},[]);return C.useEffect(()=>()=>l(),[l]),Jt(()=>{var u;const c=a().find(h=>h.ref.current===document.activeElement);(u=c==null?void 0:c.ref.current)==null||u.scrollIntoView({block:"nearest"})},[a]),g.jsx(Ve.div,{"aria-hidden":!0,...s,ref:e,style:{flexShrink:0,...s.style},onPointerDown:Se(s.onPointerDown,()=>{o.current===null&&(o.current=window.setInterval(r,50))}),onPointerMove:Se(s.onPointerMove,()=>{var c;(c=i.onItemLeave)==null||c.call(i),o.current===null&&(o.current=window.setInterval(r,50))}),onPointerLeave:Se(s.onPointerLeave,()=>{l()})})}),qJ="SelectSeparator",BM=C.forwardRef((n,e)=>{const{__scopeSelect:t,...r}=n;return g.jsx(Ve.div,{"aria-hidden":!0,...r,ref:e})});BM.displayName=qJ;var P_="SelectArrow",GJ=C.forwardRef((n,e)=>{const{__scopeSelect:t,...r}=n,s=Ty(t),i=zo(P_,t),o=Wo(P_,t);return i.open&&o.position==="popper"?g.jsx(zx,{...s,...r,ref:e}):null});GJ.displayName=P_;var KJ="SelectBubbleInput",zM=C.forwardRef(({__scopeSelect:n,value:e,...t},r)=>{const s=C.useRef(null),i=ot(r,s),o=AJ(e);return C.useEffect(()=>{const a=s.current;if(!a)return;const l=window.HTMLSelectElement.prototype,u=Object.getOwnPropertyDescriptor(l,"value").set;if(o!==e&&u){const h=new Event("change",{bubbles:!0});u.call(a,e),a.dispatchEvent(h)}},[o,e]),g.jsx(Ve.select,{...t,style:{...LI,...t.style},ref:i,defaultValue:e})});zM.displayName=KJ;function WM(n){return n===""||n===void 0}function HM(n){const e=Kr(n),t=C.useRef(""),r=C.useRef(0),s=C.useCallback(o=>{const a=t.current+o;e(a),function l(c){t.current=c,window.clearTimeout(r.current),c!==""&&(r.current=window.setTimeout(()=>l(""),1e3))}(a)},[e]),i=C.useCallback(()=>{t.current="",window.clearTimeout(r.current)},[]);return C.useEffect(()=>()=>window.clearTimeout(r.current),[]),[t,s,i]}function qM(n,e,t){const s=e.length>1&&Array.from(e).every(c=>c===e[0])?e[0]:e,i=t?n.indexOf(t):-1;let o=YJ(n,Math.max(i,0));s.length===1&&(o=o.filter(c=>c!==t));const l=o.find(c=>c.textValue.toLowerCase().startsWith(s.toLowerCase()));return l!==t?l:void 0}function YJ(n,e){return n.map((t,r)=>n[(e+r)%n.length])}var XJ=wM,GM=xM,QJ=SM,JJ=EM,ZJ=TM,KM=CM,eZ=IM,YM=NM,XM=DM,tZ=MM,nZ=FM,QM=VM,JM=UM,ZM=BM;const sA=XJ,iA=QJ,I_=C.forwardRef(({className:n,children:e,...t},r)=>g.jsxs(GM,{ref:r,className:Ge("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",n),...t,children:[e,g.jsx(JJ,{asChild:!0,children:g.jsx(oR,{className:"h-4 w-4 opacity-50"})})]}));I_.displayName=GM.displayName;const eL=C.forwardRef(({className:n,...e},t)=>g.jsx(QM,{ref:t,className:Ge("flex cursor-default items-center justify-center py-1",n),...e,children:g.jsx(JV,{className:"h-4 w-4"})}));eL.displayName=QM.displayName;const tL=C.forwardRef(({className:n,...e},t)=>g.jsx(JM,{ref:t,className:Ge("flex cursor-default items-center justify-center py-1",n),...e,children:g.jsx(oR,{className:"h-4 w-4"})}));tL.displayName=JM.displayName;const R_=C.forwardRef(({className:n,children:e,position:t="popper",...r},s)=>g.jsx(ZJ,{children:g.jsxs(KM,{ref:s,className:Ge("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",n),position:t,...r,children:[g.jsx(eL,{}),g.jsx(eZ,{className:Ge("p-1",t==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:e}),g.jsx(tL,{})]})}));R_.displayName=KM.displayName;const rZ=C.forwardRef(({className:n,...e},t)=>g.jsx(YM,{ref:t,className:Ge("py-1.5 pl-8 pr-2 text-sm font-semibold",n),...e}));rZ.displayName=YM.displayName;const O_=C.forwardRef(({className:n,children:e,...t},r)=>g.jsxs(XM,{ref:r,className:Ge("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",n),...t,children:[g.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:g.jsx(nZ,{children:g.jsx(QV,{className:"h-4 w-4"})})}),g.jsx(tZ,{children:e})]}));O_.displayName=XM.displayName;const sZ=C.forwardRef(({className:n,...e},t)=>g.jsx(ZM,{ref:t,className:Ge("-mx-1 my-1 h-px bg-muted",n),...e}));sZ.displayName=ZM.displayName;const d0=({value:n,onChange:e,onRequestShape:t,className:r,placeholder:s,disabled:i=!1})=>{const o=C.useRef(null),a=C.useRef(null),[l,c]=C.useState(null),[u,h]=C.useState(null),f=[{name:"",value:"inherit"},{name:"  ()",value:"'Aref Ruqaa', serif"},{name:"  ()",value:"'Marhey', sans-serif"},{name:" (Cairo)",value:"'Cairo', sans-serif"},{name:" (Tajawal)",value:"'Tajawal', sans-serif"},{name:" (Almarai)",value:"'Almarai', sans-serif"},{name:" (Amiri)",value:"'Amiri', serif"},{name:"  (Naskh)",value:"'Noto Naskh Arabic', serif"},{name:"Arial",value:"Arial"},{name:"Times New Roman",value:"Times New Roman"}],p=[{name:" ",value:"1"},{name:"",value:"2"},{name:"",value:"3"},{name:"",value:"4"},{name:"",value:"5"},{name:" ",value:"6"},{name:"",value:"7"}];C.useEffect(()=>{!i&&o.current&&o.current.innerHTML!==n&&document.activeElement!==o.current&&(o.current.innerHTML=n)},[n,i]),C.useEffect(()=>{const S=P=>{var D,I;const R=P.target;R.tagName==="IMG"&&((D=o.current)!=null&&D.contains(R))?(c(R),m(k=>k+1)):(I=o.current)!=null&&I.contains(R)&&R!==l&&!R.closest(".image-resize-handle")&&c(null)},T=()=>{l&&m(P=>P+1)};return document.addEventListener("click",S),window.addEventListener("scroll",T,!0),window.addEventListener("resize",T),()=>{document.removeEventListener("click",S),window.removeEventListener("scroll",T,!0),window.removeEventListener("resize",T)}},[l,i]);const[y,m]=C.useState(0),v=(S,T)=>{S.preventDefault(),S.stopPropagation(),l&&h({startWidth:l.clientWidth,startHeight:l.clientHeight,startX:S.clientX,startY:S.clientY,direction:T})};C.useEffect(()=>{if(!u||!l)return;const S=P=>{if(!u||!l)return;const R=P.clientX-u.startX,D=P.clientY-u.startY;let I=u.startWidth,k=u.startHeight;u.direction.includes("e")?I=u.startWidth+R:u.direction.includes("w")&&(I=u.startWidth-R),u.direction.includes("s")?k=u.startHeight+D:u.direction.includes("n")&&(k=u.startHeight-D),I>20&&(l.style.width=`${I}px`),k>20&&(l.style.height=`${k}px`),m(F=>F+1)},T=()=>{h(null),w()};return document.addEventListener("mousemove",S),document.addEventListener("mouseup",T),()=>{document.removeEventListener("mousemove",S),document.removeEventListener("mouseup",T)}},[u,l]);const w=()=>{if(o.current){const S=o.current.innerHTML;S!==n&&e(S)}},_=(S,T)=>{var P;document.execCommand(S,!1,T),(P=o.current)==null||P.focus(),w()},x=(S,T,P)=>{S.preventDefault(),_(T,P)},A=S=>{var T;S.preventDefault(),(T=a.current)==null||T.click()},j=S=>{var P;const T=(P=S.target.files)==null?void 0:P[0];if(T){const R=new FileReader;R.onload=D=>{var F,K;const I=(F=D.target)==null?void 0:F.result;(K=o.current)==null||K.focus();const k=`<img src="${I}" style="max-width: 100%; width: 200px; cursor: pointer;" />`;document.execCommand("insertHTML",!1,k),w()},R.readAsDataURL(T)}a.current&&(a.current.value="")};if(i)return g.jsx("div",{className:Ge("prose max-w-none p-2",r),dangerouslySetInnerHTML:{__html:n}});let N=null;if(l&&o.current){const S=o.current.getBoundingClientRect(),T=l.getBoundingClientRect();document.contains(l)&&(N={position:"absolute",top:T.top-S.top+o.current.scrollTop,left:T.left-S.left+o.current.scrollLeft,width:T.width,height:T.height,border:"1px solid #3b82f6",pointerEvents:"none",zIndex:50})}return g.jsxs("div",{className:"border rounded-md shadow-sm bg-white overflow-hidden flex flex-col relative w-full",children:[g.jsx("div",{className:"bg-muted p-1 border-b flex flex-wrap gap-1 items-center min-h-[42px]",children:l?g.jsxs("div",{className:"flex items-center gap-2 w-full animate-in fade-in slide-in-from-top-1",children:[g.jsx("span",{className:"text-xs font-bold text-blue-600 mr-2 uppercase tracking-wider",children:" "}),g.jsx(ae,{variant:"ghost",size:"sm",className:"ml-auto h-7 text-xs font-semibold",onClick:()=>c(null),children:" "}),g.jsx(ae,{variant:"destructive",size:"icon",className:"h-7 w-7",onClick:()=>{l.remove(),c(null),w()},children:g.jsx(Rh,{className:"h-3 w-3"})})]}):g.jsxs(g.Fragment,{children:[g.jsxs(sA,{onValueChange:S=>_("fontName",S),children:[g.jsx(I_,{className:"h-8 w-[140px] bg-white border-gray-300",children:g.jsx(iA,{placeholder:" "})}),g.jsx(R_,{children:f.map(S=>g.jsx(O_,{value:S.value,style:{fontFamily:S.value},children:S.name},S.value))})]}),g.jsxs(sA,{onValueChange:S=>_("fontSize",S),children:[g.jsx(I_,{className:"h-8 w-[100px] bg-white border-gray-300",children:g.jsx(iA,{placeholder:" "})}),g.jsx(R_,{children:p.map(S=>g.jsx(O_,{value:S.value,children:S.name},S.value))})]}),g.jsx("div",{className:"w-px h-6 bg-gray-300 mx-1"}),g.jsx(ae,{variant:"ghost",size:"icon",className:"h-8 w-8",onMouseDown:S=>x(S,"bold"),title:"Bold",children:g.jsx(YV,{className:"h-4 w-4"})}),g.jsx(ae,{variant:"ghost",size:"icon",className:"h-8 w-8",onMouseDown:S=>x(S,"italic"),title:"Italic",children:g.jsx(s5,{className:"h-4 w-4"})}),g.jsx(ae,{variant:"ghost",size:"icon",className:"h-8 w-8",onMouseDown:S=>x(S,"underline"),title:"Underline",children:g.jsx(x5,{className:"h-4 w-4"})}),g.jsx("div",{className:"w-px h-6 bg-gray-300 mx-1"}),g.jsx(ae,{variant:"ghost",size:"icon",className:"h-8 w-8",onMouseDown:S=>x(S,"justifyRight"),title:"Align Right",children:g.jsx(KV,{className:"h-4 w-4"})}),g.jsx(ae,{variant:"ghost",size:"icon",className:"h-8 w-8",onMouseDown:S=>x(S,"justifyCenter"),title:"Align Center",children:g.jsx(qV,{className:"h-4 w-4"})}),g.jsx(ae,{variant:"ghost",size:"icon",className:"h-8 w-8",onMouseDown:S=>x(S,"justifyLeft"),title:"Align Left",children:g.jsx(GV,{className:"h-4 w-4"})}),g.jsx("div",{className:"w-px h-6 bg-gray-300 mx-1"}),g.jsx(ae,{variant:"ghost",size:"icon",className:"h-8 w-8",onMouseDown:A,title:"Insert Image",children:g.jsx(r5,{className:"h-4 w-4"})}),g.jsx("input",{ref:a,type:"file",accept:"image/*",className:"hidden",onChange:j}),t&&g.jsx(ae,{variant:"ghost",size:"icon",className:"h-8 w-8",onMouseDown:S=>{S.preventDefault(),t()},title:"Insert Shape",children:g.jsx(g5,{className:"h-4 w-4"})}),g.jsx("div",{className:"w-px h-6 bg-gray-300 mx-1"}),g.jsx(ae,{variant:"ghost",size:"icon",className:"h-8 w-8 text-destructive hover:text-destructive",onMouseDown:S=>{S.preventDefault(),e("")},title:"Delete All",children:g.jsx(Rh,{className:"h-4 w-4"})})]})}),g.jsxs("div",{className:"relative flex-1 flex flex-col min-h-0 bg-white",children:[g.jsx("div",{ref:o,contentEditable:!i,onInput:w,className:Ge("p-4 min-h-[200px] outline-none max-w-none prose prose-p:my-1 prose-headings:my-2 cursor-text overflow-auto relative","empty:before:content-[attr(data-placeholder)] empty:before:text-muted-foreground",r),"data-placeholder":s,suppressContentEditableWarning:!0,dir:"rtl",style:{minHeight:"200px"}}),N&&g.jsxs("div",{style:N,children:[g.jsx("div",{className:"image-resize-handle absolute -right-1 -top-1 w-2.5 h-2.5 bg-blue-500 border border-white cursor-ne-resize pointer-events-auto rounded-full shadow-sm",onMouseDown:S=>v(S,"ne")}),g.jsx("div",{className:"image-resize-handle absolute -left-1 -top-1 w-2.5 h-2.5 bg-blue-500 border border-white cursor-nw-resize pointer-events-auto rounded-full shadow-sm",onMouseDown:S=>v(S,"nw")}),g.jsx("div",{className:"image-resize-handle absolute -right-1 -bottom-1 w-2.5 h-2.5 bg-blue-500 border border-white cursor-se-resize pointer-events-auto rounded-full shadow-sm",onMouseDown:S=>v(S,"se")}),g.jsx("div",{className:"image-resize-handle absolute -left-1 -bottom-1 w-2.5 h-2.5 bg-blue-500 border border-white cursor-sw-resize pointer-events-auto rounded-full shadow-sm",onMouseDown:S=>v(S,"sw")}),g.jsx("div",{className:"image-resize-handle absolute top-1/2 -translate-y-1/2 -right-1 w-1.5 h-4 bg-blue-500 border border-white cursor-e-resize pointer-events-auto rounded-full shadow-sm",onMouseDown:S=>v(S,"e")}),g.jsx("div",{className:"image-resize-handle absolute top-1/2 -translate-y-1/2 -left-1 w-1.5 h-4 bg-blue-500 border border-white cursor-w-resize pointer-events-auto rounded-full shadow-sm",onMouseDown:S=>v(S,"w")}),g.jsx("div",{className:"image-resize-handle absolute left-1/2 -translate-x-1/2 -bottom-1 h-1.5 w-4 bg-blue-500 border border-white cursor-s-resize pointer-events-auto rounded-full shadow-sm",onMouseDown:S=>v(S,"s")}),g.jsx("div",{className:"image-resize-handle absolute left-1/2 -translate-x-1/2 -top-1 h-1.5 w-4 bg-blue-500 border border-white cursor-n-resize pointer-events-auto rounded-full shadow-sm",onMouseDown:S=>v(S,"n")})]})]})]})},iZ=()=>{var I;const n=vd(),e=yi(),{toast:t}=jo(),{user:r}=Is(),[s,i]=C.useState(!1),[o,a]=C.useState(!1),[l,c]=C.useState(((I=n.state)==null?void 0:I.lessonId)||null),u=k=>k?String(k).replace(/\[:([^\]]+)\]/g,'<img src="$1" style="max-width: 300px; display: inline-block; vertical-align: middle;" />').replace(/\n/g,"<br>"):"",[h,f]=C.useState(()=>{var F;const k=((F=n.state)==null?void 0:F.lessonData)||{};return{...k,preparation:u(k.preparation),presentation:u(k.presentation),evaluation:u(k.evaluation)}}),[p,y]=C.useState(!1),[m,v]=C.useState(null),w=h;if(!w)return g.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:g.jsxs("div",{className:"bg-card p-8 rounded-lg shadow-medium max-w-md text-center",children:[g.jsx("p",{className:"text-muted-foreground mb-4",children:"     .    ."}),g.jsxs(ae,{onClick:()=>e("/"),className:"gap-2",children:[g.jsx(vE,{className:"h-4 w-4"})," "]})]})});const _=()=>{const k=document.getElementById("printable-content");if(k){k.style.width,k.style.width="794px",k.style.zoom="1";const G=k.scrollHeight;let Y=1;G>1080&&(Y=1080/G,Y=Math.floor(Y*100)/100-.01),k.style.zoom=Y.toString(),k.style.width="",document.documentElement.style.setProperty("--print-zoom",Y.toString())}const F=()=>{const K=document.getElementById("printable-content");K&&(K.style.zoom="",K.style.width="",document.documentElement.style.removeProperty("--print-zoom"))};window.addEventListener("afterprint",F,{once:!0}),setTimeout(()=>{window.print()},100)},x=()=>{_()},A=async()=>{if(!r){t({title:"",description:"    ",variant:"destructive"});return}a(!0);try{console.log("Preparing to save lesson. LessonId:",l);const k=JSON.parse(JSON.stringify(h));delete k.id,delete k.createdAt,delete k.updatedAt;const F={...k,title:h.title||" ",userId:r.uid,updatedAt:PC()};if(console.log("Saving payload:",F),l){const K=Qn(_n,"lessons",l);await Kh(K,F),t({title:" ",description:"   "})}else{const K=Rb(_n,"lessons"),G=await Q7(K,{...F,createdAt:PC()});c(G.id),t({title:" ",description:"     "})}}catch(k){console.error("CRITICAL: Error saving lesson:",k);let F="   ";k.code==="permission-denied"?F="  :      (Firebase Rules)  (lessons)":k.message&&(F=k.message),t({title:"  ",description:F,variant:"destructive"})}finally{a(!1)}},j=()=>{s?(i(!1),A()):(i(!0),t({title:" ",description:"     "}))},N=k=>{if(m){const F=`<img src="${k}" style="max-width: 100%; width: 300px; display: inline-block; cursor: pointer;" />`;T(m,(h[m]||"")+F),t({title:" ",description:"  .    ."})}},S=k=>{v(k),y(!0)},T=(k,F)=>{f(K=>({...K,[k]:F}))},P=(k,F)=>{f(K=>{const G=K[k]||[],Y=G.includes(F);return{...K,[k]:Y?G.filter(V=>V!==F):[...G,F]}})},R=(k,F)=>(w[k]||[]).includes(F),D=[" "," "," "," ",""," ",""];return g.jsxs("div",{className:"min-h-screen bg-slate-50 print:bg-white pb-12",dir:"rtl",children:[g.jsx("header",{className:"bg-white/80 backdrop-blur-md border-b print:hidden sticky top-0 z-30 shadow-sm",children:g.jsx("div",{className:"container mx-auto px-4 py-3",children:g.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[g.jsxs(ae,{variant:"ghost",onClick:()=>e("/"),className:"gap-2 h-9 text-slate-600 self-start sm:self-auto",children:[g.jsx(vE,{className:"h-4 w-4"}),""]}),g.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-2 w-full sm:w-auto",children:[g.jsxs(ae,{variant:"outline",size:"sm",onClick:A,disabled:o,className:"gap-2 h-9 border-indigo-100 text-indigo-700 hover:bg-indigo-50",children:[o?g.jsx(i5,{className:"h-4 w-4 animate-spin"}):g.jsx(xE,{className:"h-4 w-4"}),g.jsx("span",{className:"hidden xs:inline",children:o?" ...":" "}),g.jsx("span",{className:"xs:hidden",children:""})]}),g.jsxs(ae,{variant:s?"default":"outline",size:"sm",onClick:j,className:`gap-2 h-9 ${s?"bg-indigo-600 shadow-md shadow-indigo-200":"text-slate-600 border-slate-200"}`,children:[s?g.jsx(xE,{className:"h-4 w-4"}):g.jsx(m5,{className:"h-4 w-4"}),g.jsx("span",{className:"hidden xs:inline",children:s?" ":" "}),g.jsx("span",{className:"xs:hidden",children:""})]}),!s&&g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsxs(ae,{variant:"outline",size:"sm",onClick:_,className:"gap-2 h-9 border-slate-200 text-slate-600",children:[g.jsx(u5,{className:"h-4 w-4"}),g.jsx("span",{className:"hidden md:inline",children:""})]}),g.jsxs(ae,{size:"sm",onClick:x,className:"gap-2 h-9 shadow-md shadow-primary/20 bg-primary",children:[g.jsx(t5,{className:"h-4 w-4"}),g.jsx("span",{className:"hidden md:inline",children:" PDF"})]})]})]})]})})}),g.jsx("main",{className:"container mx-auto px-2 sm:px-4 py-6 md:py-10 max-w-4xl",children:g.jsxs("div",{id:"printable-content",className:"bg-white shadow-premium p-4 sm:p-8 md:p-12 border border-slate-100 rounded-[2rem] mx-auto overflow-hidden transition-all duration-300",children:[g.jsxs("div",{className:"hidden print:block mb-8 text-center border-b pb-6",children:[g.jsx("h1",{className:"text-2xl font-bold text-slate-900 border-none",children:"   "}),g.jsx("p",{className:"text-slate-500 text-sm mt-1 italic",children:"   "})]}),g.jsx("div",{className:"overflow-x-auto -mx-4 px-4 sm:mx-0 sm:px-0 mb-6 scrollbar-thin",children:g.jsx("table",{className:"w-full border-collapse border-2 border-slate-900 text-sm min-w-[600px] sm:min-w-0",children:g.jsx("tbody",{children:["","",""].map((k,F)=>g.jsxs("tr",{children:[g.jsx("td",{className:"border-2 border-slate-900 p-2 w-20 text-center font-bold bg-slate-50 text-slate-800",children:k}),Array.from({length:7}).map((K,G)=>{const Y=`schedule_r${F}_c${G}`;return g.jsx("td",{className:"border-2 border-slate-900 p-2 w-16 text-center",children:s?g.jsx("input",{type:"text",value:w[Y]||"",onChange:V=>T(Y,V.target.value),className:"w-full h-full bg-slate-50/50 rounded border-none outline-none text-center focus:bg-white transition-colors"}):g.jsx("span",{className:"font-medium text-slate-700",children:w[Y]||""})},G)})]},F))})})}),g.jsx("div",{className:"border-2 border-slate-900 mb-6 p-4 rounded-xl bg-slate-50/30",children:g.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3",children:[g.jsx("span",{className:"font-extrabold text-slate-900 whitespace-nowrap text-lg",children:" :"}),g.jsx("div",{className:"flex-1 border-b-2 border-dotted border-slate-400 min-h-[32px] flex items-center",children:s?g.jsx("input",{type:"text",value:w.title||"",onChange:k=>T("title",k.target.value),className:"w-full bg-transparent border-none outline-none text-lg font-bold text-primary focus:text-indigo-700",placeholder:"  ..."}):g.jsx("span",{className:"text-lg font-bold text-primary",children:w.title||" "})})]})}),g.jsxs("div",{className:"border-2 border-slate-900 mb-6 p-4 rounded-xl bg-slate-50/30",children:[g.jsxs("p",{className:"font-extrabold text-slate-900 mb-4 text-base",children:["  : ",g.jsx("span",{className:"text-slate-500 font-medium",children:"         :"})]}),g.jsx("div",{className:"space-y-3",children:[0,1,2].map(k=>g.jsxs("div",{className:"flex items-center gap-3 group",children:[g.jsx("span",{className:"w-6 h-6 rounded-full bg-slate-900 text-white flex items-center justify-center text-xs font-bold leading-none shrink-0",children:k+1}),g.jsx("div",{className:"flex-1 border-b-2 border-dotted border-slate-300 min-h-[28px] flex items-center group-hover:border-primary/30 transition-colors",children:s?g.jsx("input",{type:"text",value:(w.objectives||[])[k]||"",onChange:F=>{const K=[...w.objectives||[]];K[k]=F.target.value,T("objectives",K)},className:"w-full bg-transparent border-none outline-none text-sm font-medium text-slate-700 focus:text-primary transition-colors",placeholder:"  ..."}):g.jsx("span",{className:"text-sm font-medium text-slate-700",children:(w.objectives||[])[k]||"---"})})]},k))})]}),g.jsx("div",{className:"border-2 border-slate-900 mb-6 p-4 rounded-xl bg-slate-50/30",children:g.jsxs("div",{className:"flex flex-col gap-4",children:[g.jsx("span",{className:"font-extrabold text-slate-900 border-b-2 border-slate-200 pb-2",children:"   :"}),g.jsx("div",{className:"flex flex-wrap items-center gap-x-6 gap-y-3",children:D.map(k=>g.jsxs("label",{className:`flex items-center gap-2 cursor-pointer group px-2 py-1 rounded-lg transition-colors ${s?"hover:bg-slate-100":""}`,children:[g.jsxs("div",{className:`w-5 h-5 rounded border-2 flex items-center justify-center transition-all ${R("strategies",k)?"bg-primary border-primary":"border-slate-300"}`,children:[R("strategies",k)&&g.jsx(CheckCircle,{className:"h-3 w-3 text-white"}),g.jsx("input",{type:"checkbox",checked:R("strategies",k),onChange:()=>P("strategies",k),disabled:!s,className:"hidden"})]}),g.jsx("span",{className:`text-sm font-medium ${R("strategies",k)?"text-slate-900 font-bold":"text-slate-500"}`,children:k})]},k))})]})}),g.jsx("div",{className:"overflow-x-auto -mx-2 px-2 sm:mx-0 sm:px-0",children:g.jsx("table",{className:"w-full border-collapse border-2 border-slate-900 text-sm min-w-[500px] sm:min-w-0",children:g.jsxs("tbody",{children:[g.jsx("tr",{children:g.jsxs("td",{className:"border-2 border-slate-900 p-4 align-top bg-white",children:[g.jsxs("div",{className:"font-extrabold text-slate-900 mb-3 flex items-center gap-2",children:[g.jsx(Sparkles,{className:"h-4 w-4 text-amber-500"}),"  :"]}),g.jsx("div",{className:"border-2 border-dotted border-slate-200 p-3 rounded-lg min-h-[80px] hover:border-primary/20 transition-colors",children:g.jsx(d0,{value:w.preparation||"",onChange:k=>T("preparation",k),onRequestShape:()=>S("preparation"),disabled:!s,className:s?"bg-white":"border-none shadow-none p-0 min-h-0",placeholder:"    ..."})})]})}),g.jsx("tr",{children:g.jsxs("td",{className:"border-2 border-slate-900 p-4 align-top bg-slate-50/20",children:[g.jsxs("div",{className:"font-extrabold text-slate-900 mb-3 flex items-center gap-2",children:[g.jsx(BookOpen,{className:"h-4 w-4 text-indigo-600"}),"  :"]}),g.jsx("div",{className:"border-2 border-dotted border-slate-200 p-3 rounded-lg min-h-[200px] bg-white hover:border-primary/20 transition-colors",children:g.jsx(d0,{value:w.presentation||"",onChange:k=>T("presentation",k),onRequestShape:()=>S("presentation"),disabled:!s,className:s?"flex-1 min-h-[300px]":"border-none shadow-none p-0 min-h-0",placeholder:"    ..."})})]})}),g.jsx("tr",{children:g.jsx("td",{className:"border-2 border-slate-900 p-4 align-top bg-white",children:g.jsxs("div",{className:"flex flex-col gap-3",children:[g.jsxs("div",{className:"font-extrabold text-slate-900 flex items-center gap-2",children:[g.jsx(CheckCircle,{className:"h-4 w-4 text-emerald-600"}),"   :"]}),g.jsx("div",{className:"border-2 border-dotted border-slate-200 p-3 rounded-lg min-h-[100px] hover:border-primary/20 transition-colors",children:g.jsx(d0,{value:w.evaluation||"",onChange:k=>T("evaluation",k),onRequestShape:()=>S("evaluation"),disabled:!s,className:s?"min-h-[150px]":"border-none shadow-none p-0 min-h-0",placeholder:"  ..."})})]})})})]})})})]})}),g.jsx(TJ,{isOpen:p,onClose:()=>y(!1),onSave:N}),g.jsx("style",{children:`
        @media print {
          /* General Reset */
          *, *::before, *::after {
            box-sizing: border-box;
            -webkit-print-color-adjust: exact !important;
            print-color-adjust: exact !important;
          }

          body * {
            visibility: hidden;
          }

          /* Print Container */
          #printable-content, #printable-content * {
            visibility: visible;
          }

          html, body {
            height: 100vh;
            width: 100%;
            margin: 0 !important;
            padding: 0 !important;
            overflow: hidden !important; /* Critical for single page */
            background: white !important;
          }
          
          /*    */
          #printable-content {
            font-family: "Traditional Arabic", "Simplified Arabic", "Amiri", serif;
            font-weight: 600;
            line-height: 1.3;
            font-size: 11pt; /* Slightly smaller for better fit */
            direction: rtl;
          }

          #printable-content {
            position: fixed;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            /* Use a slight zoom to fit more content if needed - safe for Chrome/Edge */
            zoom: var(--print-zoom, 0.95); 
            padding: 5mm !important;
            margin: 0 !important;
            border: none !important;
            display: flex;
            flex-direction: column;
            background: white !important;
          }

          /* Top Sections */
          #printable-content > *:not(table:last-of-type) {
            flex-shrink: 0;
            margin-bottom: 4px !important; /* Tighten vertical spacing */
          }
          
          /* Compact Header Inputs/Divs */
          #printable-content .min-h-\\[24px\\] { min-height: auto !important; }
          #printable-content .mb-4 { margin-bottom: 4px !important; }
          #printable-content .p-2 { padding: 2px !important; }

          /* Main Table Container */
          #printable-content > table:last-of-type {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            border: 2px solid black !important;
            margin-top: 2px;
            height: auto !important;
            overflow: hidden; /* Prevent table itself from spilling */
          }

          #printable-content > table:last-of-type tbody {
            display: flex;
            flex-direction: column;
            flex: 1;
            width: 100%;
            overflow: hidden;
          }

          /* Table Rows */
          #printable-content > table:last-of-type tr {
            display: flex;
            width: 100%;
            border-bottom: 1px solid black;
          }
          
          #printable-content > table:last-of-type tr:last-child {
            border-bottom: none;
          }

          /* Titles styling */
          .font-bold {
             font-weight: 800 !important;
             font-size: 12pt !important;
          }
          
          /* First Row: Preparation */
          #printable-content > table:last-of-type tr:first-child {
            flex: 0 0 auto;
          }
          /* Reduce height of Preparation textarea preview */
          #printable-content > table:last-of-type tr:first-child .min-h-\\[60px\\] {
             min-height: 40px !important;
          }

          /* Second Row: Presentation (Expand based on content, but shrinkable if desperate) */
          #printable-content > table:last-of-type tr:nth-child(2) {
             flex: 0 1 auto; /* Allow shrinking if absolutely necessary, but preferred auto */
             min-height: 100px;
             overflow: hidden; /* If it shrinks, clip nicely rather than explode */
          }

          /* Third Row: Evaluation (Fill remaining space) */
          #printable-content > table:last-of-type tr:last-child {
             flex: 1 1 auto;
             min-height: 60px; /* Ensure at least this much is visible */
             display: flex;
             flex-direction: column;
          }

          /* Cells */
          #printable-content > table:last-of-type td,
          #printable-content > table:last-of-type th {
            display: block;
            width: 100%;
            padding: 4px 6px; /* Compact padding */
            border: none !important;
          }

          /* Ensure content inside Evaluation expands */
          #printable-content > table:last-of-type tr:last-child td {
             flex: 1;
             display: flex;
             flex-direction: column;
             height: 100%;
          }
           
          #printable-content > table:last-of-type tr:last-child td > div {
             flex: 1;
             display: flex !important;
             flex-direction: column;
          }
          
          #printable-content > table:last-of-type tr:last-child td > div > div { /* RichTextEditor internal */
             flex: 1;
             height: 100%;
             width: 100%;
             border: none !important;
          }
          
          /* Custom overrides for RichTextEditor in print */
          .prose {
             max-width: none !important;
          }
          .prose img {
             margin: 0 !important;
             max-height: 200px;
          }

          /* General Table Styles */
          table {
            width: 100% !important;
            border-collapse: collapse !important;
          }

          td, th {
             font-size: 11pt !important;
          }
          
          * {
            -webkit-print-color-adjust: exact !important;
            print-color-adjust: exact !important;
          }
          
          @page {
            size: A4;
            margin: 0;
          }
        }
      `})]})},Bs=C.forwardRef(({className:n,type:e,...t},r)=>g.jsx("input",{type:e,className:Ge("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",n),ref:r,...t}));Bs.displayName="Input";var oZ="Label",nL=C.forwardRef((n,e)=>g.jsx(Ve.label,{...n,ref:e,onMouseDown:t=>{var s;t.target.closest("button, input, select, textarea")||((s=n.onMouseDown)==null||s.call(n,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));nL.displayName=oZ;var rL=nL;const aZ=Rx("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),zs=C.forwardRef(({className:n,...e},t)=>g.jsx(rL,{ref:t,className:Ge(aZ(),n),...e}));zs.displayName=rL.displayName;const lZ=()=>{const[n,e]=C.useState(""),[t,r]=C.useState(""),[s,i]=C.useState(!1),[o,a]=C.useState(!1),l=yi(),{signIn:c}=Is(),{toast:u}=jo(),h=async f=>{f.preventDefault(),a(!0);try{await c(n,t),u({title:"   ",description:"   !"}),l("/")}catch(p){u({title:"   ",description:p.message||"      ",variant:"destructive"})}finally{a(!1)}};return g.jsxs("div",{className:"min-h-screen w-full flex items-center justify-center bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 relative overflow-hidden",dir:"rtl",children:[g.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[g.jsx("div",{className:"absolute top-20 right-10 w-72 h-72 bg-purple-300 rounded-full mix-blend-multiply filter blur-xl opacity-30 animate-blob"}),g.jsx("div",{className:"absolute top-40 left-20 w-72 h-72 bg-yellow-300 rounded-full mix-blend-multiply filter blur-xl opacity-30 animate-blob animation-delay-2000"}),g.jsx("div",{className:"absolute -bottom-8 left-40 w-72 h-72 bg-pink-300 rounded-full mix-blend-multiply filter blur-xl opacity-30 animate-blob animation-delay-4000"}),g.jsx("div",{className:"absolute top-32 left-1/4 opacity-10 animate-float",children:g.jsx(yg,{size:80,className:"text-indigo-500"})}),g.jsx("div",{className:"absolute bottom-32 right-1/4 opacity-10 animate-float animation-delay-2000",children:g.jsx(Ui,{size:60,className:"text-purple-500"})})]}),g.jsxs("div",{className:"relative w-full max-w-md mx-4",children:[g.jsxs("div",{className:"bg-white/80 backdrop-blur-lg rounded-3xl shadow-2xl p-8 border border-white/20 transform transition-all duration-300 hover:scale-[1.02]",children:[g.jsxs("div",{className:"text-center mb-8",children:[g.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-2xl mb-4 shadow-lg transform transition-transform hover:rotate-12",children:g.jsx(yg,{size:40,className:"text-white"})}),g.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent mb-2",children:" "}),g.jsx("p",{className:"text-gray-600 text-sm",children:"    "})]}),g.jsxs("form",{onSubmit:h,className:"space-y-6",children:[g.jsxs("div",{className:"space-y-2",children:[g.jsxs(zs,{htmlFor:"email",className:"text-gray-700 font-medium flex items-center gap-2",children:[g.jsx(vg,{size:16,className:"text-indigo-500"})," "]}),g.jsxs("div",{className:"relative",children:[g.jsx(Bs,{id:"email",type:"email",value:n,onChange:f=>e(f.target.value),placeholder:"example@domain.com",required:!0,className:"pr-4 pl-10 h-12 bg-white/50 border-gray-200 focus:border-indigo-500 focus:ring-indigo-500 rounded-xl transition-all",dir:"ltr"}),g.jsx(vg,{size:18,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"})]})]}),g.jsxs("div",{className:"space-y-2",children:[g.jsxs(zs,{htmlFor:"password",className:"text-gray-700 font-medium flex items-center gap-2",children:[g.jsx(dw,{size:16,className:"text-indigo-500"})," "]}),g.jsxs("div",{className:"relative",children:[g.jsx(Bs,{id:"password",type:s?"text":"password",value:t,onChange:f=>r(f.target.value),placeholder:"",required:!0,className:"pr-10 pl-4 h-12 bg-white/50 border-gray-200 focus:border-indigo-500 focus:ring-indigo-500 rounded-xl transition-all",dir:"ltr"}),g.jsx("button",{type:"button",onClick:()=>i(!s),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors",children:s?g.jsx(uw,{size:18}):g.jsx(hw,{size:18})})]})]}),g.jsxs("div",{className:"flex items-center justify-between text-sm",children:[g.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[g.jsx("input",{type:"checkbox",className:"w-4 h-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),g.jsx("span",{className:"text-gray-600",children:""})]}),g.jsx("button",{type:"button",className:"text-indigo-600 hover:text-indigo-700 font-medium transition-colors",children:"  "})]}),g.jsx(ae,{type:"submit",disabled:o,className:"w-full h-12 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white font-semibold rounded-xl shadow-lg hover:shadow-xl transform transition-all duration-200 hover:scale-[1.02] disabled:opacity-50 disabled:cursor-not-allowed",children:o?g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("div",{className:"w-5 h-5 border-2 border-white/20 border-t-white rounded-full animate-spin"}),"  ..."]}):" "})]}),g.jsxs("div",{className:"relative my-6",children:[g.jsx("div",{className:"absolute inset-0 flex items-center",children:g.jsx("div",{className:"w-full border-t border-gray-200"})}),g.jsx("div",{className:"relative flex justify-center text-sm",children:g.jsx("span",{className:"px-4 bg-white/80 text-gray-500",children:""})})]}),g.jsx("div",{className:"text-center",children:g.jsxs("p",{className:"text-gray-600 text-sm",children:["  "," ",g.jsx("button",{type:"button",onClick:()=>l("/signup"),className:"text-indigo-600 hover:text-indigo-700 font-semibold transition-colors",children:" "})]})})]}),g.jsx("p",{className:"text-center mt-6 text-gray-600 text-sm",children:" 2025  .   ."})]}),g.jsx("style",{children:`
        @keyframes blob {
          0%, 100% { transform: translate(0, 0) scale(1); }
          25% { transform: translate(20px, -50px) scale(1.1); }
          50% { transform: translate(-20px, 20px) scale(0.9); }
          75% { transform: translate(50px, 50px) scale(1.05); }
        }
        
        @keyframes float {
          0%, 100% { transform: translateY(0px); }
          50% { transform: translateY(-20px); }
        }
        
        .animate-blob {
          animation: blob 7s infinite;
        }
        
        .animation-delay-2000 {
          animation-delay: 2s;
        }
        
        .animation-delay-4000 {
          animation-delay: 4s;
        }
        
        .animate-float {
          animation: float 6s ease-in-out infinite;
        }
      `})]})},cZ=()=>{const[n,e]=C.useState({teacherName:"",subject:"",phone:"",email:"",password:"",confirmPassword:""}),[t,r]=C.useState(!1),[s,i]=C.useState(!1),[o,a]=C.useState(!1),l=yi(),{signUp:c}=Is(),{toast:u}=jo(),h=p=>{e(y=>({...y,[p.target.name]:p.target.value}))},f=async p=>{if(p.preventDefault(),n.password!==n.confirmPassword){u({title:"   ",description:"      ",variant:"destructive"});return}if(n.password.length<6){u({title:"  ",description:"     6   ",variant:"destructive"});return}if(!n.teacherName.trim()||!n.subject.trim()||!n.phone.trim()){u({title:" ",description:"    ",variant:"destructive"});return}a(!0);try{console.log("Starting signup process...");const y=await c(n.email,n.password);console.log("User created in Auth:",y.user.uid);try{console.log("Saving user data to Firestore..."),await X7(Qn(_n,"users",y.user.uid),{teacherName:n.teacherName,subject:n.subject,phone:n.phone,email:n.email,role:"user",status:"pending",createdAt:new Date().toISOString()}),console.log("User data saved successfully"),u({title:"  ",description:"     "})}catch(m){console.error("Firestore error:",m),console.error("Error code:",m.code),console.error("Error message:",m.message)}setTimeout(()=>{l("/")},500)}catch(y){console.error("Signup error:",y),console.error("Error code:",y.code),console.error("Error message:",y.message);let m="    ";y.code==="auth/email-already-in-use"?m="    ":y.code==="auth/invalid-email"?m="   ":y.code==="auth/weak-password"?m="   ":y.message&&(m=y.message),u({title:"  ",description:m,variant:"destructive"})}finally{a(!1)}};return g.jsxs("div",{className:"min-h-screen w-full flex items-center justify-center bg-gradient-to-br from-emerald-50 via-teal-50 to-cyan-50 relative overflow-hidden",dir:"rtl",children:[g.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[g.jsx("div",{className:"absolute top-20 right-10 w-72 h-72 bg-emerald-300 rounded-full mix-blend-multiply filter blur-xl opacity-30 animate-blob"}),g.jsx("div",{className:"absolute top-40 left-20 w-72 h-72 bg-cyan-300 rounded-full mix-blend-multiply filter blur-xl opacity-30 animate-blob animation-delay-2000"}),g.jsx("div",{className:"absolute -bottom-8 left-40 w-72 h-72 bg-teal-300 rounded-full mix-blend-multiply filter blur-xl opacity-30 animate-blob animation-delay-4000"}),g.jsx("div",{className:"absolute top-32 left-1/4 opacity-10 animate-float",children:g.jsx(yg,{size:80,className:"text-emerald-500"})}),g.jsx("div",{className:"absolute bottom-32 right-1/4 opacity-10 animate-float animation-delay-2000",children:g.jsx(Ui,{size:60,className:"text-teal-500"})})]}),g.jsxs("div",{className:"relative w-full max-w-md mx-4",children:[g.jsxs("div",{className:"bg-white/80 backdrop-blur-lg rounded-3xl shadow-2xl p-8 border border-white/20 transform transition-all duration-300 hover:scale-[1.02]",children:[g.jsxs("div",{className:"text-center mb-6",children:[g.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-emerald-500 to-teal-600 rounded-2xl mb-4 shadow-lg transform transition-transform hover:rotate-12",children:g.jsx(yg,{size:40,className:"text-white"})}),g.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-emerald-600 to-teal-600 bg-clip-text text-transparent mb-2",children:"  "}),g.jsx("p",{className:"text-gray-600 text-sm",children:"    "})]}),g.jsxs("form",{onSubmit:f,className:"space-y-4",children:[g.jsxs("div",{className:"space-y-2",children:[g.jsxs(zs,{htmlFor:"teacherName",className:"text-gray-700 font-medium flex items-center gap-2",children:[g.jsx(fw,{size:16,className:"text-emerald-500"}),"  "]}),g.jsxs("div",{className:"relative",children:[g.jsx(Bs,{id:"teacherName",name:"teacherName",type:"text",value:n.teacherName,onChange:h,placeholder:"  ",required:!0,className:"pr-10 pl-4 h-11 bg-white/50 border-gray-200 focus:border-emerald-500 focus:ring-emerald-500 rounded-xl transition-all"}),g.jsx(fw,{size:18,className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400"})]})]}),g.jsxs("div",{className:"space-y-2",children:[g.jsxs(zs,{htmlFor:"subject",className:"text-gray-700 font-medium flex items-center gap-2",children:[g.jsx(mg,{size:16,className:"text-emerald-500"})," "]}),g.jsxs("div",{className:"relative",children:[g.jsx(Bs,{id:"subject",name:"subject",type:"text",value:n.subject,onChange:h,placeholder:":   ",required:!0,className:"pr-10 pl-4 h-11 bg-white/50 border-gray-200 focus:border-emerald-500 focus:ring-emerald-500 rounded-xl transition-all"}),g.jsx(mg,{size:18,className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400"})]})]}),g.jsxs("div",{className:"space-y-2",children:[g.jsxs(zs,{htmlFor:"phone",className:"text-gray-700 font-medium flex items-center gap-2",children:[g.jsx(_E,{size:16,className:"text-emerald-500"})," "]}),g.jsxs("div",{className:"relative",children:[g.jsx(Bs,{id:"phone",name:"phone",type:"tel",value:n.phone,onChange:h,placeholder:"05xxxxxxxx",required:!0,className:"pr-10 pl-4 h-11 bg-white/50 border-gray-200 focus:border-emerald-500 focus:ring-emerald-500 rounded-xl transition-all",dir:"ltr"}),g.jsx(_E,{size:18,className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400"})]})]}),g.jsxs("div",{className:"space-y-2",children:[g.jsxs(zs,{htmlFor:"email",className:"text-gray-700 font-medium flex items-center gap-2",children:[g.jsx(vg,{size:16,className:"text-emerald-500"})," "]}),g.jsxs("div",{className:"relative",children:[g.jsx(Bs,{id:"email",name:"email",type:"email",value:n.email,onChange:h,placeholder:"example@domain.com",required:!0,className:"pr-4 pl-10 h-11 bg-white/50 border-gray-200 focus:border-emerald-500 focus:ring-emerald-500 rounded-xl transition-all",dir:"ltr"}),g.jsx(vg,{size:18,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"})]})]}),g.jsxs("div",{className:"space-y-2",children:[g.jsxs(zs,{htmlFor:"password",className:"text-gray-700 font-medium flex items-center gap-2",children:[g.jsx(dw,{size:16,className:"text-emerald-500"})," "]}),g.jsxs("div",{className:"relative",children:[g.jsx(Bs,{id:"password",name:"password",type:t?"text":"password",value:n.password,onChange:h,placeholder:"",required:!0,className:"pr-10 pl-4 h-11 bg-white/50 border-gray-200 focus:border-emerald-500 focus:ring-emerald-500 rounded-xl transition-all",dir:"ltr"}),g.jsx("button",{type:"button",onClick:()=>r(!t),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors",children:t?g.jsx(uw,{size:18}):g.jsx(hw,{size:18})})]}),g.jsxs("p",{className:"text-xs text-gray-500 flex items-center gap-1",children:[g.jsx(ZV,{size:12}),"   6   "]})]}),g.jsxs("div",{className:"space-y-2",children:[g.jsxs(zs,{htmlFor:"confirmPassword",className:"text-gray-700 font-medium flex items-center gap-2",children:[g.jsx(dw,{size:16,className:"text-emerald-500"}),"  "]}),g.jsxs("div",{className:"relative",children:[g.jsx(Bs,{id:"confirmPassword",name:"confirmPassword",type:s?"text":"password",value:n.confirmPassword,onChange:h,placeholder:"",required:!0,className:"pr-10 pl-4 h-11 bg-white/50 border-gray-200 focus:border-emerald-500 focus:ring-emerald-500 rounded-xl transition-all",dir:"ltr"}),g.jsx("button",{type:"button",onClick:()=>i(!s),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors",children:s?g.jsx(uw,{size:18}):g.jsx(hw,{size:18})})]})]}),g.jsxs("div",{className:"flex items-start gap-2 text-sm pt-2",children:[g.jsx("input",{type:"checkbox",required:!0,className:"w-4 h-4 mt-0.5 rounded border-gray-300 text-emerald-600 focus:ring-emerald-500"}),g.jsx("span",{className:"text-gray-600",children:"     "})]}),g.jsx(ae,{type:"submit",disabled:o,className:"w-full h-12 bg-gradient-to-r from-emerald-600 to-teal-600 hover:from-emerald-700 hover:to-teal-700 text-white font-semibold rounded-xl shadow-lg hover:shadow-xl transform transition-all duration-200 hover:scale-[1.02] disabled:opacity-50 disabled:cursor-not-allowed",children:o?g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("div",{className:"w-5 h-5 border-2 border-white/20 border-t-white rounded-full animate-spin"}),"  ..."]}):" "})]}),g.jsxs("div",{className:"relative my-6",children:[g.jsx("div",{className:"absolute inset-0 flex items-center",children:g.jsx("div",{className:"w-full border-t border-gray-200"})}),g.jsx("div",{className:"relative flex justify-center text-sm",children:g.jsx("span",{className:"px-4 bg-white/80 text-gray-500",children:""})})]}),g.jsx("div",{className:"text-center",children:g.jsxs("p",{className:"text-gray-600 text-sm",children:["  "," ",g.jsx("button",{type:"button",onClick:()=>l("/login"),className:"text-emerald-600 hover:text-emerald-700 font-semibold transition-colors",children:" "})]})})]}),g.jsx("p",{className:"text-center mt-6 text-gray-600 text-sm",children:" 2025   .   ."})]}),g.jsx("style",{children:`
        @keyframes blob {
          0%, 100% { transform: translate(0, 0) scale(1); }
          25% { transform: translate(20px, -50px) scale(1.1); }
          50% { transform: translate(-20px, 20px) scale(0.9); }
          75% { transform: translate(50px, 50px) scale(1.05); }
        }
        
        @keyframes float {
          0%, 100% { transform: translateY(0px); }
          50% { transform: translateY(-20px); }
        }
        
        .animate-blob {
          animation: blob 7s infinite;
        }
        
        .animation-delay-2000 {
          animation-delay: 2s;
        }
        
        .animation-delay-4000 {
          animation-delay: 4s;
        }
        
        .animate-float {
          animation: float 6s ease-in-out infinite;
        }
      `})]})},uZ=()=>{const[n,e]=C.useState([]),[t,r]=C.useState(!0),[s,i]=C.useState(!1),{user:o,signOut:a}=Is(),{toast:l}=jo(),c=yi();C.useEffect(()=>{u()},[o]);const u=async()=>{if(!o){c("/login");return}try{const x=await iy(Qn(_n,"users",o.uid)),A=x.exists()?x.data():null;o.email==="mahmoudgadmostafa@gmail.com"||(A==null?void 0:A.role)==="admin"?(i(!0),h()):(l({title:" ",description:"     ",variant:"destructive"}),c("/"))}catch(x){console.error("Error checking admin status:",x),c("/")}},h=async()=>{try{r(!0),console.log("Attempting to fetch all users...");const x=Rb(_n,"users"),A=await BN(x);console.log("Successfully fetched snapshot. Size:",A.size);const j=[];A.forEach(N=>{const S=N.data();j.push({id:N.id,...S})}),j.sort((N,S)=>N.status==="pending"&&S.status!=="pending"?-1:N.status!=="pending"&&S.status==="pending"?1:new Date(S.createdAt).getTime()-new Date(N.createdAt).getTime()),e(j),console.log("Processed users list:",j)}catch(x){console.error("CRITICAL: Error fetching users:",x);let A="    ";x.code==="permission-denied"&&(A="  :     Firestore  Firebase Console"),l({title:"   ",description:`${A} (${x.code||"unknown"})`,variant:"destructive"})}finally{r(!1)}},f=async x=>{try{await Kh(Qn(_n,"users",x),{status:"approved"}),l({title:" ",description:"    "}),h()}catch(A){console.error("Error approving user:",A),l({title:"",description:"     ",variant:"destructive"})}},p=async x=>{try{await Kh(Qn(_n,"users",x),{status:"rejected"}),l({title:" ",description:"  "}),h()}catch(A){console.error("Error rejecting user:",A),l({title:"",description:"    ",variant:"destructive"})}},y=async x=>{if(confirm("      "))try{await zN(Qn(_n,"users",x)),l({title:" ",description:"   "}),h()}catch(A){console.error("Error deleting user:",A),l({title:"",description:"    ",variant:"destructive"})}},m=async()=>{await a(),c("/login")};if(t)return g.jsx("div",{className:"min-h-screen flex items-center justify-center",children:g.jsxs("div",{className:"text-center",children:[g.jsx("div",{className:"w-16 h-16 border-4 border-indigo-200 border-t-indigo-600 rounded-full animate-spin mx-auto mb-4"}),g.jsx("p",{className:"text-gray-600 font-medium",children:" ..."})]})});if(!s)return null;const v=n.filter(x=>x.status==="pending"),w=n.filter(x=>x.status==="approved"),_=n.filter(x=>x.status==="rejected");return g.jsxs("div",{className:"min-h-screen bg-gray-50 pb-12",dir:"rtl",children:[g.jsx("header",{className:"bg-white border-b shadow-sm sticky top-0 z-30",children:g.jsx("div",{className:"container mx-auto px-4 py-4",children:g.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[g.jsxs("div",{className:"flex items-center gap-3 w-full sm:w-auto",children:[g.jsx("div",{className:"w-10 h-10 rounded-xl bg-indigo-50 flex items-center justify-center",children:g.jsx(Na,{className:"h-6 w-6 text-indigo-600"})}),g.jsxs("div",{children:[g.jsx("h1",{className:"text-xl md:text-2xl font-bold text-gray-900 leading-none",children:"  "}),g.jsx("p",{className:"text-xs md:text-sm text-gray-500 mt-1",children:"  "})]})]}),g.jsxs("div",{className:"flex items-center gap-2 w-full sm:w-auto justify-end",children:[g.jsx(ae,{variant:"outline",size:"sm",onClick:()=>c("/"),className:"h-9",children:" "}),g.jsxs(ae,{variant:"ghost",size:"sm",onClick:m,className:"h-9 text-rose-600 hover:bg-rose-50 hover:text-rose-700",children:[g.jsx(Cm,{className:"h-4 w-4 ml-2"}),""]})]})]})})}),g.jsxs("div",{className:"container mx-auto px-4 py-6 md:py-8",children:[g.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 md:gap-6 mb-8",children:[{label:" ",value:n.length,color:"text-gray-900",bg:"bg-white"},{label:" ",value:v.length,color:"text-amber-600",bg:"bg-amber-50"},{label:"",value:w.length,color:"text-green-600",bg:"bg-green-50"},{label:"",value:_.length,color:"text-red-600",bg:"bg-red-50"}].map((x,A)=>g.jsx(Ta,{className:`border-none shadow-sm ${x.bg}`,children:g.jsxs(Ca,{className:"p-4 md:p-6",children:[g.jsx("p",{className:"text-[10px] md:text-sm font-bold text-slate-500 mb-1",children:x.label}),g.jsx("div",{className:`text-2xl md:text-4xl font-extrabold ${x.color}`,children:x.value})]})},A))}),g.jsxs("div",{className:"space-y-8",children:[v.length>0&&g.jsxs(Ta,{className:"border-none shadow-md overflow-hidden",children:[g.jsx(Pc,{className:"bg-amber-50/50 border-b border-amber-100 pb-4",children:g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("div",{className:"p-2 bg-amber-100 rounded-lg text-amber-600",children:g.jsx(SE,{className:"h-5 w-5"})}),g.jsxs("div",{children:[g.jsx(Ic,{className:"text-lg md:text-xl",children:"  "}),g.jsx(Od,{className:"text-amber-700/70",children:"     "})]})]})}),g.jsx(Ca,{className:"p-0",children:g.jsx("div",{className:"divide-y divide-amber-100",children:v.map(x=>g.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between p-4 md:p-6 gap-4 hover:bg-amber-50/30 transition-colors",children:[g.jsxs("div",{className:"flex-1 space-y-1",children:[g.jsxs("h3",{className:"text-lg font-bold text-slate-900",children:["/ ",x.teacherName]}),g.jsxs("div",{className:"flex flex-wrap gap-x-4 gap-y-1 text-sm text-slate-600",children:[g.jsxs("span",{children:[": ",g.jsx("b",{children:x.subject})]}),g.jsxs("span",{children:[": ",g.jsx("b",{children:x.phone})]})]}),g.jsx("p",{className:"text-xs text-slate-400 font-mono",children:x.email})]}),g.jsxs("div",{className:"flex items-center gap-2 w-full md:w-auto border-t md:border-none pt-3 md:pt-0",children:[g.jsxs(ae,{size:"sm",onClick:()=>f(x.id),className:"flex-1 md:flex-none bg-green-600 hover:bg-green-700 shadow-sm",children:[g.jsx(wE,{className:"h-4 w-4 ml-2"}),""]}),g.jsxs(ae,{size:"sm",variant:"destructive",onClick:()=>p(x.id),className:"flex-1 md:flex-none shadow-sm",children:[g.jsx(cw,{className:"h-4 w-4 ml-2"}),""]})]})]},x.id))})})]}),g.jsxs(Ta,{className:"border-none shadow-md overflow-hidden",children:[g.jsx(Pc,{className:"border-b border-slate-100",children:g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("div",{className:"p-2 bg-indigo-50 rounded-lg text-indigo-600",children:g.jsx(SE,{className:"h-5 w-5"})}),g.jsx(Ic,{className:"text-lg md:text-xl",children:"  "})]})}),g.jsx(Ca,{className:"p-0",children:g.jsx("div",{className:"divide-y divide-slate-100",children:n.map(x=>g.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between p-4 md:p-6 gap-4 hover:bg-slate-50 transition-colors",children:[g.jsxs("div",{className:"flex-1 space-y-1",children:[g.jsxs("div",{className:"flex items-center flex-wrap gap-2",children:[g.jsxs("h3",{className:"font-bold text-slate-900",children:["/ ",x.teacherName]}),(x.role==="admin"||x.email==="mahmoudgadmostafa@gmail.com")&&g.jsx("span",{className:"px-2 py-0.5 text-[10px] font-bold bg-indigo-100 text-indigo-700 rounded-full border border-indigo-200",children:" "}),g.jsx("span",{className:`px-2 py-0.5 text-[10px] font-bold rounded-full border ${x.status==="pending"?"bg-amber-100 text-amber-700 border-amber-200":x.status==="approved"?"bg-emerald-100 text-emerald-700 border-emerald-200":"bg-rose-100 text-rose-700 border-rose-200"}`,children:x.status==="pending"?" ":x.status==="approved"?"":""})]}),g.jsxs("div",{className:"flex flex-wrap gap-x-3 text-xs text-slate-500",children:[g.jsxs("span",{children:[": ",g.jsx("b",{children:x.subject})]}),g.jsx("span",{className:"hidden sm:inline",children:"|"}),g.jsxs("span",{children:[": ",g.jsx("b",{children:x.phone})]})]}),g.jsx("p",{className:"text-[10px] text-slate-400 font-mono truncate max-w-[200px] md:max-w-none",children:x.email})]}),g.jsxs("div",{className:"flex items-center gap-2 w-full md:w-auto justify-end border-t md:border-none pt-3 md:pt-0",children:[x.status==="pending"&&g.jsxs(g.Fragment,{children:[g.jsx(ae,{size:"icon",onClick:()=>f(x.id),className:"bg-green-600 hover:bg-green-700 h-8 w-8 rounded-lg",title:"",children:g.jsx(wE,{className:"h-4 w-4"})}),g.jsx(ae,{size:"icon",variant:"destructive",onClick:()=>p(x.id),className:"h-8 w-8 rounded-lg",title:"",children:g.jsx(cw,{className:"h-4 w-4"})})]}),x.status==="rejected"&&g.jsx(ae,{size:"sm",onClick:()=>f(x.id),className:"bg-green-600 hover:bg-green-700 text-xs h-8",children:" "}),x.status==="approved"&&x.role!=="admin"&&x.email!=="mahmoudgadmostafa@gmail.com"&&g.jsx(ae,{size:"sm",variant:"outline",onClick:()=>p(x.id),className:"text-xs h-8 text-rose-600 border-rose-100 hover:bg-rose-50",children:" "}),x.role!=="admin"&&x.email!=="mahmoudgadmostafa@gmail.com"&&g.jsx(ae,{size:"icon",variant:"ghost",onClick:()=>y(x.id),className:"text-slate-400 hover:text-red-600 hover:bg-red-50 h-8 w-8 rounded-lg transition-colors",title:" ",children:g.jsx(Rh,{className:"h-4 w-4"})})]})]},x.id))})})]})]})]})]})},hZ=()=>{const n=yi(),{signOut:e}=Is(),t=async()=>{await e(),n("/login")};return g.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-amber-50 via-orange-50 to-yellow-50",dir:"rtl",children:g.jsx("div",{className:"max-w-md w-full mx-4",children:g.jsxs("div",{className:"bg-white/80 backdrop-blur-lg rounded-3xl shadow-2xl p-8 border border-white/20 text-center",children:[g.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-amber-500 to-orange-600 rounded-2xl mb-6 shadow-lg",children:g.jsx(aR,{size:40,className:"text-white"})}),g.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-amber-600 to-orange-600 bg-clip-text text-transparent mb-4",children:"  "}),g.jsxs("p",{className:"text-gray-600 mb-6 leading-relaxed",children:["   !       .",g.jsx("br",{}),"     ."]}),g.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4 mb-6",children:g.jsx("p",{className:"text-sm text-amber-800",children:"         "})}),g.jsxs(ae,{onClick:t,variant:"outline",className:"w-full gap-2",children:[g.jsx(Cm,{className:"h-4 w-4"})," "]})]})})})},dZ=()=>{const n=yi(),{signOut:e}=Is(),t=async()=>{await e(),n("/login")};return g.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-red-50 via-rose-50 to-pink-50",dir:"rtl",children:g.jsx("div",{className:"max-w-md w-full mx-4",children:g.jsxs("div",{className:"bg-white/80 backdrop-blur-lg rounded-3xl shadow-2xl p-8 border border-white/20 text-center",children:[g.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-red-500 to-rose-600 rounded-2xl mb-6 shadow-lg",children:g.jsx(cw,{size:40,className:"text-white"})}),g.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-red-600 to-rose-600 bg-clip-text text-transparent mb-4",children:"  "}),g.jsxs("p",{className:"text-gray-600 mb-6 leading-relaxed",children:["            .",g.jsx("br",{}),"      ."]}),g.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:g.jsx("p",{className:"text-sm text-red-800",children:"     "})}),g.jsxs(ae,{onClick:t,variant:"outline",className:"w-full gap-2",children:[g.jsx(Cm,{className:"h-4 w-4"})," "]})]})})})},fZ=()=>{const[n,e]=C.useState(!1),{user:t}=Is(),{toast:r}=jo(),s=async()=>{if(!t){r({title:"",description:"   ",variant:"destructive"});return}e(!0);try{await Kh(Qn(_n,"users",t.uid),{role:"admin",status:"approved"}),r({title:" !",description:"    .   ."}),setTimeout(()=>{window.location.reload()},2e3)}catch(i){console.error("Error making admin:",i),r({title:"",description:` : ${i.message}`,variant:"destructive"})}finally{e(!1)}};return g.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-indigo-50 to-purple-50 p-4",dir:"rtl",children:g.jsxs(Ta,{className:"w-full max-w-md",children:[g.jsxs(Pc,{children:[g.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[g.jsx(Na,{className:"h-8 w-8 text-indigo-600"}),g.jsx(Ic,{className:"text-2xl",children:"  "})]}),g.jsx(Od,{children:"       "})]}),g.jsxs(Ca,{className:"space-y-4",children:[g.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4 flex gap-3",children:[g.jsx(w5,{className:"h-5 w-5 text-amber-600 flex-shrink-0 mt-0.5"}),g.jsxs("div",{className:"text-sm text-amber-800",children:[g.jsx("p",{className:"font-semibold mb-1",children:":"}),g.jsx("p",{children:"         ."})]})]}),t?g.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-2",children:[g.jsx("p",{className:"text-sm text-gray-600",children:" :"}),g.jsx("p",{className:"font-semibold text-gray-900",children:t.email}),g.jsxs("p",{className:"text-xs text-gray-500",children:["UID: ",t.uid]})]}):g.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:g.jsx("p",{className:"text-sm text-red-800",children:"   "})}),g.jsx(ae,{onClick:s,disabled:n||!t,className:"w-full h-12 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700",children:n?g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("div",{className:"w-5 h-5 border-2 border-white/20 border-t-white rounded-full animate-spin"})," ..."]}):g.jsxs(g.Fragment,{children:[g.jsx(Na,{className:"h-5 w-5 ml-2"}),"  "]})}),g.jsx("p",{className:"text-xs text-center text-gray-500",children:"       "})]})]})})},pZ=()=>{const[n,e]=C.useState(null),[t,r]=C.useState(!0),[s,i]=C.useState(!1),{user:o}=Is(),{toast:a}=jo(),l=yi(),c=async()=>{if(o){r(!0);try{const h=Qn(_n,"users",o.uid),f=await iy(h);f.exists()?e({id:f.id,...f.data()}):e(null)}catch(h){console.error("Error:",h),a({title:"",description:h.message,variant:"destructive"})}finally{r(!1)}}};C.useEffect(()=>{c()},[o]);const u=async()=>{if(o){i(!0);try{await Kh(Qn(_n,"users",o.uid),{role:"admin",status:"approved"}),a({title:" !",description:"   "}),c(),setTimeout(()=>{l("/")},1500)}catch(h){a({title:"",description:h.message,variant:"destructive"})}finally{i(!1)}}};return t?g.jsx("div",{className:"min-h-screen flex items-center justify-center",children:g.jsxs("div",{className:"text-center",children:[g.jsx("div",{className:"w-16 h-16 border-4 border-indigo-200 border-t-indigo-600 rounded-full animate-spin mx-auto mb-4"}),g.jsx("p",{className:"text-gray-600",children:" ..."})]})}):g.jsx("div",{className:"min-h-screen bg-gray-50 p-8",dir:"rtl",children:g.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[g.jsxs(Ta,{children:[g.jsxs(Pc,{children:[g.jsxs(Ic,{className:"flex items-center gap-2",children:[g.jsx(fw,{className:"h-6 w-6"}),"  "]}),g.jsx(Od,{children:"   "})]}),g.jsx(Ca,{className:"space-y-4",children:o?g.jsxs(g.Fragment,{children:[g.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[g.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:" Firebase Auth:"}),g.jsxs("div",{className:"space-y-1 text-sm",children:[g.jsxs("p",{children:[g.jsx("strong",{children:"UID:"})," ",o.uid]}),g.jsxs("p",{children:[g.jsx("strong",{children:"Email:"})," ",o.email]})]})]}),n?g.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[g.jsx("h3",{className:"font-semibold text-green-900 mb-2",children:" Firestore:"}),g.jsxs("div",{className:"space-y-1 text-sm",children:[g.jsxs("p",{children:[g.jsx("strong",{children:" :"})," ",n.teacherName||" "]}),g.jsxs("p",{children:[g.jsx("strong",{children:":"})," ",n.subject||" "]}),g.jsxs("p",{children:[g.jsx("strong",{children:":"})," ",n.phone||" "]}),g.jsxs("p",{children:[g.jsx("strong",{children:":"})," ",n.email||" "]}),g.jsxs("p",{children:[g.jsx("strong",{children:" (Role):"})," ",g.jsx("span",{className:n.role==="admin"?"text-green-700 font-bold":"text-red-700 font-bold",children:n.role||" "})]}),g.jsxs("p",{children:[g.jsx("strong",{children:" (Status):"})," ",g.jsx("span",{className:n.status==="approved"?"text-green-700":"text-amber-700",children:n.status||" "})]})]})]}):g.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:g.jsx("p",{className:"text-red-800 font-semibold",children:"     Firestore  !"})}),g.jsxs("div",{className:"flex gap-3",children:[g.jsxs(ae,{onClick:c,variant:"outline",className:"gap-2",children:[g.jsx(h5,{className:"h-4 w-4"})," "]}),n&&n.role!=="admin"&&g.jsxs(ae,{onClick:u,disabled:s,className:"gap-2 bg-indigo-600 hover:bg-indigo-700",children:[g.jsx(Na,{className:"h-4 w-4"}),s?" ...":"  "]}),n&&n.role==="admin"&&g.jsxs(ae,{onClick:()=>l("/admin"),className:"gap-2 bg-green-600 hover:bg-green-700",children:[g.jsx(Na,{className:"h-4 w-4"}),"   "]})]}),g.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4 text-sm",children:g.jsxs("p",{className:"text-amber-800",children:[" ",g.jsx("strong",{children:":"}),'    (Role)  "admin"    "  "  .']})})]}):g.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:g.jsx("p",{className:"text-red-800",children:"   "})})})]}),g.jsx("div",{className:"flex gap-3",children:g.jsx(ae,{onClick:()=>l("/"),variant:"outline",children:"  "})})]})})},gZ=()=>{const n=vd();return C.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",n.pathname)},[n.pathname]),g.jsx("div",{className:"flex min-h-screen items-center justify-center bg-muted",children:g.jsxs("div",{className:"text-center",children:[g.jsx("h1",{className:"mb-4 text-4xl font-bold",children:"404"}),g.jsx("p",{className:"mb-4 text-xl text-muted-foreground",children:"Oops! Page not found"}),g.jsx("a",{href:"/",className:"text-primary underline hover:text-primary/90",children:"Return to Home"})]})})},mZ=new W$,yZ=()=>g.jsx(q$,{client:mZ,children:g.jsx(eq,{children:g.jsxs(_$,{children:[g.jsx(r3,{}),g.jsx(D3,{}),g.jsx(L6,{children:g.jsxs(j6,{children:[g.jsx(Cr,{path:"/login",element:g.jsx(lZ,{})}),g.jsx(Cr,{path:"/signup",element:g.jsx(cZ,{})}),g.jsx(Cr,{path:"/make-admin",element:g.jsx(fZ,{})}),g.jsx(Cr,{path:"/debug-user",element:g.jsx(pZ,{})}),g.jsx(Cr,{path:"/pending-approval",element:g.jsx(hZ,{})}),g.jsx(Cr,{path:"/account-rejected",element:g.jsx(dZ,{})}),g.jsx(Cr,{path:"/",element:g.jsx(Mv,{children:g.jsx(OK,{})})}),g.jsx(Cr,{path:"/preparation",element:g.jsx(Mv,{children:g.jsx(iZ,{})})}),g.jsx(Cr,{path:"/admin",element:g.jsx(Mv,{children:g.jsx(uZ,{})})}),g.jsx(Cr,{path:"*",element:g.jsx(gZ,{})})]})})]})})});PI(document.getElementById("root")).render(g.jsx(yZ,{}));
